/*! For license information please see module.js.LICENSE.txt */
define(["@grafana/data","react","@grafana/runtime","@grafana/ui","@emotion/css","lodash","prismjs","react-dom","redux","react-redux","rxjs","d3"],((e,t,r,n,i,a,o,s,l,c,u,d)=>(()=>{var p,h={4932:(e,t,r)=>{var n,i=r(2650),a=(n=i)&&"object"==typeof n&&"default"in n?n.default:n,o=r(7388),s=r(3305),l=(r(5980),function(){return(l=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)});function c(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,a=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)o.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}return o}var u,d=["af-south-1","ap-east-1","ap-northeast-1","ap-northeast-2","ap-northeast-3","ap-south-1","ap-southeast-1","ap-southeast-2","ca-central-1","cn-north-1","cn-northwest-1","eu-central-1","eu-north-1","eu-west-1","eu-west-2","eu-west-3","me-south-1","sa-east-1","us-east-1","us-east-2","us-gov-east-1","us-gov-west-1","us-iso-east-1","us-isob-east-1","us-west-1","us-west-2"];(u=t._e||(t._e={})).Keys="keys",u.Credentials="credentials",u.Default="default",u.EC2IAMRole="ec2_iam_role",u.ARN="arn";var p,h=[{label:"Workspace IAM Role",value:t._e.EC2IAMRole},{label:"AWS SDK Default",value:t._e.Default},{label:"Access & secret key",value:t._e.Keys},{label:"Credentials file",value:t._e.Credentials}],f=function(e){return{value:e,label:e}},m=function(e){var r,n,u,p,m,g,b,v,y,O=c(i.useState((e.standardRegions||d).map(f)),2),x=O[0],w=O[1],_=e.loadRegions,S=e.onOptionsChange,E=e.skipHeader,k=void 0!==E&&E,P=e.skipEndpoint,T=void 0!==P&&P,C=e.options,I=C.jsonData.profile;void 0===I&&(I=C.database);var D=window.grafanaBootData.settings,A=null!==(r=D.awsAllowedAuthProviders)&&void 0!==r?r:[t._e.Default,t._e.Keys,t._e.Credentials],R=null===(n=D.awsAssumeRoleEnabled)||void 0===n||n,j=h.find((function(e){return e.value===C.jsonData.authType}));return i.useEffect((function(){!j&&A.length&&S(l(l({},C),{jsonData:l(l({},C.jsonData),{authType:A[0]})}))}),[j,C,S]),i.useEffect((function(){_&&_().then((function(e){return w(e.map(f))}))}),[_]),a.createElement(o.FieldSet,{label:k?"":"Connection Details","data-testid":"connection-config"},a.createElement(o.InlineField,{label:"Authentication Provider",labelWidth:28,tooltip:"Specify which AWS credentials chain to use."},a.createElement(o.Select,{"aria-label":"Authentication Provider",className:"width-30",value:j,options:h.filter((function(e){return A.includes(e.value)})),defaultValue:C.jsonData.authType,onChange:function(t){s.onUpdateDatasourceJsonDataOptionSelect(e,"authType")(t)},menuShouldPortal:!0})),"credentials"===C.jsonData.authType&&a.createElement(o.InlineField,{label:"Credentials Profile Name",labelWidth:28,tooltip:"Credentials profile name, as specified in ~/.aws/credentials, leave blank for default."},a.createElement(o.Input,{"aria-label":"Credentials Profile Name",className:"width-30",placeholder:"default",value:I,onChange:s.onUpdateDatasourceJsonDataOption(e,"profile")})),"keys"===C.jsonData.authType&&a.createElement(a.Fragment,null,a.createElement(o.InlineField,{label:"Access Key ID",labelWidth:28},(null===(u=e.options.secureJsonFields)||void 0===u?void 0:u.accessKey)?a.createElement(o.ButtonGroup,{className:"width-30"},a.createElement(o.Input,{disabled:!0,placeholder:"Configured"}),a.createElement(o.ToolbarButton,{icon:"edit",tooltip:"Edit Access Key ID",type:"button",onClick:s.onUpdateDatasourceResetOption(e,"accessKey")})):a.createElement(o.Input,{"aria-label":"Access Key ID",className:"width-30",value:null!==(m=null===(p=C.secureJsonData)||void 0===p?void 0:p.accessKey)&&void 0!==m?m:"",onChange:s.onUpdateDatasourceSecureJsonDataOption(e,"accessKey")})),a.createElement(o.InlineField,{label:"Secret Access Key",labelWidth:28},(null===(g=e.options.secureJsonFields)||void 0===g?void 0:g.secretKey)?a.createElement(o.ButtonGroup,{className:"width-30"},a.createElement(o.Input,{disabled:!0,placeholder:"Configured"}),a.createElement(o.ToolbarButton,{icon:"edit",type:"button",tooltip:"Edit Secret Access Key",onClick:s.onUpdateDatasourceResetOption(e,"secretKey")})):a.createElement(o.Input,{"aria-label":"Secret Access Key",className:"width-30",value:null!==(v=null===(b=C.secureJsonData)||void 0===b?void 0:b.secretKey)&&void 0!==v?v:"",onChange:s.onUpdateDatasourceSecureJsonDataOption(e,"secretKey")}))),R&&a.createElement(a.Fragment,null,a.createElement(o.InlineField,{label:"Assume Role ARN",labelWidth:28,tooltip:"Optionally, specify the ARN of a role to assume. Specifying a role here will ensure that the selected authentication provider is used to assume the specified role rather than using the credentials directly. Leave blank if you don't need to assume a role at all"},a.createElement(o.Input,{"aria-label":"Assume Role ARN",className:"width-30",placeholder:"arn:aws:iam:*",value:C.jsonData.assumeRoleArn||"",onChange:s.onUpdateDatasourceJsonDataOption(e,"assumeRoleArn")})),a.createElement(o.InlineField,{label:"External ID",labelWidth:28,tooltip:"If you are assuming a role in another account, that has been created with an external ID, specify the external ID here."},a.createElement(o.Input,{"aria-label":"External ID",className:"width-30",placeholder:"External ID",value:C.jsonData.externalId||"",onChange:s.onUpdateDatasourceJsonDataOption(e,"externalId")}))),!T&&a.createElement(o.InlineField,{label:"Endpoint",labelWidth:28,tooltip:"Optionally, specify a custom endpoint for the service"},a.createElement(o.Input,{"aria-label":"Endpoint",className:"width-30",placeholder:null!==(y=e.defaultEndpoint)&&void 0!==y?y:"https://{service}.{region}.amazonaws.com",value:C.jsonData.endpoint||"",onChange:s.onUpdateDatasourceJsonDataOption(e,"endpoint")})),a.createElement(o.InlineField,{label:"Default Region",labelWidth:28,tooltip:"Specify the region, such as for US West (Oregon) use ` us-west-2 ` as the region."},a.createElement(o.Select,{"aria-label":"Default Region",className:"width-30",value:x.find((function(e){return e.value===C.jsonData.defaultRegion})),options:x,defaultValue:C.jsonData.defaultRegion,allowCustomValue:!0,onChange:s.onUpdateDatasourceJsonDataOptionSelect(e,"defaultRegion"),formatCreateLabel:function(e){return"Use region: "+e},menuShouldPortal:!0})),e.children)};(p=t.rB||(t.rB={}))[p.Previous=0]="Previous",p[p.Null=1]="Null",p[p.Value=2]="Value";t.rB.Previous,t.rB.Null,t.rB.Value;t.SIGV4ConnectionConfig=function(e){var t,r,n,i,o=e.onOptionsChange,s=e.options,c={onOptionsChange:function(e){var t,r,n,i,a=l(l({},s),{jsonData:l(l({},s.jsonData),{sigV4AuthType:e.jsonData.authType,sigV4Profile:e.jsonData.profile,sigV4AssumeRoleArn:e.jsonData.assumeRoleArn,sigV4ExternalId:e.jsonData.externalId,sigV4Region:e.jsonData.defaultRegion,sigV4Endpoint:e.jsonData.endpoint}),secureJsonFields:{sigV4AccessKey:null===(t=e.secureJsonFields)||void 0===t?void 0:t.accessKey,sigV4SecretKey:null===(r=e.secureJsonFields)||void 0===r?void 0:r.secretKey},secureJsonData:{sigV4AccessKey:null===(n=e.secureJsonData)||void 0===n?void 0:n.accessKey,sigV4SecretKey:null===(i=e.secureJsonData)||void 0===i?void 0:i.secretKey}});o(a)},options:l(l({},s),{jsonData:l(l({},s.jsonData),{authType:s.jsonData.sigV4AuthType,profile:s.jsonData.sigV4Profile,assumeRoleArn:s.jsonData.sigV4AssumeRoleArn,externalId:s.jsonData.sigV4ExternalId,defaultRegion:s.jsonData.sigV4Region,endpoint:s.jsonData.sigV4Endpoint}),secureJsonFields:{accessKey:null===(t=s.secureJsonFields)||void 0===t?void 0:t.sigV4AccessKey,secretKey:null===(r=s.secureJsonFields)||void 0===r?void 0:r.sigV4SecretKey},secureJsonData:{accessKey:null===(n=s.secureJsonData)||void 0===n?void 0:n.sigV4AccessKey,secretKey:null===(i=s.secureJsonData)||void 0===i?void 0:i.sigV4SecretKey}})};return a.createElement(a.Fragment,null,a.createElement("div",{className:"gf-form"},a.createElement("h6",null,"SigV4 Auth Details")),a.createElement(m,l({},c,{skipHeader:!0,skipEndpoint:!0})))}},2199:(e,t,r)=>{"use strict";e.exports=r(4932)},7667:(e,t,r)=>{"use strict";e.exports=r(7250)},7250:(e,t)=>{"use strict";const r={TimePicker:{openButton:"data-testid TimePicker Open Button",fromField:"Time Range from field",toField:"Time Range to field",applyTimeRange:"data-testid TimePicker submit button",calendar:{label:"Time Range calendar",openButton:"Open time range calendar",closeButton:"Close time range Calendar"},absoluteTimeRangeTitle:"data-testid-absolute-time-range-narrow"},DataSource:{TestData:{QueryTab:{scenarioSelectContainer:"Test Data Query scenario select container",scenarioSelect:"Test Data Query scenario select",max:"TestData max",min:"TestData min",noise:"TestData noise",seriesCount:"TestData series count",spread:"TestData spread",startValue:"TestData start value",drop:"TestData drop values"}},DataSourceHttpSettings:{urlInput:"Datasource HTTP settings url"},Jaeger:{traceIDInput:"Trace ID"},Prometheus:{configPage:{exemplarsAddButton:"Add exemplar config button",internalLinkSwitch:"Internal link switch"},exemplarMarker:"Exemplar marker"}},Menu:{MenuComponent:e=>`${e} menu`,MenuGroup:e=>`${e} menu group`,MenuItem:e=>`${e} menu item`,SubMenu:{container:"SubMenu container",icon:"SubMenu icon"}},Panels:{Panel:{title:e=>`data-testid Panel header ${e}`,headerItems:e=>`Panel header item ${e}`,containerByTitle:e=>`${e} panel`,headerCornerInfo:e=>`Panel header ${e}`},Visualization:{Graph:{VisualizationTab:{legendSection:"Legend section"},Legend:{legendItemAlias:e=>`gpl alias ${e}`,showLegendSwitch:"gpl show legend"},xAxis:{labels:()=>"div.flot-x-axis > div.flot-tick-label"}},BarGauge:{value:"Bar gauge value",valueV2:"data-testid Bar gauge value"},PieChart:{svgSlice:"Pie Chart Slice"},Text:{container:()=>".markdown-html"},Table:{header:"table header",footer:"table-footer"}}},VizLegend:{seriesName:e=>`VizLegend series ${e}`},Drawer:{General:{title:e=>`Drawer title ${e}`,expand:"Drawer expand",contract:"Drawer contract",close:"Drawer close",rcContentWrapper:()=>".drawer-content-wrapper"}},PanelEditor:{General:{content:"Panel editor content"},OptionsPane:{content:"Panel editor option pane content",select:"Panel editor option pane select",fieldLabel:e=>`${e} field property editor`},DataPane:{content:"Panel editor data pane content"},applyButton:"Apply changes and go back to dashboard",toggleVizPicker:"toggle-viz-picker",toggleVizOptions:"toggle-viz-options",toggleTableView:"toggle-table-view"},PanelInspector:{Data:{content:"Panel inspector Data content"},Stats:{content:"Panel inspector Stats content"},Json:{content:"Panel inspector Json content"},Query:{content:"Panel inspector Query content",refreshButton:"Panel inspector Query refresh button",jsonObjectKeys:()=>".json-formatter-key"}},Tab:{title:e=>`Tab ${e}`,active:()=>'[class*="-activeTabStyle"]'},RefreshPicker:{runButton:"RefreshPicker run button",intervalButton:"RefreshPicker interval button",runButtonV2:"data-testid RefreshPicker run button",intervalButtonV2:"data-testid RefreshPicker interval button"},QueryTab:{content:"Query editor tab content",queryInspectorButton:"Query inspector button",queryHistoryButton:"Rich history button",addQuery:"Query editor add query button"},QueryHistory:{queryText:"Query text"},QueryEditorRows:{rows:"Query editor row"},QueryEditorRow:{actionButton:e=>`${e} query operation action`,title:e=>`Query editor row title ${e}`,container:e=>`Query editor row ${e}`},AlertTab:{content:"Alert editor tab content"},Alert:{alert:e=>`Alert ${e}`,alertV2:e=>`data-testid Alert ${e}`},TransformTab:{content:"Transform editor tab content",newTransform:e=>`New transform ${e}`,transformationEditor:e=>`Transformation editor ${e}`,transformationEditorDebugger:e=>`Transformation editor debugger ${e}`},Transforms:{card:e=>`New transform ${e}`,Reduce:{modeLabel:"Transform mode label",calculationsLabel:"Transform calculations label"},searchInput:"search transformations"},PageToolbar:{container:()=>".page-toolbar",item:e=>`${e}`},QueryEditorToolbarItem:{button:e=>`QueryEditor toolbar item button ${e}`},BackButton:{backArrow:"Go Back"},OptionsGroup:{group:e=>e?`Options group ${e}`:"Options group",toggle:e=>e?`Options group ${e} toggle`:"Options group toggle"},PluginVisualization:{item:e=>`Plugin visualization item ${e}`,current:()=>'[class*="-currentVisualizationItem"]'},Select:{option:"Select option",input:()=>'input[id*="time-options-input"]',singleValue:()=>'div[class*="-singleValue"]'},FieldConfigEditor:{content:"Field config editor content"},OverridesConfigEditor:{content:"Field overrides editor content"},FolderPicker:{container:"Folder picker select container",containerV2:"data-testid Folder picker select container",input:"Select a folder"},ReadonlyFolderPicker:{container:"data-testid Readonly folder picker select container"},DataSourcePicker:{container:"Data source picker select container",input:()=>'input[id="data-source-picker"]',inputV2:"Select a data source"},TimeZonePicker:{container:"Time zone picker select container",containerV2:"data-testid Time zone picker select container"},WeekStartPicker:{container:"Choose starting day of the week",containerV2:"data-testid Choose starting day of the week",placeholder:"Choose starting day of the week"},TraceViewer:{spanBar:"data-testid SpanBar--wrapper"},QueryField:{container:"Query field"},QueryBuilder:{queryPatterns:"Query patterns",labelSelect:"Select label",valueSelect:"Select value",matchOperatorSelect:"Select match operator"},ValuePicker:{button:e=>`Value picker button ${e}`,select:e=>`Value picker select ${e}`},Search:{section:"Search section",sectionV2:"data-testid Search section",items:"Search items",itemsV2:"data-testid Search items",cards:"data-testid Search cards",collapseFolder:e=>`data-testid Collapse folder ${e}`,expandFolder:e=>`data-testid Expand folder ${e}`,dashboardItem:e=>`${r.Search.dashboardItems} ${e}`,dashboardCard:e=>`data-testid Search card ${e}`,dashboardItems:"data-testid Dashboard search item"},DashboardLinks:{container:"data-testid Dashboard link container",dropDown:"data-testid Dashboard link dropdown",link:"data-testid Dashboard link"},LoadingIndicator:{icon:"Loading indicator"},CallToActionCard:{button:e=>`Call to action button ${e}`,buttonV2:e=>`data-testid Call to action button ${e}`},DataLinksContextMenu:{singleLink:"Data link"},CodeEditor:{container:"Code editor container"},DashboardImportPage:{textarea:"data-testid-import-dashboard-textarea",submit:"data-testid-load-dashboard"},ImportDashboardForm:{name:"data-testid-import-dashboard-title",submit:"data-testid-import-dashboard-submit"},PanelAlertTabContent:{content:"Unified alert editor tab content"},VisualizationPreview:{card:e=>`data-testid suggestion-${e}`},ColorSwatch:{name:"data-testid-colorswatch"},DashboardRow:{title:e=>`data-testid dashboard-row-title-${e}`},UserProfile:{profileSaveButton:"data-testid-user-profile-save",preferencesSaveButton:"data-testid-shared-prefs-save",orgsTable:"data-testid-user-orgs-table",sessionsTable:"data-testid-user-sessions-table"},FileUpload:{inputField:"data-testid-file-upload-input-field",fileNameSpan:"data-testid-file-upload-file-name"}},n={pages:{Login:{url:"/login",username:"Username input field",password:"Password input field",submit:"Login button",skip:"Skip change password button"},Home:{url:"/"},DataSource:{name:"Data source settings page name input field",delete:"Data source settings page Delete button",readOnly:"Data source settings page read only message",saveAndTest:"Data source settings page Save and Test button",alert:"Data source settings page Alert"},DataSources:{url:"/datasources",dataSources:e=>`Data source list item ${e}`},AddDataSource:{url:"/datasources/new",dataSourcePlugins:e=>`Data source plugin item ${e}`,dataSourcePluginsV2:e=>`Add data source ${e}`},ConfirmModal:{delete:"Confirm Modal Danger Button"},AddDashboard:{url:"/dashboard/new",addNewPanel:"Add new panel",addNewRow:"Add new row",addNewPanelLibrary:"Add new panel from panel library"},Dashboard:{url:e=>`/d/${e}`,DashNav:{nav:"Dashboard navigation",navV2:"data-testid Dashboard navigation",publicDashboardTag:"data-testid public dashboard tag"},SubMenu:{submenu:"Dashboard submenu",submenuItem:"data-testid template variable",submenuItemLabels:e=>`data-testid Dashboard template variables submenu Label ${e}`,submenuItemValueDropDownValueLinkTexts:e=>`data-testid Dashboard template variables Variable Value DropDown value link text ${e}`,submenuItemValueDropDownDropDown:"Variable options",submenuItemValueDropDownOptionTexts:e=>`data-testid Dashboard template variables Variable Value DropDown option text ${e}`},Settings:{General:{deleteDashBoard:"Dashboard settings page delete dashboard button",sectionItems:e=>`Dashboard settings section item ${e}`,saveDashBoard:"Dashboard settings aside actions Save button",saveAsDashBoard:"Dashboard settings aside actions Save As button",timezone:"Time zone picker select container",title:"Dashboard settings page title"},Annotations:{List:{addAnnotationCTA:r.CallToActionCard.button("Add annotation query"),addAnnotationCTAV2:r.CallToActionCard.buttonV2("Add annotation query")},Settings:{name:"Annotations settings name input"}},Variables:{List:{addVariableCTA:r.CallToActionCard.button("Add variable"),addVariableCTAV2:r.CallToActionCard.buttonV2("Add variable"),newButton:"Variable editor New variable button",table:"Variable editor Table",tableRowNameFields:e=>`Variable editor Table Name field ${e}`,tableRowDefinitionFields:e=>`Variable editor Table Definition field ${e}`,tableRowArrowUpButtons:e=>`Variable editor Table ArrowUp button ${e}`,tableRowArrowDownButtons:e=>`Variable editor Table ArrowDown button ${e}`,tableRowDuplicateButtons:e=>`Variable editor Table Duplicate button ${e}`,tableRowRemoveButtons:e=>`Variable editor Table Remove button ${e}`},Edit:{General:{headerLink:"Variable editor Header link",modeLabelNew:"Variable editor Header mode New",modeLabelEdit:"Variable editor Header mode Edit",generalNameInput:"Variable editor Form Name field",generalNameInputV2:"data-testid Variable editor Form Name field",generalTypeSelect:"Variable editor Form Type select",generalTypeSelectV2:"data-testid Variable editor Form Type select",generalLabelInput:"Variable editor Form Label field",generalLabelInputV2:"data-testid Variable editor Form Label field",generalHideSelect:"Variable editor Form Hide select",generalHideSelectV2:"data-testid Variable editor Form Hide select",selectionOptionsMultiSwitch:"Variable editor Form Multi switch",selectionOptionsIncludeAllSwitch:"Variable editor Form IncludeAll switch",selectionOptionsCustomAllInput:"Variable editor Form IncludeAll field",selectionOptionsCustomAllInputV2:"data-testid Variable editor Form IncludeAll field",previewOfValuesOption:"Variable editor Preview of Values option",submitButton:"Variable editor Submit button"},QueryVariable:{queryOptionsDataSourceSelect:r.DataSourcePicker.container,queryOptionsRefreshSelect:"Variable editor Form Query Refresh select",queryOptionsRefreshSelectV2:"data-testid Variable editor Form Query Refresh select",queryOptionsRegExInput:"Variable editor Form Query RegEx field",queryOptionsRegExInputV2:"data-testid Variable editor Form Query RegEx field",queryOptionsSortSelect:"Variable editor Form Query Sort select",queryOptionsSortSelectV2:"data-testid Variable editor Form Query Sort select",queryOptionsQueryInput:"Variable editor Form Default Variable Query Editor textarea",valueGroupsTagsEnabledSwitch:"Variable editor Form Query UseTags switch",valueGroupsTagsTagsQueryInput:"Variable editor Form Query TagsQuery field",valueGroupsTagsTagsValuesQueryInput:"Variable editor Form Query TagsValuesQuery field"},ConstantVariable:{constantOptionsQueryInput:"Variable editor Form Constant Query field",constantOptionsQueryInputV2:"data-testid Variable editor Form Constant Query field"},DatasourceVariable:{datasourceSelect:"data-testid datasource variable datasource type"},TextBoxVariable:{textBoxOptionsQueryInput:"Variable editor Form TextBox Query field",textBoxOptionsQueryInputV2:"data-testid Variable editor Form TextBox Query field"},CustomVariable:{customValueInput:"data-testid custom-variable-input"},IntervalVariable:{intervalsValueInput:"data-testid interval variable intervals input"}}}}},Dashboards:{url:"/dashboards",dashboards:e=>`Dashboard search item ${e}`},SaveDashboardAsModal:{newName:"Save dashboard title field",save:"Save dashboard button"},SaveDashboardModal:{save:"Dashboard settings Save Dashboard Modal Save button",saveVariables:"Dashboard settings Save Dashboard Modal Save variables checkbox",saveTimerange:"Dashboard settings Save Dashboard Modal Save timerange checkbox"},SharePanelModal:{linkToRenderedImage:"Link to rendered image"},ShareDashboardModal:{shareButton:"Share dashboard or panel",PublicDashboard:{Tab:"Tab Public Dashboard",WillBePublicCheckbox:"data-testid public dashboard will be public checkbox",LimitedDSCheckbox:"data-testid public dashboard limited datasources checkbox",CostIncreaseCheckbox:"data-testid public dashboard cost may increase checkbox",EnableSwitch:"data-testid public dashboard on off switch",SaveConfigButton:"data-testid public dashboard save config button",CopyUrlInput:"data-testid public dashboard copy url input",CopyUrlButton:"data-testid public dashboard copy url button",TemplateVariablesWarningAlert:"data-testid public dashboard disabled template variables alert"}},Explore:{url:"/explore",General:{container:"data-testid Explore",graph:"Explore Graph",table:"Explore Table",scrollView:"data-testid explorer scroll view"}},SoloPanel:{url:e=>`/d-solo/${e}`},PluginsList:{page:"Plugins list page",list:"Plugins list",listItem:"Plugins list item",signatureErrorNotice:"Unsigned plugins notice"},PluginPage:{page:"Plugin page",signatureInfo:"Plugin signature info",disabledInfo:"Plugin disabled info"},PlaylistForm:{name:"Playlist name",interval:"Playlist interval",itemRow:"Playlist item row",itemIdType:"Playlist item dashboard by ID type",itemTagType:"Playlist item dashboard by Tag type",itemMoveUp:"Move playlist item order up",itemMoveDown:"Move playlist item order down",itemDelete:"Delete playlist item"}},components:r};t.selectors=n},5295:e=>{const t="object"==typeof performance&&performance&&"function"==typeof performance.now?performance:Date,r="function"==typeof AbortController?AbortController:class{constructor(){this.signal=new a}abort(){this.signal.dispatchEvent("abort")}},n="function"==typeof AbortSignal,i="function"==typeof r.AbortSignal,a=n?AbortSignal:i?r.AbortController:class{constructor(){this.aborted=!1,this._listeners=[]}dispatchEvent(e){if("abort"===e){this.aborted=!0;const t={type:e,target:this};this.onabort(t),this._listeners.forEach((e=>e(t)),this)}}onabort(){}addEventListener(e,t){"abort"===e&&this._listeners.push(t)}removeEventListener(e,t){"abort"===e&&(this._listeners=this._listeners.filter((e=>e!==t)))}},o=new Set,s=(e,t)=>{const r=`LRU_CACHE_OPTION_${e}`;u(r)&&d(r,`${e} option`,`options.${t}`,g)},l=(e,t)=>{const r=`LRU_CACHE_METHOD_${e}`;if(u(r)){const{prototype:n}=g,{get:i}=Object.getOwnPropertyDescriptor(n,e);d(r,`${e} method`,`cache.${t}()`,i)}},c=(...e)=>{"object"==typeof process&&process&&"function"==typeof process.emitWarning?process.emitWarning(...e):console.error(...e)},u=e=>!o.has(e),d=(e,t,r,n)=>{o.add(e),c(`The ${t} is deprecated. Please use ${r} instead.`,"DeprecationWarning",e,n)},p=e=>e&&e===Math.floor(e)&&e>0&&isFinite(e),h=e=>p(e)?e<=Math.pow(2,8)?Uint8Array:e<=Math.pow(2,16)?Uint16Array:e<=Math.pow(2,32)?Uint32Array:e<=Number.MAX_SAFE_INTEGER?f:null:null;class f extends Array{constructor(e){super(e),this.fill(0)}}class m{constructor(e){if(0===e)return[];const t=h(e);this.heap=new t(e),this.length=0}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}}class g{constructor(e={}){const{max:t=0,ttl:r,ttlResolution:n=1,ttlAutopurge:i,updateAgeOnGet:a,updateAgeOnHas:l,allowStale:d,dispose:f,disposeAfter:b,noDisposeOnSet:v,noUpdateTTL:y,maxSize:O=0,maxEntrySize:x=0,sizeCalculation:w,fetchMethod:_,fetchContext:S,noDeleteOnFetchRejection:E,noDeleteOnStaleGet:k}=e,{length:P,maxAge:T,stale:C}=e instanceof g?{}:e;if(0!==t&&!p(t))throw new TypeError("max option must be a nonnegative integer");const I=t?h(t):Array;if(!I)throw new Error("invalid max value: "+t);if(this.max=t,this.maxSize=O,this.maxEntrySize=x||this.maxSize,this.sizeCalculation=w||P,this.sizeCalculation){if(!this.maxSize&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if("function"!=typeof this.sizeCalculation)throw new TypeError("sizeCalculation set to non-function")}if(this.fetchMethod=_||null,this.fetchMethod&&"function"!=typeof this.fetchMethod)throw new TypeError("fetchMethod must be a function if specified");if(this.fetchContext=S,!this.fetchMethod&&void 0!==S)throw new TypeError("cannot set fetchContext without fetchMethod");if(this.keyMap=new Map,this.keyList=new Array(t).fill(null),this.valList=new Array(t).fill(null),this.next=new I(t),this.prev=new I(t),this.head=0,this.tail=0,this.free=new m(t),this.initialFill=1,this.size=0,"function"==typeof f&&(this.dispose=f),"function"==typeof b?(this.disposeAfter=b,this.disposed=[]):(this.disposeAfter=null,this.disposed=null),this.noDisposeOnSet=!!v,this.noUpdateTTL=!!y,this.noDeleteOnFetchRejection=!!E,0!==this.maxEntrySize){if(0!==this.maxSize&&!p(this.maxSize))throw new TypeError("maxSize must be a positive integer if specified");if(!p(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");this.initializeSizeTracking()}if(this.allowStale=!!d||!!C,this.noDeleteOnStaleGet=!!k,this.updateAgeOnGet=!!a,this.updateAgeOnHas=!!l,this.ttlResolution=p(n)||0===n?n:1,this.ttlAutopurge=!!i,this.ttl=r||T||0,this.ttl){if(!p(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.initializeTTLTracking()}if(0===this.max&&0===this.ttl&&0===this.maxSize)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.max&&!this.maxSize){const e="LRU_CACHE_UNBOUNDED";u(e)&&(o.add(e),c("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",e,g))}C&&s("stale","allowStale"),T&&s("maxAge","ttl"),P&&s("length","sizeCalculation")}getRemainingTTL(e){return this.has(e,{updateAgeOnHas:!1})?1/0:0}initializeTTLTracking(){this.ttls=new f(this.max),this.starts=new f(this.max),this.setItemTTL=(e,r,n=t.now())=>{if(this.starts[e]=0!==r?n:0,this.ttls[e]=r,0!==r&&this.ttlAutopurge){const t=setTimeout((()=>{this.isStale(e)&&this.delete(this.keyList[e])}),r+1);t.unref&&t.unref()}},this.updateItemAge=e=>{this.starts[e]=0!==this.ttls[e]?t.now():0};let e=0;const r=()=>{const r=t.now();if(this.ttlResolution>0){e=r;const t=setTimeout((()=>e=0),this.ttlResolution);t.unref&&t.unref()}return r};this.getRemainingTTL=t=>{const n=this.keyMap.get(t);return void 0===n?0:0===this.ttls[n]||0===this.starts[n]?1/0:this.starts[n]+this.ttls[n]-(e||r())},this.isStale=t=>0!==this.ttls[t]&&0!==this.starts[t]&&(e||r())-this.starts[t]>this.ttls[t]}updateItemAge(e){}setItemTTL(e,t,r){}isStale(e){return!1}initializeSizeTracking(){this.calculatedSize=0,this.sizes=new f(this.max),this.removeItemSize=e=>{this.calculatedSize-=this.sizes[e],this.sizes[e]=0},this.requireSize=(e,t,r,n)=>{if(!p(r)){if(!n)throw new TypeError("invalid size value (must be positive integer)");if("function"!=typeof n)throw new TypeError("sizeCalculation must be a function");if(r=n(t,e),!p(r))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}return r},this.addItemSize=(e,t)=>{this.sizes[e]=t;const r=this.maxSize-this.sizes[e];for(;this.calculatedSize>r;)this.evict(!0);this.calculatedSize+=this.sizes[e]}}removeItemSize(e){}addItemSize(e,t){}requireSize(e,t,r,n){if(r||n)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache")}*indexes({allowStale:e=this.allowStale}={}){if(this.size)for(let t=this.tail;this.isValidIndex(t)&&(!e&&this.isStale(t)||(yield t),t!==this.head);)t=this.prev[t]}*rindexes({allowStale:e=this.allowStale}={}){if(this.size)for(let t=this.head;this.isValidIndex(t)&&(!e&&this.isStale(t)||(yield t),t!==this.tail);)t=this.next[t]}isValidIndex(e){return this.keyMap.get(this.keyList[e])===e}*entries(){for(const e of this.indexes())yield[this.keyList[e],this.valList[e]]}*rentries(){for(const e of this.rindexes())yield[this.keyList[e],this.valList[e]]}*keys(){for(const e of this.indexes())yield this.keyList[e]}*rkeys(){for(const e of this.rindexes())yield this.keyList[e]}*values(){for(const e of this.indexes())yield this.valList[e]}*rvalues(){for(const e of this.rindexes())yield this.valList[e]}[Symbol.iterator](){return this.entries()}find(e,t={}){for(const r of this.indexes())if(e(this.valList[r],this.keyList[r],this))return this.get(this.keyList[r],t)}forEach(e,t=this){for(const r of this.indexes())e.call(t,this.valList[r],this.keyList[r],this)}rforEach(e,t=this){for(const r of this.rindexes())e.call(t,this.valList[r],this.keyList[r],this)}get prune(){return l("prune","purgeStale"),this.purgeStale}purgeStale(){let e=!1;for(const t of this.rindexes({allowStale:!0}))this.isStale(t)&&(this.delete(this.keyList[t]),e=!0);return e}dump(){const e=[];for(const r of this.indexes({allowStale:!0})){const n=this.keyList[r],i=this.valList[r],a={value:this.isBackgroundFetch(i)?i.__staleWhileFetching:i};if(this.ttls){a.ttl=this.ttls[r];const e=t.now()-this.starts[r];a.start=Math.floor(Date.now()-e)}this.sizes&&(a.size=this.sizes[r]),e.unshift([n,a])}return e}load(e){this.clear();for(const[r,n]of e){if(n.start){const e=Date.now()-n.start;n.start=t.now()-e}this.set(r,n.value,n)}}dispose(e,t,r){}set(e,t,{ttl:r=this.ttl,start:n,noDisposeOnSet:i=this.noDisposeOnSet,size:a=0,sizeCalculation:o=this.sizeCalculation,noUpdateTTL:s=this.noUpdateTTL}={}){if(a=this.requireSize(e,t,a,o),this.maxEntrySize&&a>this.maxEntrySize)return this;let l=0===this.size?void 0:this.keyMap.get(e);if(void 0===l)l=this.newIndex(),this.keyList[l]=e,this.valList[l]=t,this.keyMap.set(e,l),this.next[this.tail]=l,this.prev[l]=this.tail,this.tail=l,this.size++,this.addItemSize(l,a),s=!1;else{const r=this.valList[l];t!==r&&(this.isBackgroundFetch(r)?r.__abortController.abort():i||(this.dispose(r,e,"set"),this.disposeAfter&&this.disposed.push([r,e,"set"])),this.removeItemSize(l),this.valList[l]=t,this.addItemSize(l,a)),this.moveToTail(l)}if(0===r||0!==this.ttl||this.ttls||this.initializeTTLTracking(),s||this.setItemTTL(l,r,n),this.disposeAfter)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return this}newIndex(){return 0===this.size?this.tail:this.size===this.max&&0!==this.max?this.evict(!1):0!==this.free.length?this.free.pop():this.initialFill++}pop(){if(this.size){const e=this.valList[this.head];return this.evict(!0),e}}evict(e){const t=this.head,r=this.keyList[t],n=this.valList[t];return this.isBackgroundFetch(n)?n.__abortController.abort():(this.dispose(n,r,"evict"),this.disposeAfter&&this.disposed.push([n,r,"evict"])),this.removeItemSize(t),e&&(this.keyList[t]=null,this.valList[t]=null,this.free.push(t)),this.head=this.next[t],this.keyMap.delete(r),this.size--,t}has(e,{updateAgeOnHas:t=this.updateAgeOnHas}={}){const r=this.keyMap.get(e);return void 0!==r&&!this.isStale(r)&&(t&&this.updateItemAge(r),!0)}peek(e,{allowStale:t=this.allowStale}={}){const r=this.keyMap.get(e);if(void 0!==r&&(t||!this.isStale(r))){const e=this.valList[r];return this.isBackgroundFetch(e)?e.__staleWhileFetching:e}}backgroundFetch(e,t,n,i){const a=void 0===t?void 0:this.valList[t];if(this.isBackgroundFetch(a))return a;const o=new r,s={signal:o.signal,options:n,context:i},l=new Promise((t=>t(this.fetchMethod(e,a,s)))).then((t=>(o.signal.aborted||this.set(e,t,s.options),t)),(r=>{if(this.valList[t]===l&&(n.noDeleteOnFetchRejection&&void 0!==l.__staleWhileFetching?this.valList[t]=l.__staleWhileFetching:this.delete(e)),l.__returned===l)throw r}));return l.__abortController=o,l.__staleWhileFetching=a,l.__returned=null,void 0===t?(this.set(e,l,s.options),t=this.keyMap.get(e)):this.valList[t]=l,l}isBackgroundFetch(e){return e&&"object"==typeof e&&"function"==typeof e.then&&Object.prototype.hasOwnProperty.call(e,"__staleWhileFetching")&&Object.prototype.hasOwnProperty.call(e,"__returned")&&(e.__returned===e||null===e.__returned)}async fetch(e,{allowStale:t=this.allowStale,updateAgeOnGet:r=this.updateAgeOnGet,noDeleteOnStaleGet:n=this.noDeleteOnStaleGet,ttl:i=this.ttl,noDisposeOnSet:a=this.noDisposeOnSet,size:o=0,sizeCalculation:s=this.sizeCalculation,noUpdateTTL:l=this.noUpdateTTL,noDeleteOnFetchRejection:c=this.noDeleteOnFetchRejection,fetchContext:u=this.fetchContext,forceRefresh:d=!1}={}){if(!this.fetchMethod)return this.get(e,{allowStale:t,updateAgeOnGet:r,noDeleteOnStaleGet:n});const p={allowStale:t,updateAgeOnGet:r,noDeleteOnStaleGet:n,ttl:i,noDisposeOnSet:a,size:o,sizeCalculation:s,noUpdateTTL:l,noDeleteOnFetchRejection:c};let h=this.keyMap.get(e);if(void 0===h){const t=this.backgroundFetch(e,h,p,u);return t.__returned=t}{const n=this.valList[h];if(this.isBackgroundFetch(n))return t&&void 0!==n.__staleWhileFetching?n.__staleWhileFetching:n.__returned=n;if(!d&&!this.isStale(h))return this.moveToTail(h),r&&this.updateItemAge(h),n;const i=this.backgroundFetch(e,h,p,u);return t&&void 0!==i.__staleWhileFetching?i.__staleWhileFetching:i.__returned=i}}get(e,{allowStale:t=this.allowStale,updateAgeOnGet:r=this.updateAgeOnGet,noDeleteOnStaleGet:n=this.noDeleteOnStaleGet}={}){const i=this.keyMap.get(e);if(void 0!==i){const a=this.valList[i],o=this.isBackgroundFetch(a);if(this.isStale(i))return o?t?a.__staleWhileFetching:void 0:(n||this.delete(e),t?a:void 0);if(o)return;return this.moveToTail(i),r&&this.updateItemAge(i),a}}connect(e,t){this.prev[t]=e,this.next[e]=t}moveToTail(e){e!==this.tail&&(e===this.head?this.head=this.next[e]:this.connect(this.prev[e],this.next[e]),this.connect(this.tail,e),this.tail=e)}get del(){return l("del","delete"),this.delete}delete(e){let t=!1;if(0!==this.size){const r=this.keyMap.get(e);if(void 0!==r)if(t=!0,1===this.size)this.clear();else{this.removeItemSize(r);const t=this.valList[r];this.isBackgroundFetch(t)?t.__abortController.abort():(this.dispose(t,e,"delete"),this.disposeAfter&&this.disposed.push([t,e,"delete"])),this.keyMap.delete(e),this.keyList[r]=null,this.valList[r]=null,r===this.tail?this.tail=this.prev[r]:r===this.head?this.head=this.next[r]:(this.next[this.prev[r]]=this.next[r],this.prev[this.next[r]]=this.prev[r]),this.size--,this.free.push(r)}}if(this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return t}clear(){for(const e of this.rindexes({allowStale:!0})){const t=this.valList[e];if(this.isBackgroundFetch(t))t.__abortController.abort();else{const r=this.keyList[e];this.dispose(t,r,"delete"),this.disposeAfter&&this.disposed.push([t,r,"delete"])}}if(this.keyMap.clear(),this.valList.fill(null),this.keyList.fill(null),this.ttls&&(this.ttls.fill(0),this.starts.fill(0)),this.sizes&&this.sizes.fill(0),this.head=0,this.tail=0,this.initialFill=1,this.free.length=0,this.calculatedSize=0,this.size=0,this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift())}get reset(){return l("reset","clear"),this.clear}get length(){return((e,t)=>{const r="LRU_CACHE_PROPERTY_length";if(u(r)){const{prototype:t}=g,{get:n}=Object.getOwnPropertyDescriptor(t,e);d(r,"length property","cache.size",n)}})("length"),this.size}static get AbortController(){return r}static get AbortSignal(){return a}}e.exports=g},6407:function(e){e.exports=function(){var e=[],t=[],r={},n={},i={};function a(e){return"string"==typeof e?new RegExp("^"+e+"$","i"):e}function o(e,t){return e===t?t:e===e.toLowerCase()?t.toLowerCase():e===e.toUpperCase()?t.toUpperCase():e[0]===e[0].toUpperCase()?t.charAt(0).toUpperCase()+t.substr(1).toLowerCase():t.toLowerCase()}function s(e,t){return e.replace(/\$(\d{1,2})/g,(function(e,r){return t[r]||""}))}function l(e,t){return e.replace(t[0],(function(r,n){var i=s(t[1],arguments);return o(""===r?e[n-1]:r,i)}))}function c(e,t,n){if(!e.length||r.hasOwnProperty(e))return t;for(var i=n.length;i--;){var a=n[i];if(a[0].test(t))return l(t,a)}return t}function u(e,t,r){return function(n){var i=n.toLowerCase();return t.hasOwnProperty(i)?o(n,i):e.hasOwnProperty(i)?o(n,e[i]):c(i,n,r)}}function d(e,t,r,n){return function(n){var i=n.toLowerCase();return!!t.hasOwnProperty(i)||!e.hasOwnProperty(i)&&c(i,i,r)===i}}function p(e,t,r){return(r?t+" ":"")+(1===t?p.singular(e):p.plural(e))}return p.plural=u(i,n,e),p.isPlural=d(i,n,e),p.singular=u(n,i,t),p.isSingular=d(n,i,t),p.addPluralRule=function(t,r){e.push([a(t),r])},p.addSingularRule=function(e,r){t.push([a(e),r])},p.addUncountableRule=function(e){"string"!=typeof e?(p.addPluralRule(e,"$0"),p.addSingularRule(e,"$0")):r[e.toLowerCase()]=!0},p.addIrregularRule=function(e,t){t=t.toLowerCase(),e=e.toLowerCase(),i[e]=t,n[t]=e},[["I","we"],["me","us"],["he","they"],["she","they"],["them","them"],["myself","ourselves"],["yourself","yourselves"],["itself","themselves"],["herself","themselves"],["himself","themselves"],["themself","themselves"],["is","are"],["was","were"],["has","have"],["this","these"],["that","those"],["echo","echoes"],["dingo","dingoes"],["volcano","volcanoes"],["tornado","tornadoes"],["torpedo","torpedoes"],["genus","genera"],["viscus","viscera"],["stigma","stigmata"],["stoma","stomata"],["dogma","dogmata"],["lemma","lemmata"],["schema","schemata"],["anathema","anathemata"],["ox","oxen"],["axe","axes"],["die","dice"],["yes","yeses"],["foot","feet"],["eave","eaves"],["goose","geese"],["tooth","teeth"],["quiz","quizzes"],["human","humans"],["proof","proofs"],["carve","carves"],["valve","valves"],["looey","looies"],["thief","thieves"],["groove","grooves"],["pickaxe","pickaxes"],["passerby","passersby"]].forEach((function(e){return p.addIrregularRule(e[0],e[1])})),[[/s?$/i,"s"],[/[^\u0000-\u007F]$/i,"$0"],[/([^aeiou]ese)$/i,"$1"],[/(ax|test)is$/i,"$1es"],[/(alias|[^aou]us|t[lm]as|gas|ris)$/i,"$1es"],[/(e[mn]u)s?$/i,"$1s"],[/([^l]ias|[aeiou]las|[ejzr]as|[iu]am)$/i,"$1"],[/(alumn|syllab|vir|radi|nucle|fung|cact|stimul|termin|bacill|foc|uter|loc|strat)(?:us|i)$/i,"$1i"],[/(alumn|alg|vertebr)(?:a|ae)$/i,"$1ae"],[/(seraph|cherub)(?:im)?$/i,"$1im"],[/(her|at|gr)o$/i,"$1oes"],[/(agend|addend|millenni|dat|extrem|bacteri|desiderat|strat|candelabr|errat|ov|symposi|curricul|automat|quor)(?:a|um)$/i,"$1a"],[/(apheli|hyperbat|periheli|asyndet|noumen|phenomen|criteri|organ|prolegomen|hedr|automat)(?:a|on)$/i,"$1a"],[/sis$/i,"ses"],[/(?:(kni|wi|li)fe|(ar|l|ea|eo|oa|hoo)f)$/i,"$1$2ves"],[/([^aeiouy]|qu)y$/i,"$1ies"],[/([^ch][ieo][ln])ey$/i,"$1ies"],[/(x|ch|ss|sh|zz)$/i,"$1es"],[/(matr|cod|mur|sil|vert|ind|append)(?:ix|ex)$/i,"$1ices"],[/\b((?:tit)?m|l)(?:ice|ouse)$/i,"$1ice"],[/(pe)(?:rson|ople)$/i,"$1ople"],[/(child)(?:ren)?$/i,"$1ren"],[/eaux$/i,"$0"],[/m[ae]n$/i,"men"],["thou","you"]].forEach((function(e){return p.addPluralRule(e[0],e[1])})),[[/s$/i,""],[/(ss)$/i,"$1"],[/(wi|kni|(?:after|half|high|low|mid|non|night|[^\w]|^)li)ves$/i,"$1fe"],[/(ar|(?:wo|[ae])l|[eo][ao])ves$/i,"$1f"],[/ies$/i,"y"],[/\b([pl]|zomb|(?:neck|cross)?t|coll|faer|food|gen|goon|group|lass|talk|goal|cut)ies$/i,"$1ie"],[/\b(mon|smil)ies$/i,"$1ey"],[/\b((?:tit)?m|l)ice$/i,"$1ouse"],[/(seraph|cherub)im$/i,"$1"],[/(x|ch|ss|sh|zz|tto|go|cho|alias|[^aou]us|t[lm]as|gas|(?:her|at|gr)o|[aeiou]ris)(?:es)?$/i,"$1"],[/(analy|diagno|parenthe|progno|synop|the|empha|cri|ne)(?:sis|ses)$/i,"$1sis"],[/(movie|twelve|abuse|e[mn]u)s$/i,"$1"],[/(test)(?:is|es)$/i,"$1is"],[/(alumn|syllab|vir|radi|nucle|fung|cact|stimul|termin|bacill|foc|uter|loc|strat)(?:us|i)$/i,"$1us"],[/(agend|addend|millenni|dat|extrem|bacteri|desiderat|strat|candelabr|errat|ov|symposi|curricul|quor)a$/i,"$1um"],[/(apheli|hyperbat|periheli|asyndet|noumen|phenomen|criteri|organ|prolegomen|hedr|automat)a$/i,"$1on"],[/(alumn|alg|vertebr)ae$/i,"$1a"],[/(cod|mur|sil|vert|ind)ices$/i,"$1ex"],[/(matr|append)ices$/i,"$1ix"],[/(pe)(rson|ople)$/i,"$1rson"],[/(child)ren$/i,"$1"],[/(eau)x?$/i,"$1"],[/men$/i,"man"]].forEach((function(e){return p.addSingularRule(e[0],e[1])})),["adulthood","advice","agenda","aid","aircraft","alcohol","ammo","analytics","anime","athletics","audio","bison","blood","bream","buffalo","butter","carp","cash","chassis","chess","clothing","cod","commerce","cooperation","corps","debris","diabetes","digestion","elk","energy","equipment","excretion","expertise","firmware","flounder","fun","gallows","garbage","graffiti","hardware","headquarters","health","herpes","highjinks","homework","housework","information","jeans","justice","kudos","labour","literature","machinery","mackerel","mail","media","mews","moose","music","mud","manga","news","only","personnel","pike","plankton","pliers","police","pollution","premises","rain","research","rice","salmon","scissors","series","sewage","shambles","shrimp","software","species","staff","swine","tennis","traffic","transportation","trout","tuna","wealth","welfare","whiting","wildebeest","wildlife","you",/pok[eÃ©]mon$/i,/[^aeiou]ese$/i,/deer$/i,/fish$/i,/measles$/i,/o[iu]s$/i,/pox$/i,/sheep$/i].forEach(p.addUncountableRule),p}()},4335:e=>{var t="undefined"!=typeof Element,r="function"==typeof Map,n="function"==typeof Set,i="function"==typeof ArrayBuffer&&!!ArrayBuffer.isView;function a(e,o){if(e===o)return!0;if(e&&o&&"object"==typeof e&&"object"==typeof o){if(e.constructor!==o.constructor)return!1;var s,l,c,u;if(Array.isArray(e)){if((s=e.length)!=o.length)return!1;for(l=s;0!=l--;)if(!a(e[l],o[l]))return!1;return!0}if(r&&e instanceof Map&&o instanceof Map){if(e.size!==o.size)return!1;for(u=e.entries();!(l=u.next()).done;)if(!o.has(l.value[0]))return!1;for(u=e.entries();!(l=u.next()).done;)if(!a(l.value[1],o.get(l.value[0])))return!1;return!0}if(n&&e instanceof Set&&o instanceof Set){if(e.size!==o.size)return!1;for(u=e.entries();!(l=u.next()).done;)if(!o.has(l.value[0]))return!1;return!0}if(i&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(o)){if((s=e.length)!=o.length)return!1;for(l=s;0!=l--;)if(e[l]!==o[l])return!1;return!0}if(e.constructor===RegExp)return e.source===o.source&&e.flags===o.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===o.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===o.toString();if((s=(c=Object.keys(e)).length)!==Object.keys(o).length)return!1;for(l=s;0!=l--;)if(!Object.prototype.hasOwnProperty.call(o,c[l]))return!1;if(t&&e instanceof Element)return!1;for(l=s;0!=l--;)if(("_owner"!==c[l]&&"__v"!==c[l]&&"__o"!==c[l]||!e.$$typeof)&&!a(e[c[l]],o[c[l]]))return!1;return!0}return e!=e&&o!=o}e.exports=function(e,t){try{return a(e,t)}catch(e){if((e.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw e}}},5464:(e,t,r)=>{e.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,r),i.loaded=!0,i.exports}return r.m=e,r.c=t,r.p="",r(0)}([function(e,t,r){e.exports=r(1)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=(n=r(2))&&n.__esModule?n:{default:n};t.default=i.default,e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};function i(e){return e&&e.__esModule?e:{default:e}}t.default=c;var a=r(3),o=i(r(4)),s=r(14),l=i(r(15));function c(e){var t=e.activeClassName,r=void 0===t?"":t,i=e.activeIndex,o=void 0===i?-1:i,c=e.activeStyle,u=e.autoEscape,d=e.caseSensitive,p=void 0!==d&&d,h=e.className,f=e.findChunks,m=e.highlightClassName,g=void 0===m?"":m,b=e.highlightStyle,v=void 0===b?{}:b,y=e.highlightTag,O=void 0===y?"mark":y,x=e.sanitize,w=e.searchWords,_=e.textToHighlight,S=e.unhighlightClassName,E=void 0===S?"":S,k=e.unhighlightStyle,P=function(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}(e,["activeClassName","activeIndex","activeStyle","autoEscape","caseSensitive","className","findChunks","highlightClassName","highlightStyle","highlightTag","sanitize","searchWords","textToHighlight","unhighlightClassName","unhighlightStyle"]),T=(0,a.findAll)({autoEscape:u,caseSensitive:p,findChunks:f,sanitize:x,searchWords:w,textToHighlight:_}),C=O,I=-1,D="",A=void 0,R=(0,l.default)((function(e){var t={};for(var r in e)t[r.toLowerCase()]=e[r];return t}));return(0,s.createElement)("span",n({className:h},P,{children:T.map((function(e,t){var n=_.substr(e.start,e.end-e.start);if(e.highlight){I++;var i;i="object"==typeof g?p?g[n]:(g=R(g))[n.toLowerCase()]:g;var a=I===+o;D=i+" "+(a?r:""),A=!0===a&&null!=c?Object.assign({},v,c):v;var l={children:n,className:D,key:t,style:A};return"string"!=typeof C&&(l.highlightIndex=I),(0,s.createElement)(C,l)}return(0,s.createElement)("span",{children:n,className:E,key:t,style:k})}))}))}c.propTypes={activeClassName:o.default.string,activeIndex:o.default.number,activeStyle:o.default.object,autoEscape:o.default.bool,className:o.default.string,findChunks:o.default.func,highlightClassName:o.default.oneOfType([o.default.object,o.default.string]),highlightStyle:o.default.object,highlightTag:o.default.oneOfType([o.default.node,o.default.func,o.default.string]),sanitize:o.default.func,searchWords:o.default.arrayOf(o.default.oneOfType([o.default.string,o.default.instanceOf(RegExp)])).isRequired,textToHighlight:o.default.string.isRequired,unhighlightClassName:o.default.string,unhighlightStyle:o.default.object},e.exports=t.default},function(e,t){e.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,r),i.loaded=!0,i.exports}return r.m=e,r.c=t,r.p="",r(0)}([function(e,t,r){e.exports=r(1)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2);Object.defineProperty(t,"combineChunks",{enumerable:!0,get:function(){return n.combineChunks}}),Object.defineProperty(t,"fillInChunks",{enumerable:!0,get:function(){return n.fillInChunks}}),Object.defineProperty(t,"findAll",{enumerable:!0,get:function(){return n.findAll}}),Object.defineProperty(t,"findChunks",{enumerable:!0,get:function(){return n.findChunks}})},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findAll=function(e){var t=e.autoEscape,a=e.caseSensitive,o=void 0!==a&&a,s=e.findChunks,l=void 0===s?n:s,c=e.sanitize,u=e.searchWords,d=e.textToHighlight;return i({chunksToHighlight:r({chunks:l({autoEscape:t,caseSensitive:o,sanitize:c,searchWords:u,textToHighlight:d})}),totalLength:d?d.length:0})};var r=t.combineChunks=function(e){var t=e.chunks;return t.sort((function(e,t){return e.start-t.start})).reduce((function(e,t){if(0===e.length)return[t];var r=e.pop();if(t.start<=r.end){var n=Math.max(r.end,t.end);e.push({start:r.start,end:n})}else e.push(r,t);return e}),[])},n=function(e){var t=e.autoEscape,r=e.caseSensitive,n=e.sanitize,i=void 0===n?a:n,o=e.searchWords,s=e.textToHighlight;return s=i(s),o.filter((function(e){return e})).reduce((function(e,n){n=i(n),t&&(n=n.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"));for(var a=new RegExp(n,r?"g":"gi"),o=void 0;o=a.exec(s);){var l=o.index,c=a.lastIndex;c>l&&e.push({start:l,end:c}),o.index==a.lastIndex&&a.lastIndex++}return e}),[])};t.findChunks=n;var i=t.fillInChunks=function(e){var t=e.chunksToHighlight,r=e.totalLength,n=[],i=function(e,t,r){t-e>0&&n.push({start:e,end:t,highlight:r})};if(0===t.length)i(0,r,!1);else{var a=0;t.forEach((function(e){i(a,e.start,!1),i(e.start,e.end,!0),a=e.end})),i(a,r,!1)}return n};function a(e){return e}}])},function(e,t,r){(function(t){if("production"!==t.env.NODE_ENV){var n="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103;e.exports=r(6)((function(e){return"object"==typeof e&&null!==e&&e.$$typeof===n}),!0)}else e.exports=r(13)()}).call(t,r(5))},function(e,t){var r,n,i=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(r===setTimeout)return setTimeout(e,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(e){r=a}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var l,c=[],u=!1,d=-1;function p(){u&&l&&(u=!1,l.length?c=l.concat(c):d=-1,c.length&&h())}function h(){if(!u){var e=s(p);u=!0;for(var t=c.length;t;){for(l=c,c=[];++d<t;)l&&l[d].run();d=-1,t=c.length}l=null,u=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new f(e,t)),1!==c.length||u||s(h)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,r){(function(t){"use strict";var n=r(7),i=r(8),a=r(9),o=r(10),s=r(11),l=r(12);e.exports=function(e,r){var c="function"==typeof Symbol&&Symbol.iterator,u="<<anonymous>>",d={array:f("array"),bool:f("boolean"),func:f("function"),number:f("number"),object:f("object"),string:f("string"),symbol:f("symbol"),any:h(n.thatReturnsNull),arrayOf:function(e){return h((function(t,r,n,i,a){if("function"!=typeof e)return new p("Property `"+a+"` of component `"+n+"` has invalid PropType notation inside arrayOf.");var o=t[r];if(!Array.isArray(o))return new p("Invalid "+i+" `"+a+"` of type `"+g(o)+"` supplied to `"+n+"`, expected an array.");for(var l=0;l<o.length;l++){var c=e(o,l,n,i,a+"["+l+"]",s);if(c instanceof Error)return c}return null}))},element:h((function(t,r,n,i,a){var o=t[r];return e(o)?null:new p("Invalid "+i+" `"+a+"` of type `"+g(o)+"` supplied to `"+n+"`, expected a single ReactElement.")})),instanceOf:function(e){return h((function(t,r,n,i,a){if(!(t[r]instanceof e)){var o=e.name||u;return new p("Invalid "+i+" `"+a+"` of type `"+((s=t[r]).constructor&&s.constructor.name?s.constructor.name:u)+"` supplied to `"+n+"`, expected instance of `"+o+"`.")}var s;return null}))},node:h((function(e,t,r,n,i){return m(e[t])?null:new p("Invalid "+n+" `"+i+"` supplied to `"+r+"`, expected a ReactNode.")})),objectOf:function(e){return h((function(t,r,n,i,a){if("function"!=typeof e)return new p("Property `"+a+"` of component `"+n+"` has invalid PropType notation inside objectOf.");var o=t[r],l=g(o);if("object"!==l)return new p("Invalid "+i+" `"+a+"` of type `"+l+"` supplied to `"+n+"`, expected an object.");for(var c in o)if(o.hasOwnProperty(c)){var u=e(o,c,n,i,a+"."+c,s);if(u instanceof Error)return u}return null}))},oneOf:function(e){return Array.isArray(e)?h((function(t,r,n,i,a){for(var o=t[r],s=0;s<e.length;s++)if(l=o,c=e[s],l===c?0!==l||1/l==1/c:l!=l&&c!=c)return null;var l,c;return new p("Invalid "+i+" `"+a+"` of value `"+o+"` supplied to `"+n+"`, expected one of "+JSON.stringify(e)+".")})):("production"!==t.env.NODE_ENV&&a(!1,"Invalid argument supplied to oneOf, expected an instance of array."),n.thatReturnsNull)},oneOfType:function(e){if(!Array.isArray(e))return"production"!==t.env.NODE_ENV&&a(!1,"Invalid argument supplied to oneOfType, expected an instance of array."),n.thatReturnsNull;for(var r=0;r<e.length;r++){var i=e[r];if("function"!=typeof i)return a(!1,"Invalid argument supplied to oneOfType. Expected an array of check functions, but received %s at index %s.",v(i),r),n.thatReturnsNull}return h((function(t,r,n,i,a){for(var o=0;o<e.length;o++)if(null==(0,e[o])(t,r,n,i,a,s))return null;return new p("Invalid "+i+" `"+a+"` supplied to `"+n+"`.")}))},shape:function(e){return h((function(t,r,n,i,a){var o=t[r],l=g(o);if("object"!==l)return new p("Invalid "+i+" `"+a+"` of type `"+l+"` supplied to `"+n+"`, expected `object`.");for(var c in e){var u=e[c];if(u){var d=u(o,c,n,i,a+"."+c,s);if(d)return d}}return null}))},exact:function(e){return h((function(t,r,n,i,a){var l=t[r],c=g(l);if("object"!==c)return new p("Invalid "+i+" `"+a+"` of type `"+c+"` supplied to `"+n+"`, expected `object`.");var u=o({},t[r],e);for(var d in u){var h=e[d];if(!h)return new p("Invalid "+i+" `"+a+"` key `"+d+"` supplied to `"+n+"`.\nBad object: "+JSON.stringify(t[r],null,"  ")+"\nValid keys: "+JSON.stringify(Object.keys(e),null,"  "));var f=h(l,d,n,i,a+"."+d,s);if(f)return f}return null}))}};function p(e){this.message=e,this.stack=""}function h(e){if("production"!==t.env.NODE_ENV)var n={},o=0;function l(l,c,d,h,f,m,g){if(h=h||u,m=m||d,g!==s)if(r)i(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");else if("production"!==t.env.NODE_ENV&&"undefined"!=typeof console){var b=h+":"+d;!n[b]&&o<3&&(a(!1,"You are manually calling a React.PropTypes validation function for the `%s` prop on `%s`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details.",m,h),n[b]=!0,o++)}return null==c[d]?l?null===c[d]?new p("The "+f+" `"+m+"` is marked as required in `"+h+"`, but its value is `null`."):new p("The "+f+" `"+m+"` is marked as required in `"+h+"`, but its value is `undefined`."):null:e(c,d,h,f,m)}var c=l.bind(null,!1);return c.isRequired=l.bind(null,!0),c}function f(e){return h((function(t,r,n,i,a,o){var s=t[r];return g(s)!==e?new p("Invalid "+i+" `"+a+"` of type `"+b(s)+"` supplied to `"+n+"`, expected `"+e+"`."):null}))}function m(t){switch(typeof t){case"number":case"string":case"undefined":return!0;case"boolean":return!t;case"object":if(Array.isArray(t))return t.every(m);if(null===t||e(t))return!0;var r=function(e){var t=e&&(c&&e[c]||e["@@iterator"]);if("function"==typeof t)return t}(t);if(!r)return!1;var n,i=r.call(t);if(r!==t.entries){for(;!(n=i.next()).done;)if(!m(n.value))return!1}else for(;!(n=i.next()).done;){var a=n.value;if(a&&!m(a[1]))return!1}return!0;default:return!1}}function g(e){var t=typeof e;return Array.isArray(e)?"array":e instanceof RegExp?"object":function(e,t){return"symbol"===e||"Symbol"===t["@@toStringTag"]||"function"==typeof Symbol&&t instanceof Symbol}(t,e)?"symbol":t}function b(e){if(null==e)return""+e;var t=g(e);if("object"===t){if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp"}return t}function v(e){var t=b(e);switch(t){case"array":case"object":return"an "+t;case"boolean":case"date":case"regexp":return"a "+t;default:return t}}return p.prototype=Error.prototype,d.checkPropTypes=l,d.PropTypes=d,d}}).call(t,r(5))},function(e,t){"use strict";function r(e){return function(){return e}}var n=function(){};n.thatReturns=r,n.thatReturnsFalse=r(!1),n.thatReturnsTrue=r(!0),n.thatReturnsNull=r(null),n.thatReturnsThis=function(){return this},n.thatReturnsArgument=function(e){return e},e.exports=n},function(e,t,r){(function(t){"use strict";var r=function(e){};"production"!==t.env.NODE_ENV&&(r=function(e){if(void 0===e)throw new Error("invariant requires an error message argument")}),e.exports=function(e,t,n,i,a,o,s,l){if(r(t),!e){var c;if(void 0===t)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[n,i,a,o,s,l],d=0;(c=new Error(t.replace(/%s/g,(function(){return u[d++]})))).name="Invariant Violation"}throw c.framesToPop=1,c}}}).call(t,r(5))},function(e,t,r){(function(t){"use strict";var n=r(7);if("production"!==t.env.NODE_ENV){var i=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var i=0,a="Warning: "+e.replace(/%s/g,(function(){return r[i++]}));"undefined"!=typeof console&&console.error(a);try{throw new Error(a)}catch(e){}};n=function(e,t){if(void 0===t)throw new Error("`warning(condition, format, ...args)` requires a warning message argument");if(0!==t.indexOf("Failed Composite propType: ")&&!e){for(var r=arguments.length,n=Array(r>2?r-2:0),a=2;a<r;a++)n[a-2]=arguments[a];i.apply(void 0,[t].concat(n))}}}e.exports=n}).call(t,r(5))},function(e,t){"use strict";var r=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;function a(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach((function(e){n[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var o,s,l=a(e),c=1;c<arguments.length;c++){for(var u in o=Object(arguments[c]))n.call(o,u)&&(l[u]=o[u]);if(r){s=r(o);for(var d=0;d<s.length;d++)i.call(o,s[d])&&(l[s[d]]=o[s[d]])}}return l}},function(e,t){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,r){(function(t){"use strict";if("production"!==t.env.NODE_ENV)var n=r(8),i=r(9),a=r(11),o={};e.exports=function(e,r,s,l,c){if("production"!==t.env.NODE_ENV)for(var u in e)if(e.hasOwnProperty(u)){var d;try{n("function"==typeof e[u],"%s: %s type `%s` is invalid; it must be a function, usually from the `prop-types` package, but received `%s`.",l||"React class",s,u,typeof e[u]),d=e[u](r,u,l,s,null,a)}catch(e){d=e}if(i(!d||d instanceof Error,"%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",l||"React class",s,u,typeof d),d instanceof Error&&!(d.message in o)){o[d.message]=!0;var p=c?c():"";i(!1,"Failed %s type: %s%s",s,d.message,null!=p?p:"")}}}}).call(t,r(5))},function(e,t,r){"use strict";var n=r(7),i=r(8),a=r(11);e.exports=function(){function e(e,t,r,n,o,s){s!==a&&i(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}function t(){return e}e.isRequired=e;var r={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t};return r.checkPropTypes=n,r.PropTypes=r,r}},function(e,t){e.exports=r(2650)},function(e,t){"use strict";var r=function(e,t){return e===t};e.exports=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r,n=void 0,i=[],a=void 0,o=!1,s=function(e,r){return t(e,i[r])},l=function(){for(var t=arguments.length,r=Array(t),l=0;l<t;l++)r[l]=arguments[l];return o&&n===this&&r.length===i.length&&r.every(s)?a:(o=!0,n=this,i=r,a=e.apply(this,r))};return l}}])},7644:e=>{"use strict";e.exports=i},3305:t=>{"use strict";t.exports=e},3545:e=>{"use strict";e.exports=r},7388:e=>{"use strict";e.exports=n},8200:e=>{"use strict";e.exports=d},5980:e=>{"use strict";e.exports=a},3342:e=>{"use strict";e.exports=o},2650:e=>{"use strict";e.exports=t},2729:e=>{"use strict";e.exports=s},3929:e=>{"use strict";e.exports=c},3129:e=>{"use strict";e.exports=l},1177:e=>{"use strict";e.exports=u}},f={};function m(e){var t=f[e];if(void 0!==t)return t.exports;var r=f[e]={id:e,exports:{}};return h[e].call(r.exports,r,r.exports,m),r.exports}m.m=h,m.amdO={},m.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return m.d(t,{a:t}),t},m.d=(e,t)=>{for(var r in t)m.o(t,r)&&!m.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},m.f={},m.e=e=>Promise.all(Object.keys(m.f).reduce(((t,r)=>(m.f[r](e,t),t)),[])),m.u=e=>e+".js",m.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),m.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),p={},m.l=(e,t,r,n)=>{if(p[e])p[e].push(t);else{var i,a;if(void 0!==r)for(var o=document.getElementsByTagName("script"),s=0;s<o.length;s++){var l=o[s];if(l.getAttribute("src")==e){i=l;break}}i||(a=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,m.nc&&i.setAttribute("nonce",m.nc),i.src=e),p[e]=[t];var c=(t,r)=>{i.onerror=i.onload=null,clearTimeout(u);var n=p[e];if(delete p[e],i.parentNode&&i.parentNode.removeChild(i),n&&n.forEach((e=>e(r))),t)return t(r)},u=setTimeout(c.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=c.bind(null,i.onerror),i.onload=c.bind(null,i.onload),a&&document.head.appendChild(i)}},m.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},m.p="/public/plugins/victoria-metrics/",(()=>{m.b=document.baseURI||self.location.href;var e={1261:0};m.f.j=(t,r)=>{var n=m.o(e,t)?e[t]:void 0;if(0!==n)if(n)r.push(n[2]);else{var i=new Promise(((r,i)=>n=e[t]=[r,i]));r.push(n[2]=i);var a=m.p+m.u(t),o=new Error;m.l(a,(r=>{if(m.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var i=r&&("load"===r.type?"missing":r.type),a=r&&r.target&&r.target.src;o.message="Loading chunk "+t+" failed.\n("+i+": "+a+")",o.name="ChunkLoadError",o.type=i,o.request=a,n[1](o)}}),"chunk-"+t,t)}};var t=(t,r)=>{var n,i,[a,o,s]=r,l=0;if(a.some((t=>0!==e[t]))){for(n in o)m.o(o,n)&&(m.m[n]=o[n]);s&&s(m)}for(t&&t(r);l<a.length;l++)i=a[l],m.o(e,i)&&e[i]&&e[i][0](),e[i]=0},r=self.webpackChunk=self.webpackChunk||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),m.nc=void 0;var g={};return(()=>{"use strict";m.r(g),m.d(g,{plugin:()=>Ev});var e=m(3305),t=m(2650),r=m.n(t);const n=[{title:"Request Rate",expression:"rate(http_request_total[5m])",label:"Given an HTTP request counter, this query calculates the per-second average request rate over the last 5 minutes."},{title:"95th Percentile of Request Latencies",expression:"histogram_quantile(0.95, sum(rate(prometheus_http_request_duration_seconds_bucket[5m])) by (le))",label:"Calculates the 95th percentile of HTTP request rate over 5 minute windows."},{title:"Alerts Firing",expression:'sort_desc(sum(sum_over_time(ALERTS{alertstate="firing"}[24h])) by (alertname))',label:"Sums up the alerts that have been firing over the last 24 hours."},{title:"Step",label:"Defines the graph resolution using a duration format (15s, 1m, 3h, ...). Small steps create high-resolution graphs but can be slow over larger time ranges. Using a longer step lowers the resolution and smooths the graph by producing fewer datapoints. If no step is given the resolution is calculated automatically."}];var i=m(3545),a=m(7388),o=m(7644);function s(){return s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s.apply(this,arguments)}const l=e=>{var{className:t}=e,n=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,["className"]);const i=(0,a.useTheme2)(),l=c(i);return r().createElement(a.Button,s({},n,{className:(0,o.cx)(t,l.button)}))},c=(0,a.stylesFactory)((e=>({button:(0,o.css)({paddingLeft:e.spacing(1.5),paddingRight:e.spacing(1.5)})})));const u=e=>{var{children:n}=e,i=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,["children"]);const o=(0,a.useStyles2)((0,t.useCallback)((e=>f(e,i)),[i]));return r().createElement("div",{className:o.root},n)};var d,p,h;const f=(e,t)=>({root:(0,o.css)({display:"flex",flexDirection:null!==(d=t.direction)&&void 0!==d?d:"row",flexWrap:null===(p=t.wrap)||void 0===p||p?"wrap":void 0,alignItems:t.alignItems,gap:e.spacing(null!==(h=t.gap)&&void 0!==h?h:2),flexGrow:t.flexGrow})}),b=({children:e})=>r().createElement(u,{gap:1},e),v=({children:e})=>{const t=(0,a.useTheme2)(),n=y(t);return r().createElement("div",{className:n.root},e)},y=(0,a.stylesFactory)((e=>({root:(0,o.css)({display:"flex",flexWrap:"wrap",alignItems:"center",gap:e.spacing(3),minHeight:e.spacing(4)})}))),O=e=>{const t=(0,a.useTheme2)(),n=_(t,e);return r().createElement("span",{className:(0,o.cx)(n.wrapper)})};var x,w;O.defaultProps={v:0,h:0,layout:"block"};const _=(0,a.stylesFactory)(((e,t)=>({wrapper:(0,o.css)([{paddingRight:e.spacing(null!==(x=t.h)&&void 0!==x?x:0),paddingBottom:e.spacing(null!==(w=t.v)&&void 0!==w?w:0)},"inline"===t.layout&&{display:"inline-block"},"block"===t.layout&&{display:"block"}])})));function S(){return S=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},S.apply(this,arguments)}const E=e=>{const{label:t,optional:n,tooltip:i,children:o,width:s}=e,l=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,["label","optional","tooltip","children","width"]),c=(0,a.useTheme2)(),u=k(c,s),d=(null==l?void 0:l.htmlFor)||(null===a.ReactUtils||void 0===a.ReactUtils?void 0:a.ReactUtils.getChildId(o)),p=r().createElement(r().Fragment,null,r().createElement("label",{className:u.label,htmlFor:d},t,n&&r().createElement("span",{className:u.optional}," - optional"),i&&r().createElement(a.Tooltip,{placement:"top",content:i,theme:"info"},r().createElement(a.Icon,{name:"info-circle",size:"sm",className:u.icon}))),r().createElement(O,{v:.5}));return r().createElement("div",{className:u.root},r().createElement(a.Field,S({className:u.field,label:p},l),o))},k=(0,a.stylesFactory)(((e,t)=>({root:(0,o.css)({minWidth:e.spacing(null!=t?t:0)}),label:(0,o.css)({fontSize:12,fontWeight:e.typography.fontWeightMedium}),optional:(0,o.css)({fontStyle:"italic",color:e.colors.text.secondary}),field:(0,o.css)({marginBottom:0}),icon:(0,o.css)({color:e.colors.text.secondary,marginLeft:e.spacing(1),":hover":{color:e.colors.text.primary}})}))),P=({children:e})=>{const t=(0,a.useStyles2)(T);return r().createElement("div",{className:t.root},r().createElement(u,{gap:2},e))},T=e=>({root:(0,o.css)({padding:e.spacing(1),backgroundColor:e.colors.background.secondary,borderRadius:e.shape.borderRadius(1)})});function C({items:e,renderItem:t,onChange:n}){return r().createElement(u,null,e.map(((i,a)=>r().createElement("div",{key:a},t(i,(t=>((t,r)=>{const i=[...e];i[t]=r,n(i)})(a,t)),(()=>(t=>{const r=[...e];r.splice(t,1),n(r)})(a)))))),r().createElement(a.Button,{onClick:()=>{const t=[...e,{}];n(t)},variant:"secondary",size:"md",icon:"plus","aria-label":"Add",type:"button"}))}const I=({children:e})=>r().createElement(u,{gap:.5,direction:"column"},e);function D(){return D=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},D.apply(this,arguments)}const A=e=>{const t=R();return r().createElement("div",{className:t.switch},r().createElement(a.Switch,D({},e)))},R=()=>({switch:(0,o.css)({display:"flex",alignItems:"center",minHeight:30})}),j=({grow:e,shrink:t})=>r().createElement("div",{style:{display:"block",flexGrow:e,flexShrink:t}});function N(){return N=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},N.apply(this,arguments)}function L(e){var{label:n}=e,i=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,["label"]);const o=(0,a.useTheme2)(),[s]=(0,t.useState)((()=>Math.random().toString(16).slice(2))),l=M(o),c={SelectContainer:q,ValueContainer:$,SingleValue:$};return r().createElement("div",{className:l.root},n&&r().createElement("label",{className:l.label,htmlFor:s},n,":","Â "),r().createElement(a.Select,N({openMenuOnFocus:!0,inputId:s},i,{components:c})))}const q=e=>{const{children:t}=e,n=(0,a.useTheme2)(),i=M(n);return r().createElement(a.SelectContainer,N({},e,{className:(0,o.cx)(e.className,i.container)}),t)},$=e=>{const{className:t,children:n}=e,i=(0,a.useTheme2)(),s=M(i);return r().createElement("div",{className:(0,o.cx)(t,s.valueContainer)},n)},M=(0,a.stylesFactory)((e=>({root:(0,o.css)({display:"flex",fontSize:12,alignItems:"center"}),label:(0,o.css)({color:e.colors.text.secondary,whiteSpace:"nowrap"}),container:(0,o.css)({background:"none",borderColor:"transparent"}),valueContainer:(0,o.css)({display:"flex",alignItems:"center",flex:"initial",color:e.colors.text.secondary,fontSize:12})}))),B=({children:e})=>{const t=(0,a.useStyles2)(F);return r().createElement("div",{className:t.root},e)},F=()=>({root:(0,o.css)({display:"flex","> *":{"&:not(:first-child)":{marginLeft:-1},"&:first-child":{borderTopRightRadius:0,borderBottomRightRadius:0},"&:last-child":{borderTopLeftRadius:0,borderBottomLeftRadius:0},"&:not(:first-child):not(:last-child)":{borderRadius:0},position:"relative",zIndex:1,"&:hover":{zIndex:2},"&:focus-within":{zIndex:2}}})}),Q=[{label:"$__interval",sortValue:"$__interval"},{label:"$__rate_interval",sortValue:"$__rate_interval"},{label:"$__range",sortValue:"$__range"},{label:"1m",sortValue:"00:01:00"},{label:"5m",sortValue:"00:05:00"},{label:"10m",sortValue:"00:10:00"},{label:"30m",sortValue:"00:30:00"},{label:"1h",sortValue:"01:00:00"},{label:"1d",sortValue:"24:00:00"}],z=[{label:"absent_over_time",insertText:"absent_over_time",detail:"absent_over_time(series_selector[d])",documentation:"returns 1 if the given lookbehind window `d` doesn't contain raw samples. Otherwise it returns an empty result. See also `present_over_time`."},{label:"aggr_over_time",insertText:"aggr_over_time",detail:'aggr_over_time(("rollup_func1", "rollup_func2", ...), series_selector[d])',documentation:'calculates all the listed `rollup_func*` for raw samples on the given lookbehind window `d`. The calculations are performed individually per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). `rollup_func*` can contain any rollup function. For instance, `aggr_over_time(("min_over_time", "max_over_time", "rate"), m[d])` would calculate `min_over_time` for `m[d]`.'},{label:"ascent_over_time",insertText:"ascent_over_time",detail:"ascent_over_time(series_selector[d])",documentation:"calculates ascent of raw sample values on the given lookbehind window `d`. The calculations are performed individually per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Useful for tracking height gains in GPS tracking. Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"avg_over_time",insertText:"avg_over_time",detail:"avg_over_time(series_selector[d])",documentation:"calculates the average value over raw samples on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). See also `median_over_time`."},{label:"changes",insertText:"changes",detail:"changes(series_selector[d])",documentation:"calculates the number of times the raw samples changed on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Unlike `changes()` in Prometheus it takes into account the change from the last sample before the given lookbehind window `d`. See [this article](https://medium.com/@romanhavronenko/victoriametrics-promql-compliance-d4318203f51e) for details. Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"changes_prometheus",insertText:"changes_prometheus",detail:"changes_prometheus(series_selector[d])",documentation:"calculates the number of times the raw samples changed on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). It doesn't take into account the change from the last sample before the given lookbehind window `d` in the same way as Prometheus does. See [this article](https://medium.com/@romanhavronenko/victoriametrics-promql-compliance-d4318203f51e) for details. Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"count_eq_over_time",insertText:"count_eq_over_time",detail:"count_eq_over_time(series_selector[d], eq)",documentation:"calculates the number of raw samples on the given lookbehind window `d`, which are equal to `eq`. It is calculated independently per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"count_gt_over_time",insertText:"count_gt_over_time",detail:"count_gt_over_time(series_selector[d], gt)",documentation:"calculates the number of raw samples on the given lookbehind window `d`, which are bigger than `gt`. It is calculated independently per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"count_le_over_time",insertText:"count_le_over_time",detail:"count_le_over_time(series_selector[d], le)",documentation:"calculates the number of raw samples on the given lookbehind window `d`, which don't exceed `le`. It is calculated independently per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"count_ne_over_time",insertText:"count_ne_over_time",detail:"count_ne_over_time(series_selector[d], ne)",documentation:"calculates the number of raw samples on the given lookbehind window `d`, which aren't equal to `ne`. It is calculated independently per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"count_over_time",insertText:"count_over_time",detail:"count_over_time(series_selector[d])",documentation:"calculates the number of raw samples on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"decreases_over_time",insertText:"decreases_over_time",detail:"decreases_over_time(series_selector[d])",documentation:"calculates the number of raw sample value decreases over the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"default_rollup",insertText:"default_rollup",detail:"default_rollup(series_selector[d])",documentation:"returns the last raw sample value on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering)."},{label:"delta",insertText:"delta",detail:"delta(series_selector[d])",documentation:"calculates the difference between the last sample before the given lookbehind window `d` and the last sample at the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). The behaviour of `delta()` function in MetricsQL is slightly different to the behaviour of `delta()` function in Prometheus. See [this article](https://medium.com/@romanhavronenko/victoriametrics-promql-compliance-d4318203f51e) for details. Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"delta_prometheus",insertText:"delta_prometheus",detail:"delta_prometheus(series_selector[d])",documentation:"calculates the difference between the first and the last samples at the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). The behaviour of `delta_prometheus()` is close to the behaviour of `delta()` function in Prometheus. See [this article](https://medium.com/@romanhavronenko/victoriametrics-promql-compliance-d4318203f51e) for details. Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"deriv",insertText:"deriv",detail:"deriv(series_selector[d])",documentation:"calculates per-second derivative over the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). The derivative is calculated using linear regression. Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"deriv_fast",insertText:"deriv_fast",detail:"deriv_fast(series_selector[d])",documentation:"calculates per-second derivative using the first and the last raw samples on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"descent_over_time",insertText:"descent_over_time",detail:"descent_over_time(series_selector[d])",documentation:"calculates descent of raw sample values on the given lookbehind window `d`. The calculations are performed individually per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Useful for tracking height loss in GPS tracking. Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"distinct_over_time",insertText:"distinct_over_time",detail:"distinct_over_time(series_selector[d])",documentation:"returns the number of distinct raw sample values on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names` modifier in order to keep metric names."},{label:"duration_over_time",insertText:"duration_over_time",detail:"duration_over_time(series_selector[d], max_interval)",documentation:"returns the duration in seconds when time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering) were present over the given lookbehind window `d`. It is expected that intervals between adjacent samples per each series don't exceed the `max_interval`. Otherwise such intervals are considered as gaps and aren't counted. See also `lifetime`."},{label:"first_over_time",insertText:"first_over_time",detail:"first_over_time(series_selector[d])",documentation:"returns the first raw sample value on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). See also `last_over_time`."},{label:"geomean_over_time",insertText:"geomean_over_time",detail:"geomean_over_time(series_selector[d])",documentation:"calculates [geometric mean](https://en.wikipedia.org/wiki/Geometric_mean) over raw samples on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names` modifier in order to keep metric names."},{label:"histogram_over_time",insertText:"histogram_over_time",detail:"histogram_over_time(series_selector[d])",documentation:"calculates [VictoriaMetrics histogram](https://godoc.org/github.com/VictoriaMetrics/metrics#Histogram) over raw samples on the given lookbehind window `d`. It is calculated individually per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). The resulting histograms are useful to pass to `histogram_quantile``."},{label:"hoeffding_bound_lower",insertText:"hoeffding_bound_lower",detail:"hoeffding_bound_lower(phi, series_selector[d])",documentation:"calculates lower [Hoeffding bound](https://en.wikipedia.org/wiki/Hoeffding%27s_inequality) for the given `phi` in the range `[0...1]`. See also `hoeffding_bound_upper`."},{label:"hoeffding_bound_upper",insertText:"hoeffding_bound_upper",detail:"hoeffding_bound_upper(phi, series_selector[d])",documentation:"calculates upper [Hoeffding bound](https://en.wikipedia.org/wiki/Hoeffding%27s_inequality) for the given `phi` in the range `[0...1]`. See also `hoeffding_bound_lower`."},{label:"holt_winters",insertText:"holt_winters",detail:"holt_winters(series_selector[d], sf, tf)",documentation:"calculates Holt-Winters value (aka [double exponential smoothing](https://en.wikipedia.org/wiki/Exponential_smoothing#Double_exponential_smoothing)) for raw samples over the given lookbehind window `d` using the given smoothing factor `sf` and the given trend factor `tf`. Both `sf` and `tf` must be in the range `[0...1]`. It is expected that the [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering) returns time series of [gauge type](https://docs.victoriametrics.com/keyConcepts.html#gauge)."},{label:"idelta",insertText:"idelta",detail:"idelta(series_selector[d])",documentation:"calculates the difference between the last two raw samples on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names` modifier in order to keep metric names."},{label:"ideriv",insertText:"ideriv",detail:"ideriv(series_selector[d])",documentation:"calculates the per-second derivative based on the last two raw samples over the given lookbehind window `d`. The derivative is calculated independently per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"increase",insertText:"increase",detail:"increase(series_selector[d])",documentation:"calculates the increase over the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). It is expected that the `series_selector` returns time series of [counter type](https://docs.victoriametrics.com/keyConcepts.html#counter). Unlike Prometheus it takes into account the last sample before the given lookbehind window `d` when calculating the result. See [this article](https://medium.com/@romanhavronenko/victoriametrics-promql-compliance-d4318203f51e) for details. Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"increase_prometheus",insertText:"increase_prometheus",detail:"increase_prometheus(series_selector[d])",documentation:"calculates the increase over the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). It is expected that the `series_selector` returns time series of [counter type](https://docs.victoriametrics.com/keyConcepts.html#counter). It doesn't take into account the last sample before the given lookbehind window `d` when calculating the result in the same way as Prometheus does. See [this article](https://medium.com/@romanhavronenko/victoriametrics-promql-compliance-d4318203f51e) for details. Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"increase_pure",insertText:"increase_pure",detail:"increase_pure(series_selector[d])",documentation:"works the same as `increase` ignores the first value in a series if it is too big."},{label:"increases_over_time",insertText:"increases_over_time",detail:"increases_over_time(series_selector[d])",documentation:"calculates the number of raw sample value increases over the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"integrate",insertText:"integrate",detail:"integrate(series_selector[d])",documentation:"calculates the integral over raw samples on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names` modifier in order to keep metric names."},{label:"irate",insertText:"irate",detail:"irate(series_selector[d])",documentation:'calculates the "instant" per-second increase rate over the last two raw samples on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). It is expected that the `series_selector` returns time series of [counter type](https://docs.victoriametrics.com/keyConcepts.html#counter). Metric names are stripped from the resulting rollups. Add `keep_metric_names`.'},{label:"lag",insertText:"lag",detail:"lag(series_selector[d])",documentation:"returns the duration in seconds between the last sample on the given lookbehind window `d` and the timestamp of the current point. It is calculated independently per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"last_over_time",insertText:"last_over_time",detail:"last_over_time(series_selector[d])",documentation:"returns the last raw sample value on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). See also `first_over_time`."},{label:"lifetime",insertText:"lifetime",detail:"lifetime(series_selector[d])",documentation:"returns the duration in seconds between the last and the first sample on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"max_over_time",insertText:"max_over_time",detail:"max_over_time(series_selector[d])",documentation:"calculates the maximum value over raw samples on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). See also `tmax_over_time`."},{label:"median_over_time",insertText:"median_over_time",detail:"median_over_time(series_selector[d])",documentation:"calculates median value over raw samples on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). See also `avg_over_time`."},{label:"min_over_time",insertText:"min_over_time",detail:"min_over_time(series_selector[d])",documentation:"calculates the minimum value over raw samples on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). See also `tmin_over_time`."},{label:"mode_over_time",insertText:"mode_over_time",detail:"mode_over_time(series_selector[d])",documentation:"calculates [mode](https://en.wikipedia.org/wiki/Mode_(statistics)) for raw samples on the given lookbehind window `d`. It is calculated individually per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). It is expected that raw sample values are discrete."},{label:"predict_linear",insertText:"predict_linear",detail:"predict_linear(series_selector[d], t)",documentation:"calculates the value `t` seconds in the future using linear interpolation over raw samples on the given lookbehind window `d`. The predicted value is calculated individually per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering)."},{label:"present_over_time",insertText:"present_over_time",detail:"present_over_time(series_selector[d])",documentation:"returns 1 if there is at least a single raw sample on the given lookbehind window `d`. Otherwise an empty result is returned. Metric names are stripped from the resulting rollups. Add `keep_metric_names` modifier in order to keep metric names."},{label:"quantile_over_time",insertText:"quantile_over_time",detail:"quantile_over_time(phi, series_selector[d])",documentation:"calculates `phi`-quantile over raw samples on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). The `phi` value must be in the range `[0...1]`. See also `quantiles_over_time`."},{label:"quantiles_over_time",insertText:"quantiles_over_time",detail:'quantiles_over_time("phiLabel", phi1, ..., phiN, series_selector[d])',documentation:'calculates `phi*`-quantiles over raw samples on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). The function returns individual series per each `phi*` with `{phiLabel="phi*"}` label. `phi*` values must be in the range `[0...1]`. See also `quantile_over_time`.'},{label:"range_over_time",insertText:"range_over_time",detail:"range_over_time(series_selector[d])",documentation:"calculates value range over raw samples on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). E.g. it calculates `max_over_time(series_selector[d]) - min_over_time(series_selector[d])`. Metric names are stripped from the resulting rollups. Add `keep_metric_names` modifier in order to keep metric names."},{label:"rate",insertText:"rate",detail:"rate(series_selector[d])",documentation:"calculates the average per-second increase rate over the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). It is expected that the `series_selector` returns time series of [counter type](https://docs.victoriametrics.com/keyConcepts.html#counter). Metric names are stripped from the resulting rollups. Add `keep_metric_names` modifier in order to keep metric names."},{label:"rate_over_sum",insertText:"rate_over_sum",detail:"rate_over_sum(series_selector[d])",documentation:"calculates per-second rate over the sum of raw samples on the given lookbehind window `d`. The calculations are performed individually per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names` modifier in order to keep metric names."},{label:"resets",insertText:"resets",detail:"resets(series_selector[d])",documentation:"returns the number of [counter](https://docs.victoriametrics.com/keyConcepts.html#counter) resets over the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). It is expected that the `series_selector` returns time series of [counter type](https://docs.victoriametrics.com/keyConcepts.html#counter). Metric names are stripped from the resulting rollups. Add `keep_metric_names` modifier in order to keep metric names."},{label:"rollup",insertText:"rollup",detail:"rollup(series_selector[d])",documentation:"calculates `min`, `max` and `avg` values for raw samples on the given lookbehind window `d`. These values are calculated individually per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering)."},{label:"rollup_candlestick",insertText:"rollup_candlestick",detail:"rollup_candlestick(series_selector[d])",documentation:"calculates `open`, `high`, `low` and `close` values (aka OHLC) over raw samples on the given lookbehind window `d`. The calculations are performed individually per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). This function is useful for financial applications."},{label:"rollup_delta",insertText:"rollup_delta",detail:"rollup_delta(series_selector[d])",documentation:"calculates differences between adjacent raw samples on the given lookbehind window `d` and returns `min`, `max` and `avg` values for the calculated differences. The calculations are performed individually per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"rollup_deriv",insertText:"rollup_deriv",detail:"rollup_deriv(series_selector[d])",documentation:"calculates per-second derivatives for adjacent raw samples on the given lookbehind window `d` and returns `min`, `max` and `avg` values for the calculated per-second derivatives. The calculations are performed individually per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names` modifier in order to keep metric names."},{label:"rollup_increase",insertText:"rollup_increase",detail:"rollup_increase(series_selector[d])",documentation:"calculates increases for adjacent raw samples on the given lookbehind window `d` and returns `min`, `max` and `avg` values for the calculated increases. The calculations are performed individually per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"rollup_rate",insertText:"rollup_rate",detail:"rollup_rate(series_selector[d])",documentation:"calculates per-second change rates for adjacent raw samples on the given lookbehind window `d` and returns `min`, `max` and `avg` values for the calculated per-second change rates. The calculations are performed individually per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names` modifier in order to keep metric names."},{label:"rollup_scrape_interval",insertText:"rollup_scrape_interval",detail:"rollup_scrape_interval(series_selector[d])",documentation:"calculates the interval in seconds between adjacent raw samples on the given lookbehind window `d` and returns `min`, `max` and `avg` values for the calculated interval. The calculations are performed individually per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"scrape_interval",insertText:"scrape_interval",detail:"scrape_interval(series_selector[d])",documentation:"calculates the average interval in seconds between raw samples on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"share_gt_over_time",insertText:"share_gt_over_time",detail:"share_gt_over_time(series_selector[d], gt)",documentation:"returns share (in the range `[0...1]`) of raw samples on the given lookbehind window `d`, which are bigger than `gt`. It is calculated independently per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"share_le_over_time",insertText:"share_le_over_time",detail:"share_le_over_time(series_selector[d], le)",documentation:"returns share (in the range `[0...1]`) of raw samples on the given lookbehind window `d`, which are smaller or equal to `le`. It is calculated independently per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"stale_samples_over_time",insertText:"stale_samples_over_time",detail:"stale_samples_over_time(series_selector[d])",documentation:"calculates the number of [staleness markers](https://docs.victoriametrics.com/vmagent.html#prometheus-staleness-markers) on the given lookbehind window `d` per each time series matching the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names` modifier in order to keep metric names."},{label:"stddev_over_time",insertText:"stddev_over_time",detail:"stddev_over_time(series_selector[d])",documentation:"calculates standard deviation over raw samples on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"stdvar_over_time",insertText:"stdvar_over_time",detail:"stdvar_over_time(series_selector[d])",documentation:"calculates standard variance over raw samples on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"sum_over_time",insertText:"sum_over_time",detail:"sum_over_time(series_selector[d])",documentation:"calculates the sum of raw sample values on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names` modifier in order to keep metric names."},{label:"sum2_over_time",insertText:"sum2_over_time",detail:"sum2_over_time(series_selector[d])",documentation:"calculates the sum of squares for raw sample values on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names` modifier in order to keep metric names."},{label:"timestamp",insertText:"timestamp",detail:"timestamp(series_selector[d])",documentation:"returns the timestamp in seconds for the last raw sample on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"timestamp_with_name",insertText:"timestamp_with_name",detail:"timestamp_with_name(series_selector[d])",documentation:"returns the timestamp in seconds for the last raw sample on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are preserved in the resulting rollups. See also `timestamp`."},{label:"tfirst_over_time",insertText:"tfirst_over_time",detail:"tfirst_over_time(series_selector[d])",documentation:"returns the timestamp in seconds for the first raw sample on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"tlast_change_over_time",insertText:"tlast_change_over_time",detail:"tlast_change_over_time(series_selector[d])",documentation:"returns the timestamp in seconds for the last change per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering) on the given lookbehind window `d`. Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"tlast_over_time",insertText:"tlast_over_time",detail:"tlast_over_time(series_selector[d])",documentation:"is an alias for `timestamp`."},{label:"tmax_over_time",insertText:"tmax_over_time",detail:"tmax_over_time(series_selector[d])",documentation:"returns the timestamp in seconds for the raw sample with the maximum value on the given lookbehind window `d`. It is calculated independently per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"tmin_over_time",insertText:"tmin_over_time",detail:"tmin_over_time(series_selector[d])",documentation:"returns the timestamp in seconds for the raw sample with the minimum value on the given lookbehind window `d`. It is calculated independently per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"zscore_over_time",insertText:"zscore_over_time",detail:"zscore_over_time(series_selector[d])",documentation:"calculates returns [z-score](https://en.wikipedia.org/wiki/Standard_score) for raw samples on the given lookbehind window `d`. It is calculated independently per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names` modifier in order to keep metric names."},{label:"abs",insertText:"abs",detail:"abs(q)",documentation:"calculates the absolute value for every point of every time series returned by `q`."},{label:"absent",insertText:"absent",detail:"absent(q)",documentation:"returns 1 if `q` has no points. Otherwise returns an empty result."},{label:"acos",insertText:"acos",detail:"acos(q)",documentation:"returns [inverse cosine](https://en.wikipedia.org/wiki/Inverse_trigonometric_functions) for every point of every time series returned by `q`. Metric names are stripped from the resulting series. Add `keep_metric_names`."},{label:"acosh",insertText:"acosh",detail:"acosh(q)",documentation:"returns [inverse hyperbolic cosine](https://en.wikipedia.org/wiki/Inverse_hyperbolic_functions#Inverse_hyperbolic_cosine) for every point of every time series returned by `q`. Metric names are stripped from the resulting series. Add `keep_metric_names`."},{label:"asin",insertText:"asin",detail:"asin(q)",documentation:"returns [inverse sine](https://en.wikipedia.org/wiki/Inverse_trigonometric_functions) for every point of every time series returned by `q`. Metric names are stripped from the resulting series. Add `keep_metric_names`."},{label:"asinh",insertText:"asinh",detail:"asinh(q)",documentation:"returns [inverse hyperbolic sine](https://en.wikipedia.org/wiki/Inverse_hyperbolic_functions#Inverse_hyperbolic_sine) for every point of every time series returned by `q`. Metric names are stripped from the resulting series. Add `keep_metric_names`."},{label:"atan",insertText:"atan",detail:"atan(q)",documentation:"returns [inverse tangent](https://en.wikipedia.org/wiki/Inverse_trigonometric_functions) for every point of every time series returned by `q`. Metric names are stripped from the resulting series. Add `keep_metric_names`."},{label:"atanh",insertText:"atanh",detail:"atanh(q)",documentation:"returns [inverse hyperbolic tangent](https://en.wikipedia.org/wiki/Inverse_hyperbolic_functions#Inverse_hyperbolic_tangent) for every point of every time series returned by `q`. Metric names are stripped from the resulting series. Add `keep_metric_names`."},{label:"bitmap_and",insertText:"bitmap_and",detail:"bitmap_and(q, mask)",documentation:"- calculates bitwise `v & mask` for every `v` point of every time series returned from `q`. Metric names are stripped from the resulting series. Add `keep_metric_names` modifier in order to keep metric names."},{label:"bitmap_or",insertText:"bitmap_or",detail:"bitmap_or(q, mask)",documentation:"calculates bitwise `v | mask` for every `v` point of every time series returned from `q`. Metric names are stripped from the resulting series. Add `keep_metric_names` modifier in order to keep metric names."},{label:"bitmap_xor",insertText:"bitmap_xor",detail:"bitmap_xor(q, mask)",documentation:"calculates bitwise `v ^ mask` for every `v` point of every time series returned from `q`. Metric names are stripped from the resulting series. Add `keep_metric_names` modifier in order to keep metric names."},{label:"buckets_limit",insertText:"buckets_limit",detail:"buckets_limit(limit, buckets)",documentation:"limits the number of [histogram buckets](https://valyala.medium.com/improving-histogram-usability-for-prometheus-and-grafana-bc7e5df0e350) to the given `limit`. See also `prometheus_buckets`."},{label:"ceil",insertText:"ceil",detail:"ceil(q)",documentation:"rounds every point for every time series returned by `q` to the upper nearest integer. See also `floor`."},{label:"clamp",insertText:"clamp",detail:"clamp(q, min, max)",documentation:"clamps every point for every time series returned by `q` with the given `min` and `max` values. See also `clamp_min`."},{label:"clamp_max",insertText:"clamp_max",detail:"clamp_max(q, max)",documentation:"clamps every point for every time series returned by `q` with the given `max` value. See also `clamp`."},{label:"clamp_min",insertText:"clamp_min",detail:"clamp_min(q, min)",documentation:"clamps every point for every time series returned by `q` with the given `min` value. See also `clamp`."},{label:"cos",insertText:"cos",detail:"cos(q)",documentation:"returns `cos(v)` for every `v` point of every time series returned by `q`. Metric names are stripped from the resulting series. Add `keep_metric_names`."},{label:"cosh",insertText:"cosh",detail:"cosh(q)",documentation:"returns [hyperbolic cosine](https://en.wikipedia.org/wiki/Hyperbolic_functions) for every point of every time series returned by `q`. Metric names are stripped from the resulting series. Add `keep_metric_names`."},{label:"day_of_month",insertText:"day_of_month",detail:"day_of_month(q)",documentation:"returns the day of month for every point of every time series returned by `q`. It is expected that `q` returns unix timestamps. The returned values are in the range `[1...31]`. Metric names are stripped from the resulting series. Add `keep_metric_names` modifier in order to keep metric names."},{label:"day_of_week",insertText:"day_of_week",detail:"day_of_week(q)",documentation:"returns the day of week for every point of every time series returned by `q`. It is expected that `q` returns unix timestamps. The returned values are in the range `[0...6]`, where `0` means Sunday and `6` means Saturday. Metric names are stripped from the resulting series. Add `keep_metric_names` modifier in order to keep metric names."},{label:"days_in_month",insertText:"days_in_month",detail:"days_in_month(q)",documentation:"returns the number of days in the month identified by every point of every time series returned by `q`. It is expected that `q` returns unix timestamps. The returned values are in the range `[28...31]`. Metric names are stripped from the resulting series. Add `keep_metric_names` modifier in order to keep metric names."},{label:"deg",insertText:"deg",detail:"deg(q)",documentation:"converts [Radians to degrees](https://en.wikipedia.org/wiki/Radian#Conversions) for every point of every time series returned by `q`. Metric names are stripped from the resulting series. Add `keep_metric_names`."},{label:"end",insertText:"end",detail:"end()",documentation:"returns the unix timestamp in seconds for the last point. See also `start`."},{label:"exp",insertText:"exp",detail:"exp(q)",documentation:"calculates the `e^v` for every point `v` of every time series returned by `q`. Metric names are stripped from the resulting series. Add `keep_metric_names`."},{label:"floor",insertText:"floor",detail:"floor(q)",documentation:"rounds every point for every time series returned by `q` to the lower nearest integer. See also `ceil`."},{label:"histogram_avg",insertText:"histogram_avg",detail:"histogram_avg(buckets)",documentation:"calculates the average value for the given `buckets`. It can be used for calculating the average over the given time range across multiple time series. For example, `histogram_avg(sum(histogram_over_time(response_time_duration_seconds[5m])) by (vmrange,job))` would return the average response time per each `job` over the last 5 minutes."},{label:"histogram_quantile",insertText:"histogram_quantile",detail:"histogram_quantile(phi, buckets)",documentation:"calculates `phi`-quantile over the given [histogram buckets](https://valyala.medium.com/improving-histogram-usability-for-prometheus-and-grafana-bc7e5df0e350). `phi` must be in the range `[0...1]`. For example, `histogram_quantile(0.5, sum(rate(http_request_duration_seconds_bucket[5m]) by (le))` would return median request duration for all the requests during the last 5 minutes. It accepts optional third arg - `boundsLabel`. In this case it returns `lower` and `upper` bounds for the estimated percentile. See [this issue for details](https://github.com/prometheus/prometheus/issues/5706). This function is supported by PromQL (except of the `boundLabel` arg). See also `histogram_quantiles`."},{label:"histogram_quantiles",insertText:"histogram_quantiles",detail:'histogram_quantiles("phiLabel", phi1, ..., phiN, buckets)',documentation:"calculates the given `phi*`-quantiles over the given [histogram buckets](https://valyala.medium.com/improving-histogram-usability-for-prometheus-and-grafana-bc7e5df0e350). Argument `phi*` must be in the range `[0...1]`. For example, `histogram_quantiles('le', 0.3, 0.5, sum(rate(http_request_duration_seconds_bucket[5m]) by (le))`. Each calculated quantile is returned in a separate time series with the corresponding `{phiLabel=\"phi*\"}` label. See also `histogram_quantile`."},{label:"histogram_share",insertText:"histogram_share",detail:"histogram_share(le, buckets)",documentation:"calculates the share (in the range `[0...1]`) for `buckets` that fall below `le`. Useful for calculating SLI and SLO. This is inverse to `histogram_quantile`."},{label:"histogram_stddev",insertText:"histogram_stddev",detail:"histogram_stddev(buckets)",documentation:"calculates standard deviation for the given `buckets`."},{label:"histogram_stdvar",insertText:"histogram_stdvar",detail:"histogram_stdvar(buckets)",documentation:"calculates standard variance for the given `buckets`. It can be used for calculating standard deviation over the given time range across multiple time series. For example, `histogram_stdvar(sum(histogram_over_time(temperature[24])) by (vmrange,country))` would return standard deviation for the temperature per each country over the last 24 hours."},{label:"hour",insertText:"hour",detail:"hour(q)",documentation:"returns the hour for every point of every time series returned by `q`. It is expected that `q` returns unix timestamps. The returned values are in the range `[0...23]`. Metric names are stripped from the resulting series. Add `keep_metric_names` modifier in order to keep metric names."},{label:"interpolate",insertText:"interpolate",detail:"interpolate(q)",documentation:"fills gaps with linearly interpolated values calculated from the last and the next non-empty points per each time series returned by `q`. See also `keep_last_value`."},{label:"keep_last_value",insertText:"keep_last_value",detail:"keep_last_value(q)",documentation:"fills gaps with the value of the last non-empty point in every time series returned by `q`. See also `keep_next_value`."},{label:"keep_next_value",insertText:"keep_next_value",detail:"keep_next_value(q)",documentation:"fills gaps with the value of the next non-empty point in every time series returned by `q`. See also `keep_last_value`."},{label:"limit_offset",insertText:"limit_offset",detail:"limit_offset(limit, offset, q)",documentation:"skips `offset` time series from series returned by `q` and then returns up to `limit` of the remaining time series per each group. This allows implementing simple paging for `q` time series. See also `limitk`."},{label:"ln",insertText:"ln",detail:"ln(q)",documentation:"calculates `ln(v)` for every point `v` of every time series returned by `q`. Metric names are stripped from the resulting series. Add `keep_metric_names`."},{label:"log2",insertText:"log2",detail:"log2(q)",documentation:"calculates `log2(v)` for every point `v` of every time series returned by `q`. Metric names are stripped from the resulting series. Add `keep_metric_names`."},{label:"log10",insertText:"log10",detail:"log10(q)",documentation:"calculates `log10(v)` for every point `v` of every time series returned by `q`. Metric names are stripped from the resulting series. Add `keep_metric_names`."},{label:"minute",insertText:"minute",detail:"minute(q)",documentation:"returns the minute for every point of every time series returned by `q`. It is expected that `q` returns unix timestamps. The returned values are in the range `[0...59]`. Metric names are stripped from the resulting series. Add `keep_metric_names` modifier in order to keep metric names."},{label:"month",insertText:"month",detail:"month(q)",documentation:"returns the month for every point of every time series returned by `q`. It is expected that `q` returns unix timestamps. The returned values are in the range `[1...12]`, where `1` means January and `12` means December. Metric names are stripped from the resulting series. Add `keep_metric_names` modifier in order to keep metric names."},{label:"now",insertText:"now",detail:"now()",documentation:"returns the current timestamp as a floating-point value in seconds. See also `time`."},{label:"pi",insertText:"pi",detail:"pi()",documentation:"returns [Pi number](https://en.wikipedia.org/wiki/Pi)."},{label:"rad",insertText:"rad",detail:"rad(q)",documentation:"converts [degrees to Radians](https://en.wikipedia.org/wiki/Radian#Conversions) for every point of every time series returned by `q`. Metric names are stripped from the resulting series. Add `keep_metric_names`."},{label:"prometheus_buckets",insertText:"prometheus_buckets",detail:"prometheus_buckets(buckets)",documentation:"converts [VictoriaMetrics histogram buckets](https://valyala.medium.com/improving-histogram-usability-for-prometheus-and-grafana-bc7e5df0e350) with `vmrange` labels to Prometheus histogram buckets with `le` labels. This may be useful for building heatmaps in Grafana. See also `histogram_quantile`."},{label:"rand",insertText:"rand",detail:"rand(seed)",documentation:"returns pseudo-random numbers on the range `[0...1]` with even distribution. Optional `seed` can be used as a seed for pseudo-random number generator. See also `rand_normal`."},{label:"rand_exponential",insertText:"rand_exponential",detail:"rand_exponential(seed)",documentation:"returns pseudo-random numbers with [exponential distribution](https://en.wikipedia.org/wiki/Exponential_distribution). Optional `seed` can be used as a seed for pseudo-random number generator. See also `rand`."},{label:"rand_normal",insertText:"rand_normal",detail:"rand_normal(seed)",documentation:"returns pseudo-random numbers with [normal distribution](https://en.wikipedia.org/wiki/Normal_distribution). Optional `seed` can be used as a seed for pseudo-random number generator. See also `rand`."},{label:"range_avg",insertText:"range_avg",detail:"range_avg(q)",documentation:"calculates the avg value across points per each time series returned by `q`."},{label:"range_first",insertText:"range_first",detail:"range_first(q)",documentation:"returns the value for the first point per each time series returned by `q`."},{label:"range_last",insertText:"range_last",detail:"range_last(q)",documentation:"returns the value for the last point per each time series returned by `q`."},{label:"range_max",insertText:"range_max",detail:"range_max(q)",documentation:"calculates the max value across points per each time series returned by `q`."},{label:"range_median",insertText:"range_median",detail:"range_median(q)",documentation:"calculates the median value across points per each time series returned by `q`."},{label:"range_min",insertText:"range_min",detail:"range_min(q)",documentation:"calculates the min value across points per each time series returned by `q`."},{label:"range_quantile",insertText:"range_quantile",detail:"range_quantile(phi, q)",documentation:"returns `phi`-quantile across points per each time series returned by `q`. `phi` must be in the range `[0...1]`."},{label:"range_sum",insertText:"range_sum",detail:"range_sum(q)",documentation:"calculates the sum of points per each time series returned by `q`. Metric names are stripped from the resulting series. Add `keep_metric_names` modifier in order to keep metric names."},{label:"remove_resets",insertText:"remove_resets",detail:"remove_resets(q)",documentation:"removes counter resets from time series returned by `q`."},{label:"round",insertText:"round",detail:"round(q, nearest)",documentation:"round every point of every time series returned by `q` to the `nearest` multiple. If `nearest` is missing then the rounding is performed to the nearest integer. See also `floor`."},{label:"ru",insertText:"ru",detail:"ru(free, max)",documentation:"calculates resource utilization in the range `[0%...100%]` for the given `free` and `max` resources. For instance, `ru(node_memory_MemFree_bytes, node_memory_MemTotal_bytes)` returns memory utilization over [node_exporter](https://github.com/prometheus/node_exporter) metrics."},{label:"running_avg",insertText:"running_avg",detail:"running_avg(q)",documentation:"calculates the running avg per each time series returned by `q`."},{label:"running_max",insertText:"running_max",detail:"running_max(q)",documentation:"calculates the running max per each time series returned by `q`."},{label:"running_min",insertText:"running_min",detail:"running_min(q)",documentation:"calculates the running min per each time series returned by `q`."},{label:"running_sum",insertText:"running_sum",detail:"running_sum(q)",documentation:"calculates the running sum per each time series returned by `q`. Metric names are stripped from the resulting series. Add `keep_metric_names` modifier in order to keep metric names."},{label:"scalar",insertText:"scalar",detail:"scalar(q)",documentation:"returns `q` if `q` contains only a single time series. Otherwise it returns nothing."},{label:"sgn",insertText:"sgn",detail:"sgn(q)",documentation:"returns `1` if `v>0`, `-1` if `v<0` and `0` if `v==0` for every point `v` of every time series returned by `q`. Metric names are stripped from the resulting series. Add `keep_metric_names` modifier in order to keep metric names."},{label:"sin",insertText:"sin",detail:"sin(q)",documentation:"returns `sin(v)` for every `v` point of every time series returned by `q`. Metric names are stripped from the resulting series. Add `keep_metric_names`."},{label:"sinh",insertText:"sinh",detail:"sinh(q)",documentation:"returns [hyperbolic sine](https://en.wikipedia.org/wiki/Hyperbolic_functions) for every point of every time series returned by `q`. Metric names are stripped from the resulting series. Add `keep_metric_names`."},{label:"tan",insertText:"tan",detail:"tan(q)",documentation:"returns `tan(v)` for every `v` point of every time series returned by `q`. Metric names are stripped from the resulting series. Add `keep_metric_names`."},{label:"tanh",insertText:"tanh",detail:"tanh(q)",documentation:"returns [hyperbolic tangent](https://en.wikipedia.org/wiki/Hyperbolic_functions) for every point of every time series returned by `q`. Metric names are stripped from the resulting series. Add `keep_metric_names`."},{label:"smooth_exponential",insertText:"smooth_exponential",detail:"smooth_exponential(q, sf)",documentation:"smooths points per each time series returned by `q` using [exponential moving average](https://en.wikipedia.org/wiki/Moving_average#Exponential_moving_average) with the given smooth factor `sf`."},{label:"sort",insertText:"sort",detail:"sort(q)",documentation:"sorts series in ascending order by the last point in every time series returned by `q`. See also `sort_desc`."},{label:"sort_by_label",insertText:"sort_by_label",detail:"sort_by_label(q, label1, ... labelN)",documentation:'sorts series in ascending order by the given set of labels. For example, `sort_by_label(foo, "bar")` would sort `foo` series by values of the label `bar` in these series. See also `sort_by_label_desc`.'},{label:"sort_by_label_desc",insertText:"sort_by_label_desc",detail:"sort_by_label_desc(q, label1, ... labelN)",documentation:'sorts series in descending order by the given set of labels. For example, `sort_by_label(foo, "bar")` would sort `foo` series by values of the label `bar` in these series. See also `sort_by_label`.'},{label:"sort_by_label_numeric",insertText:"sort_by_label_numeric",detail:"sort_by_label_numeric(q, label1, ... labelN)",documentation:'sorts series in ascending order by the given set of labels using [numeric sort](https://www.gnu.org/software/coreutils/manual/html_node/Version-sort-is-not-the-same-as-numeric-sort.html). For example, if `foo` series have `bar` label with values `1`, `101`, `15` and `2`, then `sort_by_label_numeric(foo, "bar")` would return series in the following order of `bar` label values: `1`, `2`, `15` and `101`.'},{label:"sort_by_label_numeric_desc",insertText:"sort_by_label_numeric_desc",detail:"sort_by_label_numeric_desc(q, label1, ... labelN)",documentation:'sorts series in descending order by the given set of labels using [numeric sort](https://www.gnu.org/software/coreutils/manual/html_node/Version-sort-is-not-the-same-as-numeric-sort.html). For example, if `foo` series have `bar` label with values `1`, `101`, `15` and `2`, then `sort_by_label_numeric(foo, "bar")` would return series in the following order of `bar` label values: `101`, `15`, `2` and `1`.'},{label:"sort_desc",insertText:"sort_desc",detail:"sort_desc(q)",documentation:"sorts series in descending order by the last point in every time series returned by `q`. See also `sort`."},{label:"sqrt",insertText:"sqrt",detail:"sqrt(q)",documentation:"calculates square root for every point of every time series returned by `q`. Metric names are stripped from the resulting series. Add `keep_metric_names` modifier in order to keep metric names."},{label:"start",insertText:"start",detail:"start()",documentation:"returns unix timestamp in seconds for the first point. See also `end`."},{label:"step",insertText:"step",detail:"step()",documentation:"returns the step in seconds (aka interval) between the returned points. It is known as `step` query arg passed to [/api/v1/query_range](https://docs.victoriametrics.com/keyConcepts.html#range-query)."},{label:"time",insertText:"time",detail:"time()",documentation:"returns unix timestamp for every returned point."},{label:"timezone_offset",insertText:"timezone_offset",detail:"timezone_offset(tz)",documentation:'returns offset in seconds for the given timezone `tz` relative to UTC. This can be useful when combining with datetime-related functions. For example, `day_of_week(time()+timezone_offset("America/Los_Angeles"))` would return weekdays for `America/Los_Angeles` time zone. Special `Local` time zone can be used for returning an offset for the time zone set on the host where VictoriaMetrics runs. See [the list of supported timezones](https://en.wikipedia.org/wiki/List_of_tz_database_time_zones).'},{label:"ttf",insertText:"ttf",detail:"ttf(free)",documentation:"estimates the time in seconds needed to exhaust `free` resources. For instance, `ttf(node_filesystem_avail_byte)` returns the time to storage space exhaustion. This function may be useful for capacity planning."},{label:"union",insertText:"union",detail:"union(q1, ..., qN)",documentation:"returns a union of time series returned from `q1`, ..., `qN`. The `union` function name can be skipped - the following queries are equivalent: `union(q1, q2)` and `(q1, q2)`. It is expected that each `q*` query returns time series with unique sets of labels. Otherwise only the first time series out of series with identical set of labels is returned. Use `alias` functions for giving unique labelsets per each `q*` query:"},{label:"vector",insertText:"vector",detail:"vector(q)",documentation:"returns `q`, e.g. it does nothing in MetricsQL."},{label:"year",insertText:"year",detail:"year(q)",documentation:"returns the year for every point of every time series returned by `q`. It is expected that `q` returns unix timestamps. Metric names are stripped from the resulting series. Add `keep_metric_names` modifier in order to keep metric names."},{label:"alias",insertText:"alias",detail:'alias(q, "name")',documentation:'sets the given `name` to all the time series returned by `q`. For example, `alias(up, "foobar")` would rename `up` series to `foobar` series.'},{label:"drop_common_labels",insertText:"drop_common_labels",detail:"drop_common_labels(q1, ...., qN)",documentation:'drops common `label="value"` pairs among time series returned from `q1, ..., qN`.'},{label:"label_copy",insertText:"label_copy",detail:'label_copy(q, "src_label1", "dst_label1", ..., "src_labelN", "dst_labelN")',documentation:"copies label values from `src_label*` to `dst_label*` for all the time series returned by `q`. If `src_label` is empty, then the corresponding `dst_label` is left untouched."},{label:"label_del",insertText:"label_del",detail:'label_del(q, "label1", ..., "labelN")',documentation:"deletes the given `label*` labels from all the time series returned by `q`."},{label:"label_graphite_group",insertText:"label_graphite_group",detail:"label_graphite_group(q, groupNum1, ... groupNumN)",documentation:'replaces metric names returned from `q` with the given Graphite group values concatenated via `.` char. For example, `label_graphite_group({__graphite__="foo*.bar.*"}, 0, 2)` would substitute `foo<any_value>.bar.<other_value>` metric names with `foo<any_value>.<other_value>`. This function is useful for aggregating Graphite metrics with `aggregate functions`. For example, the following query would return per-app memory usage:'},{label:"label_join",insertText:"label_join",detail:'label_join(q, "dst_label", "separator", "src_label1", ..., "src_labelN")',documentation:'joins `src_label*` values with the given `separator` and stores the result in `dst_label`. This is performed individually per each time series returned by `q`. For example, `label_join(up{instance="xxx",job="yyy"}, "foo", "-", "instance", "job")` would store `xxx-yyy` label value into `foo` label.'},{label:"label_keep",insertText:"label_keep",detail:'label_keep(q, "label1", ..., "labelN")',documentation:"deletes all the labels except of the listed `label*` labels in all the time series returned by `q`."},{label:"label_lowercase",insertText:"label_lowercase",detail:'label_lowercase(q, "label1", ..., "labelN")',documentation:"lowercases values for the given `label*` labels in all the time series returned by `q`."},{label:"label_map",insertText:"label_map",detail:'label_map(q, "label", "src_value1", "dst_value1", ..., "src_valueN", "dst_valueN")',documentation:"maps `label` values from `src_*` to `dst*` for all the time series returned by `q`."},{label:"label_match",insertText:"label_match",detail:'label_match(q, "label", "regexp")',documentation:"drops time series from `q` with `label` not matching the given `regexp`. This function can be useful after `rollup`."},{label:"label_mismatch",insertText:"label_mismatch",detail:'label_mismatch(q, "label", "regexp")',documentation:"drops time series from `q` with `label` matching the given `regexp`. This function can be useful after `rollup`."},{label:"label_move",insertText:"label_move",detail:'label_move(q, "src_label1", "dst_label1", ..., "src_labelN", "dst_labelN")',documentation:"moves label values from `src_label*` to `dst_label*` for all the time series returned by `q`. If `src_label` is empty, then the corresponding `dst_label` is left untouched."},{label:"label_replace",insertText:"label_replace",detail:'label_replace(q, "dst_label", "replacement", "src_label", "regex")',documentation:'applies the given `regex` to `src_label` and stores the `replacement` in `dst_label` if the given `regex` matches `src_label`. The `replacement` may contain references to regex captures such as `$1`, `$2`, etc. These references are substituted by the corresponding regex captures. For example, `label_replace(up{job="node-exporter"}, "foo", "bar-$1", "job", "node-(.+)")` would store `bar-exporter` label value into `foo` label.'},{label:"label_set",insertText:"label_set",detail:'label_set(q, "label1", "value1", ..., "labelN", "valueN")',documentation:'sets `{label1="value1", ..., labelN="valueN"}` labels to all the time series returned by `q`.'},{label:"label_transform",insertText:"label_transform",detail:'label_transform(q, "label", "regexp", "replacement")',documentation:"substitutes all the `regexp` occurrences by the given `replacement` in the given `label`."},{label:"label_uppercase",insertText:"label_uppercase",detail:'label_uppercase(q, "label1", ..., "labelN")',documentation:"uppercases values for the given `label*` labels in all the time series returned by `q`."},{label:"label_value",insertText:"label_value",detail:'label_value(q, "label")',documentation:'returns number values for the given `label` for every time series returned by `q`. For example, if `label_value(foo, "bar")` is applied to `foo{bar="1.234"}`, then it will return a time series `foo{bar="1.234"}` with `1.234` value.'},{label:"any",insertText:"any",detail:"any(q) by (group_labels)",documentation:"returns a single series per `group_labels` out of time series returned by `q`. See also `group`."},{label:"avg",insertText:"avg",detail:"avg(q) by (group_labels)",documentation:"returns the average value per `group_labels` for time series returned by `q`. The aggregate is calculated individually per each group of points with the same timestamp."},{label:"bottomk",insertText:"bottomk",detail:"bottomk(k, q)",documentation:"returns up to `k` points with the smallest values across all the time series returned by `q`. The aggregate is calculated individually per each group of points with the same timestamp. See also `topk`."},{label:"bottomk_avg",insertText:"bottomk_avg",detail:'bottomk_avg(k, q, "other_label=other_value")',documentation:'returns up to `k` time series from `q` with the smallest averages. If an optional `other_label=other_value` arg is set, then the sum of the remaining time series is returned with the given label. For example, `bottomk_avg(3, sum(process_resident_memory_bytes) by (job), "job=other")` would return up to 3 time series with the smallest averages plus a time series with `{job="other"}` label with the sum of the remaining series if any. See also `topk_avg`.'},{label:"bottomk_last",insertText:"bottomk_last",detail:'bottomk_last(k, q, "other_label=other_value")',documentation:'returns up to `k` time series from `q` with the smallest last values. If an optional `other_label=other_value` arg is set, then the sum of the remaining time series is returned with the given label. For example, `bottomk_max(3, sum(process_resident_memory_bytes) by (job), "job=other")` would return up to 3 time series with the smallest maximums plus a time series with `{job="other"}` label with the sum of the remaining series if any. See also `topk_last`.'},{label:"bottomk_max",insertText:"bottomk_max",detail:'bottomk_max(k, q, "other_label=other_value")',documentation:'returns up to `k` time series from `q` with the smallest maximums. If an optional `other_label=other_value` arg is set, then the sum of the remaining time series is returned with the given label. For example, `bottomk_max(3, sum(process_resident_memory_bytes) by (job), "job=other")` would return up to 3 time series with the smallest maximums plus a time series with `{job="other"}` label with the sum of the remaining series if any. See also `topk_max`.'},{label:"bottomk_median",insertText:"bottomk_median",detail:'bottomk_median(k, q, "other_label=other_value")',documentation:'returns up to `k` time series from `q with the smallest medians. If an optional`other_label=other_value`arg is set, then the sum of the remaining time series is returned with the given label. For example,`bottomk_median(3, sum(process_resident_memory_bytes) by (job), "job=other")`would return up to 3 time series with the smallest medians plus a time series with`{job="other"}\\` label with the sum of the remaining series if any. See also `topk_median`.'},{label:"bottomk_min",insertText:"bottomk_min",detail:'bottomk_min(k, q, "other_label=other_value")',documentation:'returns up to `k` time series from `q` with the smallest minimums. If an optional `other_label=other_value` arg is set, then the sum of the remaining time series is returned with the given label. For example, `bottomk_min(3, sum(process_resident_memory_bytes) by (job), "job=other")` would return up to 3 time series with the smallest minimums plus a time series with `{job="other"}` label with the sum of the remaining series if any. See also `topk_min`.'},{label:"count",insertText:"count",detail:"count(q) by (group_labels)",documentation:"returns the number of non-empty points per `group_labels` for time series returned by `q`. The aggregate is calculated individually per each group of points with the same timestamp."},{label:"count_values",insertText:"count_values",detail:'count_values("label", q)',documentation:"counts the number of points with the same value and stores the counts in a time series with an additional `label`, which contains each initial value. The aggregate is calculated individually per each group of points with the same timestamp."},{label:"distinct",insertText:"distinct",detail:"distinct(q)",documentation:"calculates the number of unique values per each group of points with the same timestamp."},{label:"geomean",insertText:"geomean",detail:"geomean(q)",documentation:"calculates geometric mean per each group of points with the same timestamp."},{label:"group",insertText:"group",detail:"group(q) by (group_labels)",documentation:"returns `1` per each `group_labels` for time series returned by `q`. See also `any`."},{label:"histogram",insertText:"histogram",detail:"histogram(q)",documentation:"calculates [VictoriaMetrics histogram](https://valyala.medium.com/improving-histogram-usability-for-prometheus-and-grafana-bc7e5df0e350) per each group of points with the same timestamp. Useful for visualizing big number of time series via a heatmap. See [this article](https://medium.com/@valyala/improving-histogram-usability-for-prometheus-and-grafana-bc7e5df0e350) for more details."},{label:"limitk",insertText:"limitk",detail:"limitk(k, q) by (group_labels)",documentation:"returns up to `k` time series per each `group_labels` out of time series returned by `q`. The returned set of time series remain the same across calls. See also `limit_offset`."},{label:"mad",insertText:"mad",detail:"mad(q) by (group_labels)",documentation:"returns the [Median absolute deviation](https://en.wikipedia.org/wiki/Median_absolute_deviation) per each `group_labels` for all the time series returned by `q`. The aggregate is calculated individually per each group of points with the same timestamp. See also `outliers_mad`."},{label:"max",insertText:"max",detail:"max(q) by (group_labels)",documentation:"returns the maximum value per each `group_labels` for all the time series returned by `q`. The aggregate is calculated individually per each group of points with the same timestamp."},{label:"median",insertText:"median",detail:"median(q) by (group_labels)",documentation:"returns the median value per each `group_labels` for all the time series returned by `q`. The aggregate is calculated individually per each group of points with the same timestamp."},{label:"min",insertText:"min",detail:"min(q) by (group_labels)",documentation:"returns the minimum value per each `group_labels` for all the time series returned by `q`. The aggregate is calculated individually per each group of points with the same timestamp."},{label:"mode",insertText:"mode",detail:"mode(q) by (group_labels)",documentation:"returns [mode](https://en.wikipedia.org/wiki/Mode_(statistics)) per each `group_labels` for all the time series returned by `q`. The aggregate is calculated individually per each group of points with the same timestamp."},{label:"outliers_mad",insertText:"outliers_mad",detail:"outliers_mad(tolerance, q)",documentation:"returns time series from `q` with at least a single point outside [Median absolute deviation](https://en.wikipedia.org/wiki/Median_absolute_deviation) (aka MAD) multiplied by `tolerance`. E.g. it returns time series with at least a single point below `median(q) - mad(q)` or a single point above `median(q) + mad(q)`. See also `outliersk`."},{label:"outliersk",insertText:"outliersk",detail:"outliersk(k, q)",documentation:"returns up to `k` time series with the biggest standard deviation (aka outliers) out of time series returned by `q`. See also `outliers_mad`."},{label:"quantile",insertText:"quantile",detail:"quantile(phi, q) by (group_labels)",documentation:"calculates `phi`-quantile per each `group_labels` for all the time series returned by `q`. `phi` must be in the range `[0...1]`. The aggregate is calculated individually per each group of points with the same timestamp. See also `quantiles`."},{label:"quantiles",insertText:"quantiles",detail:'quantiles("phiLabel", phi1, ..., phiN, q)',documentation:'calculates `phi*`-quantiles for all the time series returned by `q` and return them in time series with `{phiLabel="phi*"}` label. `phi*` must be in the range `[0...1]`. The aggregate is calculated individually per each group of points with the same timestamp. See also `quantile`.'},{label:"stddev",insertText:"stddev",detail:"stddev(q) by (group_labels)",documentation:"calculates standard deviation per each `group_labels` for all the time series returned by `q`. The aggregate is calculated individually per each group of points with the same timestamp."},{label:"stdvar",insertText:"stdvar",detail:"stdvar(q) by (group_labels)",documentation:"calculates standard variance per each `group_labels` for all the time series returned by `q`. The aggregate is calculated individually per each group of points with the same timestamp."},{label:"sum",insertText:"sum",detail:"sum(q) by (group_labels)",documentation:"returns the sum per each `group_labels` for all the time series returned by `q`. The aggregate is calculated individually per each group of points with the same timestamp."},{label:"sum2",insertText:"sum2",detail:"sum2(q) by (group_labels)",documentation:"calculates the sum of squares per each `group_labels` for all the time series returned by `q`. The aggregate is calculated individually per each group of points with the same timestamp."},{label:"topk",insertText:"topk",detail:"topk(k, q)",documentation:"returns up to `k` points with the biggest values across all the time series returned by `q`. The aggregate is calculated individually per each group of points with the same timestamp. See also `bottomk`."},{label:"topk_avg",insertText:"topk_avg",detail:'topk_avg(k, q, "other_label=other_value")',documentation:'returns up to `k` time series from `q` with the biggest averages. If an optional `other_label=other_value` arg is set, then the sum of the remaining time series is returned with the given label. For example, `topk_avg(3, sum(process_resident_memory_bytes) by (job), "job=other")` would return up to 3 time series with the biggest averages plus a time series with `{job="other"}` label with the sum of the remaining series if any. See also `bottomk_avg`.'},{label:"topk_last",insertText:"topk_last",detail:'topk_last(k, q, "other_label=other_value")',documentation:'returns up to `k` time series from `q` with the biggest last values. If an optional `other_label=other_value` arg is set, then the sum of the remaining time series is returned with the given label. For example, `topk_max(3, sum(process_resident_memory_bytes) by (job), "job=other")` would return up to 3 time series with the biggest maximums plus a time series with `{job="other"}` label with the sum of the remaining series if any. See also `bottomk_last`.'},{label:"topk_max",insertText:"topk_max",detail:'topk_max(k, q, "other_label=other_value")',documentation:'returns up to `k` time series from `q` with the biggest maximums. If an optional `other_label=other_value` arg is set, then the sum of the remaining time series is returned with the given label. For example, `topk_max(3, sum(process_resident_memory_bytes) by (job), "job=other")` would return up to 3 time series with the biggest maximums plus a time series with `{job="other"}` label with the sum of the remaining series if any. See also `bottomk_max`.'},{label:"topk_median",insertText:"topk_median",detail:'topk_median(k, q, "other_label=other_value")',documentation:'returns up to `k` time series from `q` with the biggest medians. If an optional `other_label=other_value` arg is set, then the sum of the remaining time series is returned with the given label. For example, `topk_median(3, sum(process_resident_memory_bytes) by (job), "job=other")` would return up to 3 time series with the biggest medians plus a time series with `{job="other"}` label with the sum of the remaining series if any. See also `bottomk_median`.'},{label:"topk_min",insertText:"topk_min",detail:'topk_min(k, q, "other_label=other_value")',documentation:'returns up to `k` time series from `q` with the biggest minimums. If an optional `other_label=other_value` arg is set, then the sum of the remaining time series is returned with the given label. For example, `topk_min(3, sum(process_resident_memory_bytes) by (job), "job=other")` would return up to 3 time series with the biggest minimums plus a time series with `{job="other"}` label with the sum of the remaining series if any. See also `bottomk_min`.'},{label:"zscore",insertText:"zscore",detail:"zscore(q) by (group_labels)",documentation:"returns [z-score](https://en.wikipedia.org/wiki/Standard_score) values per each `group_labels` for all the time series returned by `q`. The aggregate is calculated individually per each group of points with the same timestamp. Useful for detecting anomalies in the group of related time series."},{insertText:"count_scalar",label:"count_scalar",detail:"count_scalar(v instant-vector)",documentation:"Returns the number of elements in a time series vector as a scalar. This is in contrast to the `count()` aggregation operator, which always returns a vector (an empty one if the input vector is empty) and allows grouping by labels via a `by` clause."}],V=(z.map((e=>e.label)),{comment:{pattern:/#.*/},"context-aggregation":{pattern:/((by|without)\s*)\([^)]*\)/,lookbehind:!0,inside:{"label-key":{pattern:/[^(),\s][^,)]*[^),\s]*/,alias:"attr-name"},punctuation:/[()]/}},"context-labels":{pattern:/\{[^}]*(?=}?)/,greedy:!0,inside:{comment:{pattern:/#.*/},"label-key":{pattern:/[a-z_]\w*(?=\s*(=|!=|=~|!~))/,alias:"attr-name",greedy:!0},"label-value":{pattern:/"(?:\\.|[^\\"])*"/,greedy:!0,alias:"attr-value"},punctuation:/[{]/}},function:new RegExp(`\\b(?:${z.map((e=>e.label)).join("|")})(?=\\s*\\()`,"i"),"context-range":[{pattern:/\[[^\]]*(?=])/,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}},{pattern:/(offset\s+)\w+/,lookbehind:!0,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}}],idList:{pattern:/\d+(\|\d+)+/,alias:"number"},number:/\b-?\d+((\.\d*)?([eE][+-]?\d+)?)?\b/,operator:new RegExp(`/[-+*/=%^~]|&&?|\\|?\\||!=?|<(?:=>?|<|>)?|>[>=]?|\\b(?:${["by","group_left","group_right","ignoring","on","offset","without"].join("|")})\\b`,"i"),punctuation:/[{};()`,.]/}),U=V;var W,X,G=m(5980),H=m(6407),Y=m.n(H);function K(e,t,r,n,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function J(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function o(e){K(a,n,i,o,s,"next",e)}function s(e){K(a,n,i,o,s,"throw",e)}o(void 0)}))}}function Z({onChange:n,index:i,operationIndex:o,value:s,query:l,datasource:c}){const[u,d]=(0,t.useState)({});return r().createElement(a.Select,{inputId:pe(o,i),autoFocus:""===s||void 0,openMenuOnFocus:!0,onOpenMenu:J((function*(){d({isLoading:!0});const e=yield function(e,t){return ee.apply(this,arguments)}(l,c);d({options:e,isLoading:void 0})})),isLoading:u.isLoading,allowCustomValue:!0,noOptionsMessage:"No labels found",loadingMessage:"Loading labels",options:u.options,value:(0,e.toOption)(s),onChange:e=>n(i,e.value)})}function ee(){return ee=J((function*(e,t){let r=e.labels;"prometheus"===t.type&&(r=[{label:"__name__",op:"=",value:e.metric},...e.labels]);const n=$e.renderLabels(r),i=yield t.languageProvider.fetchSeriesLabels(n);return Object.keys(i).map((e=>({label:e,value:e})))})),ee.apply(this,arguments)}function te(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function re(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){te(e,t,r[t])}))}return e}function ne(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function ie(e,t,r){const n=ce(e,t),i=e.id+"(";return r&&n.push(r),i+n.join(", ")+")"}function ae(e,t,r){const n=ce(e,t),i=e.id+"(";return r&&n.unshift(r),i+n.join(", ")+")"}function oe(e,t,r,n){if(t.params.length<2)throw`Cannot render a function with params of length [${t.params.length}]`;var i,a;let o=null!==(a=(null!==(i=e.params)&&void 0!==i?i:[])[0])&&void 0!==a?a:"5m";const s=ce(ne(re({},e),{params:e.params.slice(1)}),ne(re({},t),{params:t.params.slice(1),defaultParams:t.defaultParams.slice(1)})),l=e.id+"(";return r&&(n?s.push(`${r}[${o}]`):s.unshift(`${r}[${o}]`)),l+s.join(", ")+")"}function se(e,t,r){return oe(e,t,r,!1)}function le(e,t,r){return oe(e,t,r,!0)}function ce(e,t,r){var n;return(null!==(n=e.params)&&void 0!==n?n:[]).map(((e,r)=>"string"===t.params[r].type?'"'+e+'"':e))}function ue(e,t){const r={id:e.id,params:e.defaultParams};return ne(re({},t),{operations:[...t.operations,r]})}function de(e){return(0,G.capitalize)(e.replace(/_/g," "))}function pe(e,t){return`operations.${e}.param.${t}`}function he(e=!1){const t={name:"Range",type:"string",options:[{label:"$__interval",value:"$__interval"},{label:"1m",value:"1m"},{label:"5m",value:"5m"},{label:"10m",value:"10m"},{label:"1h",value:"1h"},{label:"24h",value:"24h"}]};return e&&t.options.unshift({label:"$__rate_interval",value:"$__rate_interval"}),t}function fe(e,t={}){var r,n;return[re({id:e,name:de(e),params:[{name:"By label",type:"string",restParam:!0,optional:!0}],defaultParams:[],alternativesKey:"plain aggregations",category:W.Aggregations,renderer:ie,paramChangedHandler:(n=`__${e}_by`,function(e,t,r){return t.params.length===r.params.length?ne(re({},t),{id:n}):t}),explainHandler:be(e,""),addOperationHandler:ue},t),re({id:`__${e}_by`,name:`${de(e)} by`,params:[{name:"Label",type:"string",restParam:!0,optional:!0,editor:Z}],defaultParams:[""],alternativesKey:"aggregations by",category:W.Aggregations,renderer:(r=e,function(e,t,n){return`${r} by(${e.params.join(", ")}) (${n})`}),paramChangedHandler:ye(e),explainHandler:be(e,"by"),addOperationHandler:ue,hideFromList:!0},t),re({id:`__${e}_without`,name:`${de(e)} without`,params:[{name:"Label",type:"string",restParam:!0,optional:!0,editor:Z}],defaultParams:[""],alternativesKey:"aggregations by",category:W.Aggregations,renderer:ge(e),paramChangedHandler:ye(e),explainHandler:be(e,"without"),addOperationHandler:ue,hideFromList:!0},t)]}function me(e,t,r={}){const n=fe(e,r);return n[0].params.unshift(...t.params),n[1].params.unshift(...t.params),n[2].params.unshift(...t.params),n[0].defaultParams=t.defaultParams,n[1].defaultParams=[...t.defaultParams,""],n[2].defaultParams=[...t.defaultParams,""],n[1].renderer=ve(e),n[2].renderer=ve(e),n}function ge(e){return function(t,r,n){return`${e} without(${t.params.join(", ")}) (${n})`}}function be(e,t){return function(r){const n=r.params.map((e=>`\`${e}\``)).join(" and "),i=Y()("label",r.params.length);switch(t){case"by":return`Calculates ${e} over dimensions while preserving ${i} ${n}.`;case"without":return`Calculates ${e} over the dimensions ${n}. All other labels are preserved.`;default:return`Calculates ${e} over the dimensions.`}}}function ve(e){return function(t,r,n){const i=r.params.findIndex((e=>e.restParam)),a=t.params.slice(0,i),o=t.params.slice(i);return`${e} by(${o.join(", ")}) (${a.map(((e,t)=>"string"===r.params[t].type?`"${e}"`:e)).join(", ")}, ${n})`}}function ye(e){return function(t,r,n){return r.params.length<n.params.length?ne(re({},r),{id:e}):r}}!function(e){e.Aggregations="Aggregations",e.RangeFunctions="Range functions",e.Functions="Functions",e.BinaryOps="Binary operations",e.Trigonometric="Trigonometric",e.Time="Time Functions"}(W||(W={})),function(e){e.Abs="abs",e.Absent="absent",e.AbsentOverTime="absent_over_time",e.Acos="acos",e.Acosh="acosh",e.Asin="asin",e.Asinh="asinh",e.Atan="atan",e.Atanh="atanh",e.Avg="avg",e.AvgOverTime="avg_over_time",e.BottomK="bottomk",e.Ceil="ceil",e.Changes="changes",e.Clamp="clamp",e.ClampMax="clamp_max",e.ClampMin="clamp_min",e.Cos="cos",e.Cosh="cosh",e.Count="count",e.CountOverTime="count_over_time",e.CountScalar="count_scalar",e.CountValues="count_values",e.DayOfMonth="day_of_month",e.DayOfWeek="day_of_week",e.DaysInMonth="days_in_month",e.Deg="deg",e.Delta="delta",e.Deriv="deriv",e.DropCommonLabels="drop_common_labels",e.Exp="exp",e.Floor="floor",e.Group="group",e.HistogramQuantile="histogram_quantile",e.HoltWinters="holt_winters",e.Hour="hour",e.Idelta="idelta",e.Increase="increase",e.Irate="irate",e.LabelJoin="label_join",e.LabelReplace="label_replace",e.Last="last",e.LastOverTime="last_over_time",e.Ln="ln",e.Log10="log10",e.Log2="log2",e.Max="max",e.MaxOverTime="max_over_time",e.Min="min",e.MinOverTime="min_over_time",e.Minute="minute",e.Month="month",e.Pi="pi",e.PredictLinear="predict_linear",e.Present="present",e.PresentOverTime="present_over_time",e.Quantile="quantile",e.QuantileOverTime="quantile_over_time",e.Rad="rad",e.Rate="rate",e.Resets="resets",e.Round="round",e.Scalar="scalar",e.Sgn="sgn",e.Sin="sin",e.Sinh="sinh",e.Sort="sort",e.SortDesc="sort_desc",e.Sqrt="sqrt",e.Stddev="stddev",e.StddevOverTime="stddev_over_time",e.Sum="sum",e.SumOverTime="sum_over_time",e.Tan="tan",e.Tanh="tanh",e.Time="time",e.Timestamp="timestamp",e.TopK="topk",e.Vector="vector",e.Year="year",e.Addition="__addition",e.Subtraction="__subtraction",e.MultiplyBy="__multiply_by",e.DivideBy="__divide_by",e.Modulo="__modulo",e.Exponent="__exponent",e.NestedQuery="__nested_query",e.EqualTo="__equal_to",e.NotEqualTo="__not_equal_to",e.GreaterThan="__greater_than",e.LessThan="__less_than",e.GreaterOrEqual="__greater_or_equal",e.LessOrEqual="__less_or_equal"}(X||(X={}));const Oe=[{id:X.Addition,name:"Add scalar",sign:"+"},{id:X.Subtraction,name:"Subtract scalar",sign:"-"},{id:X.MultiplyBy,name:"Multiply by scalar",sign:"*"},{id:X.DivideBy,name:"Divide by scalar",sign:"/"},{id:X.Modulo,name:"Modulo by scalar",sign:"%"},{id:X.Exponent,name:"Exponent",sign:"^"},{id:X.EqualTo,name:"Equal to",sign:"==",comparison:!0},{id:X.NotEqualTo,name:"Not equal to",sign:"!=",comparison:!0},{id:X.GreaterThan,name:"Greater than",sign:">",comparison:!0},{id:X.LessThan,name:"Less than",sign:"<",comparison:!0},{id:X.GreaterOrEqual,name:"Greater or equal to",sign:">=",comparison:!0},{id:X.LessOrEqual,name:"Less or equal to",sign:"<=",comparison:!0}],xe=Oe.reduce(((e,t)=>(e[t.sign]={id:t.id,comparison:t.comparison},e)),{}),we=Oe.map((e=>{const t=[{name:"Value",type:"number"}],r=[2];return e.comparison&&(t.push({name:"Bool",type:"boolean",description:"If checked comparison will return 0 or 1 for the value rather than filtering."}),r.push(!1)),{id:e.id,name:e.name,params:t,defaultParams:r,alternativesKey:"binary scalar operations",category:W.BinaryOps,renderer:_e(e.sign),addOperationHandler:ue}}));function _e(e){return function(t,r,n){let i=t.params[0],a="";return 2===t.params.length&&(a=t.params[1]?" bool":""),`${n} ${e}${a} ${i}`}}function Se(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ee(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Se(e,t,r[t])}))}return e}function ke(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function Pe(e){var t,r,n,i,a,o;return ke(Ee({},e),{id:e.id,name:null!==(t=e.name)&&void 0!==t?t:de(e.id),params:null!==(r=e.params)&&void 0!==r?r:[],defaultParams:null!==(n=e.defaultParams)&&void 0!==n?n:[],category:null!==(i=e.category)&&void 0!==i?i:W.Functions,renderer:null!==(a=e.renderer)&&void 0!==a?a:e.params?ae:ie,addOperationHandler:null!==(o=e.addOperationHandler)&&void 0!==o?o:ue})}function Te(e,t=!1){return{id:e,name:de(e),params:[he(t)],defaultParams:[t?"$__rate_interval":"$__interval"],alternativesKey:"range function",category:W.RangeFunctions,renderer:Ie,addOperationHandler:De,changeTypeHandler:Ce}}function Ce(e,t){return("$__rate_interval"===e.params[0]&&"$__rate_interval"!==t.defaultParams[0]||"$__interval"===e.params[0]&&"$__interval"!==t.defaultParams[0])&&(e.params=t.defaultParams),e}function Ie(e,t,r){var n,i;let a=null!==(i=(null!==(n=e.params)&&void 0!==n?n:[])[0])&&void 0!==i?i:"5m";return`${t.id}(${r}[${a}])`}function De(e,t,r){const n={id:e.id,params:e.defaultParams};return t.operations.length>0&&r.getOperationDef(t.operations[0].id).addOperationHandler===De?ke(Ee({},t),{operations:[n,...t.operations.slice(1)]}):ke(Ee({},t),{operations:[n,...t.operations]})}function Ae(e,t){var r;return ke(Ee({},t),{binaryQueries:[...null!==(r=t.binaryQueries)&&void 0!==r?r:[],{operator:"/",query:t}]})}function Re(e,t,r){if("string"!=typeof e.params[1])throw"The separator must be a string";const n=`"${e.params[1]}"`;return`${e.id}(${r}, "${e.params[0]}", ${n}, "${e.params.slice(2).join(n)}")`}function je(e,t){const r={id:e.id,params:e.defaultParams};return ke(Ee({},t),{operations:[...t.operations,r]})}function Ne(e){return{id:e,name:de(e),params:[he()],defaultParams:["$__interval"],alternativesKey:"overtime function",category:W.RangeFunctions,renderer:Le,addOperationHandler:De}}function Le(e,t,r){var n,i;let a=null!==(i=(null!==(n=e.params)&&void 0!==n?n:[])[0])&&void 0!==i?i:"$__interval";return`${t.id}(${r}[${a}])`}class qe extends class{setOperationCategories(e){this.categories=e}getOperationsForCategory(e){return this.operationsRegistry.list().filter((t=>t.category===e&&!t.hideFromList))}getAlternativeOperations(e){return this.operationsRegistry.list().filter((t=>t.alternativesKey&&t.alternativesKey===e))}getCategories(){return this.categories}getOperationDef(e){return this.operationsRegistry.getIfExists(e)}renderOperations(e,t){for(const r of t){const t=this.operationsRegistry.getIfExists(r.id);if(!t)throw new Error(`Could not find operation ${r.id} in the registry`);e=t.renderer(r,t,e)}return e}renderBinaryQueries(e,t){if(t)for(const r of t)e=`${this.renderBinaryQuery(e,r)}`;return e}renderBinaryQuery(e,t){let r=e+` ${t.operator} `;return t.vectorMatches&&(r+=`${t.vectorMatchesType}(${t.vectorMatches}) `),r+this.renderQuery(t.query,!0)}renderLabels(e){if(0===e.length)return"";let t="{";for(const r of e)"{"!==t&&(t+=", "),t+=`${r.label}${r.op}"${r.value}"`;return t+"}"}renderQuery(e,t){var r,n,i;let a=`${null!==(i=e.metric)&&void 0!==i?i:""}${this.renderLabels(e.labels)}`;return a=this.renderOperations(a,e.operations),!t&&this.hasBinaryOp(e)&&Boolean(null===(r=e.binaryQueries)||void 0===r?void 0:r.length)&&(a=`(${a})`),a=this.renderBinaryQueries(a,e.binaryQueries),t&&(this.hasBinaryOp(e)||Boolean(null===(n=e.binaryQueries)||void 0===n?void 0:n.length))&&(a=`(${a})`),a}hasBinaryOp(e){return void 0!==e.operations.find((e=>{const t=this.getOperationDef(e.id);return(null==t?void 0:t.category)===W.BinaryOps}))}constructor(t){this.categories=[],this.operationsRegistry=new e.Registry(t)}}{getQueryPatterns(){return[{name:"Rate then sum",operations:[{id:"rate",params:["$__rate_interval"]},{id:"sum",params:[]}]},{name:"Rate then sum by(label) then avg",operations:[{id:"rate",params:["$__rate_interval"]},{id:"__sum_by",params:[""]},{id:"avg",params:[]}]},{name:"Histogram quantile on rate",operations:[{id:"rate",params:["$__rate_interval"]},{id:"__sum_by",params:["le"]},{id:"histogram_quantile",params:[.95]}]},{name:"Histogram quantile on increase ",operations:[{id:"increase",params:["$__rate_interval"]},{id:"__max_by",params:["le"]},{id:"histogram_quantile",params:[.95]}]}]}constructor(){super((()=>{const e=[{id:X.HistogramQuantile,name:"Histogram quantile",params:[{name:"Quantile",type:"number",options:[.99,.95,.9,.75,.5,.25]}],defaultParams:[.9],category:W.Functions,renderer:ie,addOperationHandler:ue},{id:X.LabelReplace,name:"Label replace",params:[{name:"Destination label",type:"string"},{name:"Replacement",type:"string"},{name:"Source label",type:"string"},{name:"Regex",type:"string"}],category:W.Functions,defaultParams:["","$1","","(.*)"],renderer:ae,addOperationHandler:ue},{id:X.Ln,name:"Ln",params:[],defaultParams:[],category:W.Functions,renderer:ie,addOperationHandler:ue},Te(X.Changes),Te(X.Rate,!0),Te(X.Irate),Te(X.Increase,!0),Te(X.Idelta),Te(X.Delta),Pe({id:X.HoltWinters,params:[he(),{name:"Smoothing Factor",type:"number"},{name:"Trend Factor",type:"number"}],defaultParams:["$__interval",.5,.5],alternativesKey:"range function",category:W.RangeFunctions,renderer:se,addOperationHandler:De,changeTypeHandler:Ce}),Pe({id:X.PredictLinear,params:[he(),{name:"Seconds from now",type:"number"}],defaultParams:["$__interval",60],alternativesKey:"range function",category:W.RangeFunctions,renderer:se,addOperationHandler:De,changeTypeHandler:Ce}),Pe({id:X.QuantileOverTime,params:[he(),{name:"Quantile",type:"number"}],defaultParams:["$__interval",.5],alternativesKey:"overtime function",category:W.RangeFunctions,renderer:le,addOperationHandler:De,changeTypeHandler:Ce}),...we,{id:X.NestedQuery,name:"Binary operation with query",params:[],defaultParams:[],category:W.BinaryOps,renderer:(e,t,r)=>r,addOperationHandler:Ae},Pe({id:X.Absent}),Pe({id:X.Acos,category:W.Trigonometric}),Pe({id:X.Acosh,category:W.Trigonometric}),Pe({id:X.Asin,category:W.Trigonometric}),Pe({id:X.Asinh,category:W.Trigonometric}),Pe({id:X.Atan,category:W.Trigonometric}),Pe({id:X.Atanh,category:W.Trigonometric}),Pe({id:X.Ceil}),Pe({id:X.Clamp,name:"Clamp",params:[{name:"Minimum Scalar",type:"number"},{name:"Maximum Scalar",type:"number"}],defaultParams:[1,1]}),Pe({id:X.ClampMax,params:[{name:"Maximum Scalar",type:"number"}],defaultParams:[1]}),Pe({id:X.ClampMin,params:[{name:"Minimum Scalar",type:"number"}],defaultParams:[1]}),Pe({id:X.Cos,category:W.Trigonometric}),Pe({id:X.Cosh,category:W.Trigonometric}),Pe({id:X.DayOfMonth,category:W.Time}),Pe({id:X.DayOfWeek,category:W.Time}),Pe({id:X.DaysInMonth,category:W.Time}),Pe({id:X.Deg}),Te(X.Deriv),Pe({id:X.Exp}),Pe({id:X.Floor}),Pe({id:X.Group}),Pe({id:X.Hour}),Pe({id:X.LabelJoin,params:[{name:"Destination Label",type:"string",editor:Z},{name:"Separator",type:"string"},{name:"Source Label",type:"string",restParam:!0,optional:!0,editor:Z}],defaultParams:["",",",""],renderer:Re,addOperationHandler:je}),Pe({id:X.Log10}),Pe({id:X.Log2}),Pe({id:X.Minute}),Pe({id:X.Month}),Pe({id:X.Pi,renderer:e=>`${e.id}()`}),Pe({id:X.Quantile,params:[{name:"Value",type:"number"}],defaultParams:[1],renderer:ie}),Pe({id:X.Rad}),Te(X.Resets),Pe({id:X.Round,category:W.Functions,params:[{name:"To Nearest",type:"number"}],defaultParams:[1]}),Pe({id:X.Scalar}),Pe({id:X.Sgn}),Pe({id:X.Sin,category:W.Trigonometric}),Pe({id:X.Sinh,category:W.Trigonometric}),Pe({id:X.Sort}),Pe({id:X.SortDesc}),Pe({id:X.Sqrt}),Pe({id:X.Stddev}),Pe({id:X.Tan,category:W.Trigonometric}),Pe({id:X.Tanh,category:W.Trigonometric}),Pe({id:X.Time,renderer:e=>`${e.id}()`}),Pe({id:X.Timestamp}),Pe({id:X.Vector,params:[{name:"Value",type:"number"}],defaultParams:[1],renderer:e=>`${e.id}(${e.params[0]})`}),Pe({id:X.Year}),...fe(X.Sum),...fe(X.Avg),...fe(X.Min),...fe(X.Max),...fe(X.Count),...me(X.TopK,{params:[{name:"K-value",type:"number"}],defaultParams:[5]}),...me(X.BottomK,{params:[{name:"K-value",type:"number"}],defaultParams:[5]}),...me(X.CountValues,{params:[{name:"Identifier",type:"string"}],defaultParams:["count"]}),Ne(X.SumOverTime),Ne(X.AvgOverTime),Ne(X.MinOverTime),Ne(X.MaxOverTime),Ne(X.CountOverTime),Ne(X.LastOverTime),Ne(X.PresentOverTime),Ne(X.AbsentOverTime),Ne(X.StddevOverTime)];for(const t of e){const e=z.find((e=>e.insertText===t.id));e&&(t.documentation=e.documentation)}return e})),this.setOperationCategories([W.Aggregations,W.RangeFunctions,W.Functions,W.BinaryOps,W.Trigonometric,W.Time])}}const $e=new qe,Me=1024;let Be=0;class Fe{constructor(e,t){this.from=e,this.to=t}}class Qe{constructor(e={}){this.id=Be++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return"function"!=typeof e&&(e=Ve.match(e)),t=>{let r=e(t);return void 0===r?null:[this,r]}}}Qe.closedBy=new Qe({deserialize:e=>e.split(" ")}),Qe.openedBy=new Qe({deserialize:e=>e.split(" ")}),Qe.group=new Qe({deserialize:e=>e.split(" ")}),Qe.contextHash=new Qe({perNode:!0}),Qe.lookAhead=new Qe({perNode:!0}),Qe.mounted=new Qe({perNode:!0});const ze=Object.create(null);class Ve{constructor(e,t,r,n=0){this.name=e,this.props=t,this.id=r,this.flags=n}static define(e){let t=e.props&&e.props.length?Object.create(null):ze,r=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(null==e.name?8:0),n=new Ve(e.name||"",t,e.id,r);if(e.props)for(let r of e.props)if(Array.isArray(r)||(r=r(n)),r){if(r[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[r[0].id]=r[1]}return n}prop(e){return this.props[e.id]}get isTop(){return(1&this.flags)>0}get isSkipped(){return(2&this.flags)>0}get isError(){return(4&this.flags)>0}get isAnonymous(){return(8&this.flags)>0}is(e){if("string"==typeof e){if(this.name==e)return!0;let t=this.prop(Qe.group);return!!t&&t.indexOf(e)>-1}return this.id==e}static match(e){let t=Object.create(null);for(let r in e)for(let n of r.split(" "))t[n]=e[r];return e=>{for(let r=e.prop(Qe.group),n=-1;n<(r?r.length:0);n++){let i=t[n<0?e.name:r[n]];if(i)return i}}}}Ve.none=new Ve("",Object.create(null),0,8);class Ue{constructor(e){this.types=e;for(let t=0;t<e.length;t++)if(e[t].id!=t)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let t=[];for(let r of this.types){let n=null;for(let t of e){let e=t(r);e&&(n||(n=Object.assign({},r.props)),n[e[0].id]=e[1])}t.push(n?new Ve(r.name,n,r.id,r.flags):r)}return new Ue(t)}}const We=new WeakMap,Xe=new WeakMap;var Ge;!function(e){e[e.ExcludeBuffers=1]="ExcludeBuffers",e[e.IncludeAnonymous=2]="IncludeAnonymous",e[e.IgnoreMounts=4]="IgnoreMounts",e[e.IgnoreOverlays=8]="IgnoreOverlays"}(Ge||(Ge={}));class He{constructor(e,t,r,n,i){if(this.type=e,this.children=t,this.positions=r,this.length=n,this.props=null,i&&i.length){this.props=Object.create(null);for(let[e,t]of i)this.props["number"==typeof e?e:e.id]=t}}toString(){let e=this.prop(Qe.mounted);if(e&&!e.overlay)return e.tree.toString();let t="";for(let e of this.children){let r=e.toString();r&&(t&&(t+=","),t+=r)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new ot(this.topNode,e)}cursorAt(e,t=0,r=0){let n=We.get(this)||this.topNode,i=new ot(n);return i.moveTo(e,t),We.set(this,i._tree),i}get topNode(){return new tt(this,0,0,null)}resolve(e,t=0){let r=et(We.get(this)||this.topNode,e,t,!1);return We.set(this,r),r}resolveInner(e,t=0){let r=et(Xe.get(this)||this.topNode,e,t,!0);return Xe.set(this,r),r}iterate(e){let{enter:t,leave:r,from:n=0,to:i=this.length}=e;for(let a=this.cursor((e.mode||0)|Ge.IncludeAnonymous);;){let e=!1;if(a.from<=i&&a.to>=n&&(a.type.isAnonymous||!1!==t(a))){if(a.firstChild())continue;e=!0}for(;e&&r&&!a.type.isAnonymous&&r(a),!a.nextSibling();){if(!a.parent())return;e=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:ut(Ve.none,this.children,this.positions,0,this.children.length,0,this.length,((e,t,r)=>new He(this.type,e,t,r,this.propValues)),e.makeTree||((e,t,r)=>new He(Ve.none,e,t,r)))}static build(e){return function(e){var t;let{buffer:r,nodeSet:n,maxBufferLength:i=Me,reused:a=[],minRepeatType:o=n.types.length}=e,s=Array.isArray(r)?new Ye(r,r.length):r,l=n.types,c=0,u=0;function d(e,t,r,m,g){let{id:b,start:v,end:y,size:O}=s,x=u;for(;O<0;){if(s.next(),-1==O){let t=a[b];return r.push(t),void m.push(v-e)}if(-3==O)return void(c=b);if(-4==O)return void(u=b);throw new RangeError(`Unrecognized record size: ${O}`)}let w,_,S=l[b],E=v-e;if(y-v<=i&&(_=function(e,t){let r=s.fork(),n=0,a=0,l=0,c=r.end-i,u={size:0,start:0,skip:0};e:for(let i=r.pos-e;r.pos>i;){let e=r.size;if(r.id==t&&e>=0){u.size=n,u.start=a,u.skip=l,l+=4,n+=4,r.next();continue}let s=r.pos-e;if(e<0||s<i||r.start<c)break;let d=r.id>=o?4:0,p=r.start;for(r.next();r.pos>s;){if(r.size<0){if(-3!=r.size)break e;d+=4}else r.id>=o&&(d+=4);r.next()}a=p,n+=e,l+=d}return(t<0||n==e)&&(u.size=n,u.start=a,u.skip=l),u.size>4?u:void 0}(s.pos-t,g))){let t=new Uint16Array(_.size-_.skip),r=s.pos-_.size,i=t.length;for(;s.pos>r;)i=f(_.start,t,i);w=new Ke(t,y-_.start,n),E=_.start-e}else{let e=s.pos-O;s.next();let t=[],r=[],n=b>=o?b:-1,a=0,l=y;for(;s.pos>e;)n>=0&&s.id==n&&s.size>=0?(s.end<=l-i&&(p(t,r,v,a,s.end,l,n,x),a=t.length,l=s.end),s.next()):d(v,e,t,r,n);if(n>=0&&a>0&&a<t.length&&p(t,r,v,a,v,l,n,x),t.reverse(),r.reverse(),n>-1&&a>0){let e=function(e){return(t,r,n)=>{let i,a,o=0,s=t.length-1;if(s>=0&&(i=t[s])instanceof He){if(!s&&i.type==e&&i.length==n)return i;(a=i.prop(Qe.lookAhead))&&(o=r[s]+i.length+a)}return h(e,t,r,n,o)}}(S);w=ut(S,t,r,0,t.length,0,y-v,e,e)}else w=h(S,t,r,y-v,x-y)}r.push(w),m.push(E)}function p(e,t,r,i,a,o,s,l){let c=[],u=[];for(;e.length>i;)c.push(e.pop()),u.push(t.pop()+r-a);e.push(h(n.types[s],c,u,o-a,l-o)),t.push(a-r)}function h(e,t,r,n,i=0,a){if(c){let e=[Qe.contextHash,c];a=a?[e].concat(a):[e]}if(i>25){let e=[Qe.lookAhead,i];a=a?[e].concat(a):[e]}return new He(e,t,r,n,a)}function f(e,t,r){let{id:n,start:i,end:a,size:l}=s;if(s.next(),l>=0&&n<o){let o=r;if(l>4){let n=s.pos-(l-4);for(;s.pos>n;)r=f(e,t,r)}t[--r]=o,t[--r]=a-e,t[--r]=i-e,t[--r]=n}else-3==l?c=n:-4==l&&(u=n);return r}let m=[],g=[];for(;s.pos>0;)d(e.start||0,e.bufferStart||0,m,g,-1);let b=null!==(t=e.length)&&void 0!==t?t:m.length?g[0]+m[0].length:0;return new He(l[e.topID],m.reverse(),g.reverse(),b)}(e)}}He.empty=new He(Ve.none,[],[],0);class Ye{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new Ye(this.buffer,this.index)}}class Ke{constructor(e,t,r){this.buffer=e,this.length=t,this.set=r}get type(){return Ve.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],r=this.buffer[e+3],n=this.set.types[t],i=n.name;if(/\W/.test(i)&&!n.isError&&(i=JSON.stringify(i)),r==(e+=4))return i;let a=[];for(;e<r;)a.push(this.childString(e)),e=this.buffer[e+3];return i+"("+a.join(",")+")"}findChild(e,t,r,n,i){let{buffer:a}=this,o=-1;for(let s=e;s!=t&&!(Je(i,n,a[s+1],a[s+2])&&(o=s,r>0));s=a[s+3]);return o}slice(e,t,r,n){let i=this.buffer,a=new Uint16Array(t-e);for(let n=e,o=0;n<t;)a[o++]=i[n++],a[o++]=i[n++]-r,a[o++]=i[n++]-r,a[o++]=i[n++]-e;return new Ke(a,n-r,this.set)}}function Je(e,t,r,n){switch(e){case-2:return r<t;case-1:return n>=t&&r<t;case 0:return r<t&&n>t;case 1:return r<=t&&n>t;case 2:return n>t;case 4:return!0}}function Ze(e,t){let r=e.childBefore(t);for(;r;){let t=r.lastChild;if(!t||t.to!=r.to)break;t.type.isError&&t.from==t.to?(e=r,r=t.prevSibling):r=t}return e}function et(e,t,r,n){for(var i;e.from==e.to||(r<1?e.from>=t:e.from>t)||(r>-1?e.to<=t:e.to<t);){let t=!n&&e instanceof tt&&e.index<0?null:e.parent;if(!t)return e;e=t}let a=n?0:Ge.IgnoreOverlays;if(n)for(let n=e,o=n.parent;o;n=o,o=n.parent)n instanceof tt&&n.index<0&&(null===(i=o.enter(t,r,a))||void 0===i?void 0:i.from)!=n.from&&(e=o);for(;;){let n=e.enter(t,r,a);if(!n)return e;e=n}}class tt{constructor(e,t,r,n){this._tree=e,this.from=t,this.index=r,this._parent=n}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,r,n,i=0){for(let a=this;;){for(let{children:o,positions:s}=a._tree,l=t>0?o.length:-1;e!=l;e+=t){let l=o[e],c=s[e]+a.from;if(Je(n,r,c,c+l.length))if(l instanceof Ke){if(i&Ge.ExcludeBuffers)continue;let o=l.findChild(0,l.buffer.length,t,r-c,n);if(o>-1)return new at(new it(a,l,e,c),null,o)}else if(i&Ge.IncludeAnonymous||!l.type.isAnonymous||st(l)){let o;if(!(i&Ge.IgnoreMounts)&&l.props&&(o=l.prop(Qe.mounted))&&!o.overlay)return new tt(o.tree,c,e,a);let s=new tt(l,c,e,a);return i&Ge.IncludeAnonymous||!s.type.isAnonymous?s:s.nextChild(t<0?l.children.length-1:0,t,r,n)}}if(i&Ge.IncludeAnonymous||!a.type.isAnonymous)return null;if(e=a.index>=0?a.index+t:t<0?-1:a._parent._tree.children.length,a=a._parent,!a)return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,r=0){let n;if(!(r&Ge.IgnoreOverlays)&&(n=this._tree.prop(Qe.mounted))&&n.overlay){let r=e-this.from;for(let{from:e,to:i}of n.overlay)if((t>0?e<=r:e<r)&&(t<0?i>=r:i>r))return new tt(n.tree,n.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,r)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}cursor(e=0){return new ot(this,e)}get tree(){return this._tree}toTree(){return this._tree}resolve(e,t=0){return et(this,e,t,!1)}resolveInner(e,t=0){return et(this,e,t,!0)}enterUnfinishedNodesBefore(e){return Ze(this,e)}getChild(e,t=null,r=null){let n=rt(this,e,t,r);return n.length?n[0]:null}getChildren(e,t=null,r=null){return rt(this,e,t,r)}toString(){return this._tree.toString()}get node(){return this}matchContext(e){return nt(this,e)}}function rt(e,t,r,n){let i=e.cursor(),a=[];if(!i.firstChild())return a;if(null!=r)for(;!i.type.is(r);)if(!i.nextSibling())return a;for(;;){if(null!=n&&i.type.is(n))return a;if(i.type.is(t)&&a.push(i.node),!i.nextSibling())return null==n?a:[]}}function nt(e,t,r=t.length-1){for(let n=e.parent;r>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(t[r]&&t[r]!=n.name)return!1;r--}}return!0}class it{constructor(e,t,r,n){this.parent=e,this.buffer=t,this.index=r,this.start=n}}class at{constructor(e,t,r){this.context=e,this._parent=t,this.index=r,this.type=e.buffer.set.types[e.buffer.buffer[r]]}get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}child(e,t,r){let{buffer:n}=this.context,i=n.findChild(this.index+4,n.buffer[this.index+3],e,t-this.context.start,r);return i<0?null:new at(this.context,this,i)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,r=0){if(r&Ge.ExcludeBuffers)return null;let{buffer:n}=this.context,i=n.findChild(this.index+4,n.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return i<0?null:new at(this.context,this,i)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new at(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new at(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}cursor(e=0){return new ot(this,e)}get tree(){return null}toTree(){let e=[],t=[],{buffer:r}=this.context,n=this.index+4,i=r.buffer[this.index+3];if(i>n){let a=r.buffer[this.index+1],o=r.buffer[this.index+2];e.push(r.slice(n,i,a,o)),t.push(0)}return new He(this.type,e,t,this.to-this.from)}resolve(e,t=0){return et(this,e,t,!1)}resolveInner(e,t=0){return et(this,e,t,!0)}enterUnfinishedNodesBefore(e){return Ze(this,e)}toString(){return this.context.buffer.childString(this.index)}getChild(e,t=null,r=null){let n=rt(this,e,t,r);return n.length?n[0]:null}getChildren(e,t=null,r=null){return rt(this,e,t,r)}get node(){return this}matchContext(e){return nt(this,e)}}class ot{constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof tt)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let t=e._parent;t;t=t._parent)this.stack.unshift(t.index);this.bufferNode=e,this.yieldBuf(e.index)}}get name(){return this.type.name}yieldNode(e){return!!e&&(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0)}yieldBuf(e,t){this.index=e;let{start:r,buffer:n}=this.buffer;return this.type=t||n.set.types[n.buffer[e]],this.from=r+n.buffer[e+1],this.to=r+n.buffer[e+2],!0}yield(e){return!!e&&(e instanceof tt?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)))}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,r){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,r,this.mode));let{buffer:n}=this.buffer,i=n.findChild(this.index+4,n.buffer[this.index+3],e,t-this.buffer.start,r);return!(i<0)&&(this.stack.push(this.index),this.yieldBuf(i))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,r=this.mode){return this.buffer?!(r&Ge.ExcludeBuffers)&&this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,r))}parent(){if(!this.buffer)return this.yieldNode(this.mode&Ge.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&Ge.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return!!this._tree._parent&&this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode));let{buffer:t}=this.buffer,r=this.stack.length-1;if(e<0){let e=r<0?0:this.stack[r]+4;if(this.index!=e)return this.yieldBuf(t.findChild(e,this.index,-1,0,4))}else{let e=t.buffer[this.index+3];if(e<(r<0?t.buffer.length:t.buffer[this.stack[r]+3]))return this.yieldBuf(e)}return r<0&&this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode))}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,r,{buffer:n}=this;if(n){if(e>0){if(this.index<n.buffer.buffer.length)return!1}else for(let e=0;e<this.index;e++)if(n.buffer.buffer[e+3]<this.index)return!1;({index:t,parent:r}=n)}else({index:t,_parent:r}=this._tree);for(;r;({index:t,_parent:r}=r))if(t>-1)for(let n=t+e,i=e<0?-1:r._tree.children.length;n!=i;n+=e){let e=r._tree.children[n];if(this.mode&Ge.IncludeAnonymous||e instanceof Ke||!e.type.isAnonymous||st(e))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,r=0;if(e&&e.context==this.buffer)e:for(let n=this.index,i=this.stack.length;i>=0;){for(let a=e;a;a=a._parent)if(a.index==n){if(n==this.index)return a;t=a,r=i+1;break e}n=this.stack[--i]}for(let e=r;e<this.stack.length;e++)t=new at(this.buffer,t,this.stack[e]);return this.bufferNode=new at(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let r=0;;){let n=!1;if(this.type.isAnonymous||!1!==e(this)){if(this.firstChild()){r++;continue}this.type.isAnonymous||(n=!0)}for(;n&&t&&t(this),n=this.type.isAnonymous,!this.nextSibling();){if(!r)return;this.parent(),r--,n=!0}}}matchContext(e){if(!this.buffer)return nt(this.node,e);let{buffer:t}=this.buffer,{types:r}=t.set;for(let n=e.length-1,i=this.stack.length-1;n>=0;i--){if(i<0)return nt(this.node,e,n);let a=r[t.buffer[this.stack[i]]];if(!a.isAnonymous){if(e[n]&&e[n]!=a.name)return!1;n--}}return!0}}function st(e){return e.children.some((e=>e instanceof Ke||!e.type.isAnonymous||st(e)))}const lt=new WeakMap;function ct(e,t){if(!e.isAnonymous||t instanceof Ke||t.type!=e)return 1;let r=lt.get(t);if(null==r){r=1;for(let n of t.children){if(n.type!=e||!(n instanceof He)){r=1;break}r+=ct(e,n)}lt.set(t,r)}return r}function ut(e,t,r,n,i,a,o,s,l){let c=0;for(let r=n;r<i;r++)c+=ct(e,t[r]);let u=Math.ceil(1.5*c/8),d=[],p=[];return function t(r,n,i,o,s){for(let c=i;c<o;){let i=c,h=n[c],f=ct(e,r[c]);for(c++;c<o;c++){let t=ct(e,r[c]);if(f+t>=u)break;f+=t}if(c==i+1){if(f>u){let e=r[i];t(e.children,e.positions,0,e.children.length,n[i]+s);continue}d.push(r[i])}else{let t=n[c-1]+r[c-1].length-h;d.push(ut(e,r,n,i,c,h,t,null,l))}p.push(h+s-a)}}(t,r,n,i,0),(s||l)(d,p,o)}class dt{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}}new Qe({perNode:!0});class pt{constructor(e,t,r,n,i,a,o,s,l,c=0,u){this.p=e,this.stack=t,this.state=r,this.reducePos=n,this.pos=i,this.score=a,this.buffer=o,this.bufferBase=s,this.curContext=l,this.lookAhead=c,this.parent=u}toString(){return`[${this.stack.filter(((e,t)=>t%3==0)).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(e,t,r=0){let n=e.parser.context;return new pt(e,[],t,r,r,0,[],0,n?new ht(n,n.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(e,t){this.stack.push(this.state,t,this.bufferBase+this.buffer.length),this.state=e}reduce(e){let t=e>>19,r=65535&e,{parser:n}=this.p,i=n.dynamicPrecedence(r);if(i&&(this.score+=i),0==t)return this.pushState(n.getGoto(this.state,r,!0),this.reducePos),r<n.minRepeatTerm&&this.storeNode(r,this.reducePos,this.reducePos,4,!0),void this.reduceContext(r,this.reducePos);let a=this.stack.length-3*(t-1)-(262144&e?6:0),o=this.stack[a-2],s=this.stack[a-1],l=this.bufferBase+this.buffer.length-s;if(r<n.minRepeatTerm||131072&e){let e=n.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(r,o,e,l+4,!0)}if(262144&e)this.state=this.stack[a];else{let e=this.stack[a-3];this.state=n.getGoto(e,r,!0)}for(;this.stack.length>a;)this.stack.pop();this.reduceContext(r,o)}storeNode(e,t,r,n=4,i=!1){if(0==e&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let e=this,n=this.buffer.length;if(0==n&&e.parent&&(n=e.bufferBase-e.parent.bufferBase,e=e.parent),n>0&&0==e.buffer[n-4]&&e.buffer[n-1]>-1){if(t==r)return;if(e.buffer[n-2]>=t)return void(e.buffer[n-2]=r)}}if(i&&this.pos!=r){let i=this.buffer.length;if(i>0&&0!=this.buffer[i-4])for(;i>0&&this.buffer[i-2]>r;)this.buffer[i]=this.buffer[i-4],this.buffer[i+1]=this.buffer[i-3],this.buffer[i+2]=this.buffer[i-2],this.buffer[i+3]=this.buffer[i-1],i-=4,n>4&&(n-=4);this.buffer[i]=e,this.buffer[i+1]=t,this.buffer[i+2]=r,this.buffer[i+3]=n}else this.buffer.push(e,t,r,n)}shift(e,t,r){let n=this.pos;if(131072&e)this.pushState(65535&e,this.pos);else if(0==(262144&e)){let i=e,{parser:a}=this.p;(r>this.pos||t<=a.maxNode)&&(this.pos=r,a.stateFlag(i,1)||(this.reducePos=r)),this.pushState(i,n),this.shiftContext(t,n),t<=a.maxNode&&this.buffer.push(t,n,r,4)}else this.pos=r,this.shiftContext(t,n),t<=this.p.parser.maxNode&&this.buffer.push(t,n,r,4)}apply(e,t,r){65536&e?this.reduce(e):this.shift(e,t,r)}useNode(e,t){let r=this.p.reused.length-1;(r<0||this.p.reused[r]!=e)&&(this.p.reused.push(e),r++);let n=this.pos;this.reducePos=this.pos=n+e.length,this.pushState(t,n),this.buffer.push(r,n,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,e,this,this.p.stream.reset(this.pos-e.length)))}split(){let e=this,t=e.buffer.length;for(;t>0&&e.buffer[t-2]>e.reducePos;)t-=4;let r=e.buffer.slice(t),n=e.bufferBase+t;for(;e&&n==e.bufferBase;)e=e.parent;return new pt(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,r,n,this.curContext,this.lookAhead,e)}recoverByDelete(e,t){let r=e<=this.p.parser.maxNode;r&&this.storeNode(e,this.pos,t,4),this.storeNode(0,this.pos,t,r?8:4),this.pos=this.reducePos=t,this.score-=190}canShift(e){for(let t=new mt(this);;){let r=this.p.parser.stateSlot(t.state,4)||this.p.parser.hasAction(t.state,e);if(0==(65536&r))return!0;if(0==r)return!1;t.reduce(r)}}recoverByInsert(e){if(this.stack.length>=300)return[];let t=this.p.parser.nextStates(this.state);if(t.length>8||this.stack.length>=120){let r=[];for(let n,i=0;i<t.length;i+=2)(n=t[i+1])!=this.state&&this.p.parser.hasAction(n,e)&&r.push(t[i],n);if(this.stack.length<120)for(let e=0;r.length<8&&e<t.length;e+=2){let n=t[e+1];r.some(((e,t)=>1&t&&e==n))||r.push(t[e],n)}t=r}let r=[];for(let e=0;e<t.length&&r.length<4;e+=2){let n=t[e+1];if(n==this.state)continue;let i=this.split();i.pushState(n,this.pos),i.storeNode(0,i.pos,i.pos,4,!0),i.shiftContext(t[e],this.pos),i.score-=200,r.push(i)}return r}forceReduce(){let e=this.p.parser.stateSlot(this.state,5);if(0==(65536&e))return!1;let{parser:t}=this.p;if(!t.validAction(this.state,e)){let r=e>>19,n=65535&e,i=this.stack.length-3*r;if(i<0||t.getGoto(this.stack[i],n,!1)<0)return!1;this.storeNode(0,this.reducePos,this.reducePos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(e),!0}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(3!=this.stack.length)return!1;let{parser:e}=this.p;return 65535==e.data[e.stateSlot(this.state,1)]&&!e.stateSlot(this.state,4)}restart(){this.state=this.stack[0],this.stack.length=0}sameState(e){if(this.state!=e.state||this.stack.length!=e.stack.length)return!1;for(let t=0;t<this.stack.length;t+=3)if(this.stack[t]!=e.stack[t])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(e){return this.p.parser.dialect.flags[e]}shiftContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,e,this,this.p.stream.reset(t)))}reduceContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,e,this,this.p.stream.reset(t)))}emitContext(){let e=this.buffer.length-1;(e<0||-3!=this.buffer[e])&&this.buffer.push(this.curContext.hash,this.reducePos,this.reducePos,-3)}emitLookAhead(){let e=this.buffer.length-1;(e<0||-4!=this.buffer[e])&&this.buffer.push(this.lookAhead,this.reducePos,this.reducePos,-4)}updateContext(e){if(e!=this.curContext.context){let t=new ht(this.curContext.tracker,e);t.hash!=this.curContext.hash&&this.emitContext(),this.curContext=t}}setLookAhead(e){e>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=e)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class ht{constructor(e,t){this.tracker=e,this.context=t,this.hash=e.strict?e.hash(t):0}}var ft;!function(e){e[e.Insert=200]="Insert",e[e.Delete=190]="Delete",e[e.Reduce=100]="Reduce",e[e.MaxNext=4]="MaxNext",e[e.MaxInsertStackDepth=300]="MaxInsertStackDepth",e[e.DampenInsertStackDepth=120]="DampenInsertStackDepth"}(ft||(ft={}));class mt{constructor(e){this.start=e,this.state=e.state,this.stack=e.stack,this.base=this.stack.length}reduce(e){let t=65535&e,r=e>>19;0==r?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=3*(r-1);let n=this.start.p.parser.getGoto(this.stack[this.base-3],t,!0);this.state=n}}class gt{constructor(e,t,r){this.stack=e,this.pos=t,this.index=r,this.buffer=e.buffer,0==this.index&&this.maybeNext()}static create(e,t=e.bufferBase+e.buffer.length){return new gt(e,t,t-e.bufferBase)}maybeNext(){let e=this.stack.parent;null!=e&&(this.index=this.stack.bufferBase-e.bufferBase,this.stack=e,this.buffer=e.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,0==this.index&&this.maybeNext()}fork(){return new gt(this.stack,this.pos,this.index)}}class bt{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const vt=new bt;class yt{constructor(e,t){this.input=e,this.ranges=t,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=vt,this.rangeIndex=0,this.pos=this.chunkPos=t[0].from,this.range=t[0],this.end=t[t.length-1].to,this.readNext()}resolveOffset(e,t){let r=this.range,n=this.rangeIndex,i=this.pos+e;for(;i<r.from;){if(!n)return null;let e=this.ranges[--n];i-=r.from-e.to,r=e}for(;t<0?i>r.to:i>=r.to;){if(n==this.ranges.length-1)return null;let e=this.ranges[++n];i+=e.from-r.to,r=e}return i}peek(e){let t,r,n=this.chunkOff+e;if(n>=0&&n<this.chunk.length)t=this.pos+e,r=this.chunk.charCodeAt(n);else{let n=this.resolveOffset(e,1);if(null==n)return-1;if(t=n,t>=this.chunk2Pos&&t<this.chunk2Pos+this.chunk2.length)r=this.chunk2.charCodeAt(t-this.chunk2Pos);else{let e=this.rangeIndex,n=this.range;for(;n.to<=t;)n=this.ranges[++e];this.chunk2=this.input.chunk(this.chunk2Pos=t),t+this.chunk2.length>n.to&&(this.chunk2=this.chunk2.slice(0,n.to-t)),r=this.chunk2.charCodeAt(0)}}return t>=this.token.lookAhead&&(this.token.lookAhead=t+1),r}acceptToken(e,t=0){let r=t?this.resolveOffset(t,-1):this.pos;if(null==r||r<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=e,this.token.end=r}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:e,chunkPos:t}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=e,this.chunk2Pos=t,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let e=this.input.chunk(this.pos),t=this.pos+e.length;this.chunk=t>this.range.to?e.slice(0,this.range.to-this.pos):e,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(e=1){for(this.chunkOff+=e;this.pos+e>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();e-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=e,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(e,t){if(t?(this.token=t,t.start=e,t.lookAhead=e+1,t.value=t.extended=-1):this.token=vt,this.pos!=e){if(this.pos=e,e==this.end)return this.setDone(),this;for(;e<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;e>=this.range.to;)this.range=this.ranges[++this.rangeIndex];e>=this.chunkPos&&e<this.chunkPos+this.chunk.length?this.chunkOff=e-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(e,t){if(e>=this.chunkPos&&t<=this.chunkPos+this.chunk.length)return this.chunk.slice(e-this.chunkPos,t-this.chunkPos);if(e>=this.chunk2Pos&&t<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(e-this.chunk2Pos,t-this.chunk2Pos);if(e>=this.range.from&&t<=this.range.to)return this.input.read(e,t);let r="";for(let n of this.ranges){if(n.from>=t)break;n.to>e&&(r+=this.input.read(Math.max(n.from,e),Math.min(n.to,t)))}return r}}class Ot{constructor(e,t){this.data=e,this.id=t}token(e,t){!function(e,t,r,n){let i=0,a=1<<n,{parser:o}=r.p,{dialect:s}=o;e:for(;0!=(a&e[i]);){let r=e[i+1];for(let n=i+3;n<r;n+=2)if((e[n+1]&a)>0){let r=e[n];if(s.allows(r)&&(-1==t.token.value||t.token.value==r||o.overrides(r,t.token.value))){t.acceptToken(r);break}}for(let n=t.next,a=0,o=e[i+2];a<o;){let s=a+o>>1,l=r+s+(s<<1),c=e[l],u=e[l+1];if(n<c)o=s;else{if(!(n>=u)){i=e[l+2],t.advance();continue e}a=s+1}}break}}(this.data,e,t,this.id)}}function xt(e,t=Uint16Array){if("string"!=typeof e)return e;let r=null;for(let n=0,i=0;n<e.length;){let a=0;for(;;){let t=e.charCodeAt(n++),r=!1;if(126==t){a=65535;break}t>=92&&t--,t>=34&&t--;let i=t-32;if(i>=46&&(i-=46,r=!0),a+=i,r)break;a*=46}r?r[i++]=a:r=new t(a)}return r}Ot.prototype.contextual=Ot.prototype.fallback=Ot.prototype.extend=!1;const wt="undefined"!=typeof process&&process.env&&/\bparse\b/.test(process.env.LOG);let _t=null;var St,Et;function kt(e,t,r){let n=e.cursor(Ge.IncludeAnonymous);for(n.moveTo(t);;)if(!(r<0?n.childBefore(t):n.childAfter(t)))for(;;){if((r<0?n.to<t:n.from>t)&&!n.type.isError)return r<0?Math.max(0,Math.min(n.to-1,t-25)):Math.min(e.length,Math.max(n.from+1,t+25));if(r<0?n.prevSibling():n.nextSibling())break;if(!n.parent())return r<0?0:e.length}}!function(e){e[e.Margin=25]="Margin"}(St||(St={}));class Pt{constructor(e,t){this.fragments=e,this.nodeSet=t,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let e=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(e){for(this.safeFrom=e.openStart?kt(e.tree,e.from+e.offset,1)-e.offset:e.from,this.safeTo=e.openEnd?kt(e.tree,e.to+e.offset,-1)-e.offset:e.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(e.tree),this.start.push(-e.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(e){if(e<this.nextStart)return null;for(;this.fragment&&this.safeTo<=e;)this.nextFragment();if(!this.fragment)return null;for(;;){let t=this.trees.length-1;if(t<0)return this.nextFragment(),null;let r=this.trees[t],n=this.index[t];if(n==r.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let i=r.children[n],a=this.start[t]+r.positions[n];if(a>e)return this.nextStart=a,null;if(i instanceof He){if(a==e){if(a<this.safeFrom)return null;let e=a+i.length;if(e<=this.safeTo){let t=i.prop(Qe.lookAhead);if(!t||e+t<this.fragment.to)return i}}this.index[t]++,a+i.length>=Math.max(this.safeFrom,e)&&(this.trees.push(i),this.start.push(a),this.index.push(0))}else this.index[t]++,this.nextStart=a+i.length}}}class Tt{constructor(e,t){this.stream=t,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=e.tokenizers.map((e=>new bt))}getActions(e){let t=0,r=null,{parser:n}=e.p,{tokenizers:i}=n,a=n.stateSlot(e.state,3),o=e.curContext?e.curContext.hash:0,s=0;for(let n=0;n<i.length;n++){if(0==(1<<n&a))continue;let l=i[n],c=this.tokens[n];if((!r||l.fallback)&&((l.contextual||c.start!=e.pos||c.mask!=a||c.context!=o)&&(this.updateCachedToken(c,l,e),c.mask=a,c.context=o),c.lookAhead>c.end+25&&(s=Math.max(c.lookAhead,s)),0!=c.value)){let n=t;if(c.extended>-1&&(t=this.addActions(e,c.extended,c.end,t)),t=this.addActions(e,c.value,c.end,t),!l.extend&&(r=c,t>n))break}}for(;this.actions.length>t;)this.actions.pop();return s&&e.setLookAhead(s),r||e.pos!=this.stream.end||(r=new bt,r.value=e.p.parser.eofTerm,r.start=r.end=e.pos,t=this.addActions(e,r.value,r.end,t)),this.mainToken=r,this.actions}getMainToken(e){if(this.mainToken)return this.mainToken;let t=new bt,{pos:r,p:n}=e;return t.start=r,t.end=Math.min(r+1,n.stream.end),t.value=r==n.stream.end?n.parser.eofTerm:0,t}updateCachedToken(e,t,r){if(t.token(this.stream.reset(r.pos,e),r),e.value>-1){let{parser:t}=r.p;for(let n=0;n<t.specialized.length;n++)if(t.specialized[n]==e.value){let i=t.specializers[n](this.stream.read(e.start,e.end),r);if(i>=0&&r.p.parser.dialect.allows(i>>1)){0==(1&i)?e.value=i>>1:e.extended=i>>1;break}}}else e.value=0,e.end=Math.min(r.p.stream.end,r.pos+1)}putAction(e,t,r,n){for(let t=0;t<n;t+=3)if(this.actions[t]==e)return n;return this.actions[n++]=e,this.actions[n++]=t,this.actions[n++]=r,n}addActions(e,t,r,n){let{state:i}=e,{parser:a}=e.p,{data:o}=a;for(let e=0;e<2;e++)for(let s=a.stateSlot(i,e?2:1);;s+=3){if(65535==o[s]){if(1!=o[s+1]){0==n&&2==o[s+1]&&(n=this.putAction(Rt(o,s+2),t,r,n));break}s=Rt(o,s+2)}o[s]==t&&(n=this.putAction(Rt(o,s+1),t,r,n))}return n}}!function(e){e[e.Distance=5]="Distance",e[e.MaxRemainingPerStep=3]="MaxRemainingPerStep",e[e.MinBufferLengthPrune=500]="MinBufferLengthPrune",e[e.ForceReduceLimit=10]="ForceReduceLimit",e[e.CutDepth=15e3]="CutDepth",e[e.CutTo=9e3]="CutTo"}(Et||(Et={}));class Ct{constructor(e,t,r,n){this.parser=e,this.input=t,this.ranges=n,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.stream=new yt(t,n),this.tokens=new Tt(e,this.stream),this.topTerm=e.top[1];let{from:i}=n[0];this.stacks=[pt.start(this,e.top[0],i)],this.fragments=r.length&&this.stream.end-i>4*e.bufferLength?new Pt(r,e.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let e,t,r=this.stacks,n=this.minStackPos,i=this.stacks=[];for(let a=0;a<r.length;a++){let o=r[a];for(;;){if(this.tokens.mainToken=null,o.pos>n)i.push(o);else{if(this.advanceStack(o,i,r))continue;{e||(e=[],t=[]),e.push(o);let r=this.tokens.getMainToken(o);t.push(r.value,r.end)}}break}}if(!i.length){let t=e&&function(e){let t=null;for(let r of e){let e=r.p.stoppedAt;(r.pos==r.p.stream.end||null!=e&&r.pos>e)&&r.p.parser.stateFlag(r.state,2)&&(!t||t.score<r.score)&&(t=r)}return t}(e);if(t)return this.stackToTree(t);if(this.parser.strict)throw wt&&e&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+n);this.recovering||(this.recovering=5)}if(this.recovering&&e){let r=null!=this.stoppedAt&&e[0].pos>this.stoppedAt?e[0]:this.runRecovery(e,t,i);if(r)return this.stackToTree(r.forceAll())}if(this.recovering){let e=1==this.recovering?1:3*this.recovering;if(i.length>e)for(i.sort(((e,t)=>t.score-e.score));i.length>e;)i.pop();i.some((e=>e.reducePos>n))&&this.recovering--}else if(i.length>1)e:for(let e=0;e<i.length-1;e++){let t=i[e];for(let r=e+1;r<i.length;r++){let n=i[r];if(t.sameState(n)||t.buffer.length>500&&n.buffer.length>500){if(!((t.score-n.score||t.buffer.length-n.buffer.length)>0)){i.splice(e--,1);continue e}i.splice(r--,1)}}}this.minStackPos=i[0].pos;for(let e=1;e<i.length;e++)i[e].pos<this.minStackPos&&(this.minStackPos=i[e].pos);return null}stopAt(e){if(null!=this.stoppedAt&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}advanceStack(e,t,r){let n=e.pos,{parser:i}=this,a=wt?this.stackID(e)+" -> ":"";if(null!=this.stoppedAt&&n>this.stoppedAt)return e.forceReduce()?e:null;if(this.fragments){let t=e.curContext&&e.curContext.tracker.strict,r=t?e.curContext.hash:0;for(let o=this.fragments.nodeAt(n);o;){let n=this.parser.nodeSet.types[o.type.id]==o.type?i.getGoto(e.state,o.type.id):-1;if(n>-1&&o.length&&(!t||(o.prop(Qe.contextHash)||0)==r))return e.useNode(o,n),wt&&console.log(a+this.stackID(e)+` (via reuse of ${i.getName(o.type.id)})`),!0;if(!(o instanceof He)||0==o.children.length||o.positions[0]>0)break;let s=o.children[0];if(!(s instanceof He&&0==o.positions[0]))break;o=s}}let o=i.stateSlot(e.state,4);if(o>0)return e.reduce(o),wt&&console.log(a+this.stackID(e)+` (via always-reduce ${i.getName(65535&o)})`),!0;if(e.stack.length>=15e3)for(;e.stack.length>9e3&&e.forceReduce(););let s=this.tokens.getActions(e);for(let o=0;o<s.length;){let l=s[o++],c=s[o++],u=s[o++],d=o==s.length||!r,p=d?e:e.split();if(p.apply(l,c,u),wt&&console.log(a+this.stackID(p)+` (via ${0==(65536&l)?"shift":`reduce of ${i.getName(65535&l)}`} for ${i.getName(c)} @ ${n}${p==e?"":", split"})`),d)return!0;p.pos>n?t.push(p):r.push(p)}return!1}advanceFully(e,t){let r=e.pos;for(;;){if(!this.advanceStack(e,null,null))return!1;if(e.pos>r)return It(e,t),!0}}runRecovery(e,t,r){let n=null,i=!1;for(let a=0;a<e.length;a++){let o=e[a],s=t[a<<1],l=t[1+(a<<1)],c=wt?this.stackID(o)+" -> ":"";if(o.deadEnd){if(i)continue;if(i=!0,o.restart(),wt&&console.log(c+this.stackID(o)+" (restarted)"),this.advanceFully(o,r))continue}let u=o.split(),d=c;for(let e=0;u.forceReduce()&&e<10&&(wt&&console.log(d+this.stackID(u)+" (via force-reduce)"),!this.advanceFully(u,r));e++)wt&&(d=this.stackID(u)+" -> ");for(let e of o.recoverByInsert(s))wt&&console.log(c+this.stackID(e)+" (via recover-insert)"),this.advanceFully(e,r);this.stream.end>o.pos?(l==o.pos&&(l++,s=0),o.recoverByDelete(s,l),wt&&console.log(c+this.stackID(o)+` (via recover-delete ${this.parser.getName(s)})`),It(o,r)):(!n||n.score<o.score)&&(n=o)}return n}stackToTree(e){return e.close(),He.build({buffer:gt.create(e),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:e.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(e){let t=(_t||(_t=new WeakMap)).get(e);return t||_t.set(e,t=String.fromCodePoint(this.nextStackID++)),t+e}}function It(e,t){for(let r=0;r<t.length;r++){let n=t[r];if(n.pos==e.pos&&n.sameState(e))return void(t[r].score<e.score&&(t[r]=e))}t.push(e)}class Dt{constructor(e,t,r){this.source=e,this.flags=t,this.disabled=r}allows(e){return!this.disabled||0==this.disabled[e]}}class At extends class{startParse(e,t,r){return"string"==typeof e&&(e=new dt(e)),r=r?r.length?r.map((e=>new Fe(e.from,e.to))):[new Fe(0,0)]:[new Fe(0,e.length)],this.createParse(e,t||[],r)}parse(e,t,r){let n=this.startParse(e,t,r);for(;;){let e=n.advance();if(e)return e}}}{constructor(e){if(super(),this.wrappers=[],14!=e.version)throw new RangeError(`Parser version (${e.version}) doesn't match runtime version (14)`);let t=e.nodeNames.split(" ");this.minRepeatTerm=t.length;for(let r=0;r<e.repeatNodeCount;r++)t.push("");let r=Object.keys(e.topRules).map((t=>e.topRules[t][1])),n=[];for(let e=0;e<t.length;e++)n.push([]);function i(e,t,r){n[e].push([t,t.deserialize(String(r))])}if(e.nodeProps)for(let t of e.nodeProps){let e=t[0];"string"==typeof e&&(e=Qe[e]);for(let r=1;r<t.length;){let n=t[r++];if(n>=0)i(n,e,t[r++]);else{let a=t[r+-n];for(let o=-n;o>0;o--)i(t[r++],e,a);r++}}}this.nodeSet=new Ue(t.map(((t,i)=>Ve.define({name:i>=this.minRepeatTerm?void 0:t,id:i,props:n[i],top:r.indexOf(i)>-1,error:0==i,skipped:e.skippedNodes&&e.skippedNodes.indexOf(i)>-1})))),e.propSources&&(this.nodeSet=this.nodeSet.extend(...e.propSources)),this.strict=!1,this.bufferLength=Me;let a=xt(e.tokenData);if(this.context=e.context,this.specialized=new Uint16Array(e.specialized?e.specialized.length:0),this.specializers=[],e.specialized)for(let t=0;t<e.specialized.length;t++)this.specialized[t]=e.specialized[t].term,this.specializers[t]=e.specialized[t].get;this.states=xt(e.states,Uint32Array),this.data=xt(e.stateData),this.goto=xt(e.goto),this.maxTerm=e.maxTerm,this.tokenizers=e.tokenizers.map((e=>"number"==typeof e?new Ot(a,e):e)),this.topRules=e.topRules,this.dialects=e.dialects||{},this.dynamicPrecedences=e.dynamicPrecedences||null,this.tokenPrecTable=e.tokenPrec,this.termNames=e.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(e,t,r){let n=new Ct(this,e,t,r);for(let i of this.wrappers)n=i(n,e,t,r);return n}getGoto(e,t,r=!1){let n=this.goto;if(t>=n[0])return-1;for(let i=n[t+1];;){let t=n[i++],a=1&t,o=n[i++];if(a&&r)return o;for(let r=i+(t>>1);i<r;i++)if(n[i]==e)return o;if(a)return-1}}hasAction(e,t){let r=this.data;for(let n=0;n<2;n++)for(let i,a=this.stateSlot(e,n?2:1);;a+=3){if(65535==(i=r[a])){if(1!=r[a+1]){if(2==r[a+1])return Rt(r,a+2);break}i=r[a=Rt(r,a+2)]}if(i==t||0==i)return Rt(r,a+1)}return 0}stateSlot(e,t){return this.states[6*e+t]}stateFlag(e,t){return(this.stateSlot(e,0)&t)>0}validAction(e,t){if(t==this.stateSlot(e,4))return!0;for(let r=this.stateSlot(e,1);;r+=3){if(65535==this.data[r]){if(1!=this.data[r+1])return!1;r=Rt(this.data,r+2)}if(t==Rt(this.data,r+1))return!0}}nextStates(e){let t=[];for(let r=this.stateSlot(e,1);;r+=3){if(65535==this.data[r]){if(1!=this.data[r+1])break;r=Rt(this.data,r+2)}if(0==(1&this.data[r+2])){let e=this.data[r+1];t.some(((t,r)=>1&r&&t==e))||t.push(this.data[r],e)}}return t}overrides(e,t){let r=jt(this.data,this.tokenPrecTable,t);return r<0||jt(this.data,this.tokenPrecTable,e)<r}configure(e){let t=Object.assign(Object.create(At.prototype),this);if(e.props&&(t.nodeSet=this.nodeSet.extend(...e.props)),e.top){let r=this.topRules[e.top];if(!r)throw new RangeError(`Invalid top rule name ${e.top}`);t.top=r}return e.tokenizers&&(t.tokenizers=this.tokenizers.map((t=>{let r=e.tokenizers.find((e=>e.from==t));return r?r.to:t}))),e.contextTracker&&(t.context=e.contextTracker),e.dialect&&(t.dialect=this.parseDialect(e.dialect)),null!=e.strict&&(t.strict=e.strict),e.wrap&&(t.wrappers=t.wrappers.concat(e.wrap)),null!=e.bufferLength&&(t.bufferLength=e.bufferLength),t}hasWrappers(){return this.wrappers.length>0}getName(e){return this.termNames?this.termNames[e]:String(e<=this.maxNode&&this.nodeSet.types[e].name||e)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(e){let t=this.dynamicPrecedences;return null==t?0:t[e]||0}parseDialect(e){let t=Object.keys(this.dialects),r=t.map((()=>!1));if(e)for(let n of e.split(" ")){let e=t.indexOf(n);e>=0&&(r[e]=!0)}let n=null;for(let e=0;e<t.length;e++)if(!r[e])for(let r,i=this.dialects[t[e]];65535!=(r=this.data[i++]);)(n||(n=new Uint8Array(this.maxTerm+1)))[r]=1;return new Dt(e,r,n)}static deserialize(e){return new At(e)}}function Rt(e,t){return e[t]|e[t+1]<<16}function jt(e,t,r){for(let n,i=t;65535!=(n=e[i]);i++)if(n==r)return i-t;return-1}const Nt=1024;let Lt=0;class qt{constructor(e={}){this.id=Lt++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return"function"!=typeof e&&(e=Mt.match(e)),t=>{let r=e(t);return void 0===r?null:[this,r]}}}qt.closedBy=new qt({deserialize:e=>e.split(" ")}),qt.openedBy=new qt({deserialize:e=>e.split(" ")}),qt.group=new qt({deserialize:e=>e.split(" ")}),qt.contextHash=new qt({perNode:!0}),qt.lookAhead=new qt({perNode:!0}),qt.mounted=new qt({perNode:!0});const $t=Object.create(null);class Mt{constructor(e,t,r,n=0){this.name=e,this.props=t,this.id=r,this.flags=n}static define(e){let t=e.props&&e.props.length?Object.create(null):$t,r=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(null==e.name?8:0),n=new Mt(e.name||"",t,e.id,r);if(e.props)for(let r of e.props)if(Array.isArray(r)||(r=r(n)),r){if(r[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[r[0].id]=r[1]}return n}prop(e){return this.props[e.id]}get isTop(){return(1&this.flags)>0}get isSkipped(){return(2&this.flags)>0}get isError(){return(4&this.flags)>0}get isAnonymous(){return(8&this.flags)>0}is(e){if("string"==typeof e){if(this.name==e)return!0;let t=this.prop(qt.group);return!!t&&t.indexOf(e)>-1}return this.id==e}static match(e){let t=Object.create(null);for(let r in e)for(let n of r.split(" "))t[n]=e[r];return e=>{for(let r=e.prop(qt.group),n=-1;n<(r?r.length:0);n++){let i=t[n<0?e.name:r[n]];if(i)return i}}}}Mt.none=new Mt("",Object.create(null),0,8);const Bt=new WeakMap,Ft=new WeakMap;var Qt;!function(e){e[e.ExcludeBuffers=1]="ExcludeBuffers",e[e.IncludeAnonymous=2]="IncludeAnonymous",e[e.IgnoreMounts=4]="IgnoreMounts",e[e.IgnoreOverlays=8]="IgnoreOverlays"}(Qt||(Qt={}));class zt{constructor(e,t,r,n,i){if(this.type=e,this.children=t,this.positions=r,this.length=n,this.props=null,i&&i.length){this.props=Object.create(null);for(let[e,t]of i)this.props["number"==typeof e?e:e.id]=t}}toString(){let e=this.prop(qt.mounted);if(e&&!e.overlay)return e.tree.toString();let t="";for(let e of this.children){let r=e.toString();r&&(t&&(t+=","),t+=r)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new er(this.topNode,e)}cursorAt(e,t=0,r=0){let n=Bt.get(this)||this.topNode,i=new er(n);return i.moveTo(e,t),Bt.set(this,i._tree),i}get topNode(){return new Ht(this,0,0,null)}resolve(e,t=0){let r=Gt(Bt.get(this)||this.topNode,e,t,!1);return Bt.set(this,r),r}resolveInner(e,t=0){let r=Gt(Ft.get(this)||this.topNode,e,t,!0);return Ft.set(this,r),r}iterate(e){let{enter:t,leave:r,from:n=0,to:i=this.length}=e;for(let a=this.cursor((e.mode||0)|Qt.IncludeAnonymous);;){let e=!1;if(a.from<=i&&a.to>=n&&(a.type.isAnonymous||!1!==t(a))){if(a.firstChild())continue;e=!0}for(;e&&r&&!a.type.isAnonymous&&r(a),!a.nextSibling();){if(!a.parent())return;e=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:ir(Mt.none,this.children,this.positions,0,this.children.length,0,this.length,((e,t,r)=>new zt(this.type,e,t,r,this.propValues)),e.makeTree||((e,t,r)=>new zt(Mt.none,e,t,r)))}static build(e){return function(e){var t;let{buffer:r,nodeSet:n,maxBufferLength:i=Nt,reused:a=[],minRepeatType:o=n.types.length}=e,s=Array.isArray(r)?new Vt(r,r.length):r,l=n.types,c=0,u=0;function d(e,t,r,m,g){let{id:b,start:v,end:y,size:O}=s,x=u;for(;O<0;){if(s.next(),-1==O){let t=a[b];return r.push(t),void m.push(v-e)}if(-3==O)return void(c=b);if(-4==O)return void(u=b);throw new RangeError(`Unrecognized record size: ${O}`)}let w,_,S=l[b],E=v-e;if(y-v<=i&&(_=function(e,t){let r=s.fork(),n=0,a=0,l=0,c=r.end-i,u={size:0,start:0,skip:0};e:for(let i=r.pos-e;r.pos>i;){let e=r.size;if(r.id==t&&e>=0){u.size=n,u.start=a,u.skip=l,l+=4,n+=4,r.next();continue}let s=r.pos-e;if(e<0||s<i||r.start<c)break;let d=r.id>=o?4:0,p=r.start;for(r.next();r.pos>s;){if(r.size<0){if(-3!=r.size)break e;d+=4}else r.id>=o&&(d+=4);r.next()}a=p,n+=e,l+=d}return(t<0||n==e)&&(u.size=n,u.start=a,u.skip=l),u.size>4?u:void 0}(s.pos-t,g))){let t=new Uint16Array(_.size-_.skip),r=s.pos-_.size,i=t.length;for(;s.pos>r;)i=f(_.start,t,i);w=new Ut(t,y-_.start,n),E=_.start-e}else{let e=s.pos-O;s.next();let t=[],r=[],n=b>=o?b:-1,a=0,l=y;for(;s.pos>e;)n>=0&&s.id==n&&s.size>=0?(s.end<=l-i&&(p(t,r,v,a,s.end,l,n,x),a=t.length,l=s.end),s.next()):d(v,e,t,r,n);if(n>=0&&a>0&&a<t.length&&p(t,r,v,a,v,l,n,x),t.reverse(),r.reverse(),n>-1&&a>0){let e=function(e){return(t,r,n)=>{let i,a,o=0,s=t.length-1;if(s>=0&&(i=t[s])instanceof zt){if(!s&&i.type==e&&i.length==n)return i;(a=i.prop(qt.lookAhead))&&(o=r[s]+i.length+a)}return h(e,t,r,n,o)}}(S);w=ir(S,t,r,0,t.length,0,y-v,e,e)}else w=h(S,t,r,y-v,x-y)}r.push(w),m.push(E)}function p(e,t,r,i,a,o,s,l){let c=[],u=[];for(;e.length>i;)c.push(e.pop()),u.push(t.pop()+r-a);e.push(h(n.types[s],c,u,o-a,l-o)),t.push(a-r)}function h(e,t,r,n,i=0,a){if(c){let e=[qt.contextHash,c];a=a?[e].concat(a):[e]}if(i>25){let e=[qt.lookAhead,i];a=a?[e].concat(a):[e]}return new zt(e,t,r,n,a)}function f(e,t,r){let{id:n,start:i,end:a,size:l}=s;if(s.next(),l>=0&&n<o){let o=r;if(l>4){let n=s.pos-(l-4);for(;s.pos>n;)r=f(e,t,r)}t[--r]=o,t[--r]=a-e,t[--r]=i-e,t[--r]=n}else-3==l?c=n:-4==l&&(u=n);return r}let m=[],g=[];for(;s.pos>0;)d(e.start||0,e.bufferStart||0,m,g,-1);let b=null!==(t=e.length)&&void 0!==t?t:m.length?g[0]+m[0].length:0;return new zt(l[e.topID],m.reverse(),g.reverse(),b)}(e)}}zt.empty=new zt(Mt.none,[],[],0);class Vt{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new Vt(this.buffer,this.index)}}class Ut{constructor(e,t,r){this.buffer=e,this.length=t,this.set=r}get type(){return Mt.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],r=this.buffer[e+3],n=this.set.types[t],i=n.name;if(/\W/.test(i)&&!n.isError&&(i=JSON.stringify(i)),r==(e+=4))return i;let a=[];for(;e<r;)a.push(this.childString(e)),e=this.buffer[e+3];return i+"("+a.join(",")+")"}findChild(e,t,r,n,i){let{buffer:a}=this,o=-1;for(let s=e;s!=t&&!(Wt(i,n,a[s+1],a[s+2])&&(o=s,r>0));s=a[s+3]);return o}slice(e,t,r,n){let i=this.buffer,a=new Uint16Array(t-e);for(let n=e,o=0;n<t;)a[o++]=i[n++],a[o++]=i[n++]-r,a[o++]=i[n++]-r,a[o++]=i[n++]-e;return new Ut(a,n-r,this.set)}}function Wt(e,t,r,n){switch(e){case-2:return r<t;case-1:return n>=t&&r<t;case 0:return r<t&&n>t;case 1:return r<=t&&n>t;case 2:return n>t;case 4:return!0}}function Xt(e,t){let r=e.childBefore(t);for(;r;){let t=r.lastChild;if(!t||t.to!=r.to)break;t.type.isError&&t.from==t.to?(e=r,r=t.prevSibling):r=t}return e}function Gt(e,t,r,n){for(var i;e.from==e.to||(r<1?e.from>=t:e.from>t)||(r>-1?e.to<=t:e.to<t);){let t=!n&&e instanceof Ht&&e.index<0?null:e.parent;if(!t)return e;e=t}let a=n?0:Qt.IgnoreOverlays;if(n)for(let n=e,o=n.parent;o;n=o,o=n.parent)n instanceof Ht&&n.index<0&&(null===(i=o.enter(t,r,a))||void 0===i?void 0:i.from)!=n.from&&(e=o);for(;;){let n=e.enter(t,r,a);if(!n)return e;e=n}}class Ht{constructor(e,t,r,n){this._tree=e,this.from=t,this.index=r,this._parent=n}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,r,n,i=0){for(let a=this;;){for(let{children:o,positions:s}=a._tree,l=t>0?o.length:-1;e!=l;e+=t){let l=o[e],c=s[e]+a.from;if(Wt(n,r,c,c+l.length))if(l instanceof Ut){if(i&Qt.ExcludeBuffers)continue;let o=l.findChild(0,l.buffer.length,t,r-c,n);if(o>-1)return new Zt(new Jt(a,l,e,c),null,o)}else if(i&Qt.IncludeAnonymous||!l.type.isAnonymous||tr(l)){let o;if(!(i&Qt.IgnoreMounts)&&l.props&&(o=l.prop(qt.mounted))&&!o.overlay)return new Ht(o.tree,c,e,a);let s=new Ht(l,c,e,a);return i&Qt.IncludeAnonymous||!s.type.isAnonymous?s:s.nextChild(t<0?l.children.length-1:0,t,r,n)}}if(i&Qt.IncludeAnonymous||!a.type.isAnonymous)return null;if(e=a.index>=0?a.index+t:t<0?-1:a._parent._tree.children.length,a=a._parent,!a)return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,r=0){let n;if(!(r&Qt.IgnoreOverlays)&&(n=this._tree.prop(qt.mounted))&&n.overlay){let r=e-this.from;for(let{from:e,to:i}of n.overlay)if((t>0?e<=r:e<r)&&(t<0?i>=r:i>r))return new Ht(n.tree,n.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,r)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}cursor(e=0){return new er(this,e)}get tree(){return this._tree}toTree(){return this._tree}resolve(e,t=0){return Gt(this,e,t,!1)}resolveInner(e,t=0){return Gt(this,e,t,!0)}enterUnfinishedNodesBefore(e){return Xt(this,e)}getChild(e,t=null,r=null){let n=Yt(this,e,t,r);return n.length?n[0]:null}getChildren(e,t=null,r=null){return Yt(this,e,t,r)}toString(){return this._tree.toString()}get node(){return this}matchContext(e){return Kt(this,e)}}function Yt(e,t,r,n){let i=e.cursor(),a=[];if(!i.firstChild())return a;if(null!=r)for(;!i.type.is(r);)if(!i.nextSibling())return a;for(;;){if(null!=n&&i.type.is(n))return a;if(i.type.is(t)&&a.push(i.node),!i.nextSibling())return null==n?a:[]}}function Kt(e,t,r=t.length-1){for(let n=e.parent;r>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(t[r]&&t[r]!=n.name)return!1;r--}}return!0}class Jt{constructor(e,t,r,n){this.parent=e,this.buffer=t,this.index=r,this.start=n}}class Zt{constructor(e,t,r){this.context=e,this._parent=t,this.index=r,this.type=e.buffer.set.types[e.buffer.buffer[r]]}get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}child(e,t,r){let{buffer:n}=this.context,i=n.findChild(this.index+4,n.buffer[this.index+3],e,t-this.context.start,r);return i<0?null:new Zt(this.context,this,i)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,r=0){if(r&Qt.ExcludeBuffers)return null;let{buffer:n}=this.context,i=n.findChild(this.index+4,n.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return i<0?null:new Zt(this.context,this,i)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new Zt(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new Zt(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}cursor(e=0){return new er(this,e)}get tree(){return null}toTree(){let e=[],t=[],{buffer:r}=this.context,n=this.index+4,i=r.buffer[this.index+3];if(i>n){let a=r.buffer[this.index+1],o=r.buffer[this.index+2];e.push(r.slice(n,i,a,o)),t.push(0)}return new zt(this.type,e,t,this.to-this.from)}resolve(e,t=0){return Gt(this,e,t,!1)}resolveInner(e,t=0){return Gt(this,e,t,!0)}enterUnfinishedNodesBefore(e){return Xt(this,e)}toString(){return this.context.buffer.childString(this.index)}getChild(e,t=null,r=null){let n=Yt(this,e,t,r);return n.length?n[0]:null}getChildren(e,t=null,r=null){return Yt(this,e,t,r)}get node(){return this}matchContext(e){return Kt(this,e)}}class er{constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof Ht)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let t=e._parent;t;t=t._parent)this.stack.unshift(t.index);this.bufferNode=e,this.yieldBuf(e.index)}}get name(){return this.type.name}yieldNode(e){return!!e&&(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0)}yieldBuf(e,t){this.index=e;let{start:r,buffer:n}=this.buffer;return this.type=t||n.set.types[n.buffer[e]],this.from=r+n.buffer[e+1],this.to=r+n.buffer[e+2],!0}yield(e){return!!e&&(e instanceof Ht?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)))}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,r){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,r,this.mode));let{buffer:n}=this.buffer,i=n.findChild(this.index+4,n.buffer[this.index+3],e,t-this.buffer.start,r);return!(i<0)&&(this.stack.push(this.index),this.yieldBuf(i))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,r=this.mode){return this.buffer?!(r&Qt.ExcludeBuffers)&&this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,r))}parent(){if(!this.buffer)return this.yieldNode(this.mode&Qt.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&Qt.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return!!this._tree._parent&&this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode));let{buffer:t}=this.buffer,r=this.stack.length-1;if(e<0){let e=r<0?0:this.stack[r]+4;if(this.index!=e)return this.yieldBuf(t.findChild(e,this.index,-1,0,4))}else{let e=t.buffer[this.index+3];if(e<(r<0?t.buffer.length:t.buffer[this.stack[r]+3]))return this.yieldBuf(e)}return r<0&&this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode))}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,r,{buffer:n}=this;if(n){if(e>0){if(this.index<n.buffer.buffer.length)return!1}else for(let e=0;e<this.index;e++)if(n.buffer.buffer[e+3]<this.index)return!1;({index:t,parent:r}=n)}else({index:t,_parent:r}=this._tree);for(;r;({index:t,_parent:r}=r))if(t>-1)for(let n=t+e,i=e<0?-1:r._tree.children.length;n!=i;n+=e){let e=r._tree.children[n];if(this.mode&Qt.IncludeAnonymous||e instanceof Ut||!e.type.isAnonymous||tr(e))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,r=0;if(e&&e.context==this.buffer)e:for(let n=this.index,i=this.stack.length;i>=0;){for(let a=e;a;a=a._parent)if(a.index==n){if(n==this.index)return a;t=a,r=i+1;break e}n=this.stack[--i]}for(let e=r;e<this.stack.length;e++)t=new Zt(this.buffer,t,this.stack[e]);return this.bufferNode=new Zt(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let r=0;;){let n=!1;if(this.type.isAnonymous||!1!==e(this)){if(this.firstChild()){r++;continue}this.type.isAnonymous||(n=!0)}for(;n&&t&&t(this),n=this.type.isAnonymous,!this.nextSibling();){if(!r)return;this.parent(),r--,n=!0}}}matchContext(e){if(!this.buffer)return Kt(this.node,e);let{buffer:t}=this.buffer,{types:r}=t.set;for(let n=e.length-1,i=this.stack.length-1;n>=0;i--){if(i<0)return Kt(this.node,e,n);let a=r[t.buffer[this.stack[i]]];if(!a.isAnonymous){if(e[n]&&e[n]!=a.name)return!1;n--}}return!0}}function tr(e){return e.children.some((e=>e instanceof Ut||!e.type.isAnonymous||tr(e)))}const rr=new WeakMap;function nr(e,t){if(!e.isAnonymous||t instanceof Ut||t.type!=e)return 1;let r=rr.get(t);if(null==r){r=1;for(let n of t.children){if(n.type!=e||!(n instanceof zt)){r=1;break}r+=nr(e,n)}rr.set(t,r)}return r}function ir(e,t,r,n,i,a,o,s,l){let c=0;for(let r=n;r<i;r++)c+=nr(e,t[r]);let u=Math.ceil(1.5*c/8),d=[],p=[];return function t(r,n,i,o,s){for(let c=i;c<o;){let i=c,h=n[c],f=nr(e,r[c]);for(c++;c<o;c++){let t=nr(e,r[c]);if(f+t>=u)break;f+=t}if(c==i+1){if(f>u){let e=r[i];t(e.children,e.positions,0,e.children.length,n[i]+s);continue}d.push(r[i])}else{let t=n[c-1]+r[c-1].length-h;d.push(ir(e,r,n,i,c,h,t,null,l))}p.push(h+s-a)}}(t,r,n,i,0),(s||l)(d,p,o)}new qt({perNode:!0});let ar=0;class or{constructor(e,t,r){this.set=e,this.base=t,this.modified=r,this.id=ar++}static define(e){if(null==e?void 0:e.base)throw new Error("Can not derive from a modified tag");let t=new or([],null,[]);if(t.set.push(t),e)for(let r of e.set)t.set.push(r);return t}static defineModifier(){let e=new lr;return t=>t.modified.indexOf(e)>-1?t:lr.get(t.base||t,t.modified.concat(e).sort(((e,t)=>e.id-t.id)))}}let sr=0;class lr{constructor(){this.instances=[],this.id=sr++}static get(e,t){if(!t.length)return e;let r=t[0].instances.find((r=>r.base==e&&function(e,t){return e.length==t.length&&e.every(((e,r)=>e==t[r]))}(t,r.modified)));if(r)return r;let n=[],i=new or(n,e,t);for(let e of t)e.instances.push(i);let a=cr(t);for(let t of e.set)for(let e of a)n.push(lr.get(t,e));return i}}function cr(e){let t=[e];for(let r=0;r<e.length;r++)for(let n of cr(e.slice(0,r).concat(e.slice(r+1))))t.push(n);return t}const ur=new qt;class dr{constructor(e,t,r,n){this.tags=e,this.mode=t,this.context=r,this.next=n}get opaque(){return 0==this.mode}get inherit(){return 1==this.mode}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}dr.empty=new dr([],2,null);const pr=or.define,hr=pr(),fr=pr(),mr=pr(fr),gr=pr(fr),br=pr(),vr=pr(br),yr=pr(br),Or=pr(),xr=pr(Or),wr=pr(),_r=pr(),Sr=pr(),Er=pr(Sr),kr=pr(),Pr={comment:hr,lineComment:pr(hr),blockComment:pr(hr),docComment:pr(hr),name:fr,variableName:pr(fr),typeName:mr,tagName:pr(mr),propertyName:gr,attributeName:pr(gr),className:pr(fr),labelName:pr(fr),namespace:pr(fr),macroName:pr(fr),literal:br,string:vr,docString:pr(vr),character:pr(vr),attributeValue:pr(vr),number:yr,integer:pr(yr),float:pr(yr),bool:pr(br),regexp:pr(br),escape:pr(br),color:pr(br),url:pr(br),keyword:wr,self:pr(wr),null:pr(wr),atom:pr(wr),unit:pr(wr),modifier:pr(wr),operatorKeyword:pr(wr),controlKeyword:pr(wr),definitionKeyword:pr(wr),moduleKeyword:pr(wr),operator:_r,derefOperator:pr(_r),arithmeticOperator:pr(_r),logicOperator:pr(_r),bitwiseOperator:pr(_r),compareOperator:pr(_r),updateOperator:pr(_r),definitionOperator:pr(_r),typeOperator:pr(_r),controlOperator:pr(_r),punctuation:Sr,separator:pr(Sr),bracket:Er,angleBracket:pr(Er),squareBracket:pr(Er),paren:pr(Er),brace:pr(Er),content:Or,heading:xr,heading1:pr(xr),heading2:pr(xr),heading3:pr(xr),heading4:pr(xr),heading5:pr(xr),heading6:pr(xr),contentSeparator:pr(Or),list:pr(Or),quote:pr(Or),emphasis:pr(Or),strong:pr(Or),link:pr(Or),monospace:pr(Or),strikethrough:pr(Or),inserted:pr(),deleted:pr(),changed:pr(),invalid:pr(),meta:kr,documentMeta:pr(kr),annotation:pr(kr),processingInstruction:pr(kr),definition:or.defineModifier(),constant:or.defineModifier(),function:or.defineModifier(),standard:or.defineModifier(),local:or.defineModifier(),special:or.defineModifier()},Tr=(function(e,t){let r=Object.create(null);for(let t of e)if(Array.isArray(t.tag))for(let e of t.tag)r[e.id]=t.class;else r[t.tag.id]=t.class;let{scope:n,all:i=null}={}}([{tag:Pr.link,class:"tok-link"},{tag:Pr.heading,class:"tok-heading"},{tag:Pr.emphasis,class:"tok-emphasis"},{tag:Pr.strong,class:"tok-strong"},{tag:Pr.keyword,class:"tok-keyword"},{tag:Pr.atom,class:"tok-atom"},{tag:Pr.bool,class:"tok-bool"},{tag:Pr.url,class:"tok-url"},{tag:Pr.labelName,class:"tok-labelName"},{tag:Pr.inserted,class:"tok-inserted"},{tag:Pr.deleted,class:"tok-deleted"},{tag:Pr.literal,class:"tok-literal"},{tag:Pr.string,class:"tok-string"},{tag:Pr.number,class:"tok-number"},{tag:[Pr.regexp,Pr.escape,Pr.special(Pr.string)],class:"tok-string2"},{tag:Pr.variableName,class:"tok-variableName"},{tag:Pr.local(Pr.variableName),class:"tok-variableName tok-local"},{tag:Pr.definition(Pr.variableName),class:"tok-variableName tok-definition"},{tag:Pr.special(Pr.variableName),class:"tok-variableName2"},{tag:Pr.definition(Pr.propertyName),class:"tok-propertyName tok-definition"},{tag:Pr.typeName,class:"tok-typeName"},{tag:Pr.namespace,class:"tok-namespace"},{tag:Pr.className,class:"tok-className"},{tag:Pr.macroName,class:"tok-macroName"},{tag:Pr.propertyName,class:"tok-propertyName"},{tag:Pr.operator,class:"tok-operator"},{tag:Pr.comment,class:"tok-comment"},{tag:Pr.meta,class:"tok-meta"},{tag:Pr.invalid,class:"tok-invalid"},{tag:Pr.punctuation,class:"tok-punctuation"}]),{inf:147,nan:148,bool:1,ignoring:2,on:3,group_left:4,group_right:5,offset:6}),Cr={avg:8,atan2:7,bottomk:9,count:10,count_values:11,group:12,max:13,min:14,quantile:15,stddev:16,stdvar:17,sum:18,topk:19,by:20,without:21,and:22,or:23,unless:24,start:25,end:26},Ir=function(e){let t=Object.create(null);for(let r in e){let n=e[r];Array.isArray(n)||(n=[n]);for(let e of r.split(" "))if(e){let r=[],i=2,a=e;for(let t=0;;){if("..."==a&&t>0&&t+3==e.length){i=1;break}let n=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(a);if(!n)throw new RangeError("Invalid path: "+e);if(r.push("*"==n[0]?"":'"'==n[0][0]?JSON.parse(n[0]):n[0]),t+=n[0].length,t==e.length)break;let o=e[t++];if(t==e.length&&"!"==o){i=0;break}if("/"!=o)throw new RangeError("Invalid path: "+e);a=e.slice(t)}let o=r.length-1,s=r[o];if(!s)throw new RangeError("Invalid path: "+e);let l=new dr(n,i,o>0?r.slice(0,o):null);t[s]=l.sort(t[s])}}return ur.add(t)}({LineComment:Pr.comment,LabelName:Pr.labelName,StringLiteral:Pr.string,NumberLiteral:Pr.number,Duration:Pr.number,"Abs Absent AbsentOverTime Acos Acosh Asin Asinh Atan Atanh AvgOverTime Ceil Changes Clamp ClampMax ClampMin Cos Cosh CountOverTime DaysInMonth DayOfMonth DayOfWeek DayOfYear Deg Delta Deriv Exp Floor HistogramQuantile HoltWinters Hour Idelta Increase Irate LabelReplace LabelJoin LastOverTime Ln Log10 Log2 MaxOverTime MinOverTime Minute Month Pi PredictLinear PresentOverTime QuantileOverTime Rad Rate Resets Round Scalar Sgn Sin Sinh Sort SortDesc Sqrt StddevOverTime StdvarOverTime SumOverTime Tan Tanh Time Timestamp Vector Year":Pr.function(Pr.variableName),"Avg Bottomk Count Count_values Group Max Min Quantile Stddev Stdvar Sum Topk":Pr.operatorKeyword,"By Without Bool On Ignoring GroupLeft GroupRight Offset Start End":Pr.modifier,"And Unless Or":Pr.logicOperator,"Sub Add Mul Mod Div Atan2 Eql Neq Lte Lss Gte Gtr EqlRegex EqlSingle NeqRegex Pow At":Pr.operator,UnaryOp:Pr.arithmeticOperator,"( )":Pr.paren,"[ ]":Pr.squareBracket,"{ }":Pr.brace,"â ":Pr.invalid}),Dr={__proto__:null,absent_over_time:309,absent:311,abs:313,acos:315,acosh:317,asin:319,asinh:321,atan:323,atanh:325,avg_over_time:327,ceil:329,changes:331,clamp:333,clamp_max:335,clamp_min:337,cos:339,cosh:341,count_over_time:343,days_in_month:345,day_of_month:347,day_of_week:349,day_of_year:351,deg:353,delta:355,deriv:357,exp:359,floor:361,histogram_quantile:363,holt_winters:365,hour:367,idelta:369,increase:371,irate:373,label_replace:375,label_join:377,last_over_time:379,ln:381,log10:383,log2:385,max_over_time:387,min_over_time:389,minute:391,month:393,pi:395,predict_linear:397,present_over_time:399,quantile_over_time:401,rad:403,rate:405,resets:407,round:409,scalar:411,sgn:413,sin:415,sinh:417,sort:419,sort_desc:421,sqrt:423,stddev_over_time:425,stdvar_over_time:427,sum_over_time:429,tan:431,tanh:433,timestamp:435,time:437,vector:439,year:441},Ar=At.deserialize({version:14,states:"6bOYQPOOO'OQPOOOOQO'#C{'#C{O'TQPO'#CzQ'`QQOOOOQO'#De'#DeO'ZQPO'#DdOOQO'#FO'#FOO(mQPO'#FUOYQPO'#FQOYQPO'#FTOOQO'#FW'#FWO.lQSO'#FXO.tQQO'#FVOOQO'#FV'#FVOOQO'#Cy'#CyOOQO'#Df'#DfOOQO'#Dh'#DhOOQO'#Di'#DiOOQO'#Dj'#DjOOQO'#Dk'#DkOOQO'#Dl'#DlOOQO'#Dm'#DmOOQO'#Dn'#DnOOQO'#Do'#DoOOQO'#Dp'#DpOOQO'#Dq'#DqOOQO'#Dr'#DrOOQO'#Ds'#DsOOQO'#Dt'#DtOOQO'#Du'#DuOOQO'#Dv'#DvOOQO'#Dw'#DwOOQO'#Dx'#DxOOQO'#Dy'#DyOOQO'#Dz'#DzOOQO'#D{'#D{OOQO'#D|'#D|OOQO'#D}'#D}OOQO'#EO'#EOOOQO'#EP'#EPOOQO'#EQ'#EQOOQO'#ER'#EROOQO'#ES'#ESOOQO'#ET'#ETOOQO'#EU'#EUOOQO'#EV'#EVOOQO'#EW'#EWOOQO'#EX'#EXOOQO'#EY'#EYOOQO'#EZ'#EZOOQO'#E['#E[OOQO'#E]'#E]OOQO'#E^'#E^OOQO'#E_'#E_OOQO'#E`'#E`OOQO'#Ea'#EaOOQO'#Eb'#EbOOQO'#Ec'#EcOOQO'#Ed'#EdOOQO'#Ee'#EeOOQO'#Ef'#EfOOQO'#Eg'#EgOOQO'#Eh'#EhOOQO'#Ei'#EiOOQO'#Ej'#EjOOQO'#Ek'#EkOOQO'#El'#ElOOQO'#Em'#EmOOQO'#En'#EnOOQO'#Eo'#EoOOQO'#Ep'#EpOOQO'#Eq'#EqOOQO'#Er'#ErOOQO'#Es'#EsOOQO'#Et'#EtOOQO'#Eu'#EuOOQO'#Ev'#EvOOQO'#Ew'#EwOOQO'#Ex'#ExOOQO'#Ey'#EyOOQO'#Ez'#EzOOQO'#E{'#E{QOQPOOO0_QPO'#C|O0dQPO'#DRO'ZQPO,59fO0kQQO,59fO2XQPO,59oO2XQPO,59oO2XQPO,59oO2XQPO,59oO2XQPO,59oO8WQQO,5;hO8]QQO,5;kO8eQPO,5;zOOQO,5:O,5:OOOQO,5;j,5;jO8|QQO,5;lO9TQQO,5;oO:kQPO'#FZO:yQPO,5;sOOQO'#FY'#FYOOQO,5;s,5;sOOQO,5;q,5;qO;RQSO'#C}OOQO,59h,59hO;ZQPO,59mO;cQQO'#DSOOQO,59m,59mOOQO1G/Q1G/QO0_QPO'#DWOAcQPO'#DVOAmQPO'#DVOYQPO1G/ZOYQPO1G/ZOYQPO1G/ZOYQPO1G/ZOYQPO1G/ZOAwQSO1G1SOOQO1G1V1G1VOBPQQO1G1VOBUQPO'#FOOOQO'#Fb'#FbOOQO1G1f1G1fOBaQPO1G1fOOQO1G1W1G1WOOQO'#F['#F[OBfQPO,5;uOBkQSO1G1_OOQO1G1_1G1_OOQO'#DP'#DPOBsQPO,59iOOQO'#DO'#DOOOQO,59i,59iOYQPO,59nOOQO1G/X1G/XOOQO,59r,59rOHnQPO,59qOHuQPO,59qOJ^QQO7+$uOJnQQO7+$uOLSQQO7+$uOLjQQO7+$uONRQQO7+$uOOQO7+&n7+&nONlQQO7+&tOOQO7+&q7+&qONtQPO7+'QOOQO1G1a1G1aOOQO1G1`1G1`OOQO7+&y7+&yONyQSO1G/TOOQO1G/T1G/TO! RQQO1G/YOOQO1G/]1G/]O! ]QPO1G/]OOQO<<J`<<J`O!'RQPO<<J`OOQO<<Jl<<JlOOQO1G/U1G/UOOQO7+$o7+$oOOQO7+$w7+$wOOQOAN?zAN?z",stateData:"!'W~O$[OSkOS~OWQOXQOYQOZQO[QO]QO^QO_QO`QOaQObQOcQO!ZZO#u_O$XVO$YVO$]XO$``O$aaO$bbO$ccO$ddO$eeO$ffO$ggO$hhO$iiO$jjO$kkO$llO$mmO$nnO$ooO$ppO$qqO$rrO$ssO$ttO$uuO$vvO$wwO$xxO$yyO$zzO${{O$||O$}}O%O!OO%P!PO%Q!QO%R!RO%S!SO%T!TO%U!UO%V!VO%W!WO%X!XO%Y!YO%Z!ZO%[![O%]!]O%^!^O%_!_O%`!`O%a!aO%b!bO%c!cO%d!dO%e!eO%f!fO%g!gO%h!hO%i!iO%j!jO%k!kO%l!lO%m!mO%n!nO%o!oO%p!pO%q!qO%r!rO%s!sO%t!tO%wWO%xWO%yVO%{[O~O!ZZO~Od!vOe!vO$]!wO~OU#QOV!zOf!}Og#OOh!}Ox!zO{!zO|!zO}!zO!O!{O!P!{O!Q!|O!R!|O!S!|O!T!|O!U!|O!V!|O$T#RO%u#PO~O$X#TO$Y#TO%y#TOW#xXX#xXY#xXZ#xX[#xX]#xX^#xX_#xX`#xXa#xXb#xXc#xX!Z#xX#u#xX$X#xX$Y#xX$]#xX$`#xX$a#xX$b#xX$c#xX$d#xX$e#xX$f#xX$g#xX$h#xX$i#xX$j#xX$k#xX$l#xX$m#xX$n#xX$o#xX$p#xX$q#xX$r#xX$s#xX$t#xX$u#xX$v#xX$w#xX$x#xX$y#xX$z#xX${#xX$|#xX$}#xX%O#xX%P#xX%Q#xX%R#xX%S#xX%T#xX%U#xX%V#xX%W#xX%X#xX%Y#xX%Z#xX%[#xX%]#xX%^#xX%_#xX%`#xX%a#xX%b#xX%c#xX%d#xX%e#xX%f#xX%g#xX%h#xX%i#xX%j#xX%k#xX%l#xX%m#xX%n#xX%o#xX%p#xX%q#xX%r#xX%s#xX%t#xX%w#xX%x#xX%y#xX%{#xX~Ot#WO%|#ZO~O%{[OU#yXV#yXf#yXg#yXh#yXx#yX{#yX|#yX}#yX!O#yX!P#yX!Q#yX!R#yX!S#yX!T#yX!U#yX!V#yX$T#yX$W#yX%u#yX$_#yX$^#yX~O$]#]O~O$_#aO~PYOd!vOe!vOUnaVnafnagnahnaxna{na|na}na!Ona!Pna!Qna!Rna!Sna!Tna!Una!Vna$Tna$Wna%una$_na$^na~OP#eOQ#cOR#cOWyPXyPYyPZyP[yP]yP^yP_yP`yPayPbyPcyP!ZyP#uyP$XyP$YyP$]yP$`yP$ayP$byP$cyP$dyP$eyP$fyP$gyP$hyP$iyP$jyP$kyP$lyP$myP$nyP$oyP$pyP$qyP$ryP$syP$tyP$uyP$vyP$wyP$xyP$yyP$zyP${yP$|yP$}yP%OyP%PyP%QyP%RyP%SyP%TyP%UyP%VyP%WyP%XyP%YyP%ZyP%[yP%]yP%^yP%_yP%`yP%ayP%byP%cyP%dyP%eyP%fyP%gyP%hyP%iyP%jyP%kyP%lyP%myP%nyP%oyP%pyP%qyP%ryP%syP%tyP%wyP%xyP%yyP%{yP~O#q#kO~O!P#mO#q#lO~Oi#oOj#oO$XVO$YVO%w#nO%x#nO%yVO~O$_#rO~P'`Ox!zOU#waV#waf#wag#wah#wa{#wa|#wa}#wa!O#wa!P#wa!Q#wa!R#wa!S#wa!T#wa!U#wa!V#wa$T#wa$W#wa%u#wa$_#wa$^#wa~O!V#sO$P#sO$Q#sO$R#sO~O$^#uO%|#vO~Ot#wO$_#zO~O$^#{O$_#|O~O$^vX$_vX~P'`OWyXXyXYyXZyX[yX]yX^yX_yX`yXayXbyXcyX!ZyX#uyX$XyX$YyX$]yX$`yX$ayX$byX$cyX$dyX$eyX$fyX$gyX$hyX$iyX$jyX$kyX$lyX$myX$nyX$oyX$pyX$qyX$ryX$syX$tyX$uyX$vyX$wyX$xyX$yyX$zyX${yX$|yX$}yX%OyX%PyX%QyX%RyX%SyX%TyX%UyX%VyX%WyX%XyX%YyX%ZyX%[yX%]yX%^yX%_yX%`yX%ayX%byX%cyX%dyX%eyX%fyX%gyX%hyX%iyX%jyX%kyX%lyX%myX%nyX%oyX%pyX%qyX%ryX%syX%tyX%wyX%xyX%yyX%{yX~OS$OOT$OO~P;mOQ#cOR#cO~P;mO%v$VO%z$WO~O#q$XO~O$X#TO$Y#TO%y#TO~O$]$YO~O#u$ZO~Ot#WO%|$]O~O$^$^O$_$_O~OWyaXyaYyaZya[ya]ya^ya_ya`yaayabyacya!Zya#uya$Xya$Yya$`ya$aya$bya$cya$dya$eya$fya$gya$hya$iya$jya$kya$lya$mya$nya$oya$pya$qya$rya$sya$tya$uya$vya$wya$xya$yya$zya${ya$|ya$}ya%Oya%Pya%Qya%Rya%Sya%Tya%Uya%Vya%Wya%Xya%Yya%Zya%[ya%]ya%^ya%_ya%`ya%aya%bya%cya%dya%eya%fya%gya%hya%iya%jya%kya%lya%mya%nya%oya%pya%qya%rya%sya%tya%wya%xya%yya%{ya~O$]#]O~PB{OS$bOT$bO$]ya~PB{Ox!zOUwqfwqgwqhwq!Owq!Pwq!Qwq!Rwq!Swq!Twq!Uwq!Vwq$Twq$Wwq%uwq$_wq$^wq~OVwq{wq|wq}wq~PISOV!zO{!zO|!zO}!zO~PISOV!zOx!zO{!zO|!zO}!zO!O!{O!P!{OUwqfwqgwqhwq$Twq$Wwq%uwq$_wq$^wq~O!Qwq!Rwq!Swq!Twq!Uwq!Vwq~PKOO!Q!|O!R!|O!S!|O!T!|O!U!|O!V!|O~PKOOV!zOf!}Oh!}Ox!zO{!zO|!zO}!zO!O!{O!P!{O!Q!|O!R!|O!S!|O!T!|O!U!|O!V!|O~OUwqgwq$Twq$Wwq%uwq$_wq$^wq~PMQO#q$dO%v$cO~O$_$eO~Ot#wO$_$gO~O$^vi$_vi~P'`O$]#]OWyiXyiYyiZyi[yi]yi^yi_yi`yiayibyicyi!Zyi#uyi$Xyi$Yyi$`yi$ayi$byi$cyi$dyi$eyi$fyi$gyi$hyi$iyi$jyi$kyi$lyi$myi$nyi$oyi$pyi$qyi$ryi$syi$tyi$uyi$vyi$wyi$xyi$yyi$zyi${yi$|yi$}yi%Oyi%Pyi%Qyi%Ryi%Syi%Tyi%Uyi%Vyi%Wyi%Xyi%Yyi%Zyi%[yi%]yi%^yi%_yi%`yi%ayi%byi%cyi%dyi%eyi%fyi%gyi%hyi%iyi%jyi%kyi%lyi%myi%nyi%oyi%pyi%qyi%ryi%syi%tyi%wyi%xyi%yyi%{yi~O%v$iO~O",goto:"(v$VPPPPPPPPPPPPPPPPPPPPPPPPPPPPP$W$v%S%`%f%r%uP%{&U$vP&X&hPPPPPPPPPPP$v&r'OP'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O$vP'[$v$vP$v$v'k$v'w(W(g(j(pPPP$vP(sQSOQ#UXQ#VYQ#`!wQ$Q#fQ$R#gQ$S#hQ$T#iQ$U#jR$`#{e_OXY!w#f#g#h#i#j#{eROXY!w#f#g#h#i#j#{Q!xRR#b!yQ#^!vQ#}#cQ$a$OR$h$bR#x#]Q#y#]R$f$^Q!yRQ#SUR#b!xR#_!wQ#f!zQ#g!{Q#h!|Q#i!}R#j#OY#d!z!{!|!}#OR$P#eeUOXY!w#f#g#h#i#j#{eTOXY!w#f#g#h#i#j#{d_OXY!w#f#g#h#i#j#{R#p#ReYOXY!w#f#g#h#i#j#{d]OXY!w#f#g#h#i#j#{R!uPd^OXY!w#f#g#h#i#j#{R#[]R#X[Q#Y[R$[#uR#t#WR#q#R",nodeNames:"â  Bool Ignoring On GroupLeft GroupRight Offset Atan2 Avg Bottomk Count CountValues Group Max Min Quantile Stddev Stdvar Sum Topk By Without And Or Unless Start End LineComment PromQL Expr AggregateExpr AggregateOp AggregateModifier GroupingLabels GroupingLabelList GroupingLabel LabelName FunctionCallBody FunctionCallArgs BinaryExpr Pow BinModifiers OnOrIgnoring Mul Div Mod Add Sub Eql Gte Gtr Lte Lss Neq FunctionCall FunctionIdentifier AbsentOverTime Identifier Absent Abs Acos Acosh Asin Asinh Atan Atanh AvgOverTime Ceil Changes Clamp ClampMax ClampMin Cos Cosh CountOverTime DaysInMonth DayOfMonth DayOfWeek DayOfYear Deg Delta Deriv Exp Floor HistogramQuantile HoltWinters Hour Idelta Increase Irate LabelReplace LabelJoin LastOverTime Ln Log10 Log2 MaxOverTime MinOverTime Minute Month Pi PredictLinear PresentOverTime QuantileOverTime Rad Rate Resets Round Scalar Sgn Sin Sinh Sort SortDesc Sqrt StddevOverTime StdvarOverTime SumOverTime Tan Tanh Timestamp Time Vector Year MatrixSelector Duration NumberLiteral OffsetExpr ParenExpr StringLiteral SubqueryExpr UnaryExpr UnaryOp VectorSelector MetricIdentifier LabelMatchers LabelMatchList LabelMatcher MatchOp EqlSingle EqlRegex NeqRegex StepInvariantExpr At AtModifierPreprocessors MetricName",maxTerm:228,propSources:[Ir],skippedNodes:[0,27],repeatNodeCount:0,tokenData:"1R~RwX^#lpq#lqr$ars$tst%huv%swx%xxy&gyz&lz{&q{|&v|}&}}!O'S!O!P'Z!P!Q(Z!Q!R(`!R![)W![!]-r!^!_.n!_!`.{!`!a/b!b!c/o!c!}/t!}#O0[#P#Q0a#Q#R0f#R#S/t#S#T0k#T#o/t#o#p0w#q#r0|#y#z#l$f$g#l#BY#BZ#l$IS$I_#l$I|$JO#l$JT$JU#l$KV$KW#l&FU&FV#l~#qY$[~X^#lpq#l#y#z#l$f$g#l#BY#BZ#l$IS$I_#l$I|$JO#l$JT$JU#l$KV$KW#l&FU&FV#l~$dQ!_!`$j#r#s$o~$oO!V~~$tO$R~~$yU#u~OY$tZr$trs%]s#O$t#O#P%b#P~$t~%bO#u~~%ePO~$t~%mQk~OY%hZ~%h~%xO}~~%}U#u~OY%xZw%xwx%]x#O%x#O#P&a#P~%x~&dPO~%x~&lO$]~~&qO$_~~&vO{~R&}O%xP!OQ~'SO$^~R'ZO%wP!PQP'^P!Q!['aP'fR%yP!Q!['a!g!h'o#X#Y'oP'rR{|'{}!O'{!Q![(RP(OP!Q![(RP(WP%yP!Q![(R~(`O|~R(eZ%yP!O!P'a!Q![)W!g!h'o#W#X){#X#Y'o#[#]*d#a#b*x#g#h+l#k#l+}#l#m-W#m#n,iR)]Y%yP!O!P'a!Q![)W!g!h'o#W#X){#X#Y'o#[#]*d#a#b*x#g#h+l#k#l+}#m#n,iQ*QP#qQ!Q![*TQ*WS!Q![*T#[#]*d#a#b*x#g#h+lQ*iP#qQ!Q![*lQ*oR!Q![*l#a#b*x#g#h+lQ*}Q#qQ!Q![+T#g#h+gQ+WR!Q![+T#a#b+a#g#h+lQ+dP#g#h+gQ+lO#qQQ+qP#qQ!Q![+tQ+wQ!Q![+t#a#b+aQ,SP#qQ!Q![,VQ,YT!Q![,V#W#X){#[#]*d#a#b*x#g#h+lQ,nP#qQ!Q![,qQ,tU!Q![,q#W#X){#[#]*d#a#b*x#g#h+l#k#l+}P-ZR!Q![-d!c!i-d#T#Z-dP-iR%yP!Q![-d!c!i-d#T#Z-dV-yT%zS!ZR!Q![.Y![!].Y!c!}.Y#R#S.Y#T#o.YR._T!ZR!Q![.Y![!].Y!c!}.Y#R#S.Y#T#o.Y~.sP!U~!_!`.v~.{O!T~~/QQ$PP!_!`/W#r#s/]Q/]O!QQ~/bO$Q~~/gP!S~!_!`/j~/oO!R~~/tO$T~V/{T!ZRtS!Q![/t![!].Y!c!}/t#R#S/t#T#o/t~0aO%u~~0fO%v~~0kOx~~0nRO#S0k#S#T%]#T~0k~0|O%{~~1RO%|~",tokenizers:[0,1,2],topRules:{PromQL:[0,28],MetricName:[1,145]},specialized:[{term:57,get:(e,t)=>((e,t)=>Tr[e.toLowerCase()]||-1)(e)<<1},{term:57,get:(e,t)=>((e,t)=>Cr[e.toLowerCase()]||-1)(e)<<1|1},{term:57,get:e=>Dr[e]||-1}],tokenPrec:0}),Rr=126,jr=129,Nr=133,Lr=134,qr=136,$r=137;function Mr(e){return e.firstChild?Mr(e.firstChild):e}function Br(e,t){var r;return{text:zr(e,t),from:t.from,to:t.to,parentType:null===(r=t.parent)||void 0===r?void 0:r.name}}const Fr=/\$(\w+)|\[\[([\s\S]+?)(?::(\w+))?\]\]|\${(\w+)(?:\.([^:^\}]+))?(?::([^\}]+))?}/g,Qr=[(e,t)=>`$${e}`,(e,t)=>`[[${e}${t?`:${t}`:""}]]`,(e,t)=>`\${${e}${t?`:${t}`:""}}`];function zr(e,t){return t?function(e){return e.replace(/__V_(\d)__(.+?)__V__(?:__F__(\w+)__F__)?/g,((e,t,r,n)=>Qr[parseInt(t,10)](r,n)))}(e.substring(t.from,t.to)):""}function Vr(e,t,r,n){const i=[parseFloat(zr(t,r))];return e.comparison&&i.push(n),{id:e.id,params:i}}function Ur(e,t,r){if(t.type.id===r||t.name===r)return[zr(e,t)];const n=[];let i=0,a=t.childAfter(i);for(;a;)n.push(...Ur(e,a,r)),i=a.to,a=t.childAfter(i);return n}function Wr(e){const t=function(e){return e.replace(Fr,((e,t,r,n,i,a,o)=>{const s=n||o;let l=t,c="0";return r&&(l=r,c="1"),i&&(l=i,c="2"),`__V_${c}__`+l+"__V__"+(s?"__F__"+s+"__F__":"")}))}(e),r=Ar.parse(t).topNode,n={query:{metric:"",labels:[],operations:[]},errors:[]};try{Xr(t,r,n)}catch(e){console.error(e),e instanceof Error&&n.errors.push({text:e.message})}return 0===(i=n.query).labels.length&&0===i.operations.length&&!i.metric&&(n.errors=[]),n;var i}function Xr(e,t,r){const n=r.query;switch(t.type.id){case Lr:n.metric=zr(e,t);break;case $r:{n.labels.push(function(e,t){return{label:zr(e,t.getChild(36)),op:zr(e,t.getChild(138)),value:zr(e,t.getChild(jr)).replace(/"/g,"")}}(e,t));const i=t.getChild("â ");i&&r.errors.push(Br(e,i));break}case 54:!function(e,t,r){const n=r.query,i=zr(e,t.getChild(55)),a=t.getChild(37).getChild(38),o=[];let s="";if(Gr.includes(i)||i.endsWith("_over_time")){let r=zr(e,t).match(/\[(.+)\]/);(null==r?void 0:r[1])&&(s=r[1],o.push(r[1]))}const l={id:i,params:o};if(n.operations.unshift(l),a){if(zr(e,a)===s+"]")return;Hr(e,a,r,l)}}(e,t,r);break;case 30:!function(e,t,r){const n=r.query;let i=zr(e,t.getChild(31));const a=t.getChild(32),o=[];a&&(a.getChild("By")&&i&&(i=`__${i}_by`),a.getChild(21)&&(i=`__${i}_without`),o.push(...Ur(e,a,35)));const s=t.getChild(37).getChild(38),l={id:i,params:[]};n.operations.unshift(l),Hr(e,s,r,l),l.params.push(...o)}(e,t,r);break;case 39:!function(e,t,r){const n=r.query,i=t.firstChild,a=zr(e,i.nextSibling),o=function(e,t){if(t){if(t.getChild("Bool"))return{isBool:!0,isMatcher:!1};{var r;const n=t.getChild(42);if(!n)return;return{isMatcher:!0,isBool:!1,matches:zr(e,null===(r=n.getChild(33))||void 0===r?void 0:r.getChild(34)),matchType:n.getChild(3)?"on":"ignoring"}}}}(e,t.getChild(41)),s=t.lastChild,l=xe[a],c=i.getChild(Rr),u=s.getChild(Rr),d=s.getChild(39);if(c||Xr(e,i,r),u)n.operations.push(Vr(l,e,s,!!(null==o?void 0:o.isBool)));else if(d){const t=Mr(s);(null==t?void 0:t.type.id)===Rr&&n.operations.push(Vr(l,e,t,!!(null==o?void 0:o.isBool))),Xr(e,s,r)}else{n.binaryQueries=n.binaryQueries||[];const t={operator:a,query:{metric:"",labels:[],operations:[]}};(null==o?void 0:o.isMatcher)&&(t.vectorMatchesType=o.matchType,t.vectorMatches=o.matches),n.binaryQueries.push(t),Xr(e,s,{query:t.query,errors:r.errors})}}(e,t,r);break;case 0:if(function(e){var t,r,n;return 29===(null===(t=e.prevSibling)||void 0===t?void 0:t.type.id)&&(null===(r=e.prevSibling)||void 0===r||null===(n=r.firstChild)||void 0===n?void 0:n.type.id)===Nr}(t))break;r.errors.push(Br(e,t));break;default:{128===t.type.id&&r.errors.push(Br(e,t));let n=t.firstChild;for(;n;)Xr(e,n,r),n=n.nextSibling}}}const Gr=["changes","rate","irate","increase","delta"];function Hr(e,t,r,n){if(t)switch(t.type.id){case 29:case 38:{let i=t.firstChild;for(;i;)Hr(e,i,r,n),i=i.nextSibling;break}case Rr:n.params.push(parseFloat(zr(e,t)));break;case jr:n.params.push(zr(e,t).replace(/"/g,""));break;default:Xr(e,t,r)}}function Yr({feedbackUrl:e}){const t=(0,a.useStyles2)(Kr);return i.config.feedbackLinksEnabled?r().createElement(u,{gap:1},r().createElement("a",{href:e,className:t.link,title:"This query builder is new, please let us know how we can improve it",target:"_blank",rel:"noreferrer noopener",onClick:()=>(0,i.reportInteraction)("grafana_feedback_link_clicked",{link:e})},r().createElement(a.Icon,{name:"comment-alt-message"})," Give feedback")):null}function Kr(e){return{link:(0,o.css)({color:e.colors.text.secondary,fontSize:e.typography.bodySmall.fontSize,":hover":{color:e.colors.text.link}})}}var Jr;!function(e){e.Code="code",e.Builder="builder"}(Jr||(Jr={}));const Zr=[{label:"Builder",value:Jr.Builder,component:()=>r().createElement(a.Tag,{className:(0,o.css)({fontSize:10,padding:"1px 5px",verticalAlign:"text-bottom"}),name:"Beta",colorIndex:1})},{label:"Code",value:Jr.Code}];function en({mode:e,onChange:t}){return r().createElement("div",{"data-testid":"QueryEditorModeToggle"},r().createElement(a.RadioButtonGroup,{options:Zr,size:"sm",value:e,onChange:t}))}function tn(){return tn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},tn.apply(this,arguments)}function rn(e){var{label:n}=e,i=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,["label"]);const o=n.replace(" ","-"),s=(0,t.useRef)((0,G.uniqueId)(`switch-${o}`)),l=(0,a.useStyles2)(nn);return r().createElement(u,{gap:1},r().createElement("label",{htmlFor:s.current,className:l.switchLabel},n),r().createElement(a.Switch,tn({},i,{id:s.current})))}const nn=e=>({switchLabel:(0,o.css)({color:e.colors.text.secondary,cursor:"pointer",fontSize:e.typography.bodySmall.fontSize,"&:hover":{color:e.colors.text.primary}})}),an=new class{get(e){return window.localStorage[e]}set(e,t){window.localStorage[e]=t}getBool(e,t){return void 0===t||this.exists(e)?"true"===window.localStorage[e]:t}getObject(e,t){let r=t;if(this.exists(e)){const n=window.localStorage[e];try{r=JSON.parse(n)}catch(r){console.error(`Error parsing store object: ${e}. Returning default: ${t}. [${r}]`)}}return r}setObject(e,t){let r;try{r=JSON.stringify(t)}catch(t){throw new Error(`Could not stringify object: ${e}. [${t}]`)}try{this.set(e,r)}catch(t){const r=new Error(`Could not save item in localStorage: ${e}. [${t}]`);throw t instanceof Error&&(r.name=t.name),r}return!0}exists(e){return void 0!==window.localStorage[e]}delete(e){window.localStorage.removeItem(e)}};function on(e,r=!1){const[n,i]=(0,t.useState)(function(e,t=!1){const r=an.get(e);return void 0===r?t:Boolean(parseInt(r,10))}(e,r));return{flag:n,setFlag:(0,t.useCallback)((t=>{!function(e,t){an.set(e,t?"1":"0")}(e,t),i(t)}),[e])}}var sn,ln;function cn(e){return"values"in e}function un(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dn(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){un(e,t,r[t])}))}return e}function pn(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}!function(e){e.timeSeriesQuery="timeSeriesQuery"}(sn||(sn={})),function(e){e.Auto="__auto",e.Verbose="__verbose",e.Custom="__custom"}(ln||(ln={}));const hn="PrometheusQueryEditorModeDefault";function fn(e,t,r){""===e.expr&&an.set(hn,t),r(pn(dn({},e),{editorMode:t}))}function mn(e){if(null!=e&&""!==e)return Jr.Code;const t=an.get(hn);switch(t){case Jr.Builder:case Jr.Code:return t;default:return Jr.Builder}}function gn(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];throw Error("[Immer] minified error nr: "+e+(r.length?" "+r.map((function(e){return"'"+e+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function bn(e){return!!e&&!!e[ni]}function vn(e){return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object||"function"==typeof r&&Function.toString.call(r)===ii}(e)||Array.isArray(e)||!!e[ri]||!!e.constructor[ri]||Sn(e)||En(e))}function yn(e,t,r){void 0===r&&(r=!1),0===On(e)?(r?Object.keys:ai)(e).forEach((function(n){r&&"symbol"==typeof n||t(n,e[n],e)})):e.forEach((function(r,n){return t(n,r,e)}))}function On(e){var t=e[ni];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:Sn(e)?2:En(e)?3:0}function xn(e,t){return 2===On(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function wn(e,t,r){var n=On(e);2===n?e.set(t,r):3===n?(e.delete(t),e.add(r)):e[t]=r}function _n(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function Sn(e){return Jn&&e instanceof Map}function En(e){return Zn&&e instanceof Set}function kn(e){return e.o||e.t}function Pn(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=oi(e);delete t[ni];for(var r=ai(t),n=0;n<r.length;n++){var i=r[n],a=t[i];!1===a.writable&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(t[i]={configurable:!0,writable:!0,enumerable:a.enumerable,value:e[i]})}return Object.create(Object.getPrototypeOf(e),t)}function Tn(e,t){return void 0===t&&(t=!1),In(e)||bn(e)||!vn(e)||(On(e)>1&&(e.set=e.add=e.clear=e.delete=Cn),Object.freeze(e),t&&yn(e,(function(e,t){return Tn(t,!0)}),!0)),e}function Cn(){gn(2)}function In(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function Dn(e){var t=si[e];return t||gn(18,e),t}function An(){return Yn}function Rn(e,t){t&&(Dn("Patches"),e.u=[],e.s=[],e.v=t)}function jn(e){Nn(e),e.p.forEach(qn),e.p=null}function Nn(e){e===Yn&&(Yn=e.l)}function Ln(e){return Yn={p:[],l:Yn,h:e,m:!0,_:0}}function qn(e){var t=e[ni];0===t.i||1===t.i?t.j():t.O=!0}function $n(e,t){t._=t.p.length;var r=t.p[0],n=void 0!==e&&e!==r;return t.h.g||Dn("ES5").S(t,e,n),n?(r[ni].P&&(jn(t),gn(4)),vn(e)&&(e=Mn(t,e),t.l||Fn(t,e)),t.u&&Dn("Patches").M(r[ni].t,e,t.u,t.s)):e=Mn(t,r,[]),jn(t),t.u&&t.v(t.u,t.s),e!==ti?e:void 0}function Mn(e,t,r){if(In(t))return t;var n=t[ni];if(!n)return yn(t,(function(i,a){return Bn(e,n,t,i,a,r)}),!0),t;if(n.A!==e)return t;if(!n.P)return Fn(e,n.t,!0),n.t;if(!n.I){n.I=!0,n.A._--;var i=4===n.i||5===n.i?n.o=Pn(n.k):n.o;yn(3===n.i?new Set(i):i,(function(t,a){return Bn(e,n,i,t,a,r)})),Fn(e,i,!1),r&&e.u&&Dn("Patches").R(n,r,e.u,e.s)}return n.o}function Bn(e,t,r,n,i,a){if(bn(i)){var o=Mn(e,i,a&&t&&3!==t.i&&!xn(t.D,n)?a.concat(n):void 0);if(wn(r,n,o),!bn(o))return;e.m=!1}if(vn(i)&&!In(i)){if(!e.h.F&&e._<1)return;Mn(e,i),t&&t.A.l||Fn(e,i)}}function Fn(e,t,r){void 0===r&&(r=!1),e.h.F&&e.m&&Tn(t,r)}function Qn(e,t){var r=e[ni];return(r?kn(r):e)[t]}function zn(e,t){if(t in e)for(var r=Object.getPrototypeOf(e);r;){var n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Object.getPrototypeOf(r)}}function Vn(e){e.P||(e.P=!0,e.l&&Vn(e.l))}function Un(e){e.o||(e.o=Pn(e.t))}function Wn(e,t,r){var n=Sn(t)?Dn("MapSet").N(t,r):En(t)?Dn("MapSet").T(t,r):e.g?function(e,t){var r=Array.isArray(e),n={i:r?1:0,A:t?t.A:An(),P:!1,I:!1,D:{},l:t,t:e,k:null,o:null,j:null,C:!1},i=n,a=li;r&&(i=[n],a=ci);var o=Proxy.revocable(i,a),s=o.revoke,l=o.proxy;return n.k=l,n.j=s,l}(t,r):Dn("ES5").J(t,r);return(r?r.A:An()).p.push(n),n}function Xn(e){return bn(e)||gn(22,e),function e(t){if(!vn(t))return t;var r,n=t[ni],i=On(t);if(n){if(!n.P&&(n.i<4||!Dn("ES5").K(n)))return n.t;n.I=!0,r=Gn(t,i),n.I=!1}else r=Gn(t,i);return yn(r,(function(t,i){n&&function(e,t){return 2===On(e)?e.get(t):e[t]}(n.t,t)===i||wn(r,t,e(i))})),3===i?new Set(r):r}(e)}function Gn(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return Pn(e)}var Hn,Yn,Kn="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),Jn="undefined"!=typeof Map,Zn="undefined"!=typeof Set,ei="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,ti=Kn?Symbol.for("immer-nothing"):((Hn={})["immer-nothing"]=!0,Hn),ri=Kn?Symbol.for("immer-draftable"):"__$immer_draftable",ni=Kn?Symbol.for("immer-state"):"__$immer_state",ii=("undefined"!=typeof Symbol&&Symbol.iterator,""+Object.prototype.constructor),ai="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,oi=Object.getOwnPropertyDescriptors||function(e){var t={};return ai(e).forEach((function(r){t[r]=Object.getOwnPropertyDescriptor(e,r)})),t},si={},li={get:function(e,t){if(t===ni)return e;var r=kn(e);if(!xn(r,t))return function(e,t,r){var n,i=zn(t,r);return i?"value"in i?i.value:null===(n=i.get)||void 0===n?void 0:n.call(e.k):void 0}(e,r,t);var n=r[t];return e.I||!vn(n)?n:n===Qn(e.t,t)?(Un(e),e.o[t]=Wn(e.A.h,n,e)):n},has:function(e,t){return t in kn(e)},ownKeys:function(e){return Reflect.ownKeys(kn(e))},set:function(e,t,r){var n=zn(kn(e),t);if(null==n?void 0:n.set)return n.set.call(e.k,r),!0;if(!e.P){var i=Qn(kn(e),t),a=null==i?void 0:i[ni];if(a&&a.t===r)return e.o[t]=r,e.D[t]=!1,!0;if(_n(r,i)&&(void 0!==r||xn(e.t,t)))return!0;Un(e),Vn(e)}return e.o[t]===r&&"number"!=typeof r&&(void 0!==r||t in e.o)||(e.o[t]=r,e.D[t]=!0,!0)},deleteProperty:function(e,t){return void 0!==Qn(e.t,t)||t in e.t?(e.D[t]=!1,Un(e),Vn(e)):delete e.D[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var r=kn(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:n.enumerable,value:r[t]}:n},defineProperty:function(){gn(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){gn(12)}},ci={};yn(li,(function(e,t){ci[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),ci.deleteProperty=function(e,t){return ci.set.call(this,e,t,void 0)},ci.set=function(e,t,r){return li.set.call(this,e[0],t,r,e[0])};var ui=function(){function e(e){var t=this;this.g=ei,this.F=!0,this.produce=function(e,r,n){if("function"==typeof e&&"function"!=typeof r){var i=r;r=e;var a=t;return function(e){var t=this;void 0===e&&(e=i);for(var n=arguments.length,o=Array(n>1?n-1:0),s=1;s<n;s++)o[s-1]=arguments[s];return a.produce(e,(function(e){var n;return(n=r).call.apply(n,[t,e].concat(o))}))}}var o;if("function"!=typeof r&&gn(6),void 0!==n&&"function"!=typeof n&&gn(7),vn(e)){var s=Ln(t),l=Wn(t,e,void 0),c=!0;try{o=r(l),c=!1}finally{c?jn(s):Nn(s)}return"undefined"!=typeof Promise&&o instanceof Promise?o.then((function(e){return Rn(s,n),$n(e,s)}),(function(e){throw jn(s),e})):(Rn(s,n),$n(o,s))}if(!e||"object"!=typeof e){if(void 0===(o=r(e))&&(o=e),o===ti&&(o=void 0),t.F&&Tn(o,!0),n){var u=[],d=[];Dn("Patches").M(e,o,u,d),n(u,d)}return o}gn(21,e)},this.produceWithPatches=function(e,r){if("function"==typeof e)return function(r){for(var n=arguments.length,i=Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];return t.produceWithPatches(r,(function(t){return e.apply(void 0,[t].concat(i))}))};var n,i,a=t.produce(e,r,(function(e,t){n=e,i=t}));return"undefined"!=typeof Promise&&a instanceof Promise?a.then((function(e){return[e,n,i]})):[a,n,i]},"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze)}var t=e.prototype;return t.createDraft=function(e){vn(e)||gn(8),bn(e)&&(e=Xn(e));var t=Ln(this),r=Wn(this,e,void 0);return r[ni].C=!0,Nn(t),r},t.finishDraft=function(e,t){var r=(e&&e[ni]).A;return Rn(r,t),$n(void 0,r)},t.setAutoFreeze=function(e){this.F=e},t.setUseProxies=function(e){e&&!ei&&gn(20),this.g=e},t.applyPatches=function(e,t){var r;for(r=t.length-1;r>=0;r--){var n=t[r];if(0===n.path.length&&"replace"===n.op){e=n.value;break}}r>-1&&(t=t.slice(r+1));var i=Dn("Patches").$;return bn(e)?i(e,t):this.produce(e,(function(e){return i(e,t)}))},e}(),di=new ui,pi=di.produce;di.produceWithPatches.bind(di),di.setAutoFreeze.bind(di),di.setUseProxies.bind(di),di.applyPatches.bind(di),di.createDraft.bind(di),di.finishDraft.bind(di);const hi=pi;var fi=m(3129),mi=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),gi=function(e,t){for(var r=0,n=t.length,i=e.length;r<n;r++,i++)e[i]=t[r];return e},bi=Object.defineProperty,vi=(Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols),yi=Object.prototype.hasOwnProperty,Oi=Object.prototype.propertyIsEnumerable,xi=function(e,t,r){return t in e?bi(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},wi=function(e,t){for(var r in t||(t={}))yi.call(t,r)&&xi(e,r,t[r]);if(vi)for(var n=0,i=vi(t);n<i.length;n++)r=i[n],Oi.call(t,r)&&xi(e,r,t[r]);return e};function _i(e){return vn(e)?hi(e,(function(){})):e}function Si(e,t){function r(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];if(t){var i=t.apply(void 0,r);if(!i)throw new Error("prepareAction did not return an object");return wi(wi({type:e,payload:i.payload},"meta"in i&&{meta:i.meta}),"error"in i&&{error:i.error})}return{type:e,payload:r[0]}}return r.toString=function(){return""+e},r.type=e,r.match=function(t){return t.type===e},r}function Ei(e){var t,r={},n=[],i={addCase:function(e,t){var n="string"==typeof e?e:e.type;if(n in r)throw new Error("addCase cannot be called with two reducers for the same action type");return r[n]=t,i},addMatcher:function(e,t){return n.push({matcher:e,reducer:t}),i},addDefaultCase:function(e){return t=e,i}};return e(i),[r,n,t]}"undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__,"undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__,function(e){function t(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var i=e.apply(this,r)||this;return Object.setPrototypeOf(i,t.prototype),i}mi(t,e),Object.defineProperty(t,Symbol.species,{get:function(){return t},enumerable:!1,configurable:!0}),t.prototype.concat=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e.prototype.concat.apply(this,t)},t.prototype.prepend=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return 1===e.length&&Array.isArray(e[0])?new(t.bind.apply(t,gi([void 0],e[0].concat(this)))):new(t.bind.apply(t,gi([void 0],e.concat(this))))}}(Array),Object.assign;var ki="listenerMiddleware";Si(ki+"/add"),Si(ki+"/removeAll"),Si(ki+"/remove"),function(){function e(e,t){var r=i[e];return r?r.enumerable=t:i[e]=r={configurable:!0,enumerable:t,get:function(){var t=this[ni];return li.get(t,e)},set:function(t){var r=this[ni];li.set(r,e,t)}},r}function t(e){for(var t=e.length-1;t>=0;t--){var i=e[t][ni];if(!i.P)switch(i.i){case 5:n(i)&&Vn(i);break;case 4:r(i)&&Vn(i)}}}function r(e){for(var t=e.t,r=e.k,n=ai(r),i=n.length-1;i>=0;i--){var a=n[i];if(a!==ni){var o=t[a];if(void 0===o&&!xn(t,a))return!0;var s=r[a],l=s&&s[ni];if(l?l.t!==o:!_n(s,o))return!0}}var c=!!t[ni];return n.length!==ai(t).length+(c?0:1)}function n(e){var t=e.k;if(t.length!==e.t.length)return!0;var r=Object.getOwnPropertyDescriptor(t,t.length-1);if(r&&!r.get)return!0;for(var n=0;n<t.length;n++)if(!t.hasOwnProperty(n))return!0;return!1}var i={};!function(e,t){si[e]||(si[e]=t)}("ES5",{J:function(t,r){var n=Array.isArray(t),i=function(t,r){if(t){for(var n=Array(r.length),i=0;i<r.length;i++)Object.defineProperty(n,""+i,e(i,!0));return n}var a=oi(r);delete a[ni];for(var o=ai(a),s=0;s<o.length;s++){var l=o[s];a[l]=e(l,t||!!a[l].enumerable)}return Object.create(Object.getPrototypeOf(r),a)}(n,t),a={i:n?5:4,A:r?r.A:An(),P:!1,I:!1,D:{},l:r,t,k:i,o:null,O:!1,C:!1};return Object.defineProperty(i,ni,{value:a,writable:!0}),i},S:function(e,r,i){i?bn(r)&&r[ni].A===e&&t(e.p):(e.u&&function e(t){if(t&&"object"==typeof t){var r=t[ni];if(r){var i=r.t,a=r.k,o=r.D,s=r.i;if(4===s)yn(a,(function(t){t!==ni&&(void 0!==i[t]||xn(i,t)?o[t]||e(a[t]):(o[t]=!0,Vn(r)))})),yn(i,(function(e){void 0!==a[e]||xn(a,e)||(o[e]=!1,Vn(r))}));else if(5===s){if(n(r)&&(Vn(r),o.length=!0),a.length<i.length)for(var l=a.length;l<i.length;l++)o[l]=!1;else for(var c=i.length;c<a.length;c++)o[c]=!0;for(var u=Math.min(a.length,i.length),d=0;d<u;d++)a.hasOwnProperty(d)||(o[d]=!0),void 0===o[d]&&e(a[d])}}}}(e.p[0]),t(e.p))},K:function(e){return 4===e.i?r(e):n(e)}})}();var Pi=m(5295),Ti=m.n(Pi),Ci=m(3342),Ii=m.n(Ci);function Di(e,t,r,n="="){if(!t||!r)throw new Error("Need label to add to query.");const i=function(e){const t=Ar.parse(e),r=[];return t.iterate({enter:({to:t,from:n,type:i})=>{if(i.id===Nr){const i=Wr(e.substring(n,t));return r.push({query:i.query,from:n,to:t}),!1}}}),r}(e);if(!i.length)return e;const a=function(e,t,r){return{label:e,op:r,value:t===1/0?"+Inf":t.toString()}}(t,r,n);return function(e,t,r){const n=new qe;let i="",a=0;for(let o=0;o<t.length;o++){const s=t[o],l=o===t.length-1,c=e.substring(a,s.from),u=l?e.substring(s.to):"";Ai(s.query.labels,r)||s.query.labels.push(r),i+=c+n.renderQuery(s.query)+u,a=s.to}return i}(e,i,a)}function Ai(e,t){return e.find((e=>e.label===t.label&&e.value===t.value))}function Ri(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const ji=/\{[^}]*?(\}|$)/,Ni=/\b(\w+)(!?=~?)("[^"\n]*?")/g;function Li(e,t=1){if(!e.match(ji)){if(e.match(/^[A-Za-z:][\w:]*$/))return{selector:`{__name__="${e}"}`,labelKeys:["__name__"]};throw new Error("Query must contain a selector: "+e)}const r=e.slice(0,t),n=r.lastIndexOf("{"),i=r.lastIndexOf("}");if(-1===n)throw new Error("Not inside selector, missing open brace: "+r);if(i>-1&&i>n)throw new Error("Not inside selector, previous selector already closed: "+r);const a=e.slice(t),o=a.indexOf("}")+t,s=a.indexOf("{"),l=s+t;if(-1===o)throw new Error("Not inside selector, missing closing brace in suffix: "+a);if(s>-1&&l<o)throw new Error("Not inside selector, next selector opens before this one closed: "+a);const c=e.slice(n,o),u={};c.replace(Ni,((r,n,i,a)=>{const o=e.indexOf(r),s=o+n.length+i.length+1,l=o+n.length+i.length+a.length-1;return(t<s||t>l)&&(u[n]={value:a,operator:i}),""}));const d=e.slice(0,n).match(/[A-Za-z:][\w:]*$/);d&&(u.__name__={value:`"${d[0]}"`,operator:"="});const p=Object.keys(u).sort(),h=p.map((e=>`${e}${u[e].operator}${u[e].value}`)).join(",");return{labelKeys:p,selector:["{",h,"}"].join("")}}function qi(e){return $i(e/1e3)}function $i(e){return Math.floor(e/60)}function Mi(e){return e.slice(0,Zi)}function Bi(e){return e&&e.length>=Zi?`, limited to the first ${Zi} received items`:""}const Fi=/[*+?()|\\.\[\]{}^$]/g;function Qi(e){return e.replace(/\\/g,"\\\\").replace(/\n/g,"\\n").replace(/"/g,'\\"')}function zi(e){return Qi(e.replace(Fi,"\\$&"))}const Vi={"=":e.AbstractLabelOperator.Equal,"!=":e.AbstractLabelOperator.NotEqual,"=~":e.AbstractLabelOperator.EqualRegEx,"!~":e.AbstractLabelOperator.NotEqualRegEx},Ui=(0,G.invert)(Vi);function Wi(e){const t=e.labelMatchers.map((e=>{const t=Ui[e.operator];return t?`${e.name}${t}"${e.value}"`:""})).filter((e=>""!==e)).join(", ");return t?`{${t}}`:""}function Xi(e,t,r,n,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function Gi(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function o(e){Xi(a,n,i,o,s,"next",e)}function s(e){Xi(a,n,i,o,s,"throw",e)}o(void 0)}))}}function Hi(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yi(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Hi(e,t,r[t])}))}return e}function Ki(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const Ji=["job","instance"],Zi=1e4,ea=e=>({label:e}),ta=e=>(e.kind="function",e);function ra(e,t){if(!t[e])return;const{type:r,help:n}=t[e];return`${r.toUpperCase()}: ${n}`}const na=/(="|!="|=~"|!~"|\{|\[|\(|\+|-|\/|\*|%|\^|\band\b|\bor\b|\bunless\b|==|>=|!=|<=|>|<|=|~|,)/;class ia extends e.LanguageProvider{cleanText(e){return e.split(na).pop().trimLeft().replace(/"$/,"").replace(/^"/,"")}get syntax(){return U}loadMetricsMetadata(){var e=this;return Gi((function*(){e.metricsMetadata=function(e){if(!e)return e;const t={},r={};for(const n in e){const i=e[n][0];t[n]=i,"histogram"===i.type&&(r[`${n}_bucket`]={type:"counter",help:`Cumulative counters for the observation buckets (${i.help})`},r[`${n}_count`]={type:"counter",help:`Count of events that have been observed for the histogram metric (${i.help})`},r[`${n}_sum`]={type:"counter",help:`Total sum of all observed values for the histogram metric (${i.help})`}),"summary"===i.type&&(r[`${n}_count`]={type:"counter",help:`Count of events that have been observed for the base metric (${i.help})`},r[`${n}_sum`]={type:"counter",help:`Total sum of all observed values for the base metric (${i.help})`})}return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Ri(e,t,r[t])}))}return e}({},t,r,{ALERTS:{type:"counter",help:"Time series showing pending and firing alerts. The sample value is set to 1 as long as the alert is in the indicated active (pending or firing) state."}})}(yield e.request("/api/v1/metadata",{},{},{showErrorAlert:!1}))}))()}getLabelKeys(){return this.labelKeys}getRangeCompletionItems(){return{context:"context-range",suggestions:[{label:"Range vector",items:[...Q]}]}}importFromAbstractQuery(e){return function(e){return{refId:e.refId,expr:Wi(e),range:!0}}(e)}exportToAbstractQuery(t){const r=t.expr;if(!r||0===r.length)return{refId:t.refId,labelMatchers:[]};const n=Ii().tokenize(r,U),i=function(e){const t=[];for(let r in e)if(e[r]instanceof Ci.Token){let n=e[r];if("context-labels"===n.type){let e="",r="",i="",a=n.content;for(let n in a)if("string"==typeof a[n]){let e;e=a[n],"="!==e&&"!="!==e&&"=~"!==e&&"!~"!==e||(i=e)}else if(a[n]instanceof Ci.Token)switch(a[n].type){case"label-key":e=a[n].content;break;case"label-value":r=a[n].content,r=r.substring(1,r.length-1);const o=Vi[i];o&&t.push({name:e,operator:o,value:r})}}}return t}(n),a=function(e,t){let r="";for(let e in t)if("string"==typeof t[e]){r=t[e];break}return r}(0,n);return a&&a.length>0&&i.push({name:"__name__",operator:e.AbstractLabelOperator.Equal,value:a}),{refId:t.refId,labelMatchers:i}}getSeries(e,t){var r=this;return Gi((function*(){if(r.datasource.lookupsDisabled)return{};try{return"{}"===e?yield r.fetchDefaultSeries():yield r.fetchSeriesLabels(e,t)}catch(e){return console.error(e),{}}}))()}getLabelValues(e){var t=this;return Gi((function*(){return yield t.fetchLabelValues(e)}))()}fetchLabels(){var e=this;return Gi((function*(){const t=e.datasource.getTimeRangeParams();e.labelFetchTs=Date.now().valueOf();const r=yield e.request("/api/v1/labels",[],t);return Array.isArray(r)&&(e.labelKeys=r.slice().sort()),[]}))()}constructor(t,r){super(),this.labelKeys=[],this.labelsCache=new(Ti())({max:10});var n,i=this;this.request=(n=Gi((function*(e,t,r={},n){try{return(yield i.datasource.metadataRequest(e,r,n)).data.data}catch(e){console.error(e)}return t})),function(e,t){return n.apply(this,arguments)});var o=this;this.start=Gi((function*(){return o.datasource.lookupsDisabled||(yield o.fetchLabels(),o.metrics=(yield o.fetchLabelValues("__name__"))||[],yield o.loadMetricsMetadata(),o.histogramMetrics=(e=>{const t=new Set,r=new RegExp("_bucket($|:)");for(let n=0;n<e.length;n++){const i=e[n];r.test(i)&&t.add(i)}return[...t]})(o.metrics).sort()),[]}));var s=this;this.provideCompletionItems=function(){var e=Gi((function*({prefix:e,text:t,value:r,labelKey:n,wrapperClasses:i},a={}){const o={suggestions:[]};if(!r)return o;const l=0===r.document.text.length,c=r.document.getTextsAtRange(r.selection),u=1===c.size?c.first().getText():null,d=u?u[r.selection.anchor.offset]:null,p=i.length>3,h=e&&!p,f=!d||")"===d,m=e&&!t.match(/^[\]})\s]+$/)&&f,g=t.match(/[+\-*/^%]/);return i.includes("context-range")?s.getRangeCompletionItems():i.includes("context-labels")?s.getLabelCompletionItems({prefix:e,text:t,value:r,labelKey:n,wrapperClasses:i}):i.includes("context-aggregation")?s.getAggregationCompletionItems(r):l?s.getEmptyCompletionItems(a):h&&f&&!g?s.getBeginningCompletionItems(a):h&&m?s.getTermCompletionItems():o}));return function(t){return e.apply(this,arguments)}}(),this.getBeginningCompletionItems=e=>({suggestions:[...this.getEmptyCompletionItems(e).suggestions,...this.getTermCompletionItems().suggestions]}),this.getEmptyCompletionItems=t=>{const{history:r}=t,n=[];if(r&&r.length){const t=(0,G.chain)(r).map((e=>e.query.expr)).filter().uniq().take(5).map(ea).map((t=>function(t,r){const n=Date.now()-864e5,i=r.filter((e=>e.ts>n&&e.query===t.label)),a=i.length,o=i[0];let s=`Queried ${a} times in the last 24h.`;return o&&(s=`${s} Last queried ${(0,e.dateTime)(o.ts).fromNow()}.`),Ki(Yi({},t),{documentation:s})}(t,r))).value();n.push({searchFunctionType:a.SearchFunctionType.Prefix,skipSort:!0,label:"History",items:t})}return{suggestions:n}},this.getTermCompletionItems=()=>{const{metrics:e,metricsMetadata:t}=this,r=[];return r.push({searchFunctionType:a.SearchFunctionType.Prefix,label:"Functions",items:z.map(ta)}),e&&e.length&&r.push({label:"Metrics",items:e.map((e=>function(e,t){const r={label:e};return t&&t[e]&&(r.documentation=ra(e,t)),r}(e,t))),searchFunctionType:a.SearchFunctionType.Fuzzy}),{suggestions:r}};var l=this;this.getAggregationCompletionItems=function(){var e=Gi((function*(e){const t=[];let r;const n=e.document.getBlocks().reduce(((t,n)=>{if(void 0===t)return"";if(!n)return t;const i=null==n?void 0:n.getText();return e.anchorBlock.key===n.key&&(r=e.selection.anchor.offset+t.length),t+i}),""),i=n.lastIndexOf("(",r);let o=n.lastIndexOf("(",i-1),s=n.indexOf(")",o);if(-1===o){const e=n.indexOf(")",r);s=n.indexOf(")",e+1),o=n.lastIndexOf("(",s)}const c={suggestions:t,context:"context-aggregation"};if(-1===o)return c;const u=n.slice(o+1,s).replace(/\[[^\]]+\]$/,""),d=Li(u,u.length-2).selector,p=yield l.getSeries(d),h=Object.keys(p);if(h.length>0){const e=Bi(h);t.push({label:`Labels${e}`,items:h.map(ea),searchFunctionType:a.SearchFunctionType.Fuzzy})}return c}));return function(t){return e.apply(this,arguments)}}();var c=this;this.getLabelCompletionItems=function(){var e=Gi((function*({text:e,wrapperClasses:t,labelKey:r,value:n}){if(!n)return{suggestions:[]};const i=[],o=n.anchorBlock.getText(),s=n.selection.anchor.offset,l=o.substr(s),u=o.substr(0,s),d=e.match(/^(=|=~|!=|!~)/),p=l.match(/^"?[,}]|$/),h=u.match(/(=|=~|!=|!~)$/)&&l.match(/^"/);if((!d||!p)&&(!p||d)||h)return{suggestions:i};let f,m;try{m=Li(o,s),f=m.selector}catch(e){f="{}"}const g=f.includes("__name__="),b=m?m.labelKeys:[];let v,y={};if(f&&(y=yield c.getSeries(f,!g)),0===Object.keys(y).length)return console.warn(`Server did not return any values for selector = ${f}`),{suggestions:i};if(e&&d||t.includes("attr-value")){if(r&&y[r]){v="context-label-values";const e=Bi(y[r]);i.push({label:`Label values for "${r}"${e}`,items:y[r].map(ea),searchFunctionType:a.SearchFunctionType.Fuzzy})}}else{const e=y?Object.keys(y):g?null:Ji;if(e){const t=(0,G.difference)(e,b);if(t.length){v="context-labels";const e=t.map((e=>({label:e}))),r={label:`Labels${Bi(e)}`,items:e,searchFunctionType:a.SearchFunctionType.Fuzzy};i.push(r)}}}return{context:v,suggestions:i}}));return function(t){return e.apply(this,arguments)}}();var u=this;this.fetchLabelValues=function(){var e=Gi((function*(e){const t=u.datasource.getTimeRangeParams(),r=`/api/v1/label/${u.datasource.interpolateString(e)}/values`;return yield u.request(r,[],t)}));return function(t){return e.apply(this,arguments)}}();var d=this;this.fetchSeriesLabels=function(){var e=Gi((function*(e,t){const r=d.datasource.interpolateString(e),n=d.datasource.getTimeRangeParams(),i=Ki(Yi({},n),{"match[]":r}),a=`/api/v1/series?${new URLSearchParams({"match[]":r,start:$i(parseInt(n.start,10)).toString(),end:$i(parseInt(n.end,10)).toString(),withName:t?"true":"false"}).toString()}`;let o=d.labelsCache.get(a);if(!o){const e=yield d.request("/api/v1/series",[],i),{values:r}=function(e,t=!1){const r={};e.forEach((e=>{const{__name__:n}=e,i=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,["__name__"]);t&&(r.__name__=r.__name__||new Set,r.__name__.has(n)||r.__name__.add(n)),Object.keys(i).forEach((e=>{r[e]||(r[e]=new Set),r[e].has(i[e])||r[e].add(i[e])}))}));const n={};return Mi(Object.keys(r)).forEach((e=>{n[e]=Mi(Array.from(r[e]))})),{values:n,keys:Object.keys(n)}}(e,t);o=r,d.labelsCache.set(a,o)}return o}));return function(t,r){return e.apply(this,arguments)}}();var p=this;this.fetchSeries=function(){var e=Gi((function*(e){const t=Ki(Yi({},p.datasource.getTimeRangeParams()),{"match[]":e});return yield p.request("/api/v1/series",{},t)}));return function(t){return e.apply(this,arguments)}}();var h=this;this.fetchDefaultSeries=(0,G.once)(Gi((function*(){const e=yield Promise.all(Ji.map((e=>h.fetchLabelValues(e))));return Ji.reduce(((t,r,n)=>Ki(Yi({},t),{[r]:e[n]})),{})}))),this.datasource=t,this.histogramMetrics=[],this.timeRange={start:0,end:0},this.metrics=[],Object.assign(this,r)}}var aa=m(7667);function oa(e,t,r,n,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function sa(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function o(e){oa(a,n,i,o,s,"next",e)}function s(e){oa(a,n,i,o,s,"throw",e)}o(void 0)}))}}function la(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ca(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){la(e,t,r[t])}))}return e}function ua(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function da({item:n,defaultOp:i,onChange:o,onDelete:s,onGetLabelNames:c,onGetLabelValues:u}){const[d,p]=(0,t.useState)({}),h=()=>{var e;return null===(e=pa.find((e=>e.label===n.op)))||void 0===e?void 0:e.isMultiValue},f=e=>e?e.indexOf("|")>0?e.split("|"):[e]:[];var m;return r().createElement("div",{"data-testid":"prometheus-dimensions-filter-item"},r().createElement(B,null,r().createElement(a.Select,{placeholder:"Select label","aria-label":aa.selectors.components.QueryBuilder.labelSelect,inputId:"prometheus-dimensions-filter-item-key",width:"auto",value:n.label?(0,e.toOption)(n.label):null,allowCustomValue:!0,onOpenMenu:sa((function*(){p({isLoadingLabelNames:!0});const e=yield c(n);p({labelNames:e,isLoadingLabelNames:void 0})})),isLoading:d.isLoadingLabelNames,options:d.labelNames,onChange:e=>{var t;e.label&&o(ua(ca({},n),{op:null!==(t=n.op)&&void 0!==t?t:i,label:e.label}))}}),r().createElement(a.Select,{"aria-label":aa.selectors.components.QueryBuilder.matchOperatorSelect,value:(0,e.toOption)(null!==(m=n.op)&&void 0!==m?m:i),options:pa,width:"auto",onChange:e=>{null!=e.value&&o(ua(ca({},n),{op:e.value}))}}),r().createElement(a.Select,{placeholder:"Select value","aria-label":aa.selectors.components.QueryBuilder.valueSelect,inputId:"prometheus-dimensions-filter-item-value",width:"auto",value:h()?f(null==n?void 0:n.value).map(e.toOption):f(null==n?void 0:n.value).map(e.toOption)[0],allowCustomValue:!0,onOpenMenu:sa((function*(){p({isLoadingLabelValues:!0});const e=yield u(n);p(ua(ca({},d),{labelValues:e,isLoadingLabelValues:void 0}))})),isMulti:h(),isLoading:d.isLoadingLabelValues,options:(()=>{const t=d.labelValues?[...d.labelValues]:[],r=f(null==n?void 0:n.value).map(e.toOption);return(0,G.uniqBy)([...r,...t],"value")})(),onChange:e=>{if(e.value){var t;o(ua(ca({},n),{value:e.value,op:null!==(t=n.op)&&void 0!==t?t:i}))}else{const t=e.map((e=>e.label)).join("|");var r;o(ua(ca({},n),{value:t,op:null!==(r=n.op)&&void 0!==r?r:i}))}}}),r().createElement(l,{"aria-label":"remove",icon:"times",variant:"secondary",onClick:s})))}const pa=[{label:"=~",value:"=~",isMultiValue:!0},{label:"=",value:"=",isMultiValue:!1},{label:"!=",value:"!=",isMultiValue:!1},{label:"!~",value:"!~",isMultiValue:!0}];function ha({labelsFilters:e,onChange:n,onGetLabelNames:i,onGetLabelValues:a,error:o}){const[s,l]=(0,t.useState)([{op:"="}]);return(0,t.useEffect)((()=>{e.length>0?l(e):l([{op:"="}])}),[e]),r().createElement(b,null,r().createElement(E,{label:"Label filters",error:o,invalid:!!o},r().createElement(C,{items:s,onChange:t=>{l(t);const r=t.filter((e=>null!=e.label&&null!=e.value));(0,G.isEqual)(r,e)||n(r)},renderItem:(e,t,n)=>r().createElement(da,{item:e,defaultOp:"=",onChange:t,onDelete:n,onGetLabelNames:i,onGetLabelValues:a})})))}function fa({title:t,stepNumber:n,markdown:i,children:o}){const s=(0,a.useStyles2)(ma);return r().createElement("div",{className:s.box},void 0!==n&&r().createElement("div",{className:s.stepNumber},n),r().createElement("div",{className:s.boxInner},t&&r().createElement("div",{className:s.header},r().createElement("span",null,t)),r().createElement("div",{className:s.body},i&&r().createElement("div",{dangerouslySetInnerHTML:{__html:(0,e.renderMarkdown)(i)}}),o)))}const ma=e=>({box:(0,o.css)({background:e.colors.background.secondary,padding:e.spacing(1),borderRadius:e.shape.borderRadius(),position:"relative"}),boxInner:(0,o.css)({marginLeft:e.spacing(4)}),stepNumber:(0,o.css)({fontWeight:e.typography.fontWeightMedium,background:e.colors.secondary.main,width:"20px",height:"20px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",top:"10px",left:"11px",fontSize:e.typography.bodySmall.fontSize}),header:(0,o.css)({paddingBottom:e.spacing(.5),display:"flex",alignItems:"center",fontFamily:e.typography.fontFamilyMonospace}),body:(0,o.css)({color:e.colors.text.secondary,"p:last-child":{margin:0},a:{color:e.colors.text.link,textDecoration:"underline"}})});function ga(e,t){return ga=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ga(e,t)}function ba(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,ga(e,t)}function va(){return va=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},va.apply(this,arguments)}var ya=m(3929);function Oa(e,r){var n=(0,t.useState)((function(){return{inputs:r,result:e()}}))[0],i=(0,t.useRef)(!0),a=(0,t.useRef)(n),o=i.current||Boolean(r&&a.current.inputs&&function(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}(r,a.current.inputs)),s=o?a.current:{inputs:r,result:e()};return(0,t.useEffect)((function(){i.current=!1,a.current=s}),[s]),s.result}var xa=Oa,wa=function(e,t){return Oa((function(){return e}),t)},_a=function(e){var t=e.top,r=e.right,n=e.bottom,i=e.left;return{top:t,right:r,bottom:n,left:i,width:r-i,height:n-t,x:i,y:t,center:{x:(r+i)/2,y:(n+t)/2}}},Sa=function(e,t){return{top:e.top-t.top,left:e.left-t.left,bottom:e.bottom+t.bottom,right:e.right+t.right}},Ea=function(e,t){return{top:e.top+t.top,left:e.left+t.left,bottom:e.bottom-t.bottom,right:e.right-t.right}},ka={top:0,right:0,bottom:0,left:0},Pa=function(e){var t=e.borderBox,r=e.margin,n=void 0===r?ka:r,i=e.border,a=void 0===i?ka:i,o=e.padding,s=void 0===o?ka:o,l=_a(Sa(t,n)),c=_a(Ea(t,a)),u=_a(Ea(c,s));return{marginBox:l,borderBox:_a(t),paddingBox:c,contentBox:u,margin:n,border:a,padding:s}},Ta=function(e){var t=e.slice(0,-2);if("px"!==e.slice(-2))return 0;var r=Number(t);return isNaN(r)&&function(e,t){throw new Error("Invariant failed")}(),r},Ca=function(e,t){var r,n,i=e.borderBox,a=e.border,o=e.margin,s=e.padding,l=(n=t,{top:(r=i).top+n.y,left:r.left+n.x,bottom:r.bottom+n.y,right:r.right+n.x});return Pa({borderBox:l,border:a,margin:o,padding:s})},Ia=function(e,t){return void 0===t&&(t={x:window.pageXOffset,y:window.pageYOffset}),Ca(e,t)},Da=function(e,t){var r={top:Ta(t.marginTop),right:Ta(t.marginRight),bottom:Ta(t.marginBottom),left:Ta(t.marginLeft)},n={top:Ta(t.paddingTop),right:Ta(t.paddingRight),bottom:Ta(t.paddingBottom),left:Ta(t.paddingLeft)},i={top:Ta(t.borderTopWidth),right:Ta(t.borderRightWidth),bottom:Ta(t.borderBottomWidth),left:Ta(t.borderLeftWidth)};return Pa({borderBox:e,margin:r,padding:n,border:i})},Aa=function(e){var t=e.getBoundingClientRect(),r=window.getComputedStyle(e);return Da(t,r)},Ra=Number.isNaN||function(e){return"number"==typeof e&&e!=e};function ja(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!((n=e[r])===(i=t[r])||Ra(n)&&Ra(i)))return!1;var n,i;return!0}const Na=function(e,t){var r;void 0===t&&(t=ja);var n,i=[],a=!1;return function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];return a&&r===this&&t(o,i)||(n=e.apply(this,o),a=!0,r=this,i=o),n}},La=function(e){var t=[],r=null,n=function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];t=i,r||(r=requestAnimationFrame((function(){r=null,e.apply(void 0,t)})))};return n.cancel=function(){r&&(cancelAnimationFrame(r),r=null)},n};var qa=m(2729),$a=m.n(qa);function Ma(e,t){}function Ba(){}function Fa(e,t,r){var n=t.map((function(t){var n,i,a=(n=r,i=t.options,va({},n,{},i));return e.addEventListener(t.eventName,t.fn,a),function(){e.removeEventListener(t.eventName,t.fn,a)}}));return function(){n.forEach((function(e){e()}))}}Ma.bind(null,"warn"),Ma.bind(null,"error");function Qa(e){this.message=e}function za(e,t){if(!e)throw new Qa("Invariant failed")}Qa.prototype.toString=function(){return this.message};var Va=function(e){function t(){for(var t,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(t=e.call.apply(e,[this].concat(n))||this).callbacks=null,t.unbind=Ba,t.onWindowError=function(e){var r=t.getCallbacks();r.isDragging()&&r.tryAbort(),e.error instanceof Qa&&e.preventDefault()},t.getCallbacks=function(){if(!t.callbacks)throw new Error("Unable to find AppCallbacks in <ErrorBoundary/>");return t.callbacks},t.setCallbacks=function(e){t.callbacks=e},t}ba(t,e);var r=t.prototype;return r.componentDidMount=function(){this.unbind=Fa(window,[{eventName:"error",fn:this.onWindowError}])},r.componentDidCatch=function(e){if(!(e instanceof Qa))throw e;this.setState({})},r.componentWillUnmount=function(){this.unbind()},r.render=function(){return this.props.children(this.setCallbacks)},t}(r().Component),Ua=function(e){return e+1},Wa=function(e,t){var r=e.droppableId===t.droppableId,n=Ua(e.index),i=Ua(t.index);return r?"\n      You have moved the item from position "+n+"\n      to position "+i+"\n    ":"\n    You have moved the item from position "+n+"\n    in list "+e.droppableId+"\n    to list "+t.droppableId+"\n    in position "+i+"\n  "},Xa=function(e,t,r){return t.droppableId===r.droppableId?"\n      The item "+e+"\n      has been combined with "+r.draggableId:"\n      The item "+e+"\n      in list "+t.droppableId+"\n      has been combined with "+r.draggableId+"\n      in list "+r.droppableId+"\n    "},Ga=function(e){return"\n  The item has returned to its starting position\n  of "+Ua(e.index)+"\n"},Ha=function(e){return"\n  You have lifted an item in position "+Ua(e.source.index)+"\n"},Ya=function(e){var t=e.destination;if(t)return Wa(e.source,t);var r=e.combine;return r?Xa(e.draggableId,e.source,r):"You are over an area that cannot be dropped on"},Ka=function(e){if("CANCEL"===e.reason)return"\n      Movement cancelled.\n      "+Ga(e.source)+"\n    ";var t=e.destination,r=e.combine;return t?"\n      You have dropped the item.\n      "+Wa(e.source,t)+"\n    ":r?"\n      You have dropped the item.\n      "+Xa(e.draggableId,e.source,r)+"\n    ":"\n    The item has been dropped while not over a drop area.\n    "+Ga(e.source)+"\n  "},Ja={x:0,y:0},Za=function(e,t){return{x:e.x+t.x,y:e.y+t.y}},eo=function(e,t){return{x:e.x-t.x,y:e.y-t.y}},to=function(e,t){return e.x===t.x&&e.y===t.y},ro=function(e){return{x:0!==e.x?-e.x:0,y:0!==e.y?-e.y:0}},no=function(e,t,r){var n;return void 0===r&&(r=0),(n={})[e]=t,n["x"===e?"y":"x"]=r,n},io=function(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},ao=function(e,t){return Math.min.apply(Math,t.map((function(t){return io(e,t)})))},oo=function(e){return function(t){return{x:e(t.x),y:e(t.y)}}},so=function(e,t){return{top:e.top+t.y,left:e.left+t.x,bottom:e.bottom+t.y,right:e.right+t.x}},lo=function(e){return[{x:e.left,y:e.top},{x:e.right,y:e.top},{x:e.left,y:e.bottom},{x:e.right,y:e.bottom}]},co=function(e,t){return t&&t.shouldClipSubject?function(e,t){var r=_a({top:Math.max(t.top,e.top),right:Math.min(t.right,e.right),bottom:Math.min(t.bottom,e.bottom),left:Math.max(t.left,e.left)});return r.width<=0||r.height<=0?null:r}(t.pageMarginBox,e):_a(e)},uo=function(e){var t=e.page,r=e.withPlaceholder,n=e.axis,i=e.frame,a=function(e,t){return t?so(e,t.scroll.diff.displacement):e}(t.marginBox,i),o=function(e,t,r){var n;return r&&r.increasedBy?va({},e,((n={})[t.end]=e[t.end]+r.increasedBy[t.line],n)):e}(a,n,r);return{page:t,withPlaceholder:r,active:co(o,i)}},po=function(e,t){e.frame||za(!1);var r=e.frame,n=eo(t,r.scroll.initial),i=ro(n),a=va({},r,{scroll:{initial:r.scroll.initial,current:t,diff:{value:n,displacement:i},max:r.scroll.max}});return va({},e,{frame:a,subject:uo({page:e.subject.page,withPlaceholder:e.subject.withPlaceholder,axis:e.axis,frame:a})})};function ho(e){return Object.values?Object.values(e):Object.keys(e).map((function(t){return e[t]}))}function fo(e,t){if(e.findIndex)return e.findIndex(t);for(var r=0;r<e.length;r++)if(t(e[r]))return r;return-1}function mo(e,t){if(e.find)return e.find(t);var r=fo(e,t);return-1!==r?e[r]:void 0}function go(e){return Array.prototype.slice.call(e)}var bo=Na((function(e){return e.reduce((function(e,t){return e[t.descriptor.id]=t,e}),{})})),vo=Na((function(e){return e.reduce((function(e,t){return e[t.descriptor.id]=t,e}),{})})),yo=Na((function(e){return ho(e)})),Oo=Na((function(e){return ho(e)})),xo=Na((function(e,t){var r=Oo(t).filter((function(t){return e===t.descriptor.droppableId})).sort((function(e,t){return e.descriptor.index-t.descriptor.index}));return r}));function wo(e){return e.at&&"REORDER"===e.at.type?e.at.destination:null}function _o(e){return e.at&&"COMBINE"===e.at.type?e.at.combine:null}var So=Na((function(e,t){return t.filter((function(t){return t.descriptor.id!==e.descriptor.id}))})),Eo=function(e,t){return e.descriptor.droppableId===t.descriptor.id},ko={point:Ja,value:0},Po={invisible:{},visible:{},all:[]},To={displaced:Po,displacedBy:ko,at:null},Co=function(e,t){return function(r){return e<=r&&r<=t}},Io=function(e){var t=Co(e.top,e.bottom),r=Co(e.left,e.right);return function(n){if(t(n.top)&&t(n.bottom)&&r(n.left)&&r(n.right))return!0;var i=t(n.top)||t(n.bottom),a=r(n.left)||r(n.right);if(i&&a)return!0;var o=n.top<e.top&&n.bottom>e.bottom,s=n.left<e.left&&n.right>e.right;return!(!o||!s)||o&&a||s&&i}},Do=function(e){var t=Co(e.top,e.bottom),r=Co(e.left,e.right);return function(e){return t(e.top)&&t(e.bottom)&&r(e.left)&&r(e.right)}},Ao={direction:"vertical",line:"y",crossAxisLine:"x",start:"top",end:"bottom",size:"height",crossAxisStart:"left",crossAxisEnd:"right",crossAxisSize:"width"},Ro={direction:"horizontal",line:"x",crossAxisLine:"y",start:"left",end:"right",size:"width",crossAxisStart:"top",crossAxisEnd:"bottom",crossAxisSize:"height"},jo=function(e){var t=e.target,r=e.destination,n=e.viewport,i=e.withDroppableDisplacement,a=e.isVisibleThroughFrameFn,o=i?function(e,t){var r=t.frame?t.frame.scroll.diff.displacement:Ja;return so(e,r)}(t,r):t;return function(e,t,r){return!!t.subject.active&&r(t.subject.active)(e)}(o,r,a)&&function(e,t,r){return r(t)(e)}(o,n,a)},No=function(e){return jo(va({},e,{isVisibleThroughFrameFn:Do}))};function Lo(e){var t=e.afterDragging,r=e.destination,n=e.displacedBy,i=e.viewport,a=e.forceShouldAnimate,o=e.last;return t.reduce((function(e,t){var s=function(e,t){var r=e.page.marginBox,n={top:t.point.y,right:0,bottom:0,left:t.point.x};return _a(Sa(r,n))}(t,n),l=t.descriptor.id;if(e.all.push(l),!jo(va({},{target:s,destination:r,viewport:i,withDroppableDisplacement:!0},{isVisibleThroughFrameFn:Io})))return e.invisible[t.descriptor.id]=!0,e;var c=function(e,t,r){if("boolean"==typeof r)return r;if(!t)return!0;var n=t.invisible,i=t.visible;if(n[e])return!1;var a=i[e];return!a||a.shouldAnimate}(l,o,a),u={draggableId:l,shouldAnimate:c};return e.visible[l]=u,e}),{all:[],visible:{},invisible:{}})}function qo(e){var t=e.insideDestination,r=e.inHomeList,n=e.displacedBy,i=e.destination,a=function(e,t){if(!e.length)return 0;var r=e[e.length-1].descriptor.index;return t.inHomeList?r:r+1}(t,{inHomeList:r});return{displaced:Po,displacedBy:n,at:{type:"REORDER",destination:{droppableId:i.descriptor.id,index:a}}}}function $o(e){var t=e.draggable,r=e.insideDestination,n=e.destination,i=e.viewport,a=e.displacedBy,o=e.last,s=e.index,l=e.forceShouldAnimate,c=Eo(t,n);if(null==s)return qo({insideDestination:r,inHomeList:c,displacedBy:a,destination:n});var u=mo(r,(function(e){return e.descriptor.index===s}));if(!u)return qo({insideDestination:r,inHomeList:c,displacedBy:a,destination:n});var d=So(t,r),p=r.indexOf(u);return{displaced:Lo({afterDragging:d.slice(p),destination:n,displacedBy:a,last:o,viewport:i.frame,forceShouldAnimate:l}),displacedBy:a,at:{type:"REORDER",destination:{droppableId:n.descriptor.id,index:s}}}}function Mo(e,t){return Boolean(t.effected[e])}var Bo=function(e,t){return t.margin[e.start]+t.borderBox[e.size]/2},Fo=function(e,t,r){return t[e.crossAxisStart]+r.margin[e.crossAxisStart]+r.borderBox[e.crossAxisSize]/2},Qo=function(e){var t=e.axis,r=e.moveRelativeTo,n=e.isMoving;return no(t.line,r.marginBox[t.end]+Bo(t,n),Fo(t,r.marginBox,n))},zo=function(e){var t=e.axis,r=e.moveRelativeTo,n=e.isMoving;return no(t.line,r.marginBox[t.start]-function(e,t){return t.margin[e.end]+t.borderBox[e.size]/2}(t,n),Fo(t,r.marginBox,n))},Vo=function(e,t){var r=e.frame;return r?Za(t,r.scroll.diff.displacement):t},Uo=function(e){var t=function(e){var t=e.impact,r=e.draggable,n=e.droppable,i=e.draggables,a=e.afterCritical,o=r.page.borderBox.center,s=t.at;return n&&s?"REORDER"===s.type?function(e){var t=e.impact,r=e.draggable,n=e.draggables,i=e.droppable,a=e.afterCritical,o=xo(i.descriptor.id,n),s=r.page,l=i.axis;if(!o.length)return function(e){var t=e.axis,r=e.moveInto,n=e.isMoving;return no(t.line,r.contentBox[t.start]+Bo(t,n),Fo(t,r.contentBox,n))}({axis:l,moveInto:i.page,isMoving:s});var c=t.displaced,u=t.displacedBy,d=c.all[0];if(d){var p=n[d];if(Mo(d,a))return zo({axis:l,moveRelativeTo:p.page,isMoving:s});var h=Ca(p.page,u.point);return zo({axis:l,moveRelativeTo:h,isMoving:s})}var f=o[o.length-1];if(f.descriptor.id===r.descriptor.id)return s.borderBox.center;if(Mo(f.descriptor.id,a)){var m=Ca(f.page,ro(a.displacedBy.point));return Qo({axis:l,moveRelativeTo:m,isMoving:s})}return Qo({axis:l,moveRelativeTo:f.page,isMoving:s})}({impact:t,draggable:r,draggables:i,droppable:n,afterCritical:a}):function(e){var t=e.afterCritical,r=e.impact,n=e.draggables,i=_o(r);i||za(!1);var a=i.draggableId,o=n[a].page.borderBox.center,s=function(e){var t=e.displaced,r=e.afterCritical,n=e.combineWith,i=e.displacedBy,a=Boolean(t.visible[n]||t.invisible[n]);return Mo(n,r)?a?Ja:ro(i.point):a?i.point:Ja}({displaced:r.displaced,afterCritical:t,combineWith:a,displacedBy:r.displacedBy});return Za(o,s)}({impact:t,draggables:i,afterCritical:a}):o}(e),r=e.droppable;return r?Vo(r,t):t},Wo=function(e,t){var r=eo(t,e.scroll.initial),n=ro(r);return{frame:_a({top:t.y,bottom:t.y+e.frame.height,left:t.x,right:t.x+e.frame.width}),scroll:{initial:e.scroll.initial,max:e.scroll.max,current:t,diff:{value:r,displacement:n}}}};function Xo(e,t){return e.map((function(e){return t[e]}))}var Go=function(e){var t=e.pageBorderBoxCenter,r=e.draggable,n=function(e,t){return Za(e.scroll.diff.displacement,t)}(e.viewport,t),i=eo(n,r.page.borderBox.center);return Za(r.client.borderBox.center,i)},Ho=function(e){var t=e.draggable,r=e.destination,n=e.newPageBorderBoxCenter,i=e.viewport,a=e.withDroppableDisplacement,o=e.onlyOnMainAxis,s=void 0!==o&&o,l=eo(n,t.page.borderBox.center),c={target:so(t.page.borderBox,l),destination:r,withDroppableDisplacement:a,viewport:i};return s?function(e){return jo(va({},e,{isVisibleThroughFrameFn:(t=e.destination.axis,function(e){var r=Co(e.top,e.bottom),n=Co(e.left,e.right);return function(e){return t===Ao?r(e.top)&&r(e.bottom):n(e.left)&&n(e.right)}})}));var t}(c):No(c)},Yo=function(e){var t=e.isMovingForward,r=e.draggable,n=e.destination,i=e.draggables,a=e.previousImpact,o=e.viewport,s=e.previousPageBorderBoxCenter,l=e.previousClientSelection,c=e.afterCritical;if(!n.isEnabled)return null;var u=xo(n.descriptor.id,i),d=Eo(r,n),p=function(e){var t=e.isMovingForward,r=e.draggable,n=e.destination,i=e.insideDestination,a=e.previousImpact;if(!n.isCombineEnabled)return null;if(!wo(a))return null;function o(e){var t={type:"COMBINE",combine:{draggableId:e,droppableId:n.descriptor.id}};return va({},a,{at:t})}var s=a.displaced.all,l=s.length?s[0]:null;if(t)return l?o(l):null;var c=So(r,i);if(!l)return c.length?o(c[c.length-1].descriptor.id):null;var u=fo(c,(function(e){return e.descriptor.id===l}));-1===u&&za(!1);var d=u-1;return d<0?null:o(c[d].descriptor.id)}({isMovingForward:t,draggable:r,destination:n,insideDestination:u,previousImpact:a})||function(e){var t=e.isMovingForward,r=e.isInHomeList,n=e.draggable,i=e.draggables,a=e.destination,o=e.insideDestination,s=e.previousImpact,l=e.viewport,c=e.afterCritical,u=s.at;if(u||za(!1),"REORDER"===u.type){var d=function(e){var t=e.isMovingForward,r=e.isInHomeList,n=e.insideDestination,i=e.location;if(!n.length)return null;var a=i.index,o=t?a+1:a-1,s=n[0].descriptor.index,l=n[n.length-1].descriptor.index;return o<s||o>(r?l:l+1)?null:o}({isMovingForward:t,isInHomeList:r,location:u.destination,insideDestination:o});return null==d?null:$o({draggable:n,insideDestination:o,destination:a,viewport:l,last:s.displaced,displacedBy:s.displacedBy,index:d})}var p=function(e){var t=e.isMovingForward,r=e.draggables,n=e.combine,i=e.afterCritical;if(!e.destination.isCombineEnabled)return null;var a=n.draggableId,o=r[a].descriptor.index;return Mo(a,i)?t?o:o-1:t?o+1:o}({isMovingForward:t,destination:a,displaced:s.displaced,draggables:i,combine:u.combine,afterCritical:c});return null==p?null:$o({draggable:n,insideDestination:o,destination:a,viewport:l,last:s.displaced,displacedBy:s.displacedBy,index:p})}({isMovingForward:t,isInHomeList:d,draggable:r,draggables:i,destination:n,insideDestination:u,previousImpact:a,viewport:o,afterCritical:c});if(!p)return null;var h=Uo({impact:p,draggable:r,droppable:n,draggables:i,afterCritical:c});if(Ho({draggable:r,destination:n,newPageBorderBoxCenter:h,viewport:o.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0}))return{clientSelection:Go({pageBorderBoxCenter:h,draggable:r,viewport:o}),impact:p,scrollJumpRequest:null};var f=eo(h,s),m=function(e){var t=e.impact,r=e.viewport,n=e.destination,i=e.draggables,a=e.maxScrollChange,o=Wo(r,Za(r.scroll.current,a)),s=n.frame?po(n,Za(n.frame.scroll.current,a)):n,l=t.displaced,c=Lo({afterDragging:Xo(l.all,i),destination:n,displacedBy:t.displacedBy,viewport:o.frame,last:l,forceShouldAnimate:!1}),u=Lo({afterDragging:Xo(l.all,i),destination:s,displacedBy:t.displacedBy,viewport:r.frame,last:l,forceShouldAnimate:!1}),d={},p={},h=[l,c,u];return l.all.forEach((function(e){var t=function(e,t){for(var r=0;r<t.length;r++){var n=t[r].visible[e];if(n)return n}return null}(e,h);t?p[e]=t:d[e]=!0})),va({},t,{displaced:{all:l.all,invisible:d,visible:p}})}({impact:p,viewport:o,destination:n,draggables:i,maxScrollChange:f});return{clientSelection:l,impact:m,scrollJumpRequest:f}},Ko=function(e){var t=e.subject.active;return t||za(!1),t},Jo=function(e,t){var r=e.page.borderBox.center;return Mo(e.descriptor.id,t)?eo(r,t.displacedBy.point):r},Zo=function(e,t){var r=e.page.borderBox;return Mo(e.descriptor.id,t)?so(r,ro(t.displacedBy.point)):r},es=Na((function(e,t){var r=t[e.line];return{value:r,point:no(e.line,r)}})),ts=function(e,t){return va({},e,{scroll:va({},e.scroll,{max:t})})},rs=function(e,t,r){var n=e.frame;Eo(t,e)&&za(!1),e.subject.withPlaceholder&&za(!1);var i=es(e.axis,t.displaceBy).point,a=function(e,t,r){var n=e.axis;if("virtual"===e.descriptor.mode)return no(n.line,t[n.line]);var i=e.subject.page.contentBox[n.size],a=xo(e.descriptor.id,r).reduce((function(e,t){return e+t.client.marginBox[n.size]}),0)+t[n.line]-i;return a<=0?null:no(n.line,a)}(e,i,r),o={placeholderSize:i,increasedBy:a,oldFrameMaxScroll:e.frame?e.frame.scroll.max:null};if(!n)return va({},e,{subject:uo({page:e.subject.page,withPlaceholder:o,axis:e.axis,frame:e.frame})});var s=a?Za(n.scroll.max,a):n.scroll.max,l=ts(n,s);return va({},e,{subject:uo({page:e.subject.page,withPlaceholder:o,axis:e.axis,frame:l}),frame:l})},ns=function(e){var t=e.at;return t?"REORDER"===t.type?t.destination.droppableId:t.combine.droppableId:null},is=function(e){var t=e.state,r=e.type,n=function(e,t){var r=ns(e);return r?t[r]:null}(t.impact,t.dimensions.droppables),i=Boolean(n),a=t.dimensions.droppables[t.critical.droppable.id],o=n||a,s=o.axis.direction,l="vertical"===s&&("MOVE_UP"===r||"MOVE_DOWN"===r)||"horizontal"===s&&("MOVE_LEFT"===r||"MOVE_RIGHT"===r);if(l&&!i)return null;var c="MOVE_DOWN"===r||"MOVE_RIGHT"===r,u=t.dimensions.draggables[t.critical.draggable.id],d=t.current.page.borderBoxCenter,p=t.dimensions,h=p.draggables,f=p.droppables;return l?Yo({isMovingForward:c,previousPageBorderBoxCenter:d,draggable:u,destination:o,draggables:h,viewport:t.viewport,previousClientSelection:t.current.client.selection,previousImpact:t.impact,afterCritical:t.afterCritical}):function(e){var t=e.isMovingForward,r=e.previousPageBorderBoxCenter,n=e.draggable,i=e.isOver,a=e.draggables,o=e.droppables,s=e.viewport,l=e.afterCritical,c=function(e){var t=e.isMovingForward,r=e.pageBorderBoxCenter,n=e.source,i=e.droppables,a=e.viewport,o=n.subject.active;if(!o)return null;var s=n.axis,l=Co(o[s.start],o[s.end]),c=yo(i).filter((function(e){return e!==n})).filter((function(e){return e.isEnabled})).filter((function(e){return Boolean(e.subject.active)})).filter((function(e){return Io(a.frame)(Ko(e))})).filter((function(e){var r=Ko(e);return t?o[s.crossAxisEnd]<r[s.crossAxisEnd]:r[s.crossAxisStart]<o[s.crossAxisStart]})).filter((function(e){var t=Ko(e),r=Co(t[s.start],t[s.end]);return l(t[s.start])||l(t[s.end])||r(o[s.start])||r(o[s.end])})).sort((function(e,r){var n=Ko(e)[s.crossAxisStart],i=Ko(r)[s.crossAxisStart];return t?n-i:i-n})).filter((function(e,t,r){return Ko(e)[s.crossAxisStart]===Ko(r[0])[s.crossAxisStart]}));if(!c.length)return null;if(1===c.length)return c[0];var u=c.filter((function(e){return Co(Ko(e)[s.start],Ko(e)[s.end])(r[s.line])}));return 1===u.length?u[0]:u.length>1?u.sort((function(e,t){return Ko(e)[s.start]-Ko(t)[s.start]}))[0]:c.sort((function(e,t){var n=ao(r,lo(Ko(e))),i=ao(r,lo(Ko(t)));return n!==i?n-i:Ko(e)[s.start]-Ko(t)[s.start]}))[0]}({isMovingForward:t,pageBorderBoxCenter:r,source:i,droppables:o,viewport:s});if(!c)return null;var u=xo(c.descriptor.id,a),d=function(e){var t=e.pageBorderBoxCenter,r=e.viewport,n=e.destination,i=e.afterCritical,a=e.insideDestination.filter((function(e){return No({target:Zo(e,i),destination:n,viewport:r.frame,withDroppableDisplacement:!0})})).sort((function(e,r){var a=io(t,Vo(n,Jo(e,i))),o=io(t,Vo(n,Jo(r,i)));return a<o?-1:o<a?1:e.descriptor.index-r.descriptor.index}));return a[0]||null}({pageBorderBoxCenter:r,viewport:s,destination:c,insideDestination:u,afterCritical:l}),p=function(e){var t=e.previousPageBorderBoxCenter,r=e.moveRelativeTo,n=e.insideDestination,i=e.draggable,a=e.draggables,o=e.destination,s=e.viewport,l=e.afterCritical;if(!r){if(n.length)return null;var c={displaced:Po,displacedBy:ko,at:{type:"REORDER",destination:{droppableId:o.descriptor.id,index:0}}},u=Uo({impact:c,draggable:i,droppable:o,draggables:a,afterCritical:l}),d=Eo(i,o)?o:rs(o,i,a);return Ho({draggable:i,destination:d,newPageBorderBoxCenter:u,viewport:s.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0})?c:null}var p,h=Boolean(t[o.axis.line]<=r.page.borderBox.center[o.axis.line]),f=(p=r.descriptor.index,r.descriptor.id===i.descriptor.id||h?p:p+1);return $o({draggable:i,insideDestination:n,destination:o,viewport:s,displacedBy:es(o.axis,i.displaceBy),last:Po,index:f})}({previousPageBorderBoxCenter:r,destination:c,draggable:n,draggables:a,moveRelativeTo:d,insideDestination:u,viewport:s,afterCritical:l});if(!p)return null;var h=Uo({impact:p,draggable:n,droppable:c,draggables:a,afterCritical:l});return{clientSelection:Go({pageBorderBoxCenter:h,draggable:n,viewport:s}),impact:p,scrollJumpRequest:null}}({isMovingForward:c,previousPageBorderBoxCenter:d,draggable:u,isOver:o,draggables:h,droppables:f,viewport:t.viewport,afterCritical:t.afterCritical})};function as(e){return"DRAGGING"===e.phase||"COLLECTING"===e.phase}function os(e){var t=Co(e.top,e.bottom),r=Co(e.left,e.right);return function(e){return t(e.y)&&r(e.x)}}var ss=function(e,t){return _a(so(e,t))};function ls(e){var t=e.displaced,r=e.id;return Boolean(t.visible[r]||t.invisible[r])}var cs=function(e){var t=e.pageOffset,r=e.draggable,n=e.draggables,i=e.droppables,a=e.previousImpact,o=e.viewport,s=e.afterCritical,l=ss(r.page.borderBox,t),c=function(e){var t=e.pageBorderBox,r=e.draggable,n=e.droppables,i=yo(n).filter((function(e){if(!e.isEnabled)return!1;var r,n,i=e.subject.active;if(!i)return!1;if(n=i,!((r=t).left<n.right&&r.right>n.left&&r.top<n.bottom&&r.bottom>n.top))return!1;if(os(i)(t.center))return!0;var a=e.axis,o=i.center[a.crossAxisLine],s=t[a.crossAxisStart],l=t[a.crossAxisEnd],c=Co(i[a.crossAxisStart],i[a.crossAxisEnd]),u=c(s),d=c(l);return!u&&!d||(u?s<o:l>o)}));return i.length?1===i.length?i[0].descriptor.id:function(e){var t=e.pageBorderBox,r=e.candidates,n=e.draggable.page.borderBox.center,i=r.map((function(e){var r=e.axis,i=no(e.axis.line,t.center[r.line],e.page.borderBox.center[r.crossAxisLine]);return{id:e.descriptor.id,distance:io(n,i)}})).sort((function(e,t){return t.distance-e.distance}));return i[0]?i[0].id:null}({pageBorderBox:t,draggable:r,candidates:i}):null}({pageBorderBox:l,draggable:r,droppables:i});if(!c)return To;var u=i[c],d=xo(u.descriptor.id,n),p=function(e,t){var r=e.frame;return r?ss(t,r.scroll.diff.value):t}(u,l);return function(e){var t=e.draggable,r=e.pageBorderBoxWithDroppableScroll,n=e.previousImpact,i=e.destination,a=e.insideDestination,o=e.afterCritical;if(!i.isCombineEnabled)return null;var s=i.axis,l=es(i.axis,t.displaceBy),c=l.value,u=r[s.start],d=r[s.end],p=mo(So(t,a),(function(e){var t=e.descriptor.id,r=e.page.borderBox,i=r[s.size]/4,a=Mo(t,o),l=ls({displaced:n.displaced,id:t});return a?l?d>r[s.start]+i&&d<r[s.end]-i:u>r[s.start]-c+i&&u<r[s.end]-c-i:l?d>r[s.start]+c+i&&d<r[s.end]+c-i:u>r[s.start]+i&&u<r[s.end]-i}));return p?{displacedBy:l,displaced:n.displaced,at:{type:"COMBINE",combine:{draggableId:p.descriptor.id,droppableId:i.descriptor.id}}}:null}({pageBorderBoxWithDroppableScroll:p,draggable:r,previousImpact:a,destination:u,insideDestination:d,afterCritical:s})||function(e){var t=e.pageBorderBoxWithDroppableScroll,r=e.draggable,n=e.destination,i=e.insideDestination,a=e.last,o=e.viewport,s=e.afterCritical,l=n.axis,c=es(n.axis,r.displaceBy),u=c.value,d=t[l.start],p=t[l.end],h=function(e){var t=e.draggable,r=e.closest;return r?e.inHomeList&&r.descriptor.index>t.descriptor.index?r.descriptor.index-1:r.descriptor.index:null}({draggable:r,closest:mo(So(r,i),(function(e){var t=e.descriptor.id,r=e.page.borderBox.center[l.line],n=Mo(t,s),i=ls({displaced:a,id:t});return n?i?p<=r:d<r-u:i?p<=r+u:d<r})),inHomeList:Eo(r,n)});return $o({draggable:r,insideDestination:i,destination:n,viewport:o,last:a,displacedBy:c,index:h})}({pageBorderBoxWithDroppableScroll:p,draggable:r,destination:u,insideDestination:d,last:a.displaced,viewport:o,afterCritical:s})},us=function(e,t){var r;return va({},e,((r={})[t.descriptor.id]=t,r))},ds=function(e){var t=e.state,r=e.clientSelection,n=e.dimensions,i=e.viewport,a=e.impact,o=e.scrollJumpRequest,s=i||t.viewport,l=n||t.dimensions,c=r||t.current.client.selection,u=eo(c,t.initial.client.selection),d={offset:u,selection:c,borderBoxCenter:Za(t.initial.client.borderBoxCenter,u)},p={selection:Za(d.selection,s.scroll.current),borderBoxCenter:Za(d.borderBoxCenter,s.scroll.current),offset:Za(d.offset,s.scroll.diff.value)},h={client:d,page:p};if("COLLECTING"===t.phase)return va({phase:"COLLECTING"},t,{dimensions:l,viewport:s,current:h});var f=l.draggables[t.critical.draggable.id],m=a||cs({pageOffset:p.offset,draggable:f,draggables:l.draggables,droppables:l.droppables,previousImpact:t.impact,viewport:s,afterCritical:t.afterCritical}),g=function(e){var t=e.draggable,r=e.draggables,n=e.droppables,i=e.impact,a=function(e){var t=e.previousImpact,r=e.impact,n=e.droppables,i=ns(t),a=ns(r);if(!i)return n;if(i===a)return n;var o=n[i];if(!o.subject.withPlaceholder)return n;var s=function(e){var t=e.subject.withPlaceholder;t||za(!1);var r=e.frame;if(!r)return va({},e,{subject:uo({page:e.subject.page,axis:e.axis,frame:null,withPlaceholder:null})});var n=t.oldFrameMaxScroll;n||za(!1);var i=ts(r,n);return va({},e,{subject:uo({page:e.subject.page,axis:e.axis,frame:i,withPlaceholder:null}),frame:i})}(o);return us(n,s)}({previousImpact:e.previousImpact,impact:i,droppables:n}),o=ns(i);if(!o)return a;var s=n[o];if(Eo(t,s))return a;if(s.subject.withPlaceholder)return a;var l=rs(s,t,r);return us(a,l)}({draggable:f,impact:m,previousImpact:t.impact,draggables:l.draggables,droppables:l.droppables});return va({},t,{current:h,dimensions:{draggables:l.draggables,droppables:g},impact:m,viewport:s,scrollJumpRequest:o||null,forceShouldAnimate:!o&&null})},ps=function(e){var t=e.impact,r=e.viewport,n=e.draggables,i=e.destination,a=e.forceShouldAnimate,o=t.displaced,s=function(e,t){return e.map((function(e){return t[e]}))}(o.all,n);return va({},t,{displaced:Lo({afterDragging:s,destination:i,displacedBy:t.displacedBy,viewport:r.frame,forceShouldAnimate:a,last:o})})},hs=function(e){var t=e.impact,r=e.draggable,n=e.droppable,i=e.draggables,a=e.viewport,o=e.afterCritical,s=Uo({impact:t,draggable:r,draggables:i,droppable:n,afterCritical:o});return Go({pageBorderBoxCenter:s,draggable:r,viewport:a})},fs=function(e){var t=e.state,r=e.dimensions,n=e.viewport;"SNAP"!==t.movementMode&&za(!1);var i=t.impact,a=n||t.viewport,o=r||t.dimensions,s=o.draggables,l=o.droppables,c=s[t.critical.draggable.id],u=ns(i);u||za(!1);var d=l[u],p=ps({impact:i,viewport:a,destination:d,draggables:s}),h=hs({impact:p,draggable:c,droppable:d,draggables:s,viewport:a,afterCritical:t.afterCritical});return ds({impact:p,clientSelection:h,state:t,dimensions:o,viewport:a})},ms=function(e){var t=e.draggable,r=e.home,n=e.draggables,i=e.viewport,a=es(r.axis,t.displaceBy),o=xo(r.descriptor.id,n),s=o.indexOf(t);-1===s&&za(!1);var l,c=o.slice(s+1),u=c.reduce((function(e,t){return e[t.descriptor.id]=!0,e}),{}),d={inVirtualList:"virtual"===r.descriptor.mode,displacedBy:a,effected:u};return{impact:{displaced:Lo({afterDragging:c,destination:r,displacedBy:a,last:null,viewport:i.frame,forceShouldAnimate:!1}),displacedBy:a,at:{type:"REORDER",destination:(l=t.descriptor,{index:l.index,droppableId:l.droppableId})}},afterCritical:d}},gs=function(e){return"SNAP"===e.movementMode},bs=function(e,t,r){var n=function(e,t){return{draggables:e.draggables,droppables:us(e.droppables,t)}}(e.dimensions,t);return!gs(e)||r?ds({state:e,dimensions:n}):fs({state:e,dimensions:n})};function vs(e){return e.isDragging&&"SNAP"===e.movementMode?va({phase:"DRAGGING"},e,{scrollJumpRequest:null}):e}var ys={phase:"IDLE",completed:null,shouldFlush:!1},Os=function(e,t){if(void 0===e&&(e=ys),"FLUSH"===t.type)return va({},ys,{shouldFlush:!0});if("INITIAL_PUBLISH"===t.type){"IDLE"!==e.phase&&za(!1);var r=t.payload,n=r.critical,i=r.clientSelection,a=r.viewport,o=r.dimensions,s=r.movementMode,l=o.draggables[n.draggable.id],c=o.droppables[n.droppable.id],u={selection:i,borderBoxCenter:l.client.borderBox.center,offset:Ja},d={client:u,page:{selection:Za(u.selection,a.scroll.initial),borderBoxCenter:Za(u.selection,a.scroll.initial),offset:Za(u.selection,a.scroll.diff.value)}},p=yo(o.droppables).every((function(e){return!e.isFixedOnPage})),h=ms({draggable:l,home:c,draggables:o.draggables,viewport:a}),f=h.impact;return{phase:"DRAGGING",isDragging:!0,critical:n,movementMode:s,dimensions:o,initial:d,current:d,isWindowScrollAllowed:p,impact:f,afterCritical:h.afterCritical,onLiftImpact:f,viewport:a,scrollJumpRequest:null,forceShouldAnimate:null}}if("COLLECTION_STARTING"===t.type)return"COLLECTING"===e.phase||"DROP_PENDING"===e.phase?e:("DRAGGING"!==e.phase&&za(!1),va({phase:"COLLECTING"},e,{phase:"COLLECTING"}));if("PUBLISH_WHILE_DRAGGING"===t.type)return"COLLECTING"!==e.phase&&"DROP_PENDING"!==e.phase&&za(!1),function(e){var t=e.state,r=e.published,n=r.modified.map((function(e){var r=t.dimensions.droppables[e.droppableId];return po(r,e.scroll)})),i=va({},t.dimensions.droppables,{},bo(n)),a=vo(function(e){var t=e.additions,r=e.updatedDroppables,n=e.viewport,i=n.scroll.diff.value;return t.map((function(e){var t=e.descriptor.droppableId,a=function(e){var t=e.frame;return t||za(!1),t}(r[t]),o=a.scroll.diff.value,s=function(e){var t=e.draggable,r=e.offset,n=e.initialWindowScroll,i=Ca(t.client,r),a=Ia(i,n);return va({},t,{placeholder:va({},t.placeholder,{client:i}),client:i,page:a})}({draggable:e,offset:Za(i,o),initialWindowScroll:n.scroll.initial});return s}))}({additions:r.additions,updatedDroppables:i,viewport:t.viewport})),o=va({},t.dimensions.draggables,{},a);r.removals.forEach((function(e){delete o[e]}));var s={droppables:i,draggables:o},l=ns(t.impact),c=l?s.droppables[l]:null,u=s.draggables[t.critical.draggable.id],d=s.droppables[t.critical.droppable.id],p=ms({draggable:u,home:d,draggables:o,viewport:t.viewport}),h=p.impact,f=p.afterCritical,m=c&&c.isCombineEnabled?t.impact:h,g=cs({pageOffset:t.current.page.offset,draggable:s.draggables[t.critical.draggable.id],draggables:s.draggables,droppables:s.droppables,previousImpact:m,viewport:t.viewport,afterCritical:f}),b=va({phase:"DRAGGING"},t,{phase:"DRAGGING",impact:g,onLiftImpact:h,dimensions:s,afterCritical:f,forceShouldAnimate:!1});return"COLLECTING"===t.phase?b:va({phase:"DROP_PENDING"},b,{phase:"DROP_PENDING",reason:t.reason,isWaiting:!1})}({state:e,published:t.payload});if("MOVE"===t.type){if("DROP_PENDING"===e.phase)return e;as(e)||za(!1);var m=t.payload.client;return to(m,e.current.client.selection)?e:ds({state:e,clientSelection:m,impact:gs(e)?e.impact:null})}if("UPDATE_DROPPABLE_SCROLL"===t.type){if("DROP_PENDING"===e.phase)return vs(e);if("COLLECTING"===e.phase)return vs(e);as(e)||za(!1);var g=t.payload,b=g.id,v=g.newScroll,y=e.dimensions.droppables[b];if(!y)return e;var O=po(y,v);return bs(e,O,!1)}if("UPDATE_DROPPABLE_IS_ENABLED"===t.type){if("DROP_PENDING"===e.phase)return e;as(e)||za(!1);var x=t.payload,w=x.id,_=x.isEnabled,S=e.dimensions.droppables[w];S||za(!1),S.isEnabled===_&&za(!1);var E=va({},S,{isEnabled:_});return bs(e,E,!0)}if("UPDATE_DROPPABLE_IS_COMBINE_ENABLED"===t.type){if("DROP_PENDING"===e.phase)return e;as(e)||za(!1);var k=t.payload,P=k.id,T=k.isCombineEnabled,C=e.dimensions.droppables[P];C||za(!1),C.isCombineEnabled===T&&za(!1);var I=va({},C,{isCombineEnabled:T});return bs(e,I,!0)}if("MOVE_BY_WINDOW_SCROLL"===t.type){if("DROP_PENDING"===e.phase||"DROP_ANIMATING"===e.phase)return e;as(e)||za(!1),e.isWindowScrollAllowed||za(!1);var D=t.payload.newScroll;if(to(e.viewport.scroll.current,D))return vs(e);var A=Wo(e.viewport,D);return gs(e)?fs({state:e,viewport:A}):ds({state:e,viewport:A})}if("UPDATE_VIEWPORT_MAX_SCROLL"===t.type){if(!as(e))return e;var R=t.payload.maxScroll;if(to(R,e.viewport.scroll.max))return e;var j=va({},e.viewport,{scroll:va({},e.viewport.scroll,{max:R})});return va({phase:"DRAGGING"},e,{viewport:j})}if("MOVE_UP"===t.type||"MOVE_DOWN"===t.type||"MOVE_LEFT"===t.type||"MOVE_RIGHT"===t.type){if("COLLECTING"===e.phase||"DROP_PENDING"===e.phase)return e;"DRAGGING"!==e.phase&&za(!1);var N=is({state:e,type:t.type});return N?ds({state:e,impact:N.impact,clientSelection:N.clientSelection,scrollJumpRequest:N.scrollJumpRequest}):e}if("DROP_PENDING"===t.type){var L=t.payload.reason;return"COLLECTING"!==e.phase&&za(!1),va({phase:"DROP_PENDING"},e,{phase:"DROP_PENDING",isWaiting:!0,reason:L})}if("DROP_ANIMATE"===t.type){var q=t.payload,$=q.completed,M=q.dropDuration,B=q.newHomeClientOffset;return"DRAGGING"!==e.phase&&"DROP_PENDING"!==e.phase&&za(!1),{phase:"DROP_ANIMATING",completed:$,dropDuration:M,newHomeClientOffset:B,dimensions:e.dimensions}}return"DROP_COMPLETE"===t.type?{phase:"IDLE",completed:t.payload.completed,shouldFlush:!1}:e},xs=function(e){return{type:"PUBLISH_WHILE_DRAGGING",payload:e}},ws=function(){return{type:"COLLECTION_STARTING",payload:null}},_s=function(e){return{type:"UPDATE_DROPPABLE_SCROLL",payload:e}},Ss=function(e){return{type:"UPDATE_DROPPABLE_IS_ENABLED",payload:e}},Es=function(e){return{type:"UPDATE_DROPPABLE_IS_COMBINE_ENABLED",payload:e}},ks=function(e){return{type:"MOVE",payload:e}},Ps=function(){return{type:"MOVE_UP",payload:null}},Ts=function(){return{type:"MOVE_DOWN",payload:null}},Cs=function(){return{type:"MOVE_RIGHT",payload:null}},Is=function(){return{type:"MOVE_LEFT",payload:null}},Ds=function(e){return{type:"DROP_COMPLETE",payload:e}},As=function(e){return{type:"DROP",payload:e}},Rs="cubic-bezier(.2,1,.1,1)",js=0,Ns=.7,Ls=.75,qs="0.2s cubic-bezier(0.2, 0, 0, 1)",$s={fluid:"opacity "+qs,snap:"transform "+qs+", opacity "+qs,drop:function(e){var t=e+"s "+Rs;return"transform "+t+", opacity "+t},outOfTheWay:"transform "+qs,placeholder:"height "+qs+", width "+qs+", margin "+qs},Ms=function(e){return to(e,Ja)?null:"translate("+e.x+"px, "+e.y+"px)"},Bs=Ms,Fs=.33,Qs=function(e){var t=e.getState,r=e.dispatch;return function(e){return function(n){if("DROP"===n.type){var i=t(),a=n.payload.reason;if("COLLECTING"!==i.phase){if("IDLE"!==i.phase){"DROP_PENDING"===i.phase&&i.isWaiting&&za(!1),"DRAGGING"!==i.phase&&"DROP_PENDING"!==i.phase&&za(!1);var o=i.critical,s=i.dimensions,l=s.draggables[i.critical.draggable.id],c=function(e){var t=e.draggables,r=e.reason,n=e.lastImpact,i=e.home,a=e.viewport,o=e.onLiftImpact;return n.at&&"DROP"===r?"REORDER"===n.at.type?{impact:n,didDropInsideDroppable:!0}:{impact:va({},n,{displaced:Po}),didDropInsideDroppable:!0}:{impact:ps({draggables:t,impact:o,destination:i,viewport:a,forceShouldAnimate:!0}),didDropInsideDroppable:!1}}({reason:a,lastImpact:i.impact,afterCritical:i.afterCritical,onLiftImpact:i.onLiftImpact,home:i.dimensions.droppables[i.critical.droppable.id],viewport:i.viewport,draggables:i.dimensions.draggables}),u=c.impact,d=c.didDropInsideDroppable,p=d?wo(u):null,h=d?_o(u):null,f={index:o.draggable.index,droppableId:o.droppable.id},m={draggableId:l.descriptor.id,type:l.descriptor.type,source:f,reason:a,mode:i.movementMode,destination:p,combine:h},g=function(e){var t=e.impact,r=e.draggable,n=e.dimensions,i=e.viewport,a=e.afterCritical,o=n.draggables,s=n.droppables,l=ns(t),c=l?s[l]:null,u=s[r.descriptor.droppableId],d=hs({impact:t,draggable:r,draggables:o,afterCritical:a,droppable:c||u,viewport:i});return eo(d,r.client.borderBox.center)}({impact:u,draggable:l,dimensions:s,viewport:i.viewport,afterCritical:i.afterCritical}),b={critical:i.critical,afterCritical:i.afterCritical,result:m,impact:u};if(!to(i.current.client.offset,g)||Boolean(m.combine)){var v=function(e){var t=e.reason,r=io(e.current,e.destination);if(r<=0)return Fs;if(r>=1500)return.55;var n=Fs+r/1500*.22000000000000003;return Number(("CANCEL"===t?.6*n:n).toFixed(2))}({current:i.current.client.offset,destination:g,reason:a});r({type:"DROP_ANIMATE",payload:{newHomeClientOffset:g,dropDuration:v,completed:b}})}else r(Ds({completed:b}))}}else r(function(e){return{type:"DROP_PENDING",payload:e}}({reason:a}))}else e(n)}}},zs=function(){return{x:window.pageXOffset,y:window.pageYOffset}};var Vs=function(e){var t=function(e){var t=e.onWindowScroll,r=La((function(){t(zs())})),n=function(e){return{eventName:"scroll",options:{passive:!0,capture:!1},fn:function(t){t.target!==window&&t.target!==window.document||e()}}}(r),i=Ba;function a(){return i!==Ba}return{start:function(){a()&&za(!1),i=Fa(window,[n])},stop:function(){a()||za(!1),r.cancel(),i(),i=Ba},isActive:a}}({onWindowScroll:function(t){e.dispatch({type:"MOVE_BY_WINDOW_SCROLL",payload:{newScroll:t}})}});return function(e){return function(r){t.isActive()||"INITIAL_PUBLISH"!==r.type||t.start(),t.isActive()&&function(e){return"DROP_COMPLETE"===e.type||"DROP_ANIMATE"===e.type||"FLUSH"===e.type}(r)&&t.stop(),e(r)}}},Us=function(e,t){t()},Ws=function(e,t){return{draggableId:e.draggable.id,type:e.droppable.type,source:{droppableId:e.droppable.id,index:e.draggable.index},mode:t}},Xs=function(e,t,r,n){if(e){var i=function(e){var t=!1,r=!1,n=setTimeout((function(){r=!0})),i=function(i){t||r||(t=!0,e(i),clearTimeout(n))};return i.wasCalled=function(){return t},i}(r);e(t,{announce:i}),i.wasCalled()||r(n(t))}else r(n(t))},Gs=function(e,t){var r=function(e,t){var r,n=(r=[],{add:function(e){var t=setTimeout((function(){return function(e){var t=fo(r,(function(t){return t.timerId===e}));-1===t&&za(!1),r.splice(t,1)[0].callback()}(t)})),n={timerId:t,callback:e};r.push(n)},flush:function(){if(r.length){var e=[].concat(r);r.length=0,e.forEach((function(e){clearTimeout(e.timerId),e.callback()}))}}}),i=null,a=function(r){i||za(!1),i=null,Us(0,(function(){return Xs(e().onDragEnd,r,t,Ka)}))};return{beforeCapture:function(t,r){i&&za(!1),Us(0,(function(){var n=e().onBeforeCapture;n&&n({draggableId:t,mode:r})}))},beforeStart:function(t,r){i&&za(!1),Us(0,(function(){var n=e().onBeforeDragStart;n&&n(Ws(t,r))}))},start:function(r,a){i&&za(!1);var o=Ws(r,a);i={mode:a,lastCritical:r,lastLocation:o.source,lastCombine:null},n.add((function(){Us(0,(function(){return Xs(e().onDragStart,o,t,Ha)}))}))},update:function(r,a){var o=wo(a),s=_o(a);i||za(!1);var l=!function(e,t){if(e===t)return!0;var r=e.draggable.id===t.draggable.id&&e.draggable.droppableId===t.draggable.droppableId&&e.draggable.type===t.draggable.type&&e.draggable.index===t.draggable.index,n=e.droppable.id===t.droppable.id&&e.droppable.type===t.droppable.type;return r&&n}(r,i.lastCritical);l&&(i.lastCritical=r);var c,u,d=(u=o,!(null==(c=i.lastLocation)&&null==u||null!=c&&null!=u&&c.droppableId===u.droppableId&&c.index===u.index));d&&(i.lastLocation=o);var p=!function(e,t){return null==e&&null==t||null!=e&&null!=t&&e.draggableId===t.draggableId&&e.droppableId===t.droppableId}(i.lastCombine,s);if(p&&(i.lastCombine=s),l||d||p){var h=va({},Ws(r,i.mode),{combine:s,destination:o});n.add((function(){Us(0,(function(){return Xs(e().onDragUpdate,h,t,Ya)}))}))}},flush:function(){i||za(!1),n.flush()},drop:a,abort:function(){if(i){var e=va({},Ws(i.lastCritical,i.mode),{combine:null,destination:null,reason:"CANCEL"});a(e)}}}}(e,t);return function(e){return function(t){return function(n){if("BEFORE_INITIAL_CAPTURE"!==n.type){if("INITIAL_PUBLISH"===n.type){var i=n.payload.critical;return r.beforeStart(i,n.payload.movementMode),t(n),void r.start(i,n.payload.movementMode)}if("DROP_COMPLETE"===n.type){var a=n.payload.completed.result;return r.flush(),t(n),void r.drop(a)}if(t(n),"FLUSH"!==n.type){var o=e.getState();"DRAGGING"===o.phase&&r.update(o.critical,o.impact)}else r.abort()}else r.beforeCapture(n.payload.draggableId,n.payload.movementMode)}}}},Hs=function(e){return function(t){return function(r){if("DROP_ANIMATION_FINISHED"===r.type){var n=e.getState();"DROP_ANIMATING"!==n.phase&&za(!1),e.dispatch(Ds({completed:n.completed}))}else t(r)}}},Ys=function(e){var t=null,r=null;return function(n){return function(i){if("FLUSH"!==i.type&&"DROP_COMPLETE"!==i.type&&"DROP_ANIMATION_FINISHED"!==i.type||(r&&(cancelAnimationFrame(r),r=null),t&&(t(),t=null)),n(i),"DROP_ANIMATE"===i.type){var a={eventName:"scroll",options:{capture:!0,passive:!1,once:!0},fn:function(){"DROP_ANIMATING"===e.getState().phase&&e.dispatch({type:"DROP_ANIMATION_FINISHED",payload:null})}};r=requestAnimationFrame((function(){r=null,t=Fa(window,[a])}))}}}},Ks=function(e){return function(t){return function(r){if(t(r),"PUBLISH_WHILE_DRAGGING"===r.type){var n=e.getState();"DROP_PENDING"===n.phase&&(n.isWaiting||e.dispatch(As({reason:n.reason})))}}}},Js=fi.compose,Zs=function(e){var t=e.scrollHeight,r=e.scrollWidth,n=e.height,i=e.width,a=eo({x:r,y:t},{x:i,y:n});return{x:Math.max(0,a.x),y:Math.max(0,a.y)}},el=function(){var e=document.documentElement;return e||za(!1),e},tl=function(){var e=el();return Zs({scrollHeight:e.scrollHeight,scrollWidth:e.scrollWidth,width:e.clientWidth,height:e.clientHeight})};function rl(e,t,r){return r.descriptor.id!==t.id&&r.descriptor.type===t.type&&"virtual"===e.droppable.getById(r.descriptor.droppableId).descriptor.mode}var nl,il,al=function(e,t){var r=null,n=function(e){var t=e.registry,r=e.callbacks,n={additions:{},removals:{},modified:{}},i=null,a=function(){i||(r.collectionStarting(),i=requestAnimationFrame((function(){i=null;var e=n,a=e.additions,o=e.removals,s=e.modified,l=Object.keys(a).map((function(e){return t.draggable.getById(e).getDimension(Ja)})).sort((function(e,t){return e.descriptor.index-t.descriptor.index})),c=Object.keys(s).map((function(e){return{droppableId:e,scroll:t.droppable.getById(e).callbacks.getScrollWhileDragging()}})),u={additions:l,removals:Object.keys(o),modified:c};n={additions:{},removals:{},modified:{}},r.publish(u)})))};return{add:function(e){var t=e.descriptor.id;n.additions[t]=e,n.modified[e.descriptor.droppableId]=!0,n.removals[t]&&delete n.removals[t],a()},remove:function(e){var t=e.descriptor;n.removals[t.id]=!0,n.modified[t.droppableId]=!0,n.additions[t.id]&&delete n.additions[t.id],a()},stop:function(){i&&(cancelAnimationFrame(i),i=null,n={additions:{},removals:{},modified:{}})}}}({callbacks:{publish:t.publishWhileDragging,collectionStarting:t.collectionStarting},registry:e}),i=function(t){r||za(!1);var i=r.critical.draggable;"ADDITION"===t.type&&rl(e,i,t.value)&&n.add(t.value),"REMOVAL"===t.type&&rl(e,i,t.value)&&n.remove(t.value)},a={updateDroppableIsEnabled:function(n,i){e.droppable.exists(n)||za(!1),r&&t.updateDroppableIsEnabled({id:n,isEnabled:i})},updateDroppableIsCombineEnabled:function(n,i){r&&(e.droppable.exists(n)||za(!1),t.updateDroppableIsCombineEnabled({id:n,isCombineEnabled:i}))},scrollDroppable:function(t,n){r&&e.droppable.getById(t).callbacks.scroll(n)},updateDroppableScroll:function(n,i){r&&(e.droppable.exists(n)||za(!1),t.updateDroppableScroll({id:n,newScroll:i}))},startPublishing:function(t){r&&za(!1);var n=e.draggable.getById(t.draggableId),a=e.droppable.getById(n.descriptor.droppableId),o={draggable:n.descriptor,droppable:a.descriptor},s=e.subscribe(i);return r={critical:o,unsubscribe:s},function(e){var t=e.critical,r=e.scrollOptions,n=e.registry,i=function(){var e=zs(),t=tl(),r=e.y,n=e.x,i=el(),a=i.clientWidth,o=i.clientHeight;return{frame:_a({top:r,left:n,right:n+a,bottom:r+o}),scroll:{initial:e,current:e,max:t,diff:{value:Ja,displacement:Ja}}}}(),a=i.scroll.current,o=t.droppable,s=n.droppable.getAllByType(o.type).map((function(e){return e.callbacks.getDimensionAndWatchScroll(a,r)})),l=n.draggable.getAllByType(t.draggable.type).map((function(e){return e.getDimension(a)}));return{dimensions:{draggables:vo(l),droppables:bo(s)},critical:t,viewport:i}}({critical:o,registry:e,scrollOptions:t.scrollOptions})},stopPublishing:function(){if(r){n.stop();var t=r.critical.droppable;e.droppable.getAllByType(t.type).forEach((function(e){return e.callbacks.dragStopped()})),r.unsubscribe(),r=null}}};return a},ol=function(e,t){return"IDLE"===e.phase||"DROP_ANIMATING"===e.phase&&e.completed.result.draggableId!==t&&"DROP"===e.completed.result.reason},sl=function(e){window.scrollBy(e.x,e.y)},ll=Na((function(e){return yo(e).filter((function(e){return!!e.isEnabled&&!!e.frame}))})),cl=function(e){return Math.pow(e,2)},ul=function(e){var t=e.startOfRange,r=e.endOfRange,n=e.current,i=r-t;return 0===i?0:(n-t)/i},dl=360,pl=1200,hl=function(e){var t=e.distanceToEdge,r=e.thresholds,n=e.dragStartTime,i=e.shouldUseTimeDampening,a=function(e,t){if(e>t.startScrollingFrom)return 0;if(e<=t.maxScrollValueAt)return 28;if(e===t.startScrollingFrom)return 1;var r=ul({startOfRange:t.maxScrollValueAt,endOfRange:t.startScrollingFrom,current:e}),n=28*cl(1-r);return Math.ceil(n)}(t,r);return 0===a?0:i?Math.max(function(e,t){var r=t,n=pl,i=Date.now()-r;if(i>=pl)return e;if(i<dl)return 1;var a=ul({startOfRange:dl,endOfRange:n,current:i}),o=e*cl(a);return Math.ceil(o)}(a,n),1):a},fl=function(e){var t=e.container,r=e.distanceToEdges,n=e.dragStartTime,i=e.axis,a=e.shouldUseTimeDampening,o=function(e,t){return{startScrollingFrom:.25*e[t.size],maxScrollValueAt:.05*e[t.size]}}(t,i);return r[i.end]<r[i.start]?hl({distanceToEdge:r[i.end],thresholds:o,dragStartTime:n,shouldUseTimeDampening:a}):-1*hl({distanceToEdge:r[i.start],thresholds:o,dragStartTime:n,shouldUseTimeDampening:a})},ml=oo((function(e){return 0===e?0:e})),gl=function(e){var t=e.dragStartTime,r=e.container,n=e.subject,i=e.center,a=e.shouldUseTimeDampening,o={top:i.y-r.top,right:r.right-i.x,bottom:r.bottom-i.y,left:i.x-r.left},s=fl({container:r,distanceToEdges:o,dragStartTime:t,axis:Ao,shouldUseTimeDampening:a}),l=fl({container:r,distanceToEdges:o,dragStartTime:t,axis:Ro,shouldUseTimeDampening:a}),c=ml({x:l,y:s});if(to(c,Ja))return null;var u=function(e){var t=e.container,r=e.subject,n=e.proposedScroll,i=r.height>t.height,a=r.width>t.width;return a||i?a&&i?null:{x:a?0:n.x,y:i?0:n.y}:n}({container:r,subject:n,proposedScroll:c});return u?to(u,Ja)?null:u:null},bl=oo((function(e){return 0===e?0:e>0?1:-1})),vl=(nl=function(e,t){return e<0?e:e>t?e-t:0},function(e){var t=e.current,r=e.max,n=e.change,i=Za(t,n),a={x:nl(i.x,r.x),y:nl(i.y,r.y)};return to(a,Ja)?null:a}),yl=function(e){var t=e.max,r=e.current,n=e.change,i={x:Math.max(r.x,t.x),y:Math.max(r.y,t.y)},a=bl(n),o=vl({max:i,current:r,change:a});return!o||0!==a.x&&0===o.x||0!==a.y&&0===o.y},Ol=function(e,t){return yl({current:e.scroll.current,max:e.scroll.max,change:t})},xl=function(e,t){var r=e.frame;return!!r&&yl({current:r.scroll.current,max:r.scroll.max,change:t})},wl=function(e){var t=e.state,r=e.dragStartTime,n=e.shouldUseTimeDampening,i=e.scrollWindow,a=e.scrollDroppable,o=t.current.page.borderBoxCenter,s=t.dimensions.draggables[t.critical.draggable.id].page.marginBox;if(t.isWindowScrollAllowed){var l=function(e){var t=e.viewport,r=e.subject,n=e.center,i=e.shouldUseTimeDampening,a=gl({dragStartTime:e.dragStartTime,container:t.frame,subject:r,center:n,shouldUseTimeDampening:i});return a&&Ol(t,a)?a:null}({dragStartTime:r,viewport:t.viewport,subject:s,center:o,shouldUseTimeDampening:n});if(l)return void i(l)}var c=function(e){var t=e.center,r=e.destination,n=e.droppables;if(r){var i=n[r];return i.frame?i:null}var a=function(e,t){var r=mo(ll(t),(function(t){return t.frame||za(!1),os(t.frame.pageMarginBox)(e)}));return r}(t,n);return a}({center:o,destination:ns(t.impact),droppables:t.dimensions.droppables});if(c){var u=function(e){var t=e.droppable,r=e.subject,n=e.center,i=e.dragStartTime,a=e.shouldUseTimeDampening,o=t.frame;if(!o)return null;var s=gl({dragStartTime:i,container:o.pageMarginBox,subject:r,center:n,shouldUseTimeDampening:a});return s&&xl(t,s)?s:null}({dragStartTime:r,droppable:c,subject:s,center:o,shouldUseTimeDampening:n});u&&a(c.descriptor.id,u)}},_l=function(e){var t=e.move,r=e.scrollDroppable,n=e.scrollWindow;return function(e){var i=e.scrollJumpRequest;if(i){var a=ns(e.impact);a||za(!1);var o=function(e,t){if(!xl(e,t))return t;var n=function(e,t){var r=e.frame;return r&&xl(e,t)?vl({current:r.scroll.current,max:r.scroll.max,change:t}):null}(e,t);if(!n)return r(e.descriptor.id,t),null;var i=eo(t,n);return r(e.descriptor.id,i),eo(t,i)}(e.dimensions.droppables[a],i);if(o){var s=e.viewport,l=function(e,t,r){if(!e)return r;if(!Ol(t,r))return r;var i=function(e,t){if(!Ol(e,t))return null;var r=e.scroll.max,n=e.scroll.current;return vl({current:n,max:r,change:t})}(t,r);if(!i)return n(r),null;var a=eo(r,i);return n(a),eo(r,a)}(e.isWindowScrollAllowed,s,o);l&&function(e,r){var n=Za(e.current.client.selection,r);t({client:n})}(e,l)}}}},Sl={base:il="data-rbd-drag-handle",draggableId:il+"-draggable-id",contextId:il+"-context-id"},El=function(){var e="data-rbd-draggable";return{base:e,contextId:e+"-context-id",id:e+"-id"}}(),kl=function(){var e="data-rbd-droppable";return{base:e,contextId:e+"-context-id",id:e+"-id"}}(),Pl="data-rbd-scroll-container-context-id",Tl=function(e,t){return e.map((function(e){var r=e.styles[t];return r?e.selector+" { "+r+" }":""})).join(" ")},Cl="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?t.useLayoutEffect:t.useEffect,Il=function(){var e=document.querySelector("head");return e||za(!1),e},Dl=function(e){var t=document.createElement("style");return e&&t.setAttribute("nonce",e),t.type="text/css",t};var Al=function(e){return e&&e.ownerDocument?e.ownerDocument.defaultView:window};function Rl(e){return e instanceof Al(e).HTMLElement}function jl(){var e={draggables:{},droppables:{}},t=[];function r(e){t.length&&t.forEach((function(t){return t(e)}))}function n(t){return e.draggables[t]||null}function i(t){return e.droppables[t]||null}return{draggable:{register:function(t){e.draggables[t.descriptor.id]=t,r({type:"ADDITION",value:t})},update:function(t,r){var n=e.draggables[r.descriptor.id];n&&n.uniqueId===t.uniqueId&&(delete e.draggables[r.descriptor.id],e.draggables[t.descriptor.id]=t)},unregister:function(t){var i=t.descriptor.id,a=n(i);a&&t.uniqueId===a.uniqueId&&(delete e.draggables[i],r({type:"REMOVAL",value:t}))},getById:function(e){var t=n(e);return t||za(!1),t},findById:n,exists:function(e){return Boolean(n(e))},getAllByType:function(t){return ho(e.draggables).filter((function(e){return e.descriptor.type===t}))}},droppable:{register:function(t){e.droppables[t.descriptor.id]=t},unregister:function(t){var r=i(t.descriptor.id);r&&t.uniqueId===r.uniqueId&&delete e.droppables[t.descriptor.id]},getById:function(e){var t=i(e);return t||za(!1),t},findById:i,exists:function(e){return Boolean(i(e))},getAllByType:function(t){return ho(e.droppables).filter((function(e){return e.descriptor.type===t}))}},subscribe:function(e){return t.push(e),function(){var r=t.indexOf(e);-1!==r&&t.splice(r,1)}},clean:function(){e.draggables={},e.droppables={},t.length=0}}}var Nl=r().createContext(null),Ll=function(){var e=document.body;return e||za(!1),e},ql={position:"absolute",width:"1px",height:"1px",margin:"-1px",border:"0",padding:"0",overflow:"hidden",clip:"rect(0 0 0 0)","clip-path":"inset(100%)"},$l=0,Ml={separator:"::"};function Bl(e,t){return void 0===t&&(t=Ml),xa((function(){return""+e+t.separator+$l++}),[t.separator,e])}var Fl=r().createContext(null);function Ql(e){var r=(0,t.useRef)(e);return(0,t.useEffect)((function(){r.current=e})),r}var zl,Vl,Ul=((zl={})[13]=!0,zl[9]=!0,zl),Wl=function(e){Ul[e.keyCode]&&e.preventDefault()},Xl=function(){var e="visibilitychange";return"undefined"==typeof document?e:mo([e,"ms"+e,"webkit"+e,"moz"+e,"o"+e],(function(e){return"on"+e in document}))||e}(),Gl={type:"IDLE"};function Hl(){}var Yl=((Vl={})[34]=!0,Vl[33]=!0,Vl[36]=!0,Vl[35]=!0,Vl);var Kl={type:"IDLE"},Jl={input:!0,button:!0,textarea:!0,select:!0,option:!0,optgroup:!0,video:!0,audio:!0};function Zl(e,t){if(null==t)return!1;if(Boolean(Jl[t.tagName.toLowerCase()]))return!0;var r=t.getAttribute("contenteditable");return"true"===r||""===r||t!==e&&Zl(e,t.parentElement)}function ec(e,t){var r=t.target;return!!Rl(r)&&Zl(e,r)}var tc=function(e){return _a(e.getBoundingClientRect()).center},rc=function(){var e="matches";return"undefined"==typeof document?e:mo([e,"msMatchesSelector","webkitMatchesSelector"],(function(e){return e in Element.prototype}))||e}();function nc(e,t){return null==e?null:e[rc](t)?e:nc(e.parentElement,t)}function ic(e,t){return e.closest?e.closest(t):nc(e,t)}function ac(e){e.preventDefault()}function oc(e){var t=e.expected,r=e.phase,n=e.isLockActive;return e.shouldWarn,!!n()&&t===r}function sc(e){var t=e.lockAPI,r=e.store,n=e.registry,i=e.draggableId;if(t.isClaimed())return!1;var a=n.draggable.findById(i);return!!a&&!!a.options.isEnabled&&!!ol(r.getState(),i)}var lc=[function(e){var r=(0,t.useRef)(Gl),n=(0,t.useRef)(Ba),i=xa((function(){return{eventName:"mousedown",fn:function(t){if(!t.defaultPrevented&&0===t.button&&!(t.ctrlKey||t.metaKey||t.shiftKey||t.altKey)){var r=e.findClosestDraggableId(t);if(r){var i=e.tryGetLock(r,s,{sourceEvent:t});if(i){t.preventDefault();var a={x:t.clientX,y:t.clientY};n.current(),u(i,a)}}}}}}),[e]),a=xa((function(){return{eventName:"webkitmouseforcewillbegin",fn:function(t){if(!t.defaultPrevented){var r=e.findClosestDraggableId(t);if(r){var n=e.findOptionsForDraggable(r);n&&(n.shouldRespectForcePress||e.canGetLock(r)&&t.preventDefault())}}}}}),[e]),o=wa((function(){n.current=Fa(window,[a,i],{passive:!1,capture:!0})}),[a,i]),s=wa((function(){"IDLE"!==r.current.type&&(r.current=Gl,n.current(),o())}),[o]),l=wa((function(){var e=r.current;s(),"DRAGGING"===e.type&&e.actions.cancel({shouldBlockNextClick:!0}),"PENDING"===e.type&&e.actions.abort()}),[s]),c=wa((function(){var e=function(e){var t=e.cancel,r=e.completed,n=e.getPhase,i=e.setPhase;return[{eventName:"mousemove",fn:function(e){var t,r,a=e.button,o=e.clientX,s=e.clientY;if(0===a){var l={x:o,y:s},c=n();if("DRAGGING"===c.type)return e.preventDefault(),void c.actions.move(l);if("PENDING"!==c.type&&za(!1),t=c.point,r=l,Math.abs(r.x-t.x)>=5||Math.abs(r.y-t.y)>=5){e.preventDefault();var u=c.actions.fluidLift(l);i({type:"DRAGGING",actions:u})}}}},{eventName:"mouseup",fn:function(e){var i=n();"DRAGGING"===i.type?(e.preventDefault(),i.actions.drop({shouldBlockNextClick:!0}),r()):t()}},{eventName:"mousedown",fn:function(e){"DRAGGING"===n().type&&e.preventDefault(),t()}},{eventName:"keydown",fn:function(e){if("PENDING"!==n().type)return 27===e.keyCode?(e.preventDefault(),void t()):void Wl(e);t()}},{eventName:"resize",fn:t},{eventName:"scroll",options:{passive:!0,capture:!1},fn:function(){"PENDING"===n().type&&t()}},{eventName:"webkitmouseforcedown",fn:function(e){var r=n();"IDLE"===r.type&&za(!1),r.actions.shouldRespectForcePress()?t():e.preventDefault()}},{eventName:Xl,fn:t}]}({cancel:l,completed:s,getPhase:function(){return r.current},setPhase:function(e){r.current=e}});n.current=Fa(window,e,{capture:!0,passive:!1})}),[l,s]),u=wa((function(e,t){"IDLE"!==r.current.type&&za(!1),r.current={type:"PENDING",point:t,actions:e},c()}),[c]);Cl((function(){return o(),function(){n.current()}}),[o])},function(e){var r=(0,t.useRef)(Hl),n=xa((function(){return{eventName:"keydown",fn:function(t){if(!t.defaultPrevented&&32===t.keyCode){var n=e.findClosestDraggableId(t);if(n){var a=e.tryGetLock(n,l,{sourceEvent:t});if(a){t.preventDefault();var o=!0,s=a.snapLift();r.current(),r.current=Fa(window,function(e,t){function r(){t(),e.cancel()}return[{eventName:"keydown",fn:function(n){return 27===n.keyCode?(n.preventDefault(),void r()):32===n.keyCode?(n.preventDefault(),t(),void e.drop()):40===n.keyCode?(n.preventDefault(),void e.moveDown()):38===n.keyCode?(n.preventDefault(),void e.moveUp()):39===n.keyCode?(n.preventDefault(),void e.moveRight()):37===n.keyCode?(n.preventDefault(),void e.moveLeft()):void(Yl[n.keyCode]?n.preventDefault():Wl(n))}},{eventName:"mousedown",fn:r},{eventName:"mouseup",fn:r},{eventName:"click",fn:r},{eventName:"touchstart",fn:r},{eventName:"resize",fn:r},{eventName:"wheel",fn:r,options:{passive:!0}},{eventName:Xl,fn:r}]}(s,l),{capture:!0,passive:!1})}}}function l(){o||za(!1),o=!1,r.current(),i()}}}}),[e]),i=wa((function(){r.current=Fa(window,[n],{passive:!1,capture:!0})}),[n]);Cl((function(){return i(),function(){r.current()}}),[i])},function(e){var r=(0,t.useRef)(Kl),n=(0,t.useRef)(Ba),i=wa((function(){return r.current}),[]),a=wa((function(e){r.current=e}),[]),o=xa((function(){return{eventName:"touchstart",fn:function(t){if(!t.defaultPrevented){var r=e.findClosestDraggableId(t);if(r){var i=e.tryGetLock(r,l,{sourceEvent:t});if(i){var a=t.touches[0],o={x:a.clientX,y:a.clientY};n.current(),p(i,o)}}}}}}),[e]),s=wa((function(){n.current=Fa(window,[o],{capture:!0,passive:!1})}),[o]),l=wa((function(){var e=r.current;"IDLE"!==e.type&&("PENDING"===e.type&&clearTimeout(e.longPressTimerId),a(Kl),n.current(),s())}),[s,a]),c=wa((function(){var e=r.current;l(),"DRAGGING"===e.type&&e.actions.cancel({shouldBlockNextClick:!0}),"PENDING"===e.type&&e.actions.abort()}),[l]),u=wa((function(){var e={capture:!0,passive:!1},t={cancel:c,completed:l,getPhase:i},r=Fa(window,function(e){var t=e.cancel,r=e.completed,n=e.getPhase;return[{eventName:"touchmove",options:{capture:!1},fn:function(e){var r=n();if("DRAGGING"===r.type){r.hasMoved=!0;var i=e.touches[0],a={x:i.clientX,y:i.clientY};e.preventDefault(),r.actions.move(a)}else t()}},{eventName:"touchend",fn:function(e){var i=n();"DRAGGING"===i.type?(e.preventDefault(),i.actions.drop({shouldBlockNextClick:!0}),r()):t()}},{eventName:"touchcancel",fn:function(e){"DRAGGING"===n().type?(e.preventDefault(),t()):t()}},{eventName:"touchforcechange",fn:function(e){var r=n();"IDLE"===r.type&&za(!1);var i=e.touches[0];if(i&&i.force>=.15){var a=r.actions.shouldRespectForcePress();if("PENDING"!==r.type)return a?r.hasMoved?void e.preventDefault():void t():void e.preventDefault();a&&t()}}},{eventName:Xl,fn:t}]}(t),e),a=Fa(window,function(e){var t=e.cancel,r=e.getPhase;return[{eventName:"orientationchange",fn:t},{eventName:"resize",fn:t},{eventName:"contextmenu",fn:function(e){e.preventDefault()}},{eventName:"keydown",fn:function(e){"DRAGGING"===r().type?(27===e.keyCode&&e.preventDefault(),t()):t()}},{eventName:Xl,fn:t}]}(t),e);n.current=function(){r(),a()}}),[c,i,l]),d=wa((function(){var e=i();"PENDING"!==e.type&&za(!1);var t=e.actions.fluidLift(e.point);a({type:"DRAGGING",actions:t,hasMoved:!1})}),[i,a]),p=wa((function(e,t){"IDLE"!==i().type&&za(!1);var r=setTimeout(d,120);a({type:"PENDING",point:t,actions:e,longPressTimerId:r}),u()}),[u,i,a,d]);Cl((function(){return s(),function(){n.current();var e=i();"PENDING"===e.type&&(clearTimeout(e.longPressTimerId),a(Kl))}}),[i,s,a]),Cl((function(){return Fa(window,[{eventName:"touchmove",fn:function(){},options:{capture:!1,passive:!1}}])}),[])}];function cc(e){var r=e.contextId,n=e.store,i=e.registry,a=e.customSensors,o=e.enableDefaultSensors,s=[].concat(o?lc:[],a||[]),l=(0,t.useState)((function(){return function(){var e=null;function t(){e||za(!1),e=null}return{isClaimed:function(){return Boolean(e)},isActive:function(t){return t===e},claim:function(t){e&&za(!1);var r={abandon:t};return e=r,r},release:t,tryAbandon:function(){e&&(e.abandon(),t())}}}()}))[0],c=wa((function(e,t){e.isDragging&&!t.isDragging&&l.tryAbandon()}),[l]);Cl((function(){var e=n.getState();return n.subscribe((function(){var t=n.getState();c(e,t),e=t}))}),[l,n,c]),Cl((function(){return l.tryAbandon}),[l.tryAbandon]);for(var u=wa((function(e){return sc({lockAPI:l,registry:i,store:n,draggableId:e})}),[l,i,n]),d=wa((function(e,t,a){return function(e){var t=e.lockAPI,r=e.contextId,n=e.store,i=e.registry,a=e.draggableId,o=e.forceSensorStop,s=e.sourceEvent;if(!sc({lockAPI:t,store:n,registry:i,draggableId:a}))return null;var l=i.draggable.getById(a),c=function(e,t){var r="["+El.contextId+'="'+e+'"]',n=mo(go(document.querySelectorAll(r)),(function(e){return e.getAttribute(El.id)===t}));return n&&Rl(n)?n:null}(r,l.descriptor.id);if(!c)return null;if(s&&!l.options.canDragInteractiveElements&&ec(c,s))return null;var u=t.claim(o||Ba),d="PRE_DRAG";function p(){return l.options.shouldRespectForcePress}function h(){return t.isActive(u)}var f=function(e,t){oc({expected:e,phase:d,isLockActive:h,shouldWarn:!0})&&n.dispatch(t())}.bind(null,"DRAGGING");function m(e){function r(){t.release(),d="COMPLETED"}function i(t,i){if(void 0===i&&(i={shouldBlockNextClick:!1}),e.cleanup(),i.shouldBlockNextClick){var a=Fa(window,[{eventName:"click",fn:ac,options:{once:!0,passive:!1,capture:!0}}]);setTimeout(a)}r(),n.dispatch(As({reason:t}))}return"PRE_DRAG"!==d&&(r(),"PRE_DRAG"!==d&&za(!1)),n.dispatch(function(e){return{type:"LIFT",payload:e}}(e.liftActionArgs)),d="DRAGGING",va({isActive:function(){return oc({expected:"DRAGGING",phase:d,isLockActive:h,shouldWarn:!1})},shouldRespectForcePress:p,drop:function(e){return i("DROP",e)},cancel:function(e){return i("CANCEL",e)}},e.actions)}return{isActive:function(){return oc({expected:"PRE_DRAG",phase:d,isLockActive:h,shouldWarn:!1})},shouldRespectForcePress:p,fluidLift:function(e){var t=La((function(e){f((function(){return ks({client:e})}))}));return va({},m({liftActionArgs:{id:a,clientSelection:e,movementMode:"FLUID"},cleanup:function(){return t.cancel()},actions:{move:t}}),{move:t})},snapLift:function(){var e={moveUp:function(){return f(Ps)},moveRight:function(){return f(Cs)},moveDown:function(){return f(Ts)},moveLeft:function(){return f(Is)}};return m({liftActionArgs:{id:a,clientSelection:tc(c),movementMode:"SNAP"},cleanup:Ba,actions:e})},abort:function(){oc({expected:"PRE_DRAG",phase:d,isLockActive:h,shouldWarn:!0})&&t.release()}}}({lockAPI:l,registry:i,contextId:r,store:n,draggableId:e,forceSensorStop:t,sourceEvent:a&&a.sourceEvent?a.sourceEvent:null})}),[r,l,i,n]),p=wa((function(e){return function(e,t){var r=function(e,t){var r,n=t.target;if(!((r=n)instanceof Al(r).Element))return null;var i=function(e){return"["+Sl.contextId+'="'+e+'"]'}(e),a=ic(n,i);return a&&Rl(a)?a:null}(e,t);return r?r.getAttribute(Sl.draggableId):null}(r,e)}),[r]),h=wa((function(e){var t=i.draggable.findById(e);return t?t.options:null}),[i.draggable]),f=wa((function(){l.isClaimed()&&(l.tryAbandon(),"IDLE"!==n.getState().phase&&n.dispatch({type:"FLUSH",payload:null}))}),[l,n]),m=wa(l.isClaimed,[l]),g=xa((function(){return{canGetLock:u,tryGetLock:d,findClosestDraggableId:p,findOptionsForDraggable:h,tryReleaseLock:f,isLockClaimed:m}}),[u,d,p,h,f,m]),b=0;b<s.length;b++)s[b](g)}function uc(e){return e.current||za(!1),e.current}function dc(e){var n=e.contextId,i=e.setCallbacks,a=e.sensors,o=e.nonce,s=e.dragHandleUsageInstructions,l=(0,t.useRef)(null),c=Ql(e),u=wa((function(){return function(e){return{onBeforeCapture:e.onBeforeCapture,onBeforeDragStart:e.onBeforeDragStart,onDragStart:e.onDragStart,onDragEnd:e.onDragEnd,onDragUpdate:e.onDragUpdate}}(c.current)}),[c]),d=function(e){var r=xa((function(){return function(e){return"rbd-announcement-"+e}(e)}),[e]),n=(0,t.useRef)(null);return(0,t.useEffect)((function(){var e=document.createElement("div");return n.current=e,e.id=r,e.setAttribute("aria-live","assertive"),e.setAttribute("aria-atomic","true"),va(e.style,ql),Ll().appendChild(e),function(){setTimeout((function(){var t=Ll();t.contains(e)&&t.removeChild(e),e===n.current&&(n.current=null)}))}}),[r]),wa((function(e){var t=n.current;t&&(t.textContent=e)}),[])}(n),p=function(e){var r=e.contextId,n=e.text,i=Bl("hidden-text",{separator:"-"}),a=xa((function(){return"rbd-hidden-text-"+(e={contextId:r,uniqueId:i}).contextId+"-"+e.uniqueId;var e}),[i,r]);return(0,t.useEffect)((function(){var e=document.createElement("div");return e.id=a,e.textContent=n,e.style.display="none",Ll().appendChild(e),function(){var t=Ll();t.contains(e)&&t.removeChild(e)}}),[a,n]),a}({contextId:n,text:s}),h=function(e,r){var n=xa((function(){return function(e){var t,r,n=function(e){return function(t){return"["+t+'="'+e+'"]'}}(e),i=(t="\n      cursor: -webkit-grab;\n      cursor: grab;\n    ",{selector:n(Sl.contextId),styles:{always:"\n          -webkit-touch-callout: none;\n          -webkit-tap-highlight-color: rgba(0,0,0,0);\n          touch-action: manipulation;\n        ",resting:t,dragging:"pointer-events: none;",dropAnimating:t}}),a=[(r="\n      transition: "+$s.outOfTheWay+";\n    ",{selector:n(El.contextId),styles:{dragging:r,dropAnimating:r,userCancel:r}}),i,{selector:n(kl.contextId),styles:{always:"overflow-anchor: none;"}},{selector:"body",styles:{dragging:"\n        cursor: grabbing;\n        cursor: -webkit-grabbing;\n        user-select: none;\n        -webkit-user-select: none;\n        -moz-user-select: none;\n        -ms-user-select: none;\n        overflow-anchor: none;\n      "}}];return{always:Tl(a,"always"),resting:Tl(a,"resting"),dragging:Tl(a,"dragging"),dropAnimating:Tl(a,"dropAnimating"),userCancel:Tl(a,"userCancel")}}(e)}),[e]),i=(0,t.useRef)(null),a=(0,t.useRef)(null),o=wa(Na((function(e){var t=a.current;t||za(!1),t.textContent=e})),[]),s=wa((function(e){var t=i.current;t||za(!1),t.textContent=e}),[]);Cl((function(){(i.current||a.current)&&za(!1);var t=Dl(r),l=Dl(r);return i.current=t,a.current=l,t.setAttribute("data-rbd-always",e),l.setAttribute("data-rbd-dynamic",e),Il().appendChild(t),Il().appendChild(l),s(n.always),o(n.resting),function(){var e=function(e){var t=e.current;t||za(!1),Il().removeChild(t),e.current=null};e(i),e(a)}}),[r,s,o,n.always,n.resting,e]);var l=wa((function(){return o(n.dragging)}),[o,n.dragging]),c=wa((function(e){o("DROP"!==e?n.userCancel:n.dropAnimating)}),[o,n.dropAnimating,n.userCancel]),u=wa((function(){a.current&&o(n.resting)}),[o,n.resting]);return xa((function(){return{dragging:l,dropping:c,resting:u}}),[l,c,u])}(n,o),f=wa((function(e){uc(l).dispatch(e)}),[]),m=xa((function(){return(0,fi.bindActionCreators)({publishWhileDragging:xs,updateDroppableScroll:_s,updateDroppableIsEnabled:Ss,updateDroppableIsCombineEnabled:Es,collectionStarting:ws},f)}),[f]),g=function(){var e=xa(jl,[]);return(0,t.useEffect)((function(){return function(){requestAnimationFrame(e.clean)}}),[e]),e}(),b=xa((function(){return al(g,m)}),[g,m]),v=xa((function(){return function(e){var t=e.scrollDroppable,r=e.scrollWindow,n=e.move,i=function(e){var t=e.scrollDroppable,r=La(e.scrollWindow),n=La(t),i=null,a=function(e){i||za(!1);var t=i,a=t.shouldUseTimeDampening,o=t.dragStartTime;wl({state:e,scrollWindow:r,scrollDroppable:n,dragStartTime:o,shouldUseTimeDampening:a})};return{start:function(e){i&&za(!1);var t=Date.now(),r=!1,n=function(){r=!0};wl({state:e,dragStartTime:0,shouldUseTimeDampening:!1,scrollWindow:n,scrollDroppable:n}),i={dragStartTime:t,shouldUseTimeDampening:r},r&&a(e)},stop:function(){i&&(r.cancel(),n.cancel(),i=null)},scroll:a}}({scrollWindow:r,scrollDroppable:t}),a=_l({move:n,scrollWindow:r,scrollDroppable:t});return{scroll:function(e){"DRAGGING"===e.phase&&("FLUID"!==e.movementMode?e.scrollJumpRequest&&a(e):i.scroll(e))},start:i.start,stop:i.stop}}(va({scrollWindow:sl,scrollDroppable:b.scrollDroppable},(0,fi.bindActionCreators)({move:ks},f)))}),[b.scrollDroppable,f]),y=function(e){var r=(0,t.useRef)({}),n=(0,t.useRef)(null),i=(0,t.useRef)(null),a=(0,t.useRef)(!1),o=wa((function(e,t){var n={id:e,focus:t};return r.current[e]=n,function(){var t=r.current;t[e]!==n&&delete t[e]}}),[]),s=wa((function(t){var r=function(e,t){var r="["+Sl.contextId+'="'+e+'"]',n=go(document.querySelectorAll(r));if(!n.length)return null;var i=mo(n,(function(e){return e.getAttribute(Sl.draggableId)===t}));return i&&Rl(i)?i:null}(e,t);r&&r!==document.activeElement&&r.focus()}),[e]),l=wa((function(e,t){n.current===e&&(n.current=t)}),[]),c=wa((function(){i.current||a.current&&(i.current=requestAnimationFrame((function(){i.current=null;var e=n.current;e&&s(e)})))}),[s]),u=wa((function(e){n.current=null;var t=document.activeElement;t&&t.getAttribute(Sl.draggableId)===e&&(n.current=e)}),[]);return Cl((function(){return a.current=!0,function(){a.current=!1;var e=i.current;e&&cancelAnimationFrame(e)}}),[]),xa((function(){return{register:o,tryRecordFocus:u,tryRestoreFocusRecorded:c,tryShiftRecord:l}}),[o,u,c,l])}(n),O=xa((function(){return function(e){var t,r=e.dimensionMarshal,n=e.focusMarshal,i=e.styleMarshal,a=e.getResponders,o=e.announce,s=e.autoScroller;return(0,fi.createStore)(Os,Js((0,fi.applyMiddleware)((t=i,function(){return function(e){return function(r){"INITIAL_PUBLISH"===r.type&&t.dragging(),"DROP_ANIMATE"===r.type&&t.dropping(r.payload.completed.result.reason),"FLUSH"!==r.type&&"DROP_COMPLETE"!==r.type||t.resting(),e(r)}}}),function(e){return function(){return function(t){return function(r){"DROP_COMPLETE"!==r.type&&"FLUSH"!==r.type&&"DROP_ANIMATE"!==r.type||e.stopPublishing(),t(r)}}}}(r),function(e){return function(t){var r=t.getState,n=t.dispatch;return function(t){return function(i){if("LIFT"===i.type){var a=i.payload,o=a.id,s=a.clientSelection,l=a.movementMode,c=r();"DROP_ANIMATING"===c.phase&&n(Ds({completed:c.completed})),"IDLE"!==r().phase&&za(!1),n({type:"FLUSH",payload:null}),n({type:"BEFORE_INITIAL_CAPTURE",payload:{draggableId:o,movementMode:l}});var u={draggableId:o,scrollOptions:{shouldPublishImmediately:"SNAP"===l}},d=e.startPublishing(u),p=d.critical,h=d.dimensions,f=d.viewport;n({type:"INITIAL_PUBLISH",payload:{critical:p,dimensions:h,clientSelection:s,movementMode:l,viewport:f}})}else t(i)}}}}(r),Qs,Hs,Ys,Ks,function(e){return function(t){return function(r){return function(n){if(function(e){return"DROP_COMPLETE"===e.type||"DROP_ANIMATE"===e.type||"FLUSH"===e.type}(n))return e.stop(),void r(n);if("INITIAL_PUBLISH"===n.type){r(n);var i=t.getState();return"DRAGGING"!==i.phase&&za(!1),void e.start(i)}r(n),e.scroll(t.getState())}}}}(s),Vs,function(e){var t=!1;return function(){return function(r){return function(n){if("INITIAL_PUBLISH"===n.type)return t=!0,e.tryRecordFocus(n.payload.critical.draggable.id),r(n),void e.tryRestoreFocusRecorded();if(r(n),t){if("FLUSH"===n.type)return t=!1,void e.tryRestoreFocusRecorded();if("DROP_COMPLETE"===n.type){t=!1;var i=n.payload.completed.result;i.combine&&e.tryShiftRecord(i.draggableId,i.combine.draggableId),e.tryRestoreFocusRecorded()}}}}}}(n),Gs(a,o))))}({announce:d,autoScroller:v,dimensionMarshal:b,focusMarshal:y,getResponders:u,styleMarshal:h})}),[d,v,b,y,u,h]);l.current=O;var x=wa((function(){var e=uc(l);"IDLE"!==e.getState().phase&&e.dispatch({type:"FLUSH",payload:null})}),[]),w=wa((function(){var e=uc(l).getState();return e.isDragging||"DROP_ANIMATING"===e.phase}),[]);i(xa((function(){return{isDragging:w,tryAbort:x}}),[w,x]));var _=wa((function(e){return ol(uc(l).getState(),e)}),[]),S=wa((function(){return as(uc(l).getState())}),[]),E=xa((function(){return{marshal:b,focus:y,contextId:n,canLift:_,isMovementAllowed:S,dragHandleUsageInstructionsId:p,registry:g}}),[n,b,p,y,_,S,g]);return cc({contextId:n,store:O,registry:g,customSensors:a,enableDefaultSensors:!1!==e.enableDefaultSensors}),(0,t.useEffect)((function(){return x}),[x]),r().createElement(Fl.Provider,{value:E},r().createElement(ya.Provider,{context:Nl,store:O},e.children))}var pc=0;function hc(e){var t=xa((function(){return""+pc++}),[]),n=e.dragHandleUsageInstructions||"\n  Press space bar to start a drag.\n  When dragging you can use the arrow keys to move the item around and escape to cancel.\n  Some screen readers may require you to be in focus mode or to use your pass through key\n";return r().createElement(Va,null,(function(i){return r().createElement(dc,{nonce:e.nonce,contextId:t,setCallbacks:i,dragHandleUsageInstructions:n,enableDefaultSensors:e.enableDefaultSensors,sensors:e.sensors,onBeforeCapture:e.onBeforeCapture,onBeforeDragStart:e.onBeforeDragStart,onDragStart:e.onDragStart,onDragUpdate:e.onDragUpdate,onDragEnd:e.onDragEnd},e.children)}))}var fc=function(e){return function(t){return e===t}},mc=fc("scroll"),gc=fc("auto"),bc=(fc("visible"),function(e,t){return t(e.overflowX)||t(e.overflowY)}),vc=function e(t){return null==t||t===document.body||t===document.documentElement?null:function(e){var t=window.getComputedStyle(e),r={overflowX:t.overflowX,overflowY:t.overflowY};return bc(r,mc)||bc(r,gc)}(t)?t:e(t.parentElement)},yc=function(e){return{x:e.scrollLeft,y:e.scrollTop}},Oc=function e(t){return!!t&&("fixed"===window.getComputedStyle(t).position||e(t.parentElement))},xc={passive:!1},wc={passive:!0},_c=function(e){return e.shouldPublishImmediately?xc:wc};function Sc(e){var r=(0,t.useContext)(e);return r||za(!1),r}var Ec=function(e){return e&&e.env.closestScrollable||null};function kc(){}var Pc={width:0,height:0,margin:{top:0,right:0,bottom:0,left:0}},Tc=r().memo((function(e){var n=(0,t.useRef)(null),i=wa((function(){n.current&&(clearTimeout(n.current),n.current=null)}),[]),a=e.animate,o=e.onTransitionEnd,s=e.onClose,l=e.contextId,c=(0,t.useState)("open"===e.animate),u=c[0],d=c[1];(0,t.useEffect)((function(){return u?"open"!==a?(i(),d(!1),kc):n.current?kc:(n.current=setTimeout((function(){n.current=null,d(!1)})),i):kc}),[a,u,i]);var p=wa((function(e){"height"===e.propertyName&&(o(),"close"===a&&s())}),[a,s,o]),h=function(e){var t=e.isAnimatingOpenOnMount,r=e.placeholder,n=e.animate,i=function(e){var t=e.placeholder;return e.isAnimatingOpenOnMount||"close"===e.animate?Pc:{height:t.client.borderBox.height,width:t.client.borderBox.width,margin:t.client.margin}}({isAnimatingOpenOnMount:t,placeholder:r,animate:n});return{display:r.display,boxSizing:"border-box",width:i.width,height:i.height,marginTop:i.margin.top,marginRight:i.margin.right,marginBottom:i.margin.bottom,marginLeft:i.margin.left,flexShrink:"0",flexGrow:"0",pointerEvents:"none",transition:"none"!==n?$s.placeholder:null}}({isAnimatingOpenOnMount:u,animate:e.animate,placeholder:e.placeholder});return r().createElement(e.placeholder.tagName,{style:h,"data-rbd-placeholder-context-id":l,onTransitionEnd:p,ref:e.innerRef})})),Cc=r().createContext(null),Ic=function(e){function t(){for(var t,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(t=e.call.apply(e,[this].concat(n))||this).state={isVisible:Boolean(t.props.on),data:t.props.on,animate:t.props.shouldAnimate&&t.props.on?"open":"none"},t.onClose=function(){"close"===t.state.animate&&t.setState({isVisible:!1})},t}return ba(t,e),t.getDerivedStateFromProps=function(e,t){return e.shouldAnimate?e.on?{isVisible:!0,data:e.on,animate:"open"}:t.isVisible?{isVisible:!0,data:t.data,animate:"close"}:{isVisible:!1,animate:"close",data:null}:{isVisible:Boolean(e.on),data:e.on,animate:"none"}},t.prototype.render=function(){if(!this.state.isVisible)return null;var e={onClose:this.onClose,data:this.state.data,animate:this.state.animate};return this.props.children(e)},t}(r().PureComponent),Dc=function(e,t){return t?$s.drop(t.duration):e?$s.snap:$s.fluid},Ac=function(e,t){return e?t?js:Ns:null};function Rc(e){return"DRAGGING"===e.type?function(e){var t=e.dimension.client,r=e.offset,n=e.combineWith,i=e.dropping,a=Boolean(n),o=function(e){return null!=e.forceShouldAnimate?e.forceShouldAnimate:"SNAP"===e.mode}(e),s=Boolean(i),l=s?function(e,t){var r=Ms(e);return r?t?r+" scale("+Ls+")":r:null}(r,a):Bs(r);return{position:"fixed",top:t.marginBox.top,left:t.marginBox.left,boxSizing:"border-box",width:t.borderBox.width,height:t.borderBox.height,transition:Dc(o,i),transform:l,opacity:Ac(a,s),zIndex:s?4500:5e3,pointerEvents:"none"}}(e):{transform:Bs((t=e).offset),transition:t.shouldAnimateDisplacement?null:"none"};var t}function jc(e){e.preventDefault()}var Nc=function(e,t){return e===t},Lc=function(e){var t=e.combine,r=e.destination;return r?r.droppableId:t?t.droppableId:null};function qc(e){return{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,mode:null,draggingOver:null,combineTargetFor:e,combineWith:null}}var $c={mapped:{type:"SECONDARY",offset:Ja,combineTargetFor:null,shouldAnimateDisplacement:!0,snapshot:qc(null)}},Mc={dropAnimationFinished:function(){return{type:"DROP_ANIMATION_FINISHED",payload:null}}},Bc=(0,ya.connect)((function(){var e,t,r,n=(e=Na((function(e,t){return{x:e,y:t}})),t=Na((function(e,t,r,n,i){return{isDragging:!0,isClone:t,isDropAnimating:Boolean(i),dropAnimation:i,mode:e,draggingOver:r,combineWith:n,combineTargetFor:null}})),r=Na((function(e,r,n,i,a,o,s){return{mapped:{type:"DRAGGING",dropping:null,draggingOver:a,combineWith:o,mode:r,offset:e,dimension:n,forceShouldAnimate:s,snapshot:t(r,i,a,o,null)}}})),function(n,i){if(n.isDragging){if(n.critical.draggable.id!==i.draggableId)return null;var a=n.current.client.offset,o=n.dimensions.draggables[i.draggableId],s=ns(n.impact),l=(u=n.impact).at&&"COMBINE"===u.at.type?u.at.combine.draggableId:null,c=n.forceShouldAnimate;return r(e(a.x,a.y),n.movementMode,o,i.isClone,s,l,c)}var u;if("DROP_ANIMATING"===n.phase){var d=n.completed;if(d.result.draggableId!==i.draggableId)return null;var p=i.isClone,h=n.dimensions.draggables[i.draggableId],f=d.result,m=f.mode,g=Lc(f),b=function(e){return e.combine?e.combine.draggableId:null}(f),v={duration:n.dropDuration,curve:Rs,moveTo:n.newHomeClientOffset,opacity:b?js:null,scale:b?Ls:null};return{mapped:{type:"DRAGGING",offset:n.newHomeClientOffset,dimension:h,dropping:v,draggingOver:g,combineWith:b,mode:m,forceShouldAnimate:null,snapshot:t(m,p,g,b,v)}}}return null}),i=function(){var e=Na((function(e,t){return{x:e,y:t}})),t=Na(qc),r=Na((function(e,r,n){return void 0===r&&(r=null),{mapped:{type:"SECONDARY",offset:e,combineTargetFor:r,shouldAnimateDisplacement:n,snapshot:t(r)}}})),n=function(e){return e?r(Ja,e,!0):null},i=function(t,i,a,o){var s=a.displaced.visible[t],l=Boolean(o.inVirtualList&&o.effected[t]),c=_o(a),u=c&&c.draggableId===t?i:null;if(!s){if(!l)return n(u);if(a.displaced.invisible[t])return null;var d=ro(o.displacedBy.point),p=e(d.x,d.y);return r(p,u,!0)}if(l)return n(u);var h=a.displacedBy.point,f=e(h.x,h.y);return r(f,u,s.shouldAnimate)};return function(e,t){if(e.isDragging)return e.critical.draggable.id===t.draggableId?null:i(t.draggableId,e.critical.draggable.id,e.impact,e.afterCritical);if("DROP_ANIMATING"===e.phase){var r=e.completed;return r.result.draggableId===t.draggableId?null:i(t.draggableId,r.result.draggableId,r.impact,r.afterCritical)}return null}}();return function(e,t){return n(e,t)||i(e,t)||$c}}),Mc,null,{context:Nl,pure:!0,areStatePropsEqual:Nc})((function(e){var r=(0,t.useRef)(null),n=wa((function(e){r.current=e}),[]),i=wa((function(){return r.current}),[]),a=Sc(Fl),o=a.contextId,s=a.dragHandleUsageInstructionsId,l=a.registry,c=Sc(Cc),u=c.type,d=c.droppableId,p=xa((function(){return{id:e.draggableId,index:e.index,type:u,droppableId:d}}),[e.draggableId,e.index,u,d]),h=e.children,f=e.draggableId,m=e.isEnabled,g=e.shouldRespectForcePress,b=e.canDragInteractiveElements,v=e.isClone,y=e.mapped,O=e.dropAnimationFinished;v||function(e){var r=Bl("draggable"),n=e.descriptor,i=e.registry,a=e.getDraggableRef,o=e.canDragInteractiveElements,s=e.shouldRespectForcePress,l=e.isEnabled,c=xa((function(){return{canDragInteractiveElements:o,shouldRespectForcePress:s,isEnabled:l}}),[o,l,s]),u=wa((function(e){var t=a();return t||za(!1),function(e,t,r){void 0===r&&(r=Ja);var n=window.getComputedStyle(t),i=t.getBoundingClientRect(),a=Da(i,n),o=Ia(a,r);return{descriptor:e,placeholder:{client:a,tagName:t.tagName.toLowerCase(),display:n.display},displaceBy:{x:a.marginBox.width,y:a.marginBox.height},client:a,page:o}}(n,t,e)}),[n,a]),d=xa((function(){return{uniqueId:r,descriptor:n,options:c,getDimension:u}}),[n,u,c,r]),p=(0,t.useRef)(d),h=(0,t.useRef)(!0);Cl((function(){return i.draggable.register(p.current),function(){return i.draggable.unregister(p.current)}}),[i.draggable]),Cl((function(){if(h.current)h.current=!1;else{var e=p.current;p.current=d,i.draggable.update(d,e)}}),[d,i.draggable])}(xa((function(){return{descriptor:p,registry:l,getDraggableRef:i,canDragInteractiveElements:b,shouldRespectForcePress:g,isEnabled:m}}),[p,l,i,b,g,m]));var x=xa((function(){return m?{tabIndex:0,role:"button","aria-describedby":s,"data-rbd-drag-handle-draggable-id":f,"data-rbd-drag-handle-context-id":o,draggable:!1,onDragStart:jc}:null}),[o,s,f,m]),w=wa((function(e){"DRAGGING"===y.type&&y.dropping&&"transform"===e.propertyName&&O()}),[O,y]),_=xa((function(){var e=Rc(y),t="DRAGGING"===y.type&&y.dropping?w:null;return{innerRef:n,draggableProps:{"data-rbd-draggable-context-id":o,"data-rbd-draggable-id":f,style:e,onTransitionEnd:t},dragHandleProps:x}}),[o,x,f,y,w,n]),S=xa((function(){return{draggableId:p.id,type:p.type,source:{index:p.index,droppableId:p.droppableId}}}),[p.droppableId,p.id,p.index,p.type]);return h(_,y.snapshot,S)}));function Fc(e){return Sc(Cc).isUsingCloneFor!==e.draggableId||e.isClone?r().createElement(Bc,e):null}function Qc(e){var t="boolean"!=typeof e.isDragDisabled||!e.isDragDisabled,n=Boolean(e.disableInteractiveElementBlocking),i=Boolean(e.shouldRespectForcePress);return r().createElement(Fc,va({},e,{isClone:!1,isEnabled:t,canDragInteractiveElements:n,shouldRespectForcePress:i}))}var zc=function(e,t){return e===t.droppable.type},Vc=function(e,t){return t.draggables[e.draggable.id]},Uc={mode:"standard",type:"DEFAULT",direction:"vertical",isDropDisabled:!1,isCombineEnabled:!1,ignoreContainerClipping:!1,renderClone:null,getContainerForClone:function(){return document.body||za(!1),document.body}},Wc=(0,ya.connect)((function(){var e={placeholder:null,shouldAnimatePlaceholder:!0,snapshot:{isDraggingOver:!1,draggingOverWith:null,draggingFromThisWith:null,isUsingPlaceholder:!1},useClone:null},t=va({},e,{shouldAnimatePlaceholder:!1}),r=Na((function(e){return{draggableId:e.id,type:e.type,source:{index:e.index,droppableId:e.droppableId}}})),n=Na((function(n,i,a,o,s,l){var c=s.descriptor.id;if(s.descriptor.droppableId===n){var u=l?{render:l,dragging:r(s.descriptor)}:null,d={isDraggingOver:a,draggingOverWith:a?c:null,draggingFromThisWith:c,isUsingPlaceholder:!0};return{placeholder:s.placeholder,shouldAnimatePlaceholder:!1,snapshot:d,useClone:u}}if(!i)return t;if(!o)return e;var p={isDraggingOver:a,draggingOverWith:c,draggingFromThisWith:null,isUsingPlaceholder:!0};return{placeholder:s.placeholder,shouldAnimatePlaceholder:!0,snapshot:p,useClone:null}}));return function(r,i){var a=i.droppableId,o=i.type,s=!i.isDropDisabled,l=i.renderClone;if(r.isDragging){var c=r.critical;if(!zc(o,c))return t;var u=Vc(c,r.dimensions),d=ns(r.impact)===a;return n(a,s,d,d,u,l)}if("DROP_ANIMATING"===r.phase){var p=r.completed;if(!zc(o,p.critical))return t;var h=Vc(p.critical,r.dimensions);return n(a,s,Lc(p.result)===a,ns(p.impact)===a,h,l)}if("IDLE"===r.phase&&r.completed&&!r.shouldFlush){var f=r.completed;if(!zc(o,f.critical))return t;var m=ns(f.impact)===a,g=Boolean(f.impact.at&&"COMBINE"===f.impact.at.type),b=f.critical.droppable.id===a;return m?g?e:t:b?e:t}return t}}),{updateViewportMaxScroll:function(e){return{type:"UPDATE_VIEWPORT_MAX_SCROLL",payload:e}}},null,{context:Nl,pure:!0,areStatePropsEqual:Nc})((function(e){var n=(0,t.useContext)(Fl);n||za(!1);var i=n.contextId,a=n.isMovementAllowed,o=(0,t.useRef)(null),s=(0,t.useRef)(null),l=e.children,c=e.droppableId,u=e.type,d=e.mode,p=e.direction,h=e.ignoreContainerClipping,f=e.isDropDisabled,m=e.isCombineEnabled,g=e.snapshot,b=e.useClone,v=e.updateViewportMaxScroll,y=e.getContainerForClone,O=wa((function(){return o.current}),[]),x=wa((function(e){o.current=e}),[]),w=(wa((function(){return s.current}),[]),wa((function(e){s.current=e}),[])),_=wa((function(){a()&&v({maxScroll:tl()})}),[a,v]);!function(e){var r=(0,t.useRef)(null),n=Sc(Fl),i=Bl("droppable"),a=n.registry,o=n.marshal,s=Ql(e),l=xa((function(){return{id:e.droppableId,type:e.type,mode:e.mode}}),[e.droppableId,e.mode,e.type]),c=(0,t.useRef)(l),u=xa((function(){return Na((function(e,t){r.current||za(!1);var n={x:e,y:t};o.updateDroppableScroll(l.id,n)}))}),[l.id,o]),d=wa((function(){var e=r.current;return e&&e.env.closestScrollable?yc(e.env.closestScrollable):Ja}),[]),p=wa((function(){var e=d();u(e.x,e.y)}),[d,u]),h=xa((function(){return La(p)}),[p]),f=wa((function(){var e=r.current,t=Ec(e);e&&t||za(!1),e.scrollOptions.shouldPublishImmediately?p():h()}),[h,p]),m=wa((function(e,t){r.current&&za(!1);var i=s.current,a=i.getDroppableRef();a||za(!1);var o=function(e){return{closestScrollable:vc(e),isFixedOnPage:Oc(e)}}(a),c={ref:a,descriptor:l,env:o,scrollOptions:t};r.current=c;var u=function(e){var t=e.ref,r=e.descriptor,n=e.env,i=e.windowScroll,a=e.direction,o=e.isDropDisabled,s=e.isCombineEnabled,l=e.shouldClipSubject,c=n.closestScrollable,u=function(e,t){var r=Aa(e);if(!t)return r;if(e!==t)return r;var n=r.paddingBox.top-t.scrollTop,i=r.paddingBox.left-t.scrollLeft,a=n+t.scrollHeight,o=i+t.scrollWidth,s=Sa({top:n,right:o,bottom:a,left:i},r.border);return Pa({borderBox:s,margin:r.margin,border:r.border,padding:r.padding})}(t,c),d=Ia(u,i),p=function(){if(!c)return null;var e=Aa(c),t={scrollHeight:c.scrollHeight,scrollWidth:c.scrollWidth};return{client:e,page:Ia(e,i),scroll:yc(c),scrollSize:t,shouldClipSubject:l}}(),h=function(e){var t=e.descriptor,r=e.isEnabled,n=e.isCombineEnabled,i=e.isFixedOnPage,a=e.direction,o=e.client,s=e.page,l=e.closest,c=function(){if(!l)return null;var e=l.scrollSize,t=l.client,r=Zs({scrollHeight:e.scrollHeight,scrollWidth:e.scrollWidth,height:t.paddingBox.height,width:t.paddingBox.width});return{pageMarginBox:l.page.marginBox,frameClient:t,scrollSize:e,shouldClipSubject:l.shouldClipSubject,scroll:{initial:l.scroll,current:l.scroll,max:r,diff:{value:Ja,displacement:Ja}}}}(),u="vertical"===a?Ao:Ro;return{descriptor:t,isCombineEnabled:n,isFixedOnPage:i,axis:u,isEnabled:r,client:o,page:s,frame:c,subject:uo({page:s,withPlaceholder:null,axis:u,frame:c})}}({descriptor:r,isEnabled:!o,isCombineEnabled:s,isFixedOnPage:n.isFixedOnPage,direction:a,client:u,page:d,closest:p});return h}({ref:a,descriptor:l,env:o,windowScroll:e,direction:i.direction,isDropDisabled:i.isDropDisabled,isCombineEnabled:i.isCombineEnabled,shouldClipSubject:!i.ignoreContainerClipping}),d=o.closestScrollable;return d&&(d.setAttribute(Pl,n.contextId),d.addEventListener("scroll",f,_c(c.scrollOptions))),u}),[n.contextId,l,f,s]),g=wa((function(){var e=r.current,t=Ec(e);return e&&t||za(!1),yc(t)}),[]),b=wa((function(){var e=r.current;e||za(!1);var t=Ec(e);r.current=null,t&&(h.cancel(),t.removeAttribute(Pl),t.removeEventListener("scroll",f,_c(e.scrollOptions)))}),[f,h]),v=wa((function(e){var t=r.current;t||za(!1);var n=Ec(t);n||za(!1),n.scrollTop+=e.y,n.scrollLeft+=e.x}),[]),y=xa((function(){return{getDimensionAndWatchScroll:m,getScrollWhileDragging:g,dragStopped:b,scroll:v}}),[b,m,g,v]),O=xa((function(){return{uniqueId:i,descriptor:l,callbacks:y}}),[y,l,i]);Cl((function(){return c.current=O.descriptor,a.droppable.register(O),function(){r.current&&b(),a.droppable.unregister(O)}}),[y,l,b,O,o,a.droppable]),Cl((function(){r.current&&o.updateDroppableIsEnabled(c.current.id,!e.isDropDisabled)}),[e.isDropDisabled,o]),Cl((function(){r.current&&o.updateDroppableIsCombineEnabled(c.current.id,e.isCombineEnabled)}),[e.isCombineEnabled,o])}({droppableId:c,type:u,mode:d,direction:p,isDropDisabled:f,isCombineEnabled:m,ignoreContainerClipping:h,getDroppableRef:O});var S=r().createElement(Ic,{on:e.placeholder,shouldAnimate:e.shouldAnimatePlaceholder},(function(e){var t=e.onClose,n=e.data,a=e.animate;return r().createElement(Tc,{placeholder:n,onClose:t,innerRef:w,animate:a,contextId:i,onTransitionEnd:_})})),E=xa((function(){return{innerRef:x,placeholder:S,droppableProps:{"data-rbd-droppable-id":c,"data-rbd-droppable-context-id":i}}}),[i,c,S,x]),k=b?b.dragging.draggableId:null,P=xa((function(){return{droppableId:c,type:u,isUsingCloneFor:k}}),[c,k,u]);return r().createElement(Cc.Provider,{value:P},l(E,g),function(){if(!b)return null;var e=b.dragging,t=b.render,n=r().createElement(Fc,{draggableId:e.draggableId,index:e.source.index,isClone:!0,isEnabled:!0,shouldRespectForcePress:!1,canDragInteractiveElements:!0},(function(r,n){return t(r,n,e)}));return $a().createPortal(n,y())}())}));function Xc(e){var r=(0,t.useRef)();return(0,t.useEffect)((function(){r.current=e})),r.current}function Gc(){return Gc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Gc.apply(this,arguments)}function Hc(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function Yc(e){return e instanceof Hc(e).Element||e instanceof Element}function Kc(e){return e instanceof Hc(e).HTMLElement||e instanceof HTMLElement}function Jc(e){return"undefined"!=typeof ShadowRoot&&(e instanceof Hc(e).ShadowRoot||e instanceof ShadowRoot)}Wc.defaultProps=Uc;var Zc=Math.max,eu=Math.min,tu=Math.round;function ru(e,t){void 0===t&&(t=!1);var r=e.getBoundingClientRect(),n=1,i=1;if(Kc(e)&&t){var a=e.offsetHeight,o=e.offsetWidth;o>0&&(n=tu(r.width)/o||1),a>0&&(i=tu(r.height)/a||1)}return{width:r.width/n,height:r.height/i,top:r.top/i,right:r.right/n,bottom:r.bottom/i,left:r.left/n,x:r.left/n,y:r.top/i}}function nu(e){var t=Hc(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function iu(e){return e?(e.nodeName||"").toLowerCase():null}function au(e){return((Yc(e)?e.ownerDocument:e.document)||window.document).documentElement}function ou(e){return ru(au(e)).left+nu(e).scrollLeft}function su(e){return Hc(e).getComputedStyle(e)}function lu(e){var t=su(e),r=t.overflow,n=t.overflowX,i=t.overflowY;return/auto|scroll|overlay|hidden/.test(r+i+n)}function cu(e,t,r){void 0===r&&(r=!1);var n,i,a=Kc(t),o=Kc(t)&&function(e){var t=e.getBoundingClientRect(),r=tu(t.width)/e.offsetWidth||1,n=tu(t.height)/e.offsetHeight||1;return 1!==r||1!==n}(t),s=au(t),l=ru(e,o),c={scrollLeft:0,scrollTop:0},u={x:0,y:0};return(a||!a&&!r)&&(("body"!==iu(t)||lu(s))&&(c=(n=t)!==Hc(n)&&Kc(n)?{scrollLeft:(i=n).scrollLeft,scrollTop:i.scrollTop}:nu(n)),Kc(t)?((u=ru(t,!0)).x+=t.clientLeft,u.y+=t.clientTop):s&&(u.x=ou(s))),{x:l.left+c.scrollLeft-u.x,y:l.top+c.scrollTop-u.y,width:l.width,height:l.height}}function uu(e){var t=ru(e),r=e.offsetWidth,n=e.offsetHeight;return Math.abs(t.width-r)<=1&&(r=t.width),Math.abs(t.height-n)<=1&&(n=t.height),{x:e.offsetLeft,y:e.offsetTop,width:r,height:n}}function du(e){return"html"===iu(e)?e:e.assignedSlot||e.parentNode||(Jc(e)?e.host:null)||au(e)}function pu(e){return["html","body","#document"].indexOf(iu(e))>=0?e.ownerDocument.body:Kc(e)&&lu(e)?e:pu(du(e))}function hu(e,t){var r;void 0===t&&(t=[]);var n=pu(e),i=n===(null==(r=e.ownerDocument)?void 0:r.body),a=Hc(n),o=i?[a].concat(a.visualViewport||[],lu(n)?n:[]):n,s=t.concat(o);return i?s:s.concat(hu(du(o)))}function fu(e){return["table","td","th"].indexOf(iu(e))>=0}function mu(e){return Kc(e)&&"fixed"!==su(e).position?e.offsetParent:null}function gu(e){for(var t=Hc(e),r=mu(e);r&&fu(r)&&"static"===su(r).position;)r=mu(r);return r&&("html"===iu(r)||"body"===iu(r)&&"static"===su(r).position)?t:r||function(e){var t=-1!==navigator.userAgent.toLowerCase().indexOf("firefox");if(-1!==navigator.userAgent.indexOf("Trident")&&Kc(e)&&"fixed"===su(e).position)return null;var r=du(e);for(Jc(r)&&(r=r.host);Kc(r)&&["html","body"].indexOf(iu(r))<0;){var n=su(r);if("none"!==n.transform||"none"!==n.perspective||"paint"===n.contain||-1!==["transform","perspective"].indexOf(n.willChange)||t&&"filter"===n.willChange||t&&n.filter&&"none"!==n.filter)return r;r=r.parentNode}return null}(e)||t}var bu="top",vu="bottom",yu="right",Ou="left",xu="auto",wu=[bu,vu,yu,Ou],_u="start",Su="end",Eu="viewport",ku="popper",Pu=wu.reduce((function(e,t){return e.concat([t+"-"+_u,t+"-"+Su])}),[]),Tu=[].concat(wu,[xu]).reduce((function(e,t){return e.concat([t,t+"-"+_u,t+"-"+Su])}),[]),Cu=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function Iu(e){var t=new Map,r=new Set,n=[];function i(e){r.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach((function(e){if(!r.has(e)){var n=t.get(e);n&&i(n)}})),n.push(e)}return e.forEach((function(e){t.set(e.name,e)})),e.forEach((function(e){r.has(e.name)||i(e)})),n}function Du(e){var t;return function(){return t||(t=new Promise((function(r){Promise.resolve().then((function(){t=void 0,r(e())}))}))),t}}var Au={placement:"bottom",modifiers:[],strategy:"absolute"};function Ru(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return!t.some((function(e){return!(e&&"function"==typeof e.getBoundingClientRect)}))}function ju(e){void 0===e&&(e={});var t=e,r=t.defaultModifiers,n=void 0===r?[]:r,i=t.defaultOptions,a=void 0===i?Au:i;return function(e,t,r){void 0===r&&(r=a);var i={placement:"bottom",orderedModifiers:[],options:Object.assign({},Au,a),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},o=[],s=!1,l={state:i,setOptions:function(r){var s="function"==typeof r?r(i.options):r;c(),i.options=Object.assign({},a,i.options,s),i.scrollParents={reference:Yc(e)?hu(e):e.contextElement?hu(e.contextElement):[],popper:hu(t)};var u,d,p=function(e){var t=Iu(e);return Cu.reduce((function(e,r){return e.concat(t.filter((function(e){return e.phase===r})))}),[])}((u=[].concat(n,i.options.modifiers),d=u.reduce((function(e,t){var r=e[t.name];return e[t.name]=r?Object.assign({},r,t,{options:Object.assign({},r.options,t.options),data:Object.assign({},r.data,t.data)}):t,e}),{}),Object.keys(d).map((function(e){return d[e]}))));return i.orderedModifiers=p.filter((function(e){return e.enabled})),i.orderedModifiers.forEach((function(e){var t=e.name,r=e.options,n=void 0===r?{}:r,a=e.effect;if("function"==typeof a){var s=a({state:i,name:t,instance:l,options:n});o.push(s||function(){})}})),l.update()},forceUpdate:function(){if(!s){var e=i.elements,t=e.reference,r=e.popper;if(Ru(t,r)){i.rects={reference:cu(t,gu(r),"fixed"===i.options.strategy),popper:uu(r)},i.reset=!1,i.placement=i.options.placement,i.orderedModifiers.forEach((function(e){return i.modifiersData[e.name]=Object.assign({},e.data)}));for(var n=0;n<i.orderedModifiers.length;n++)if(!0!==i.reset){var a=i.orderedModifiers[n],o=a.fn,c=a.options,u=void 0===c?{}:c,d=a.name;"function"==typeof o&&(i=o({state:i,options:u,name:d,instance:l})||i)}else i.reset=!1,n=-1}}},update:Du((function(){return new Promise((function(e){l.forceUpdate(),e(i)}))})),destroy:function(){c(),s=!0}};if(!Ru(e,t))return l;function c(){o.forEach((function(e){return e()})),o=[]}return l.setOptions(r).then((function(e){!s&&r.onFirstUpdate&&r.onFirstUpdate(e)})),l}}var Nu={passive:!0};const Lu={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,r=e.instance,n=e.options,i=n.scroll,a=void 0===i||i,o=n.resize,s=void 0===o||o,l=Hc(t.elements.popper),c=[].concat(t.scrollParents.reference,t.scrollParents.popper);return a&&c.forEach((function(e){e.addEventListener("scroll",r.update,Nu)})),s&&l.addEventListener("resize",r.update,Nu),function(){a&&c.forEach((function(e){e.removeEventListener("scroll",r.update,Nu)})),s&&l.removeEventListener("resize",r.update,Nu)}},data:{}};function qu(e){return e.split("-")[0]}function $u(e){return e.split("-")[1]}function Mu(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function Bu(e){var t,r=e.reference,n=e.element,i=e.placement,a=i?qu(i):null,o=i?$u(i):null,s=r.x+r.width/2-n.width/2,l=r.y+r.height/2-n.height/2;switch(a){case bu:t={x:s,y:r.y-n.height};break;case vu:t={x:s,y:r.y+r.height};break;case yu:t={x:r.x+r.width,y:l};break;case Ou:t={x:r.x-n.width,y:l};break;default:t={x:r.x,y:r.y}}var c=a?Mu(a):null;if(null!=c){var u="y"===c?"height":"width";switch(o){case _u:t[c]=t[c]-(r[u]/2-n[u]/2);break;case Su:t[c]=t[c]+(r[u]/2-n[u]/2)}}return t}var Fu={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Qu(e){var t,r=e.popper,n=e.popperRect,i=e.placement,a=e.variation,o=e.offsets,s=e.position,l=e.gpuAcceleration,c=e.adaptive,u=e.roundOffsets,d=e.isFixed,p=o.x,h=void 0===p?0:p,f=o.y,m=void 0===f?0:f,g="function"==typeof u?u({x:h,y:m}):{x:h,y:m};h=g.x,m=g.y;var b=o.hasOwnProperty("x"),v=o.hasOwnProperty("y"),y=Ou,O=bu,x=window;if(c){var w=gu(r),_="clientHeight",S="clientWidth";w===Hc(r)&&"static"!==su(w=au(r)).position&&"absolute"===s&&(_="scrollHeight",S="scrollWidth"),(i===bu||(i===Ou||i===yu)&&a===Su)&&(O=vu,m-=(d&&w===x&&x.visualViewport?x.visualViewport.height:w[_])-n.height,m*=l?1:-1),i!==Ou&&(i!==bu&&i!==vu||a!==Su)||(y=yu,h-=(d&&w===x&&x.visualViewport?x.visualViewport.width:w[S])-n.width,h*=l?1:-1)}var E,k=Object.assign({position:s},c&&Fu),P=!0===u?function(e){var t=e.x,r=e.y,n=window.devicePixelRatio||1;return{x:tu(t*n)/n||0,y:tu(r*n)/n||0}}({x:h,y:m}):{x:h,y:m};return h=P.x,m=P.y,l?Object.assign({},k,((E={})[O]=v?"0":"",E[y]=b?"0":"",E.transform=(x.devicePixelRatio||1)<=1?"translate("+h+"px, "+m+"px)":"translate3d("+h+"px, "+m+"px, 0)",E)):Object.assign({},k,((t={})[O]=v?m+"px":"",t[y]=b?h+"px":"",t.transform="",t))}const zu={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,r=e.options,n=r.gpuAcceleration,i=void 0===n||n,a=r.adaptive,o=void 0===a||a,s=r.roundOffsets,l=void 0===s||s,c={placement:qu(t.placement),variation:$u(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:i,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,Qu(Object.assign({},c,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:o,roundOffsets:l})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,Qu(Object.assign({},c,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}},Vu={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,r=e.options,n=e.name,i=r.offset,a=void 0===i?[0,0]:i,o=Tu.reduce((function(e,r){return e[r]=function(e,t,r){var n=qu(e),i=[Ou,bu].indexOf(n)>=0?-1:1,a="function"==typeof r?r(Object.assign({},t,{placement:e})):r,o=a[0],s=a[1];return o=o||0,s=(s||0)*i,[Ou,yu].indexOf(n)>=0?{x:s,y:o}:{x:o,y:s}}(r,t.rects,a),e}),{}),s=o[t.placement],l=s.x,c=s.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=l,t.modifiersData.popperOffsets.y+=c),t.modifiersData[n]=o}};var Uu={left:"right",right:"left",bottom:"top",top:"bottom"};function Wu(e){return e.replace(/left|right|bottom|top/g,(function(e){return Uu[e]}))}var Xu={start:"end",end:"start"};function Gu(e){return e.replace(/start|end/g,(function(e){return Xu[e]}))}function Hu(e,t){var r=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(r&&Jc(r)){var n=t;do{if(n&&e.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function Yu(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function Ku(e,t){return t===Eu?Yu(function(e){var t=Hc(e),r=au(e),n=t.visualViewport,i=r.clientWidth,a=r.clientHeight,o=0,s=0;return n&&(i=n.width,a=n.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(o=n.offsetLeft,s=n.offsetTop)),{width:i,height:a,x:o+ou(e),y:s}}(e)):Yc(t)?function(e){var t=ru(e);return t.top=t.top+e.clientTop,t.left=t.left+e.clientLeft,t.bottom=t.top+e.clientHeight,t.right=t.left+e.clientWidth,t.width=e.clientWidth,t.height=e.clientHeight,t.x=t.left,t.y=t.top,t}(t):Yu(function(e){var t,r=au(e),n=nu(e),i=null==(t=e.ownerDocument)?void 0:t.body,a=Zc(r.scrollWidth,r.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),o=Zc(r.scrollHeight,r.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),s=-n.scrollLeft+ou(e),l=-n.scrollTop;return"rtl"===su(i||r).direction&&(s+=Zc(r.clientWidth,i?i.clientWidth:0)-a),{width:a,height:o,x:s,y:l}}(au(e)))}function Ju(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function Zu(e,t){return t.reduce((function(t,r){return t[r]=e,t}),{})}function ed(e,t){void 0===t&&(t={});var r=t,n=r.placement,i=void 0===n?e.placement:n,a=r.boundary,o=void 0===a?"clippingParents":a,s=r.rootBoundary,l=void 0===s?Eu:s,c=r.elementContext,u=void 0===c?ku:c,d=r.altBoundary,p=void 0!==d&&d,h=r.padding,f=void 0===h?0:h,m=Ju("number"!=typeof f?f:Zu(f,wu)),g=u===ku?"reference":ku,b=e.rects.popper,v=e.elements[p?g:u],y=function(e,t,r){var n="clippingParents"===t?function(e){var t=hu(du(e)),r=["absolute","fixed"].indexOf(su(e).position)>=0&&Kc(e)?gu(e):e;return Yc(r)?t.filter((function(e){return Yc(e)&&Hu(e,r)&&"body"!==iu(e)})):[]}(e):[].concat(t),i=[].concat(n,[r]),a=i[0],o=i.reduce((function(t,r){var n=Ku(e,r);return t.top=Zc(n.top,t.top),t.right=eu(n.right,t.right),t.bottom=eu(n.bottom,t.bottom),t.left=Zc(n.left,t.left),t}),Ku(e,a));return o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}(Yc(v)?v:v.contextElement||au(e.elements.popper),o,l),O=ru(e.elements.reference),x=Bu({reference:O,element:b,strategy:"absolute",placement:i}),w=Yu(Object.assign({},b,x)),_=u===ku?w:O,S={top:y.top-_.top+m.top,bottom:_.bottom-y.bottom+m.bottom,left:y.left-_.left+m.left,right:_.right-y.right+m.right},E=e.modifiersData.offset;if(u===ku&&E){var k=E[i];Object.keys(S).forEach((function(e){var t=[yu,vu].indexOf(e)>=0?1:-1,r=[bu,vu].indexOf(e)>=0?"y":"x";S[e]+=k[r]*t}))}return S}const td={name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,r=e.options,n=e.name;if(!t.modifiersData[n]._skip){for(var i=r.mainAxis,a=void 0===i||i,o=r.altAxis,s=void 0===o||o,l=r.fallbackPlacements,c=r.padding,u=r.boundary,d=r.rootBoundary,p=r.altBoundary,h=r.flipVariations,f=void 0===h||h,m=r.allowedAutoPlacements,g=t.options.placement,b=qu(g),v=l||(b!==g&&f?function(e){if(qu(e)===xu)return[];var t=Wu(e);return[Gu(e),t,Gu(t)]}(g):[Wu(g)]),y=[g].concat(v).reduce((function(e,r){return e.concat(qu(r)===xu?function(e,t){void 0===t&&(t={});var r=t,n=r.placement,i=r.boundary,a=r.rootBoundary,o=r.padding,s=r.flipVariations,l=r.allowedAutoPlacements,c=void 0===l?Tu:l,u=$u(n),d=u?s?Pu:Pu.filter((function(e){return $u(e)===u})):wu,p=d.filter((function(e){return c.indexOf(e)>=0}));0===p.length&&(p=d);var h=p.reduce((function(t,r){return t[r]=ed(e,{placement:r,boundary:i,rootBoundary:a,padding:o})[qu(r)],t}),{});return Object.keys(h).sort((function(e,t){return h[e]-h[t]}))}(t,{placement:r,boundary:u,rootBoundary:d,padding:c,flipVariations:f,allowedAutoPlacements:m}):r)}),[]),O=t.rects.reference,x=t.rects.popper,w=new Map,_=!0,S=y[0],E=0;E<y.length;E++){var k=y[E],P=qu(k),T=$u(k)===_u,C=[bu,vu].indexOf(P)>=0,I=C?"width":"height",D=ed(t,{placement:k,boundary:u,rootBoundary:d,altBoundary:p,padding:c}),A=C?T?yu:Ou:T?vu:bu;O[I]>x[I]&&(A=Wu(A));var R=Wu(A),j=[];if(a&&j.push(D[P]<=0),s&&j.push(D[A]<=0,D[R]<=0),j.every((function(e){return e}))){S=k,_=!1;break}w.set(k,j)}if(_)for(var N=function(e){var t=y.find((function(t){var r=w.get(t);if(r)return r.slice(0,e).every((function(e){return e}))}));if(t)return S=t,"break"},L=f?3:1;L>0&&"break"!==N(L);L--);t.placement!==S&&(t.modifiersData[n]._skip=!0,t.placement=S,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function rd(e,t,r){return Zc(e,eu(t,r))}const nd={name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,r=e.options,n=e.name,i=r.mainAxis,a=void 0===i||i,o=r.altAxis,s=void 0!==o&&o,l=r.boundary,c=r.rootBoundary,u=r.altBoundary,d=r.padding,p=r.tether,h=void 0===p||p,f=r.tetherOffset,m=void 0===f?0:f,g=ed(t,{boundary:l,rootBoundary:c,padding:d,altBoundary:u}),b=qu(t.placement),v=$u(t.placement),y=!v,O=Mu(b),x="x"===O?"y":"x",w=t.modifiersData.popperOffsets,_=t.rects.reference,S=t.rects.popper,E="function"==typeof m?m(Object.assign({},t.rects,{placement:t.placement})):m,k="number"==typeof E?{mainAxis:E,altAxis:E}:Object.assign({mainAxis:0,altAxis:0},E),P=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,T={x:0,y:0};if(w){if(a){var C,I="y"===O?bu:Ou,D="y"===O?vu:yu,A="y"===O?"height":"width",R=w[O],j=R+g[I],N=R-g[D],L=h?-S[A]/2:0,q=v===_u?_[A]:S[A],$=v===_u?-S[A]:-_[A],M=t.elements.arrow,B=h&&M?uu(M):{width:0,height:0},F=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},Q=F[I],z=F[D],V=rd(0,_[A],B[A]),U=y?_[A]/2-L-V-Q-k.mainAxis:q-V-Q-k.mainAxis,W=y?-_[A]/2+L+V+z+k.mainAxis:$+V+z+k.mainAxis,X=t.elements.arrow&&gu(t.elements.arrow),G=X?"y"===O?X.clientTop||0:X.clientLeft||0:0,H=null!=(C=null==P?void 0:P[O])?C:0,Y=R+W-H,K=rd(h?eu(j,R+U-H-G):j,R,h?Zc(N,Y):N);w[O]=K,T[O]=K-R}if(s){var J,Z="x"===O?bu:Ou,ee="x"===O?vu:yu,te=w[x],re="y"===x?"height":"width",ne=te+g[Z],ie=te-g[ee],ae=-1!==[bu,Ou].indexOf(b),oe=null!=(J=null==P?void 0:P[x])?J:0,se=ae?ne:te-_[re]-S[re]-oe+k.altAxis,le=ae?te+_[re]+S[re]-oe-k.altAxis:ie,ce=h&&ae?function(e,t,r){var n=rd(e,t,r);return n>r?r:n}(se,te,le):rd(h?se:ne,te,h?le:ie);w[x]=ce,T[x]=ce-te}t.modifiersData[n]=T}},requiresIfExists:["offset"]},id={name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,r=e.state,n=e.name,i=e.options,a=r.elements.arrow,o=r.modifiersData.popperOffsets,s=qu(r.placement),l=Mu(s),c=[Ou,yu].indexOf(s)>=0?"height":"width";if(a&&o){var u=function(e,t){return Ju("number"!=typeof(e="function"==typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:Zu(e,wu))}(i.padding,r),d=uu(a),p="y"===l?bu:Ou,h="y"===l?vu:yu,f=r.rects.reference[c]+r.rects.reference[l]-o[l]-r.rects.popper[c],m=o[l]-r.rects.reference[l],g=gu(a),b=g?"y"===l?g.clientHeight||0:g.clientWidth||0:0,v=f/2-m/2,y=u[p],O=b-d[c]-u[h],x=b/2-d[c]/2+v,w=rd(y,x,O),_=l;r.modifiersData[n]=((t={})[_]=w,t.centerOffset=w-x,t)}},effect:function(e){var t=e.state,r=e.options.element,n=void 0===r?"[data-popper-arrow]":r;null!=n&&("string"!=typeof n||(n=t.elements.popper.querySelector(n)))&&Hu(t.elements.popper,n)&&(t.elements.arrow=n)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function ad(e,t,r){return void 0===r&&(r={x:0,y:0}),{top:e.top-t.height-r.y,right:e.right-t.width+r.x,bottom:e.bottom-t.height+r.y,left:e.left-t.width-r.x}}function od(e){return[bu,yu,vu,Ou].some((function(t){return e[t]>=0}))}var sd=ju({defaultModifiers:[Lu,{name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,r=e.name;t.modifiersData[r]=Bu({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}},zu,{name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach((function(e){var r=t.styles[e]||{},n=t.attributes[e]||{},i=t.elements[e];Kc(i)&&iu(i)&&(Object.assign(i.style,r),Object.keys(n).forEach((function(e){var t=n[e];!1===t?i.removeAttribute(e):i.setAttribute(e,!0===t?"":t)})))}))},effect:function(e){var t=e.state,r={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,r.popper),t.styles=r,t.elements.arrow&&Object.assign(t.elements.arrow.style,r.arrow),function(){Object.keys(t.elements).forEach((function(e){var n=t.elements[e],i=t.attributes[e]||{},a=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:r[e]).reduce((function(e,t){return e[t]="",e}),{});Kc(n)&&iu(n)&&(Object.assign(n.style,a),Object.keys(i).forEach((function(e){n.removeAttribute(e)})))}))}},requires:["computeStyles"]},Vu,td,nd,id,{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,r=e.name,n=t.rects.reference,i=t.rects.popper,a=t.modifiersData.preventOverflow,o=ed(t,{elementContext:"reference"}),s=ed(t,{altBoundary:!0}),l=ad(o,n),c=ad(s,i,a),u=od(l),d=od(c);t.modifiersData[r]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:u,hasPopperEscaped:d},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":d})}}]}),ld=m(4335),cd=m.n(ld),ud=function(e){return e.reduce((function(e,t){var r=t[0],n=t[1];return e[r]=n,e}),{})},dd="undefined"!=typeof window&&window.document&&window.document.createElement?t.useLayoutEffect:t.useEffect,pd=[];function hd(e){var r=t.useRef(e);return r.current=e,t.useCallback((function(){return r.current}),[])}var fd=function(){};function md(e,t){return void 0===e&&(e=0),void 0===t&&(t=0),function(){return{width:0,height:0,top:t,right:e,bottom:t,left:e,x:0,y:0,toJSON:function(){return null}}}}var gd=["styles","attributes"],bd={getBoundingClientRect:md()},vd={closeOnOutsideClick:!0,closeOnTriggerHidden:!1,defaultVisible:!1,delayHide:0,delayShow:0,followCursor:!1,interactive:!1,mutationObserverOptions:{attributes:!0,childList:!0,subtree:!0},offset:[0,6],trigger:"hover"};function yd(){return yd=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yd.apply(this,arguments)}const Od=r().memo((({def:e,operation:n})=>{const i=(0,a.useStyles2)(xd),[o,s]=(0,t.useState)(!1),{getTooltipProps:l,setTooltipRef:c,setTriggerRef:u,visible:d}=function(e,r){var n,i,a;void 0===e&&(e={}),void 0===r&&(r={});var o=Object.keys(vd).reduce((function(e,t){var r;return Gc({},e,((r={})[t]=void 0!==e[t]?e[t]:vd[t],r))}),e),s=t.useMemo((function(){return[{name:"offset",options:{offset:o.offset}}]}),Array.isArray(o.offset)?o.offset:[]),l=Gc({},r,{placement:r.placement||o.placement,modifiers:r.modifiers||s}),c=t.useState(null),u=c[0],d=c[1],p=t.useState(null),h=p[0],f=p[1],m=function(e){var r=e.initial,n=e.value,i=e.onChange,a=void 0===i?fd:i;if(void 0===r&&void 0===n)throw new TypeError('Either "value" or "initial" variable must be set. Now both are undefined');var o=t.useState(r),s=o[0],l=o[1],c=hd(s),u=t.useCallback((function(e){var t=c(),r="function"==typeof e?e(t):e;"function"==typeof r.persist&&r.persist(),l(r),"function"==typeof a&&a(r)}),[c,a]),d=void 0!==n;return[d?n:s,d?a:u]}({initial:o.defaultVisible,value:o.visible,onChange:o.onVisibleChange}),g=m[0],b=m[1],v=t.useRef();t.useEffect((function(){return function(){return clearTimeout(v.current)}}),[]);var y=function(e,r,n){void 0===n&&(n={});var i=t.useRef(null),a={onFirstUpdate:n.onFirstUpdate,placement:n.placement||"bottom",strategy:n.strategy||"absolute",modifiers:n.modifiers||pd},o=t.useState({styles:{popper:{position:a.strategy,left:"0",top:"0"},arrow:{position:"absolute"}},attributes:{}}),s=o[0],l=o[1],c=t.useMemo((function(){return{name:"updateState",enabled:!0,phase:"write",fn:function(e){var t=e.state,r=Object.keys(t.elements);qa.flushSync((function(){l({styles:ud(r.map((function(e){return[e,t.styles[e]||{}]}))),attributes:ud(r.map((function(e){return[e,t.attributes[e]]})))})}))},requires:["computeStyles"]}}),[]),u=t.useMemo((function(){var e={onFirstUpdate:a.onFirstUpdate,placement:a.placement,strategy:a.strategy,modifiers:[].concat(a.modifiers,[c,{name:"applyStyles",enabled:!1}])};return cd()(i.current,e)?i.current||e:(i.current=e,e)}),[a.onFirstUpdate,a.placement,a.strategy,a.modifiers,c]),d=t.useRef();return dd((function(){d.current&&d.current.setOptions(u)}),[u]),dd((function(){if(null!=e&&null!=r){var t=(n.createPopper||sd)(e,r,u);return d.current=t,function(){t.destroy(),d.current=null}}}),[e,r,n.createPopper]),{state:d.current?d.current.state:null,styles:s.styles,attributes:s.attributes,update:d.current?d.current.update:null,forceUpdate:d.current?d.current.forceUpdate:null}}(o.followCursor?bd:u,h,l),O=y.styles,x=y.attributes,w=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(y,gd),_=w.update,S=hd({visible:g,triggerRef:u,tooltipRef:h,finalConfig:o}),E=t.useCallback((function(e){return Array.isArray(o.trigger)?o.trigger.includes(e):o.trigger===e}),Array.isArray(o.trigger)?o.trigger:[o.trigger]),k=t.useCallback((function(){clearTimeout(v.current),v.current=window.setTimeout((function(){return b(!1)}),o.delayHide)}),[o.delayHide,b]),P=t.useCallback((function(){clearTimeout(v.current),v.current=window.setTimeout((function(){return b(!0)}),o.delayShow)}),[o.delayShow,b]),T=t.useCallback((function(){S().visible?k():P()}),[S,k,P]);t.useEffect((function(){if(S().finalConfig.closeOnOutsideClick){var e=function(e){var t,r=S(),n=r.tooltipRef,i=r.triggerRef,a=(null==e.composedPath||null==(t=e.composedPath())?void 0:t[0])||e.target;a instanceof Node&&(null==n||null==i||n.contains(a)||i.contains(a)||k())};return document.addEventListener("mousedown",e),function(){return document.removeEventListener("mousedown",e)}}}),[S,k]),t.useEffect((function(){if(null!=u&&E("click"))return u.addEventListener("click",T),function(){return u.removeEventListener("click",T)}}),[u,E,T]),t.useEffect((function(){if(null!=u&&E("double-click"))return u.addEventListener("dblclick",T),function(){return u.removeEventListener("dblclick",T)}}),[u,E,T]),t.useEffect((function(){if(null!=u&&E("right-click")){var e=function(e){e.preventDefault(),T()};return u.addEventListener("contextmenu",e),function(){return u.removeEventListener("contextmenu",e)}}}),[u,E,T]),t.useEffect((function(){if(null!=u&&E("focus"))return u.addEventListener("focus",P),u.addEventListener("blur",k),function(){u.removeEventListener("focus",P),u.removeEventListener("blur",k)}}),[u,E,P,k]),t.useEffect((function(){if(null!=u&&E("hover"))return u.addEventListener("mouseenter",P),u.addEventListener("mouseleave",k),function(){u.removeEventListener("mouseenter",P),u.removeEventListener("mouseleave",k)}}),[u,E,P,k]),t.useEffect((function(){if(null!=h&&E("hover")&&S().finalConfig.interactive)return h.addEventListener("mouseenter",P),h.addEventListener("mouseleave",k),function(){h.removeEventListener("mouseenter",P),h.removeEventListener("mouseleave",k)}}),[h,E,P,k,S]);var C=null==w||null==(n=w.state)||null==(i=n.modifiersData)||null==(a=i.hide)?void 0:a.isReferenceHidden;return t.useEffect((function(){o.closeOnTriggerHidden&&C&&k()}),[o.closeOnTriggerHidden,k,C]),t.useEffect((function(){if(o.followCursor&&null!=u)return u.addEventListener("mousemove",e),function(){return u.removeEventListener("mousemove",e)};function e(e){var t=e.clientX,r=e.clientY;bd.getBoundingClientRect=md(t,r),null==_||_()}}),[o.followCursor,u,_]),t.useEffect((function(){if(null!=h&&null!=_&&null!=o.mutationObserverOptions){var e=new MutationObserver(_);return e.observe(h,o.mutationObserverOptions),function(){return e.disconnect()}}}),[o.mutationObserverOptions,h,_]),Gc({getArrowProps:function(e){return void 0===e&&(e={}),Gc({},e,x.arrow,{style:Gc({},e.style,O.arrow),"data-popper-arrow":!0})},getTooltipProps:function(e){return void 0===e&&(e={}),Gc({},e,{style:Gc({},e.style,O.popper)},x.popper,{"data-popper-interactive":o.interactive})},setTooltipRef:f,setTriggerRef:d,tooltipRef:h,triggerRef:u,visible:g},w)}({placement:"top",visible:o,offset:[0,16],onVisibleChange:s,interactive:!0,trigger:["click"]});return r().createElement(r().Fragment,null,r().createElement(a.Button,{title:"Click to show description",ref:u,icon:"info-circle",size:"sm",variant:"secondary",fill:"text"}),d&&r().createElement(a.Portal,null,r().createElement("div",yd({ref:c},l(),{className:i.docBox}),r().createElement("div",{className:i.docBoxHeader},r().createElement("span",null,e.renderer(n,e,"<expr>")),r().createElement(j,{grow:1}),r().createElement(a.Button,{icon:"times",onClick:()=>s(!1),fill:"text",variant:"secondary",title:"Remove operation"})),r().createElement("div",{className:i.docBoxBody,dangerouslySetInnerHTML:{__html:wd(e,n)}}))))}));Od.displayName="OperationDocs";const xd=e=>({docBox:(0,o.css)({overflow:"hidden",background:e.colors.background.primary,border:`1px solid ${e.colors.border.strong}`,boxShadow:e.shadows.z3,maxWidth:"600px",padding:e.spacing(1),borderRadius:e.shape.borderRadius(),zIndex:e.zIndex.tooltip}),docBoxHeader:(0,o.css)({fontSize:e.typography.h5.fontSize,fontFamily:e.typography.fontFamilyMonospace,paddingBottom:e.spacing(1),display:"flex",alignItems:"center"}),docBoxBody:(0,o.css)({marginBottom:e.spacing(-1),color:e.colors.text.secondary}),signature:(0,o.css)({fontSize:e.typography.bodySmall.fontSize,fontFamily:e.typography.fontFamilyMonospace}),dropdown:(0,o.css)({opacity:0,color:e.colors.text.secondary})});function wd(t,r){var n;return(0,e.renderMarkdown)(t.explainHandler?t.explainHandler(r,t):null!==(n=t.documentation)&&void 0!==n?n:"no docs")}function _d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Sd(){return Sd=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Sd.apply(this,arguments)}function Ed(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){_d(e,t,r[t])}))}return e}function kd(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const Pd=r().memo((({operation:e,def:n,index:i,onChange:o,onRemove:s,queryModeller:l,dragHandleProps:c})=>{const u=(0,a.useStyles2)(Td),[d,p]=(0,t.useState)({}),h=()=>{if(d.isOpen)p(kd(Ed({},d),{isOpen:!1}));else{const e=l.getAlternativeOperations(n.alternativesKey).map((e=>({label:e.name,value:e})));p({isOpen:!0,alternatives:e})}};var f;return r().createElement("div",{className:u.header},!d.isOpen&&r().createElement(r().Fragment,null,r().createElement("div",Sd({},c),null!==(f=n.name)&&void 0!==f?f:n.id),r().createElement(j,{grow:1}),r().createElement("div",{className:`${u.operationHeaderButtons} operation-header-show-on-hover`},r().createElement(a.Button,{icon:"angle-down",size:"sm",onClick:h,fill:"text",variant:"secondary",title:"Click to view alternative operations"}),r().createElement(Od,{def:n,operation:e}),r().createElement(a.Button,{icon:"times",size:"sm",onClick:()=>s(i),fill:"text",variant:"secondary",title:"Remove operation"}))),d.isOpen&&r().createElement("div",{className:u.selectWrapper},r().createElement(a.Select,{autoFocus:!0,openMenuOnFocus:!0,placeholder:"Replace with",options:d.alternatives,isOpen:!0,onCloseMenu:h,onChange:t=>{if(t.value){const r=l.getOperationDef(t.value.id),a=[...r.defaultParams];for(let t=0;t<Math.min(e.params.length,a.length);t++)r.params[t].type===n.params[t].type&&(a[t]=e.params[t]);const s=kd(Ed({},e),{params:a,id:t.value.id});o(i,n.changeTypeHandler?n.changeTypeHandler(s,r):s)}}})))}));Pd.displayName="OperationHeader";const Td=e=>({header:(0,o.css)({borderBottom:`1px solid ${e.colors.border.medium}`,padding:e.spacing(.5,.5,.5,1),display:"flex",alignItems:"center","&:hover .operation-header-show-on-hover":(0,o.css)({opacity:1})}),operationHeaderButtons:(0,o.css)({opacity:0,transition:e.transitions.create(["opacity"],{duration:e.transitions.duration.short})}),selectWrapper:(0,o.css)({paddingRight:e.spacing(2)})});function Cd(e){return e.editor?e.editor:e.options?Ad:"boolean"===e.type?Dd:Id}function Id(e){var t;return r().createElement(a.AutoSizeInput,{id:pe(e.operationIndex,e.index),defaultValue:null===(t=e.value)||void 0===t?void 0:t.toString(),minWidth:e.paramDef.minWidth,placeholder:e.paramDef.placeholder,title:e.paramDef.description,onCommitChange:t=>{e.onChange(e.index,t.currentTarget.value),e.paramDef.runQueryOnEnter&&"keydown"===t.type&&e.onRunQuery()}})}function Dd(e){return r().createElement(a.Checkbox,{id:pe(e.operationIndex,e.index),value:e.value,onChange:t=>e.onChange(e.index,t.currentTarget.checked)})}function Ad({paramDef:t,value:n,index:i,operationIndex:o,onChange:s}){var l;const c=(0,a.useStyles2)(Rd);let d=t.options;var p;(null===(l=d[0])||void 0===l?void 0:l.label)||(d=t.options.map((e=>({label:e.toString(),value:e}))));let h=null!==(p=d.find((e=>e.value===n)))&&void 0!==p?p:(0,e.toOption)(n);return!n&&t.optional?r().createElement("div",{className:c.optionalParam},r().createElement(a.Button,{size:"sm",variant:"secondary",title:`Add ${t.name}`,icon:"plus",onClick:()=>s(i,d[0].value)},t.name)):r().createElement(u,{gap:.5,direction:"row",alignItems:"center",wrap:!1},r().createElement(a.Select,{id:pe(o,i),value:h,options:d,placeholder:t.placeholder,allowCustomValue:!0,onChange:e=>s(i,e.value)}),t.optional&&r().createElement(a.Button,{"data-testid":`operations.${i}.remove-param`,size:"sm",fill:"text",icon:"times",variant:"secondary",title:`Remove ${t.name}`,onClick:()=>s(i,"")}))}const Rd=e=>({optionalParam:(0,o.css)({marginTop:e.spacing(1)})});function jd(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Nd(){return Nd=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Nd.apply(this,arguments)}function Ld(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){jd(e,t,r[t])}))}return e}function qd(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function $d({operation:e,index:n,onRemove:i,onChange:s,onRunQuery:l,queryModeller:c,query:d,datasource:p,flash:h,highlight:f}){const m=(0,a.useStyles2)(Bd),g=c.getOperationDef(e.id),b=function(e){const[r,n]=(0,t.useState)(!0);return(0,t.useEffect)((()=>{let t;return e?t=setTimeout((()=>{n(!1)}),1e3):n(!0),()=>clearTimeout(t)}),[e]),r&&e}(h);if(!g)return r().createElement("span",null,"Operation ",e.id," not found");const v=(t,r)=>{const i=qd(Ld({},e),{params:[...e.params]});i.params[t]=r,Md(g,i,n,t,s)},y=()=>{const t=qd(Ld({},e),{params:[...e.params,""]});Md(g,t,n,e.params.length,s)},O=t=>{const r=qd(Ld({},e),{params:[...e.params.slice(0,t),...e.params.slice(t+1)]});Md(g,r,n,t,s)},x=[];for(let t=0;t<e.params.length;t++){const i=g.params[Math.min(g.params.length-1,t)],o=Cd(i);x.push(r().createElement("div",{className:m.paramRow,key:`${t}-1`},!i.hideName&&r().createElement("div",{className:m.paramName},r().createElement("label",{htmlFor:pe(n,t)},i.name),i.description&&r().createElement(a.Tooltip,{placement:"top",content:i.description,theme:"info"},r().createElement(a.Icon,{name:"info-circle",size:"sm",className:m.infoIcon}))),r().createElement("div",{className:m.paramValue},r().createElement(u,{gap:.5,direction:"row",alignItems:"center",wrap:!1},r().createElement(o,{index:t,paramDef:i,value:e.params[t],operation:e,operationIndex:n,onChange:v,onRunQuery:l,query:d,datasource:p}),i.restParam&&(e.params.length>g.params.length||i.optional)&&r().createElement(a.Button,{"data-testid":`operations.${n}.remove-rest-param`,size:"sm",fill:"text",icon:"times",variant:"secondary",title:`Remove ${i.name}`,onClick:()=>O(t)})))))}let w;if(g.params.length>0){const t=g.params[g.params.length-1];t.restParam&&(w=function(e,t,n,i,o){return r().createElement("div",{className:o.restParam,key:`${i}-2`},r().createElement(a.Button,{size:"sm",icon:"plus",title:`Add ${e.name}`,variant:"secondary",onClick:t,"data-testid":`operations.${n}.add-rest-param`},e.name))}(t,y,n,e.params.length,m))}return r().createElement(Qc,{draggableId:`operation-${n}`,index:n},(t=>r().createElement("div",Nd({className:(0,o.cx)(m.card,(b||f)&&m.cardHighlight),ref:t.innerRef},t.draggableProps,{"data-testid":`operations.${n}.wrapper`}),r().createElement(Pd,{operation:e,dragHandleProps:t.dragHandleProps,def:g,index:n,onChange:s,onRemove:i,queryModeller:c}),r().createElement("div",{className:m.body},x),w,n<d.operations.length-1&&r().createElement("div",{className:m.arrow},r().createElement("div",{className:m.arrowLine}),r().createElement("div",{className:m.arrowArrow})))))}function Md(e,t,r,n,i){e.paramChangedHandler?i(r,e.paramChangedHandler(n,t,e)):i(r,t)}const Bd=e=>({card:(0,o.css)({background:e.colors.background.primary,border:`1px solid ${e.colors.border.medium}`,display:"flex",flexDirection:"column",cursor:"grab",borderRadius:e.shape.borderRadius(1),marginBottom:e.spacing(1),position:"relative",transition:"all 0.5s ease-in 0s"}),cardHighlight:(0,o.css)({boxShadow:`0px 0px 4px 0px ${e.colors.primary.border}`,border:`1px solid ${e.colors.primary.border}`}),infoIcon:(0,o.css)({marginLeft:e.spacing(.5),color:e.colors.text.secondary,":hover":{color:e.colors.text.primary}}),body:(0,o.css)({margin:e.spacing(1,1,.5,1),display:"table"}),paramRow:(0,o.css)({label:"paramRow",display:"table-row",verticalAlign:"middle"}),paramName:(0,o.css)({display:"table-cell",padding:e.spacing(0,1,0,0),fontSize:e.typography.bodySmall.fontSize,fontWeight:e.typography.fontWeightMedium,verticalAlign:"middle",height:"32px"}),paramValue:(0,o.css)({label:"paramValue",display:"table-cell",verticalAlign:"middle"}),restParam:(0,o.css)({padding:e.spacing(0,1,1,1)}),arrow:(0,o.css)({position:"absolute",top:"0",right:"-18px",display:"flex"}),arrowLine:(0,o.css)({height:"2px",width:"8px",backgroundColor:e.colors.border.strong,position:"relative",top:"14px"}),arrowArrow:(0,o.css)({width:0,height:0,borderTop:"5px solid transparent",borderBottom:"5px solid transparent",borderLeft:`7px solid ${e.colors.border.strong}`,position:"relative",top:"10px"})});function Fd(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Qd(){return Qd=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Qd.apply(this,arguments)}function zd(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Fd(e,t,r[t])}))}return e}function Vd(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function Ud({query:e,datasource:n,queryModeller:i,onChange:o,onRunQuery:s,highlightedOp:l}){const c=(0,a.useStyles2)(Wd),{operations:d}=e,p=function(e){const r=(i=(0,t.useRef)(!1),a=(0,t.useCallback)((function(){return i.current}),[]),(0,t.useEffect)((function(){return i.current=!0,function(){i.current=!1}}),[]),a),n=Xc(e);var i,a;if(!r())return e.map((()=>!1));if(!n)return e.map((()=>!0));let o=[];if(n.length-1===e.length&&e.every((e=>n.includes(e))))return e.map((()=>!1));if(n.length+1===e.length&&n.every((t=>e.includes(t)))){const t=e.find((e=>!n.includes(e)));o=e.map((e=>e===t))}else o=e.map(((e,t)=>{var r,i,a;return!((i=e.id)===(a=null===(r=n[t])||void 0===r?void 0:r.id)||`__${i}_by`===a||i===`__${a}_by`)}));return o}(d),[h,f]=(0,t.useState)(!1),m=(t,r)=>{const n=[...d];n.splice(t,1,r),o(Vd(zd({},e),{operations:n}))},g=t=>{const r=[...d.slice(0,t),...d.slice(t+1)];o(Vd(zd({},e),{operations:r}))},b=i.getCategories().map((e=>({value:e,label:e,items:i.getOperationsForCategory(e).map((e=>({value:e.id,label:e.name,isLeaf:!0})))})));return r().createElement(u,{gap:1,direction:"column"},r().createElement(u,{gap:1},d.length>0&&r().createElement(hc,{onDragEnd:t=>{if(!t.destination)return;const r=[...d],n=r[t.source.index];r.splice(t.source.index,1),r.splice(t.destination.index,0,n),o(Vd(zd({},e),{operations:r}))}},r().createElement(Wc,{droppableId:"sortable-field-mappings",direction:"horizontal"},(t=>r().createElement("div",Qd({className:c.operationList,ref:t.innerRef},t.droppableProps),d.map(((t,a)=>r().createElement($d,{key:t.id+JSON.stringify(t.params)+a,queryModeller:i,index:a,operation:t,query:e,datasource:n,onChange:m,onRemove:g,onRunQuery:s,flash:p[a],highlight:l===t}))),t.placeholder)))),r().createElement("div",{className:c.addButton},h?r().createElement(a.Cascader,{options:b,onSelect:t=>{const r=i.getOperationDef(t);r&&(o(r.addOperationHandler(r,e,i)),f(!1))},onBlur:()=>{f(!1)},autoFocus:!0,alwaysOpen:!0,hideActiveLevelLabel:!0,placeholder:"Search"}):r().createElement(a.Button,{icon:"plus",variant:"secondary",onClick:()=>f(!0),title:"Add operation"},"Operations"))))}const Wd=e=>({heading:(0,o.css)({label:"heading",fontSize:12,fontWeight:e.typography.fontWeightMedium,marginBottom:0}),operationList:(0,o.css)({label:"operationList",display:"flex",flexWrap:"wrap",gap:e.spacing(2)}),addButton:(0,o.css)({label:"addButton",width:126,paddingBottom:e.spacing(1)})});function Xd({query:e,lang:t}){const n=(0,a.useTheme2)(),i=Gd(n),s=Ii().highlight(e,t.grammar,t.name);return r().createElement("div",{className:(0,o.cx)(i.editorField,"prism-syntax-highlight"),"aria-label":"selector",dangerouslySetInnerHTML:{__html:s}})}const Gd=e=>({editorField:(0,o.css)({fontFamily:e.typography.fontFamilyMonospace,fontSize:e.typography.bodySmall.fontSize})});function Hd({query:e,queryModeller:t,stepNumber:n,lang:i,onMouseEnter:a,onMouseLeave:o}){return r().createElement(r().Fragment,null,e.operations.map(((e,s)=>{const l=t.getOperationDef(e.id);if(!l)return`Operation ${e.id} not found`;const c=l.renderer(e,l,"<expr>");var u;const d=l.explainHandler?l.explainHandler(e,l):null!==(u=l.documentation)&&void 0!==u?u:"no docs";return r().createElement("div",{key:s,onMouseEnter:()=>null==a?void 0:a(e,s),onMouseLeave:()=>null==o?void 0:o(e,s)},r().createElement(fa,{stepNumber:s+n,title:r().createElement(Xd,{query:c,lang:i}),markdown:d}))})))}function Yd({children:e}){const t=(0,a.useStyles2)(Kd);return r().createElement("div",{className:t.root},r().createElement(u,{gap:1},e))}const Kd=e=>({root:(0,o.css)({padding:e.spacing(1,1,0,1),backgroundColor:e.colors.background.secondary,borderRadius:e.shape.borderRadius(1)})}),Jd=({datasource:e,query:n,onChange:i,data:o,queryModeller:s,buildVisualQueryFromString:l})=>{const[c,u]=(0,t.useState)([]),d=(0,a.useStyles2)(Zd);return(0,t.useEffect)((()=>{const t={expr:s.renderQuery(n),refId:""},r=e.getQueryHints(t,(null==o?void 0:o.series)||[]).filter((e=>{var t;return null===(t=e.fix)||void 0===t?void 0:t.action}));u(r)}),[e,n,o,s]),r().createElement(r().Fragment,null,c.length>0&&r().createElement("div",{className:d.container},c.map((t=>{var o,c,u;return r().createElement(a.Tooltip,{content:`${t.label} ${null===(o=t.fix)||void 0===o?void 0:o.label}`,key:t.type},r().createElement(a.Button,{onClick:()=>{var r;if(null==t||null===(r=t.fix)||void 0===r?void 0:r.action){const r={expr:s.renderQuery(n),refId:""},a=e.modifyQuery(r,t.fix.action),o=l(a.expr);return i(o.query)}},fill:"outline",size:"sm",className:d.hint},"hint: "+(null===(c=t.fix)||void 0===c||null===(u=c.action)||void 0===u?void 0:u.type.toLowerCase().replace("_"," "))+"()"))}))))};Jd.displayName="QueryBuilderHints";const Zd=e=>({container:o.css`
      display: flex;
      align-items: start;
    `,hint:o.css`
      margin-right: ${e.spacing(1)};
    `});var ep=m(5464),tp=m.n(ep);function rp(e,t,r,n,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function np(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function o(e){rp(a,n,i,o,s,"next",e)}function s(e){rp(a,n,i,o,s,"throw",e)}o(void 0)}))}}function ip(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ap({query:n,onChange:i,onGetMetrics:o}){const s=(0,a.useStyles2)(op),[l,c]=(0,t.useState)({}),u=(0,t.useCallback)(((e,t)=>{var r;const n=null!==(r=e.label)&&void 0!==r?r:e.value;return!!n&&(!n.toLowerCase||t.split(" ").reduce(((e,t)=>e&&n.toLowerCase().includes(t.toLowerCase())),!0))}),[]),d=(0,t.useCallback)(((e,t)=>{return e.__isNew__?e.label:r().createElement(tp(),{searchWords:t.inputValue.split(" "),textToHighlight:null!==(n=e.label)&&void 0!==n?n:"",highlightClassName:s.highlight});var n}),[s.highlight]);return r().createElement(b,null,r().createElement(E,{label:"Metric"},r().createElement(a.Select,{inputId:"prometheus-metric-select",className:s.select,value:n.metric?(0,e.toOption)(n.metric):void 0,placeholder:"Select metric",allowCustomValue:!0,formatOptionLabel:d,filterOption:u,onOpenMenu:np((function*(){c({isLoading:!0});const e=yield o();c({metrics:e,isLoading:void 0})})),isLoading:l.isLoading,options:l.metrics,onChange:({value:e})=>{var t,r;e&&i((t=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){ip(e,t,r[t])}))}return e}({},n),r=null!=(r={metric:e})?r:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})),t))}})))}const op=e=>({select:o.css`
    min-width: 125px;
  `,highlight:o.css`
    label: select__match-highlight;
    background: inherit;
    padding: inherit;
    color: ${e.colors.warning.contrastText};
    background-color: ${e.colors.warning.main};
  `});function sp(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lp(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){sp(e,t,r[t])}))}return e}function cp(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const up=r().memo((t=>{const{nestedQuery:n,index:i,datasource:o,onChange:s,onRemove:l,onRunQuery:c,showExplain:u}=t,d=(0,a.useStyles2)(pp);return r().createElement("div",{className:d.card},r().createElement("div",{className:d.header},r().createElement("div",{className:d.name},"Operator"),r().createElement(a.Select,{width:"auto",options:dp,value:(0,e.toOption)(n.operator),onChange:e=>{s(i,cp(lp({},n),{operator:e.value}))}}),r().createElement("div",{className:d.name},"Vector matches"),r().createElement("div",{className:d.vectorMatchWrapper},r().createElement(a.Select,{width:"auto",value:n.vectorMatchesType||"on",allowCustomValue:!0,options:[{value:"on",label:"on"},{value:"ignoring",label:"ignoring"}],onChange:e=>{s(i,cp(lp({},n),{vectorMatchesType:e.value}))}}),r().createElement(a.AutoSizeInput,{className:d.vectorMatchInput,minWidth:20,defaultValue:n.vectorMatches,onCommitChange:e=>{s(i,cp(lp({},n),{vectorMatches:e.currentTarget.value,vectorMatchesType:n.vectorMatchesType||"on"}))}})),r().createElement(j,{grow:1}),r().createElement(a.IconButton,{name:"times",size:"sm",onClick:()=>l(i)})),r().createElement("div",{className:d.body},r().createElement(I,null,r().createElement(wp,{showExplain:u,query:n.query,datasource:o,onRunQuery:c,onChange:e=>{s(i,cp(lp({},n),{query:e}))}}))))})),dp=Oe.map((e=>({label:e.sign,value:e.sign})));up.displayName="NestedQuery";const pp=e=>({card:(0,o.css)({label:"card",display:"flex",flexDirection:"column",gap:e.spacing(.5)}),header:(0,o.css)({label:"header",padding:e.spacing(.5,.5,.5,1),gap:e.spacing(1),display:"flex",alignItems:"center"}),name:(0,o.css)({label:"name",whiteSpace:"nowrap"}),body:(0,o.css)({label:"body",paddingLeft:e.spacing(2)}),vectorMatchInput:(0,o.css)({label:"vectorMatchInput",marginLeft:-1}),vectorMatchWrapper:(0,o.css)({label:"vectorMatchWrapper",display:"flex"})});function hp(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fp(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){hp(e,t,r[t])}))}return e}function mp(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function gp(e){const{query:t,datasource:n,onChange:i,onRunQuery:a,showExplain:o}=e;var s;const l=null!==(s=t.binaryQueries)&&void 0!==s?s:[],c=(e,r)=>{const n=[...l];n.splice(e,1,r),i(mp(fp({},t),{binaryQueries:n}))},d=e=>{const r=[...l.slice(0,e),...l.slice(e+1)];i(mp(fp({},t),{binaryQueries:r}))};return r().createElement(u,{direction:"column",gap:1},l.map(((e,t)=>r().createElement(up,{key:t.toString(),nestedQuery:e,index:t,onChange:c,datasource:n,onRemove:d,onRunQuery:a,showExplain:o}))))}const bp="Fetch all series matching metric name and label filters.",vp=r().memo((({query:e})=>{const t=Wr(e||"").query,n={grammar:U,name:"promql"};return r().createElement(u,{gap:.5,direction:"column"},r().createElement(fa,{stepNumber:1,title:r().createElement(Xd,{query:`${t.metric} ${$e.renderLabels(t.labels)}`,lang:n})},bp),r().createElement(Hd,{stepNumber:2,queryModeller:$e,query:t,lang:n}))}));function yp(e,t,r,n,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function Op(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function o(e){yp(a,n,i,o,s,"next",e)}function s(e){yp(a,n,i,o,s,"throw",e)}o(void 0)}))}}function xp(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}vp.displayName="PromQueryBuilderExplained";const wp=r().memo((e=>{const{datasource:n,query:i,onChange:a,onRunQuery:o,data:s,showExplain:l}=e,[c,u]=(0,t.useState)(),d=(0,t.useCallback)((p=Op((function*(e){const t=n.getVariables(),r=yield e;return[...t.map((e=>({label:e,value:e}))),...r.map((e=>({label:e.value,value:e.value,title:e.description})))]})),function(e){return p.apply(this,arguments)}),[n]);var p;const h=function(){var e=Op((function*(e){if(!i.metric)return yield n.languageProvider.fetchLabels(),n.languageProvider.getLabelKeys().map((e=>({value:e})));const t=i.labels.filter((t=>t!==e));t.push({label:"__name__",op:"=",value:i.metric});const r=$e.renderLabels(t),a=yield n.languageProvider.fetchSeriesLabels(r);return Object.keys(a).filter((e=>!t.find((t=>t.label===e)))).map((e=>({value:e})))}));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=Op((function*(e){if(!e.label)return[];if(!i.metric)return(yield n.languageProvider.getLabelValues(e.label)).map((e=>({value:e})));const t=i.labels.filter((t=>t!==e));t.push({label:"__name__",op:"=",value:i.metric});const r=$e.renderLabels(t);var a;return null!==(a=(yield n.languageProvider.fetchSeriesLabels(r))[n.interpolateString(e.label)].map((e=>({value:e}))))&&void 0!==a?a:[]}));return function(t){return e.apply(this,arguments)}}(),m=(0,t.useCallback)((()=>d(function(e,t){return _p.apply(this,arguments)}(n,i))),[n,i,d]),g={grammar:U,name:"promql"};return r().createElement(r().Fragment,null,r().createElement(P,null,r().createElement(ap,{query:i,onChange:a,onGetMetrics:m}),r().createElement(ha,{labelsFilters:i.labels,onChange:e=>{var t,r;a((t=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){xp(e,t,r[t])}))}return e}({},i),r=null!=(r={labels:e})?r:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})),t))},onGetLabelNames:e=>d(h(e)),onGetLabelValues:e=>d(f(e))})),l&&r().createElement(fa,{stepNumber:1,title:r().createElement(Xd,{query:`${i.metric} ${$e.renderLabels(i.labels)}`,lang:g})},bp),r().createElement(Yd,null,r().createElement(Ud,{queryModeller:$e,datasource:n,query:i,onChange:a,onRunQuery:o,highlightedOp:c}),r().createElement(Jd,{datasource:n,query:i,onChange:a,data:s,queryModeller:$e,buildVisualQueryFromString:Wr})),l&&r().createElement(Hd,{lang:g,query:i,stepNumber:2,queryModeller:$e,onMouseEnter:e=>u(e),onMouseLeave:()=>u(void 0)}),i.binaryQueries&&i.binaryQueries.length>0&&r().createElement(gp,{query:i,datasource:n,onChange:a,onRunQuery:o,showExplain:l}))}));function _p(){return _p=Op((function*(e,t){let r;if(e.languageProvider.metricsMetadata||(yield e.languageProvider.loadMetricsMetadata()),e.languageProvider.metricsMetadata||(e.languageProvider.metricsMetadata={}),t.labels.length>0){const i=$e.renderLabels(t.labels);var n;r=null!==(n=(yield e.languageProvider.getSeries(i,!0)).__name__)&&void 0!==n?n:[]}else{var i;r=null!==(i=yield e.languageProvider.getLabelValues("__name__"))&&void 0!==i?i:[]}return r.map((t=>({value:t,description:ra(t,e.languageProvider.metricsMetadata)})))})),_p.apply(this,arguments)}function Sp({query:e}){return r().createElement(P,null,r().createElement(b,null,r().createElement(E,{label:"Raw query"},r().createElement(Xd,{query:e,lang:{grammar:U,name:"promql"}}))))}function Ep(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kp(e){const{query:n,onChange:i,onRunQuery:a,datasource:o,data:s,showRawQuery:l,showExplain:c}=e,[u,d]=(0,t.useReducer)(Pp.reducer,{expr:n.expr});return(0,t.useEffect)((()=>{d(Cp(n.expr))}),[n.expr]),u.visQuery?r().createElement(r().Fragment,null,r().createElement(wp,{query:u.visQuery,datasource:o,onChange:t=>{const r=$e.renderQuery(t);var n,a;d(Tp({visQuery:t,expr:r})),i((n=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Ep(e,t,r[t])}))}return e}({},e.query),a=null!=(a={expr:r})?a:{},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(a)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(a,e))})),n))},onRunQuery:a,data:s,showExplain:c}),l&&r().createElement(Sp,{query:n.expr})):null}wp.displayName="PromQueryBuilder";const Pp=function(e){var t=e.name;if(!t)throw new Error("`name` is a required option for createSlice");var r,n="function"==typeof e.initialState?e.initialState:_i(e.initialState),i=e.reducers||{},a=Object.keys(i),o={},s={},l={};function c(){var t="function"==typeof e.extraReducers?Ei(e.extraReducers):[e.extraReducers],r=t[0],i=void 0===r?{}:r,a=t[1],o=void 0===a?[]:a,l=t[2],c=void 0===l?void 0:l,u=wi(wi({},i),s);return function(e,t,r,n){void 0===r&&(r=[]);var i,a="function"==typeof t?Ei(t):[t,r,n],o=a[0],s=a[1],l=a[2];if(function(e){return"function"==typeof e}(e))i=function(){return _i(e())};else{var c=_i(e);i=function(){return c}}function u(e,t){void 0===e&&(e=i());var r=gi([o[t.type]],s.filter((function(e){return(0,e.matcher)(t)})).map((function(e){return e.reducer})));return 0===r.filter((function(e){return!!e})).length&&(r=[l]),r.reduce((function(e,r){if(r){var n;if(bn(e))return void 0===(n=r(e,t))?e:n;if(vn(e))return hi(e,(function(e){return r(e,t)}));if(void 0===(n=r(e,t))){if(null===e)return e;throw Error("A case reducer on a non-draftable value must not return undefined")}return n}return e}),e)}return u.getInitialState=i,u}(n,u,o,c)}return a.forEach((function(e){var r,n,a=i[e],c=t+"/"+e;"reducer"in a?(r=a.reducer,n=a.prepare):r=a,o[e]=r,s[c]=r,l[e]=n?Si(c,n):Si(c)})),{name:t,reducer:function(e,t){return r||(r=c()),r(e,t)},actions:l,caseReducers:o,getInitialState:function(){return r||(r=c()),r.getInitialState()}}}({name:"prom-builder-container",initialState:{expr:""},reducers:{visualQueryChange:(e,t)=>{e.expr=t.payload.expr,e.visQuery=t.payload.visQuery},exprChanged:(e,t)=>{if(!e.visQuery||e.expr!==t.payload){e.expr=t.payload;const r=Wr(t.payload);e.visQuery=r.query}}}}),{visualQueryChange:Tp,exprChanged:Cp}=Pp.actions;function Ip(e){var{datasource:n,onChange:i,query:s}=e,l=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,["datasource","onChange","query"]);const[c,u]=(0,t.useState)(null),d=(0,a.useStyles2)(Dp),p=Xc(c);(0,t.useEffect)((()=>{n.exemplarsAvailable?s.instant&&!s.range?(u("Exemplars are not available for instant queries"),i(!1)):(u(null),p&&!c&&i(!0)):(u("Exemplars for this query are not available"),i(!1))}),[n.exemplarsAvailable,s.instant,s.range,i,p,c]);const h=(0,o.cx)({[d.activeIcon]:!!s.exemplar},d.eyeIcon);return r().createElement(a.InlineLabel,{width:"auto","data-testid":l["data-testid"]},r().createElement(a.Tooltip,{content:null!=c?c:""},r().createElement("div",{className:d.iconWrapper},"Exemplars",r().createElement(a.IconButton,{name:"eye",tooltip:s.exemplar?"Disable query with exemplars":"Enable query with exemplars",disabled:!!c,className:h,onClick:()=>{i(!s.exemplar)}}))))}function Dp(e){return{eyeIcon:o.css`
      margin-left: ${e.spacing(2)};
    `,activeIcon:o.css`
      color: ${e.colors.primary.main};
    `,iconWrapper:o.css`
      display: flex;
      align-items: center;
    `}}function Ap(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Rp(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Ap(e,t,r[t])}))}return e}function jp(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const Np=(0,t.memo)((({query:e,datasource:n,onChange:i,onRunQuery:s})=>{const l=Lp(!0),c=Xc(e),u=(0,t.useCallback)((t=>{(0,G.isEqual)(e,c)&&t===e.exemplar||i(jp(Rp({},e),{exemplar:t}))}),[c,e,i]),d=qp(e,i);var p;return r().createElement("div",{"aria-label":"Prometheus extra field",className:"gf-form-inline","data-testid":$p.extraFieldEditor},r().createElement("div",{"data-testid":$p.queryTypeField,className:(0,o.cx)("gf-form explore-input-margin",o.css`
              flex-wrap: nowrap;
            `),"aria-label":"Query type field"},r().createElement(a.InlineFormLabel,{width:"auto"},"Query type"),r().createElement(a.RadioButtonGroup,{options:l,value:e.range&&e.instant?"both":e.instant?"instant":"range",onChange:d})),r().createElement("div",{"data-testid":$p.stepField,className:(0,o.cx)("gf-form",o.css`
              flex-wrap: nowrap;
            `),"aria-label":"Step field"},r().createElement(a.InlineFormLabel,{width:6,tooltip:"Time units and built-in variables can be used here, for example: $__interval, $__rate_interval, 5s, 1m, 3h, 1d, 1y (Default if no unit is specified: s)"},"Min step"),r().createElement("input",{type:"text",className:"gf-form-input width-4",placeholder:"auto",onChange:function(t){var r;t.currentTarget.value!==e.interval&&(r=t.currentTarget.value,i(jp(Rp({},e),{interval:r})))},onKeyDown:function(e){"Enter"===e.key&&e.shiftKey&&s()},value:null!==(p=e.interval)&&void 0!==p?p:""})),r().createElement(Ip,{onChange:u,datasource:n,query:e}))}));function Lp(e){const t=[{value:"range",label:"Range",description:"Run query over a range of time"},{value:"instant",label:"Instant",description:'Run query against a single point in time. For this query, the "To" time is used'}];return e&&t.push({value:"both",label:"Both",description:"Run an Instant query and a Range query"}),t}function qp(e,t){return r=>{t(jp(Rp({},e),"instant"===r?{instant:!0,range:!1,exemplar:!1}:"range"===r?{instant:!1,range:!0}:{instant:!0,range:!0}))}}Np.displayName="PromExploreExtraField";const $p={extraFieldEditor:"prom-editor-extra-field",stepField:"prom-editor-extra-field-step",queryTypeField:"prom-editor-extra-field-query-type"};function Mp(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Bp(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Mp(e,t,r[t])}))}return e}const Fp=({panelData:n,query:i,datasource:a})=>{const[o,s]=(0,t.useState)("");return(0,t.useEffect)((()=>{if(n){const t=()=>{if(!n.request)return"";const{request:{range:t,interval:r,scopedVars:o}}=n,s=a.getPrometheusTime(t.from,!1),l=a.getPrometheusTime(t.to,!0),c=Math.ceil(l-s),u=t.to.utc().format("YYYY-MM-DD HH:mm"),d={interval:r,scopedVars:Bp({},o,a.getRateIntervalScopedVariable(e.rangeUtil.intervalToSeconds(r),e.rangeUtil.intervalToSeconds(a.interval)))},p={};if(a.customQueryParameters)for(const[e,t]of a.customQueryParameters)p[e]=t;const h=a.createQuery(i,d,s,l),f=(g=Bp({},p),b=null!=(b={"g0.expr":h.expr,"g0.range_input":c+"s","g0.end_input":u,"g0.step_input":h.step,"g0.tab":0})?b:{},Object.getOwnPropertyDescriptors?Object.defineProperties(g,Object.getOwnPropertyDescriptors(b)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(b)).forEach((function(e){Object.defineProperty(g,e,Object.getOwnPropertyDescriptor(b,e))})),g),m=(0,G.map)(f,((e,t)=>t+"="+encodeURIComponent(e))).join("&");var g,b;return`${a.directUrl}/graph?${m}`};s(t())}}),[a,n,i]),r().createElement("a",{href:e.textUtil.sanitizeUrl(o),target:"_blank",rel:"noopener noreferrer"},"Prometheus")},Qp=(0,t.memo)(Fp);class zp extends t.PureComponent{render(){const{children:e}=this.props,{value:t}=this.state;return r().createElement(r().Fragment,null,e(t,this.onSaveToStore,this.onDeleteFromStore))}constructor(e){super(e),this.onSaveToStore=e=>{const{storageKey:t}=this.props;try{an.setObject(t,e)}catch(e){console.error(e)}this.setState({value:e})},this.onDeleteFromStore=()=>{const{storageKey:e,defaultValue:t}=this.props;try{an.delete(e)}catch(e){console.log(e)}this.setState({value:t})};const{storageKey:t,defaultValue:r}=e;this.state={value:an.getObject(t,r)}}}function Vp(){return Vp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Vp.apply(this,arguments)}function Up(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Wp(e,t){return Wp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Wp(e,t)}var Xp=Number.isNaN||function(e){return"number"==typeof e&&e!=e};function Gp(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!((n=e[r])===(i=t[r])||Xp(n)&&Xp(i)))return!1;var n,i;return!0}const Hp=function(e,t){var r;void 0===t&&(t=Gp);var n,i=[],a=!1;return function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];return a&&r===this&&t(o,i)||(n=e.apply(this,o),a=!0,r=this,i=o),n}};var Yp="object"==typeof performance&&"function"==typeof performance.now?function(){return performance.now()}:function(){return Date.now()};function Kp(e){cancelAnimationFrame(e.id)}var Jp=null;function Zp(e){if(void 0===e&&(e=!1),null===Jp||e){var t=document.createElement("div"),r=t.style;r.width="50px",r.height="50px",r.overflow="scroll",r.direction="rtl";var n=document.createElement("div"),i=n.style;return i.width="100px",i.height="100px",t.appendChild(n),document.body.appendChild(t),t.scrollLeft>0?Jp="positive-descending":(t.scrollLeft=1,Jp=0===t.scrollLeft?"negative":"positive-ascending"),document.body.removeChild(t),Jp}return Jp}var eh=function(e,t){return e};function th(e){var r,n=e.getItemOffset,i=e.getEstimatedTotalSize,a=e.getItemSize,o=e.getOffsetForIndexAndAlignment,s=e.getStartIndexForOffset,l=e.getStopIndexForStartIndex,c=e.initInstanceProps,u=e.shouldResetStyleCacheOnItemSizeChange,d=e.validateProps;return r=function(e){function r(t){var r;return(r=e.call(this,t)||this)._instanceProps=c(r.props,Up(r)),r._outerRef=void 0,r._resetIsScrollingTimeoutId=null,r.state={instance:Up(r),isScrolling:!1,scrollDirection:"forward",scrollOffset:"number"==typeof r.props.initialScrollOffset?r.props.initialScrollOffset:0,scrollUpdateWasRequested:!1},r._callOnItemsRendered=void 0,r._callOnItemsRendered=Hp((function(e,t,n,i){return r.props.onItemsRendered({overscanStartIndex:e,overscanStopIndex:t,visibleStartIndex:n,visibleStopIndex:i})})),r._callOnScroll=void 0,r._callOnScroll=Hp((function(e,t,n){return r.props.onScroll({scrollDirection:e,scrollOffset:t,scrollUpdateWasRequested:n})})),r._getItemStyle=void 0,r._getItemStyle=function(e){var t,i=r.props,o=i.direction,s=i.itemSize,l=i.layout,c=r._getItemStyleCache(u&&s,u&&l,u&&o);if(c.hasOwnProperty(e))t=c[e];else{var d=n(r.props,e,r._instanceProps),p=a(r.props,e,r._instanceProps),h="horizontal"===o||"horizontal"===l,f="rtl"===o,m=h?d:0;c[e]=t={position:"absolute",left:f?void 0:m,right:f?m:void 0,top:h?0:d,height:h?"100%":p,width:h?p:"100%"}}return t},r._getItemStyleCache=void 0,r._getItemStyleCache=Hp((function(e,t,r){return{}})),r._onScrollHorizontal=function(e){var t=e.currentTarget,n=t.clientWidth,i=t.scrollLeft,a=t.scrollWidth;r.setState((function(e){if(e.scrollOffset===i)return null;var t=r.props.direction,o=i;if("rtl"===t)switch(Zp()){case"negative":o=-i;break;case"positive-descending":o=a-n-i}return o=Math.max(0,Math.min(o,a-n)),{isScrolling:!0,scrollDirection:e.scrollOffset<i?"forward":"backward",scrollOffset:o,scrollUpdateWasRequested:!1}}),r._resetIsScrollingDebounced)},r._onScrollVertical=function(e){var t=e.currentTarget,n=t.clientHeight,i=t.scrollHeight,a=t.scrollTop;r.setState((function(e){if(e.scrollOffset===a)return null;var t=Math.max(0,Math.min(a,i-n));return{isScrolling:!0,scrollDirection:e.scrollOffset<t?"forward":"backward",scrollOffset:t,scrollUpdateWasRequested:!1}}),r._resetIsScrollingDebounced)},r._outerRefSetter=function(e){var t=r.props.outerRef;r._outerRef=e,"function"==typeof t?t(e):null!=t&&"object"==typeof t&&t.hasOwnProperty("current")&&(t.current=e)},r._resetIsScrollingDebounced=function(){null!==r._resetIsScrollingTimeoutId&&Kp(r._resetIsScrollingTimeoutId),r._resetIsScrollingTimeoutId=function(e,t){var r=Yp(),n={id:requestAnimationFrame((function i(){Yp()-r>=t?e.call(null):n.id=requestAnimationFrame(i)}))};return n}(r._resetIsScrolling,150)},r._resetIsScrolling=function(){r._resetIsScrollingTimeoutId=null,r.setState({isScrolling:!1},(function(){r._getItemStyleCache(-1,null)}))},r}var p,h;h=e,(p=r).prototype=Object.create(h.prototype),p.prototype.constructor=p,Wp(p,h),r.getDerivedStateFromProps=function(e,t){return rh(e,t),d(e),null};var f=r.prototype;return f.scrollTo=function(e){e=Math.max(0,e),this.setState((function(t){return t.scrollOffset===e?null:{scrollDirection:t.scrollOffset<e?"forward":"backward",scrollOffset:e,scrollUpdateWasRequested:!0}}),this._resetIsScrollingDebounced)},f.scrollToItem=function(e,t){void 0===t&&(t="auto");var r=this.props.itemCount,n=this.state.scrollOffset;e=Math.max(0,Math.min(e,r-1)),this.scrollTo(o(this.props,e,t,n,this._instanceProps))},f.componentDidMount=function(){var e=this.props,t=e.direction,r=e.initialScrollOffset,n=e.layout;if("number"==typeof r&&null!=this._outerRef){var i=this._outerRef;"horizontal"===t||"horizontal"===n?i.scrollLeft=r:i.scrollTop=r}this._callPropsCallbacks()},f.componentDidUpdate=function(){var e=this.props,t=e.direction,r=e.layout,n=this.state,i=n.scrollOffset;if(n.scrollUpdateWasRequested&&null!=this._outerRef){var a=this._outerRef;if("horizontal"===t||"horizontal"===r)if("rtl"===t)switch(Zp()){case"negative":a.scrollLeft=-i;break;case"positive-ascending":a.scrollLeft=i;break;default:var o=a.clientWidth,s=a.scrollWidth;a.scrollLeft=s-o-i}else a.scrollLeft=i;else a.scrollTop=i}this._callPropsCallbacks()},f.componentWillUnmount=function(){null!==this._resetIsScrollingTimeoutId&&Kp(this._resetIsScrollingTimeoutId)},f.render=function(){var e=this.props,r=e.children,n=e.className,a=e.direction,o=e.height,s=e.innerRef,l=e.innerElementType,c=e.innerTagName,u=e.itemCount,d=e.itemData,p=e.itemKey,h=void 0===p?eh:p,f=e.layout,m=e.outerElementType,g=e.outerTagName,b=e.style,v=e.useIsScrolling,y=e.width,O=this.state.isScrolling,x="horizontal"===a||"horizontal"===f,w=x?this._onScrollHorizontal:this._onScrollVertical,_=this._getRangeToRender(),S=_[0],E=_[1],k=[];if(u>0)for(var P=S;P<=E;P++)k.push((0,t.createElement)(r,{data:d,key:h(P,d),index:P,isScrolling:v?O:void 0,style:this._getItemStyle(P)}));var T=i(this.props,this._instanceProps);return(0,t.createElement)(m||g||"div",{className:n,onScroll:w,ref:this._outerRefSetter,style:Vp({position:"relative",height:o,width:y,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:a},b)},(0,t.createElement)(l||c||"div",{children:k,ref:s,style:{height:x?"100%":T,pointerEvents:O?"none":void 0,width:x?T:"100%"}}))},f._callPropsCallbacks=function(){if("function"==typeof this.props.onItemsRendered&&this.props.itemCount>0){var e=this._getRangeToRender(),t=e[0],r=e[1],n=e[2],i=e[3];this._callOnItemsRendered(t,r,n,i)}if("function"==typeof this.props.onScroll){var a=this.state,o=a.scrollDirection,s=a.scrollOffset,l=a.scrollUpdateWasRequested;this._callOnScroll(o,s,l)}},f._getRangeToRender=function(){var e=this.props,t=e.itemCount,r=e.overscanCount,n=this.state,i=n.isScrolling,a=n.scrollDirection,o=n.scrollOffset;if(0===t)return[0,0,0,0];var c=s(this.props,o,this._instanceProps),u=l(this.props,c,o,this._instanceProps),d=i&&"backward"!==a?1:Math.max(1,r),p=i&&"forward"!==a?1:Math.max(1,r);return[Math.max(0,c-d),Math.max(0,Math.min(t-1,u+p)),c,u]},r}(t.PureComponent),r.defaultProps={direction:"ltr",itemData:void 0,layout:"vertical",overscanCount:2,useIsScrolling:!1},r}var rh=function(e,t){e.children,e.direction,e.height,e.layout,e.innerTagName,e.outerTagName,e.width,t.instance},nh=th({getItemOffset:function(e,t){return t*e.itemSize},getItemSize:function(e,t){return e.itemSize},getEstimatedTotalSize:function(e){var t=e.itemCount;return e.itemSize*t},getOffsetForIndexAndAlignment:function(e,t,r,n){var i=e.direction,a=e.height,o=e.itemCount,s=e.itemSize,l=e.layout,c=e.width,u="horizontal"===i||"horizontal"===l?c:a,d=Math.max(0,o*s-u),p=Math.min(d,t*s),h=Math.max(0,t*s-u+s);switch("smart"===r&&(r=n>=h-u&&n<=p+u?"auto":"center"),r){case"start":return p;case"end":return h;case"center":var f=Math.round(h+(p-h)/2);return f<Math.ceil(u/2)?0:f>d+Math.floor(u/2)?d:f;default:return n>=h&&n<=p?n:n<h?h:p}},getStartIndexForOffset:function(e,t){var r=e.itemCount,n=e.itemSize;return Math.max(0,Math.min(r-1,Math.floor(t/n)))},getStopIndexForStartIndex:function(e,t,r){var n=e.direction,i=e.height,a=e.itemCount,o=e.itemSize,s=e.layout,l=e.width,c=t*o,u="horizontal"===n||"horizontal"===s?l:i,d=Math.ceil((u+r-c)/o);return Math.max(0,Math.min(a-1,t+d-1))},initInstanceProps:function(e){},shouldResetStyleCacheOnItemSizeChange:!0,validateProps:function(e){e.itemSize}});function ih(e,t,r,n,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function ah(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function o(e){ih(a,n,i,o,s,"next",e)}function s(e){ih(a,n,i,o,s,"throw",e)}o(void 0)}))}}function oh(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sh(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){oh(e,t,r[t])}))}return e}function lh(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const ch="{}",uh="__name__";function dh(e){let t="";const r=[];for(const n of e)if((n.name===uh||n.selected)&&n.values&&n.values.length>0){const e=n.values.filter((e=>e.selected)).map((e=>e.name));e.length>1?r.push(`${n.name}=~"${e.map(zi).join("|")}"`):1===e.length&&(n.name===uh?t=e[0]:r.push(`${n.name}="${Qi(e[0])}"`))}return[t,"{",r.join(","),"}"].join("")}const ph=(0,a.stylesFactory)((e=>({wrapper:o.css`
    background-color: ${e.colors.bg2};
    padding: ${e.spacing.sm};
    width: 100%;
  `,list:o.css`
    margin-top: ${e.spacing.sm};
    display: flex;
    flex-wrap: wrap;
    max-height: 200px;
    overflow: auto;
    align-content: flex-start;
  `,section:o.css`
    & + & {
      margin: ${e.spacing.md} 0;
    }
    position: relative;
  `,selector:o.css`
    font-family: ${e.typography.fontFamily.monospace};
    margin-bottom: ${e.spacing.sm};
  `,status:o.css`
    padding: ${e.spacing.xs};
    color: ${e.colors.textSemiWeak};
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    /* using absolute positioning because flex interferes with ellipsis */
    position: absolute;
    width: 50%;
    right: 0;
    text-align: right;
    transition: opacity 100ms linear;
    opacity: 0;
  `,statusShowing:o.css`
    opacity: 1;
  `,error:o.css`
    color: ${e.palette.brandDanger};
  `,valueList:o.css`
    margin-right: ${e.spacing.sm};
    resize: horizontal;
  `,valueListWrapper:o.css`
    border-left: 1px solid ${e.colors.border2};
    margin: ${e.spacing.sm} 0;
    padding: ${e.spacing.sm} 0 ${e.spacing.sm} ${e.spacing.sm};
  `,valueListArea:o.css`
    display: flex;
    flex-wrap: wrap;
    margin-top: ${e.spacing.sm};
  `,valueTitle:o.css`
    margin-left: -${e.spacing.xs};
    margin-bottom: ${e.spacing.sm};
  `,validationStatus:o.css`
    padding: ${e.spacing.xs};
    margin-bottom: ${e.spacing.sm};
    color: ${e.colors.textStrong};
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  `})));class hh extends r().Component{updateLabelState(e,t,r="",n){this.setState((n=>{const i=n.labels.map((r=>r.name===e?sh({},r,t):r)),a=r?"":n.error;return{labels:i,status:r,error:a,validationStatus:""}}),n)}componentDidMount(){const{languageProvider:e,lastUsedLabels:t}=this.props;if(e){const r=t;e.start().then((()=>{let t=e.getLabelKeys();this.fetchValues(uh,ch);const n=t.map(((e,t,n)=>({name:e,selected:r.includes(e),loading:!1})));this.setState({labels:n},(()=>{this.state.labels.forEach((e=>{e.selected&&this.fetchValues(e.name,ch)}))}))}))}}doFacettingForLabel(e){const t=this.state.labels.find((t=>t.name===e));if(!t)return;const r=this.state.labels.filter((e=>e.selected)).map((e=>e.name));this.props.storeLastUsedLabels(r),t.selected?t.values||this.fetchValues(e,dh(this.state.labels)):this.doFacetting()}fetchValues(e,t){var r=this;return ah((function*(){const{languageProvider:n}=r.props;r.updateLabelState(e,{loading:!0},`Fetching values for ${e}`);try{let i=yield n.getLabelValues(e);if(t!==dh(r.state.labels))return void r.updateLabelState(e,{loading:!1});const a=[],{metricsMetadata:o}=n;for(const t of i){const r={name:t};if(e===uh&&o){const e=o[t];e&&(r.details=`(${e.type}) ${e.help}`)}a.push(r)}r.updateLabelState(e,{values:a,loading:!1})}catch(e){console.error(e)}}))()}fetchSeries(e,t){var r=this;return ah((function*(){const{languageProvider:n}=r.props;t&&r.updateLabelState(t,{loading:!0},`Facetting labels for ${e}`);try{const i=yield n.fetchSeriesLabels(e,!0);if(e!==dh(r.state.labels))return void(t&&r.updateLabelState(t,{loading:!1}));if(0===Object.keys(i).length)return void r.setState({error:`Empty results, no matching label for ${e}`});const a=function(e,t,r){return e.map((e=>{const n=t[e.name];if(n){let t;if(e.name===r&&e.values)t=e.values;else{var i;const r=new Set((null===(i=e.values)||void 0===i?void 0:i.filter((e=>e.selected)).map((e=>e.name)))||[]);t=n.map((e=>({name:e,selected:r.has(e)})))}return lh(sh({},e),{loading:!1,values:t,hidden:!n,facets:t.length})}return lh(sh({},e),{loading:!1,hidden:!n,values:void 0,facets:0})}))}(r.state.labels,i,t);r.setState({labels:a,error:""}),t&&r.updateLabelState(t,{loading:!1})}catch(e){console.error(e)}}))()}validateSelector(e){var t=this;return ah((function*(){const{languageProvider:r}=t.props;t.setState({validationStatus:`Validating selector ${e}`,error:""});const n=yield r.fetchSeries(e);t.setState({validationStatus:`Selector is valid (${n.length} series found)`})}))()}render(){var e;const{theme:t}=this.props,{labels:n,labelSearchTerm:i,metricSearchTerm:s,status:l,error:c,validationStatus:u,valueSearchTerm:d}=this.state,p=ph(t);if(0===n.length)return r().createElement("div",{className:p.wrapper},r().createElement(a.LoadingPlaceholder,{text:"Loading labels..."}));let h=n.find((e=>e.name===uh));var f;h&&s&&(h=lh(sh({},h),{values:null===(f=h.values)||void 0===f?void 0:f.filter((e=>e.selected||e.name.includes(s)))}));let m=n.filter((e=>!e.hidden&&e.name!==uh));i&&(m=m.filter((e=>e.selected||e.name.includes(i))));let g=m.filter((e=>e.selected&&e.values));d&&(g=g.map((e=>{var t;return lh(sh({},e),{values:null===(t=e.values)||void 0===t?void 0:t.filter((e=>e.selected||e.name.includes(d)))})})));const b=dh(this.state.labels),v=b===ch,y=(null==h||null===(e=h.values)||void 0===e?void 0:e.length)||0;return r().createElement("div",{className:p.wrapper},r().createElement(a.HorizontalGroup,{align:"flex-start",spacing:"lg"},r().createElement("div",null,r().createElement("div",{className:p.section},r().createElement(a.Label,{description:"Once a metric is selected only possible labels are shown."},"1. Select a metric"),r().createElement("div",null,r().createElement(a.Input,{onChange:this.onChangeMetricSearch,"aria-label":"Filter expression for metric",value:s})),r().createElement("div",{role:"list",className:p.valueListWrapper},r().createElement(nh,{height:Math.min(450,25*y),itemCount:y,itemSize:25,itemKey:e=>h.values[e].name,width:300,className:p.valueList},(({index:e,style:t})=>{var n;const i=null==h||null===(n=h.values)||void 0===n?void 0:n[e];return i?r().createElement("div",{style:t},r().createElement(a.BrowserLabel,{name:h.name,value:null==i?void 0:i.name,title:i.details,active:null==i?void 0:i.selected,onClick:this.onClickMetric,searchTerm:s})):null}))))),r().createElement("div",null,r().createElement("div",{className:p.section},r().createElement(a.Label,{description:"Once label values are selected, only possible label combinations are shown."},"2. Select labels to search in"),r().createElement("div",null,r().createElement(a.Input,{onChange:this.onChangeLabelSearch,"aria-label":"Filter expression for label",value:i})),r().createElement("div",{className:p.list,style:{height:120}},m.map((e=>r().createElement(a.BrowserLabel,{key:e.name,name:e.name,loading:e.loading,active:e.selected,hidden:e.hidden,facets:e.facets,onClick:this.onClickLabel,searchTerm:i}))))),r().createElement("div",{className:p.section},r().createElement(a.Label,{description:"Use the search field to find values across selected labels."},"3. Select (multiple) values for your labels"),r().createElement("div",null,r().createElement(a.Input,{onChange:this.onChangeValueSearch,"aria-label":"Filter expression for label values",value:d})),r().createElement("div",{className:p.valueListArea,ref:this.valueListsRef},g.map((e=>{var t,n,i;return r().createElement("div",{role:"list",key:e.name,"aria-label":`Values for ${e.name}`,className:p.valueListWrapper},r().createElement("div",{className:p.valueTitle},r().createElement(a.BrowserLabel,{name:e.name,loading:e.loading,active:e.selected,hidden:e.hidden,facets:e.facets||(null===(t=e.values)||void 0===t?void 0:t.length),onClick:this.onClickLabel})),r().createElement(nh,{height:Math.min(200,25*((null===(n=e.values)||void 0===n?void 0:n.length)||0)),itemCount:(null===(i=e.values)||void 0===i?void 0:i.length)||0,itemSize:28,itemKey:t=>e.values[t].name,width:200,className:p.valueList},(({index:t,style:n})=>{var i;const o=null===(i=e.values)||void 0===i?void 0:i[t];return o?r().createElement("div",{style:n},r().createElement(a.BrowserLabel,{name:e.name,value:null==o?void 0:o.name,active:null==o?void 0:o.selected,onClick:this.onClickValue,searchTerm:d})):null})))})))))),r().createElement("div",{className:p.section},r().createElement(a.Label,null,"4. Resulting selector"),r().createElement("div",{"aria-label":"selector",className:p.selector},b),u&&r().createElement("div",{className:p.validationStatus},u),r().createElement(a.HorizontalGroup,null,r().createElement(a.Button,{"aria-label":"Use selector for query button",disabled:v,onClick:this.onClickRunQuery},"Use query"),r().createElement(a.Button,{"aria-label":"Use selector as metrics button",variant:"secondary",disabled:v,onClick:this.onClickRunRateQuery},"Use as rate query"),r().createElement(a.Button,{"aria-label":"Validate submit button",variant:"secondary",disabled:v,onClick:this.onClickValidate},"Validate selector"),r().createElement(a.Button,{"aria-label":"Selector clear button",variant:"secondary",onClick:this.onClickClear},"Clear"),r().createElement("div",{className:(0,o.cx)(p.status,(l||c)&&p.statusShowing)},r().createElement("span",{className:c?p.error:""},c||l)))))}constructor(...e){super(...e),this.valueListsRef=r().createRef(),this.state={labels:[],labelSearchTerm:"",metricSearchTerm:"",status:"Ready",error:"",validationStatus:"",valueSearchTerm:""},this.onChangeLabelSearch=e=>{this.setState({labelSearchTerm:e.target.value})},this.onChangeMetricSearch=e=>{this.setState({metricSearchTerm:e.target.value})},this.onChangeValueSearch=e=>{this.setState({valueSearchTerm:e.target.value})},this.onClickRunQuery=()=>{const e=dh(this.state.labels);this.props.onChange(e)},this.onClickRunRateQuery=()=>{const e=`rate(${dh(this.state.labels)}[$__interval])`;this.props.onChange(e)},this.onClickClear=()=>{this.setState((e=>({labels:e.labels.map((e=>lh(sh({},e),{values:void 0,selected:!1,loading:!1,hidden:!1,facets:void 0}))),labelSearchTerm:"",metricSearchTerm:"",status:"",error:"",validationStatus:"",valueSearchTerm:""}))),this.props.deleteLastUsedLabels(),this.fetchValues(uh,ch)},this.onClickLabel=(e,t,r)=>{const n=this.state.labels.find((t=>t.name===e));if(!n)return;const i=!n.selected;let a={selected:i};if(n.values&&!i){const e=n.values.map((e=>lh(sh({},e),{selected:!1})));a=lh(sh({},a),{facets:0,values:e})}this.setState({labelSearchTerm:""}),this.updateLabelState(e,a,"",(()=>this.doFacettingForLabel(e)))},this.onClickValue=(e,t,r)=>{const n=this.state.labels.find((t=>t.name===e));if(!n||!n.values)return;this.setState({labelSearchTerm:""});const i=n.values.map((e=>lh(sh({},e),{selected:e.name===t?!e.selected:e.selected})));this.updateLabelState(e,{values:i},"",(()=>this.doFacetting(e)))},this.onClickMetric=(e,t,r)=>{const n=this.state.labels.find((t=>t.name===e));if(!n||!n.values)return;this.setState({metricSearchTerm:""});const i=n.values.map((e=>lh(sh({},e),{selected:e.name===t||e.selected?!e.selected:e.selected}))),a=i.some((e=>e.selected));this.updateLabelState(e,{selected:a,values:i},"",(()=>this.doFacetting(e)))},this.onClickValidate=()=>{const e=dh(this.state.labels);this.validateSelector(e)},this.doFacetting=e=>{const t=dh(this.state.labels);if(t===ch){const e=this.state.labels.map((e=>lh(sh({},e),{facets:0,values:void 0,hidden:!1})));this.setState({labels:e},(()=>{this.state.labels.forEach((e=>(e.selected||e.name===uh)&&this.fetchValues(e.name,t)))}))}else this.fetchSeries(t,e)}}}const fh=(0,a.withTheme)(hh);var mh={id:"promql",extensions:[".promql"],aliases:["Prometheus","prometheus","prom","Prom","promql","Promql","promQL","PromQL"],mimetypes:[],loader:function(){return Promise.all([m.e(719),m.e(8)]).then(m.bind(m,719))}};const gh=function(e){var r=(0,t.useRef)(e);return r.current=e,r};function bh(){const e=new Map;return e.set("expandSuggestionDocs",(!0).toString()),{onDidChangeValue:e=>{},onDidChangeTarget:e=>{},onWillSaveState:e=>{},get:(t,r,n)=>{var i;return null!==(i=e.get(t))&&void 0!==i?i:n},getBoolean:(t,r,n)=>{const i=e.get(t);return void 0!==i?"true"===i:n},getNumber:(t,r,n)=>{const i=e.get(t);return void 0!==i?parseInt(i,10):n},store:(t,r,n,i)=>{null==r?e.delete(t):e.set(t,r.toString())},remove:(t,r)=>{e.delete(t)},keys:(t,r)=>Array.from(e.keys()),logStorage:()=>{console.log("logStorage: not implemented")},migrate:()=>Promise.resolve(void 0),isNew:e=>!0,flush:e=>Promise.resolve(void 0)}}let vh=null;class yh extends Error{constructor(e){super("should never happen")}}function Oh(e,t,r,n,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function xh(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function o(e){Oh(a,n,i,o,s,"next",e)}function s(e){Oh(a,n,i,o,s,"throw",e)}o(void 0)}))}}function wh(e){return _h.apply(this,arguments)}function _h(){return(_h=xh((function*(e){return(yield e.getAllMetricNames()).map((e=>({type:"METRIC_NAME",label:e.name,insertText:e.name,detail:`${e.name} : ${e.type}`,documentation:e.help})))}))).apply(this,arguments)}var Sh;const Eh=z.map((e=>({type:"FUNCTION",label:e.label,insertText:null!==(Sh=e.insertText)&&void 0!==Sh?Sh:"",detail:e.detail,documentation:e.documentation})));function kh(e){return Ph.apply(this,arguments)}function Ph(){return(Ph=xh((function*(e){const t=yield wh(e);return[...Eh,...t]}))).apply(this,arguments)}const Th=["$__interval","$__range","$__rate_interval","1m","5m","10m","30m","1h","1d"].map((e=>({type:"DURATION",label:e,insertText:e})));function Ch(e){return Ih.apply(this,arguments)}function Ih(){return(Ih=xh((function*(e){return(yield e.getHistory()).slice(0,10).map((e=>({type:"HISTORY",label:e,insertText:e})))}))).apply(this,arguments)}function Dh(e,t){const r=[...t];return void 0!==e&&r.push({name:"__name__",value:e,op:"="}),`{${r.map((e=>`${e.name}${e.op}"${Qi(e.value)}"`)).join(",")}}`}function Ah(e,t,r){return Rh.apply(this,arguments)}function Rh(){return Rh=xh((function*(e,t,r){if(void 0===e&&0===t.length)return r.getAllLabelNames();{const n=Dh(e,t),i=yield r.getSeries(n),a=Object.keys(i),o=new Set(t.map((e=>e.name)));return a.filter((e=>!o.has(e)))}})),Rh.apply(this,arguments)}function jh(e,t,r,n,i){return Nh.apply(this,arguments)}function Nh(){return(Nh=xh((function*(e,t,r,n,i){return(yield Ah(e,n,i)).map((e=>({type:"LABEL_NAME",label:e,insertText:`${e}${t}`,triggerOnInsert:r})))}))).apply(this,arguments)}function Lh(e,t,r){return qh.apply(this,arguments)}function qh(){return(qh=xh((function*(e,t,r){return jh(e,"=",!0,t,r)}))).apply(this,arguments)}function $h(e,t,r){return Mh.apply(this,arguments)}function Mh(){return(Mh=xh((function*(e,t,r){return jh(e,"",!1,t,r)}))).apply(this,arguments)}function Bh(e,t,r,n){return Fh.apply(this,arguments)}function Fh(){return(Fh=xh((function*(e,t,r,n){if(void 0===e&&0===r.length)return n.getLabelValues(t);{const a=Dh(e,r);var i;return null!==(i=(yield n.getSeries(a))[t])&&void 0!==i?i:[]}}))).apply(this,arguments)}function Qh(e,t,r,n,i){return zh.apply(this,arguments)}function zh(){return(zh=xh((function*(e,t,r,n,i){return(yield Bh(e,t,n,i)).map((e=>({type:"LABEL_VALUE",label:e,insertText:r?e:`"${e}"`})))}))).apply(this,arguments)}function Vh(){return(Vh=xh((function*(e,t){switch(e.type){case"IN_DURATION":return Th;case"IN_FUNCTION":case"AT_ROOT":return kh(t);case"EMPTY":{const e=yield wh(t);return[...yield Ch(t),...Eh,...e]}case"IN_LABEL_SELECTOR_NO_LABEL_NAME":return Lh(e.metricName,e.otherLabels,t);case"IN_GROUPING":return $h(e.metricName,e.otherLabels,t);case"IN_LABEL_SELECTOR_WITH_LABEL_NAME":return Qh(e.metricName,e.labelName,e.betweenQuotes,e.otherLabels,t);default:throw new yh(e)}}))).apply(this,arguments)}function Uh(e,t){switch(t){case"parent":return e.parent;case"firstChild":return e.firstChild;case"lastChild":return e.lastChild;case"nextSibling":return e.nextSibling;default:throw new yh(t)}}function Wh(e,t){let r=e;for(const[e,n]of t){if(r=Uh(r,e),null===r)return null;if(r.type.id!==n)return null}return r}function Xh(e,t){return t.slice(e.from,e.to)}function Gh(e,t){return e.every(((e,r)=>e===t[r]))}const Hh=[{path:[135,Nr],fun:function(e,t,r){if(function(e){return null!==Zh(e,0)}(e))return null;const n=Wh(e,[["firstChild",qr]]);if(null!==n&&!t.slice(n.to,r).includes(","))return null;const i=Wh(e,[["parent",Nr],["firstChild",Lr],["firstChild",57]]),a=Jh(e,t);return null===i?{type:"IN_LABEL_SELECTOR_NO_LABEL_NAME",otherLabels:a}:{type:"IN_LABEL_SELECTOR_NO_LABEL_NAME",metricName:Xh(i,t),otherLabels:a}}},{path:[28],fun:function(e,t,r){return{type:"AT_ROOT"}}},{path:[37],fun:function(e,t,r){return{type:"IN_FUNCTION"}}},{path:[jr,$r],fun:ef},{path:[0,$r],fun:ef},{path:[0,124],fun:function(e,t,r){return{type:"IN_DURATION"}}},{path:[33],fun:function(e,t,r){const n=Wh(e,[["parent",32],["parent",30]]);if(null===n)return null;const i=n.getChild(37);if(null===i)return null;const a=Zh(i,Lr);if(null===a)return null;const o=Wh(a,[["firstChild",57]]);return null===o?null:{type:"IN_GROUPING",metricName:Xh(o,t),otherLabels:[]}}}],Yh=new Map([[139,"="],[140,"=~"],[53,"!="],[141,"!~"]]);function Kh(e,t){if(e.type.id!==$r)return null;const r=Wh(e,[["firstChild",36]]);if(null===r)return null;const n=Wh(r,[["nextSibling",138]]);if(null===n)return null;const i=function(e){const t=e.firstChild;return null===t?null:null!==(r=Yh.get(t.type.id))&&void 0!==r?r:null;var r}(n);if(null===i)return null;const a=Wh(e,[["lastChild",jr]]);if(null===a)return null;const o=Xh(r,t),s=function(e){const t=e.slice(1,e.length-1);if(e.startsWith('"')&&e.endsWith('"'))return t.replace(/\\"/,'"');if(e.startsWith("'")&&e.endsWith("'"))return t.replace(/\\'/,"'");if(e.startsWith("`")&&e.endsWith("`"))return t;throw new Error("FIXME: invalid string literal")}(Xh(a,t));return{name:o,value:s,op:i}}function Jh(e,t){if(135!==e.type.id)return[];let r=Wh(e,[["firstChild",qr]]);const n=[];for(;null!==r;){const e=Wh(r,[["lastChild",$r]]);if(null===e)return[];const i=Kh(e,t);null!==i&&n.push(i),r=Wh(r,[["firstChild",qr]])}return n.reverse(),n}function Zh(e,t){if(e.type.id===t)return e;const r=function(e){let t=e.firstChild;const r=[];for(;null!==t;)r.push(t),t=t.nextSibling;return r}(e);for(const e of r){const r=Zh(e,t);if(null!==r)return r}return null}function ef(e,t,r){const n=!e.type.isError,i=Wh(e,[["parent",$r]]);if(null===i)return null;const a=Wh(i,[["firstChild",36]]);if(null===a)return null;const o=Xh(a,t),s=Wh(i,[["parent",qr]]);if(null===s)return null;let l=s,c=null;for(;null===c;){const e=l.parent;if(null===e)return null;const{id:t}=e.type;switch(t){case qr:l=e;continue;case 135:c=e;continue;default:return null}}const u=Jh(c,t).filter((e=>e.name!==o)),d=Wh(c,[["parent",Nr],["firstChild",Lr],["firstChild",57]]);return null===d?{type:"IN_LABEL_SELECTOR_WITH_LABEL_NAME",labelName:o,betweenQuotes:n,otherLabels:u}:{type:"IN_LABEL_SELECTOR_WITH_LABEL_NAME",metricName:Xh(d,t),labelName:o,betweenQuotes:n,otherLabels:u}}function tf(e,t){switch(e){case"DURATION":return t.languages.CompletionItemKind.Unit;case"FUNCTION":return t.languages.CompletionItemKind.Variable;case"HISTORY":return t.languages.CompletionItemKind.Snippet;case"LABEL_NAME":return t.languages.CompletionItemKind.Enum;case"LABEL_VALUE":return t.languages.CompletionItemKind.EnumMember;case"METRIC_NAME":return t.languages.CompletionItemKind.Constructor;default:throw new yh(e)}}function rf(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const nf={codeLens:!1,contextmenu:!1,fixedOverflowWidgets:!0,folding:!1,fontSize:14,lineDecorationsWidth:8,lineNumbers:"off",minimap:{enabled:!1},overviewRulerBorder:!1,overviewRulerLanes:0,padding:{top:4,bottom:5},renderLineHighlight:"none",scrollbar:{vertical:"hidden",verticalScrollbarSize:8,horizontal:"hidden",horizontalScrollbarSize:0},scrollBeyondLastLine:!1,suggest:{showWords:!1},suggestFontSize:12,wordWrap:"on"},af=mh.id;let of=!1;const sf=e=>{const n=(0,t.useRef)((null===vh&&(vh={storageService:bh()}),vh)),i=(0,t.useRef)(null),{languageProvider:s,history:l,onBlur:c,onRunQuery:u,initialValue:d,placeholder:p}=e,h=gh(s),f=gh(l),g=gh(u),b=gh(c),v=(0,t.useRef)(null),y=((e,t)=>({container:o.css`
      border-radius: ${e.shape.borderRadius()};
      border: 1px solid ${e.components.input.borderColor};
    `,placeholder:o.css`
      ::after {
        content: '${t}';
        font-family: ${e.typography.fontFamilyMonospace};
        opacity: 0.3;
      }
    `}))((0,a.useTheme2)(),p);return(0,t.useEffect)((()=>()=>{var e;null===(e=v.current)||void 0===e||e.call(v)}),[]),r().createElement("div",{"aria-label":aa.selectors.components.QueryField.container,className:y.container,ref:i},r().createElement(a.ReactMonacoEditor,{overrideServices:n.current,options:nf,language:"promql",value:d,beforeMount:e=>{!function(e){if(!1===of){of=!0;const{aliases:t,extensions:r,mimetypes:n,loader:i}=mh;e.languages.register({id:af,aliases:t,extensions:r,mimetypes:n}),i().then((t=>{e.languages.setMonarchTokensProvider(af,t.language),e.languages.setLanguageConfiguration(af,t.languageConfiguration)}))}}(e)},onMount:(e,t)=>{e.onDidBlurEditorWidget((()=>{b.current(e.getValue())}));const r={getSeries:e=>h.current.getSeries(e),getHistory:()=>Promise.resolve(f.current.map((e=>e.query.expr)).filter((e=>void 0!==e))),getAllMetricNames:()=>{const{metrics:e,metricsMetadata:t}=h.current,r=e.map((e=>{const r=null==t?void 0:t[e];var n,i;return{name:e,help:null!==(n=null==r?void 0:r.help)&&void 0!==n?n:"",type:null!==(i=null==r?void 0:r.type)&&void 0!==i?i:""}}));return Promise.resolve(r)},getAllLabelNames:()=>Promise.resolve(h.current.getLabelKeys()),getLabelValues:e=>h.current.getLabelValues(e)},n=function(e,t){return{triggerCharacters:["{",",","[","(","=","~"," ",'"'],provideCompletionItems:(r,n)=>{const i=r.getWordAtPosition(n),a=null!=i?e.Range.lift({startLineNumber:n.lineNumber,endLineNumber:n.lineNumber,startColumn:i.startColumn,endColumn:i.endColumn}):e.Range.fromPositions(n),o={column:n.column,lineNumber:n.lineNumber},s=r.getOffsetAt(o),l=function(e,t){if(""===e)return{type:"EMPTY"};const r=Ar.parse(e),n=function(e,t){const r=e.cursorAt(t);for(;;){if(r.from===t&&r.to===t){const{node:e}=r;if(e.type.isError)return e}if(!r.next())break}return null}(r,t),i=null!=n?n.cursor():r.cursorAt(t),a=i.node,o=[i.type.id];for(;i.parent();)o.push(i.type.id);for(let r of Hh)if(Gh(r.path,o))return r.fun(a,e,t);return null}(r.getValue(),s),c=null!=l?function(e,t){return Vh.apply(this,arguments)}(l,t):Promise.resolve([]);return c.then((t=>{const r=t.length.toString().length;return{suggestions:t.map(((t,n)=>({kind:tf(t.type,e),label:t.label,insertText:t.insertText,detail:t.detail,documentation:{value:t.documentation},sortText:n.toString().padStart(r,"0"),range:a,command:t.triggerOnInsert?{id:"editor.action.triggerSuggest",title:""}:void 0})))}}))}}}(t,r),a=(s=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){rf(e,t,r[t])}))}return e}({},n),l={provideCompletionItems:(t,r,i,a)=>{var o;return(null===(o=e.getModel())||void 0===o?void 0:o.id)!==t.id?{suggestions:[]}:n.provideCompletionItems(t,r,i,a)}},l=null!=l?l:{},Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(l)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(l)).forEach((function(e){Object.defineProperty(s,e,Object.getOwnPropertyDescriptor(l,e))})),s),{dispose:o}=t.languages.registerCompletionItemProvider(af,a);var s,l;v.current=o;const c=()=>{const t=i.current;if(null!==t){const r=e.getContentHeight();t.style.height=`${r+2}px`,t.style.width="100%";const n=t.clientWidth;e.layout({width:n,height:r})}};if(e.onDidContentSizeChange(c),c(),e.addCommand(t.KeyMod.Shift|t.KeyCode.Enter,(()=>{g.current(e.getValue())})),e.addCommand(t.KeyMod.CtrlCmd|t.KeyCode.KeyK,(function(){m.g.dispatchEvent(new KeyboardEvent("keydown",{key:"k",metaKey:!0}))})),p){const r=[{range:new t.Range(1,1,1,1),contents:[{value:"**bold** _italics_ regular `code`"}],options:{className:y.placeholder,isWholeLine:!0}}];let n=[];const i=()=>{const t=e.getModel();if(!t)return;const i=0===t.getValueLength()?r:[];n=t.deltaDecorations(n,i)};i(),e.onDidChangeModelContent(i)}}}))};function lf(){return lf=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},lf.apply(this,arguments)}const cf=e=>r().createElement(t.Suspense,{fallback:null},r().createElement(sf,lf({},e)));function uf(){return uf=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},uf.apply(this,arguments)}const df=e=>{const n=(0,t.useRef)(null),{runQueryOnBlur:i,onRunQuery:a,onChange:o}=e,s=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,["runQueryOnBlur","onRunQuery","onChange"]),l=e=>{n.current=e,o(e),a()};return r().createElement(cf,uf({onRunQuery:l,onBlur:e=>{i?e!==n.current&&l(e):o(e)}},s))};function pf(e,t,r,n,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function hf(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function o(e){pf(a,n,i,o,s,"next",e)}function s(e){pf(a,n,i,o,s,"throw",e)}o(void 0)}))}}function ff(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mf(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){ff(e,t,r[t])}))}return e}function gf(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}class bf extends r().PureComponent{componentDidMount(){this.props.datasource.languageProvider&&this.refreshMetrics(),this.refreshHint()}componentWillUnmount(){this.languageProviderInitializationPromise&&this.languageProviderInitializationPromise.cancel()}componentDidUpdate(e){const{data:t,datasource:{languageProvider:r},range:n}=this.props;r!==e.datasource.languageProvider&&this.setState({syntaxLoaded:!1});const i=this.rangeChangedToRefresh(n,e.range);(r!==e.datasource.languageProvider||i)&&this.refreshMetrics(),t&&e.data&&e.data.series!==t.series&&this.refreshHint()}rangeChangedToRefresh(e,t){if(e&&t){const r=qi(e.from.valueOf())===qi(t.from.valueOf()),n=qi(e.to.valueOf())===qi(t.to.valueOf());return!(r&&n)}return!1}render(){const{datasource:t,datasource:{languageProvider:n},query:i,ExtraFieldElement:o,history:s=[]}=this.props,{labelBrowserVisible:l,syntaxLoaded:c,hint:u}=this.state,d=n.metrics.length>0,p=function(e,t,r){return e?"(Disabled)":t?r?"Metrics browser":"(No metrics found)":"Loading metrics..."}(t.lookupsDisabled,c,d),h=!(c&&d);return r().createElement(zp,{storageKey:"grafana.datasources.prometheus.browser.labels",defaultValue:[]},((t,c,d)=>{var f;return r().createElement(r().Fragment,null,r().createElement("div",{className:"gf-form-inline gf-form-inline--xs-view-flex-column flex-grow-1","data-testid":this.props["data-testid"]},r().createElement("button",{className:"gf-form-label query-keyword pointer",onClick:this.onClickChooserButton,disabled:h},p,r().createElement(a.Icon,{name:l?"angle-down":"angle-right"})),r().createElement("div",{className:"gf-form gf-form--grow flex-shrink-1 min-width-15"},r().createElement(df,{runQueryOnBlur:this.props.app!==e.CoreApp.Explore,languageProvider:n,history:s,onChange:this.onChangeQuery,onRunQuery:this.props.onRunQuery,initialValue:null!==(f=i.expr)&&void 0!==f?f:"",placeholder:"Enter a PromQL queryâ¦"}))),l&&r().createElement("div",{className:"gf-form"},r().createElement(fh,{languageProvider:n,onChange:this.onChangeLabelBrowser,lastUsedLabels:t||[],storeLastUsedLabels:c,deleteLastUsedLabels:d})),o,u?r().createElement("div",{className:"query-row-break"},r().createElement("div",{className:"prom-query-field-info text-warning"},u.label," ",u.fix?r().createElement("a",{className:"text-link muted",onClick:this.onClickHintFix},u.fix.label):null)):null)}))}constructor(t,r){super(t,r),this.refreshHint=()=>{const{datasource:t,query:r,data:n}=this.props,i=t.getInitHints(),a=i.length>0?i[0]:null;if(!n||0===n.series.length)return void this.setState({hint:a});const o=(0,e.isDataFrame)(n.series[0])?n.series.map(e.toLegacyResponseData):n.series,s=t.getQueryHints(r,o);let l=s.length>0?s[0]:null;this.setState({hint:null!=l?l:a})};var n=this;this.refreshMetrics=hf((function*(){const{datasource:{languageProvider:e}}=n.props;n.languageProviderInitializationPromise=(e=>{let t=!1;return{promise:new Promise(((r,n)=>{const i={isCanceled:!0};e.then((e=>t?n(i):r(e))),e.catch((e=>n(t?i:e)))})),cancel(){t=!0}}})(e.start());try{const e=yield n.languageProviderInitializationPromise.promise;yield Promise.all(e),n.onUpdateLanguage()}catch(e){if("object"!=typeof(t=e)||null===t||!("isCanceled"in t)||!e.isCanceled)throw e}var t})),this.onChangeLabelBrowser=e=>{this.onChangeQuery(e,!0),this.setState({labelBrowserVisible:!1})},this.onChangeQuery=(e,t)=>{const{query:r,onChange:n,onRunQuery:i}=this.props;n&&(n(gf(mf({},r),{expr:e})),t&&i&&i())},this.onClickChooserButton=()=>{var e,t;this.setState((e=>({labelBrowserVisible:!e.labelBrowserVisible}))),(0,i.reportInteraction)("user_grafana_prometheus_metrics_browser_clicked",{editorMode:this.state.labelBrowserVisible?"metricViewClosed":"metricViewOpen",app:null!==(t=null===(e=this.props)||void 0===e?void 0:e.app)&&void 0!==t?t:""})},this.onClickHintFix=()=>{var e;const{datasource:t,query:r,onChange:n,onRunQuery:i}=this.props,{hint:a}=this.state;(null==a||null===(e=a.fix)||void 0===e?void 0:e.action)&&n(t.modifyQuery(r,a.fix.action)),i()},this.onUpdateLanguage=()=>{const{datasource:{languageProvider:e}}=this.props,{metrics:t}=e;t&&this.setState({syntaxLoaded:!0})};var o,s=this;this.onTypeahead=(o=hf((function*(e){const{datasource:{languageProvider:t}}=s.props;if(!t)return{suggestions:[]};const{history:r}=s.props,{prefix:n,text:i,value:a,wrapperClasses:o,labelKey:l}=e;return yield t.provideCompletionItems({text:i,value:a,prefix:n,wrapperClasses:o,labelKey:l},{history:r})})),function(e){return o.apply(this,arguments)}),this.plugins=[(0,a.BracesPlugin)(),(0,a.SlatePrism)({onlyIn:e=>"code_block"===e.type,getSyntax:e=>"promql"},gf(mf({},Ci.languages),{promql:this.props.datasource.languageProvider.syntax}))],this.state={labelBrowserVisible:!1,syntaxLoaded:!1,hint:null}}}const vf=bf;function yf(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const{Switch:Of}=a.LegacyForms,xf=[{label:"Time series",value:"time_series"},{label:"Table",value:"table"},{label:"Heatmap",value:"heatmap"}],wf=(0,G.map)([1,2,3,4,5,10],(e=>({value:e,label:"1/"+e})));class _f extends t.PureComponent{render(){const{datasource:t,query:n,range:i,data:o}=this.props,{formatOption:s,instant:l,interval:c,intervalFactorOption:u,legendFormat:d}=this.state,p=this.props.app!==e.CoreApp.UnifiedAlerting;return r().createElement(vf,{datasource:t,query:n,range:i,onRunQuery:this.onRunQuery,onChange:this.onFieldChange,history:[],data:o,"data-testid":Sf.editor,ExtraFieldElement:r().createElement("div",{className:"gf-form-inline"},r().createElement("div",{className:"gf-form"},r().createElement(a.InlineFormLabel,{width:7,tooltip:"Controls the name of the time series, using name or pattern. For example {{hostname}} will be replaced with label value for the label hostname."},"Legend"),r().createElement("input",{type:"text",className:"gf-form-input",placeholder:"legend format",value:d,onChange:this.onLegendChange,onBlur:this.onRunQuery})),r().createElement("div",{className:"gf-form"},r().createElement(a.InlineFormLabel,{width:7,tooltip:r().createElement(r().Fragment,null,"An additional lower limit for the step parameter of the Prometheus query and for the"," ",r().createElement("code",null,"$__interval")," and ",r().createElement("code",null,"$__rate_interval"),' variables. The limit is absolute and not modified by the "Resolution" setting.')},"Min step"),r().createElement("input",{type:"text",className:"gf-form-input width-8","aria-label":"Set lower limit for the step parameter",placeholder:c,onChange:this.onIntervalChange,onBlur:this.onRunQuery,value:c})),r().createElement("div",{className:"gf-form"},r().createElement("div",{className:"gf-form-label"},"Resolution"),r().createElement(a.Select,{"aria-label":"Select resolution",isSearchable:!1,options:wf,onChange:this.onIntervalFactorChange,value:u})),r().createElement("div",{className:"gf-form"},r().createElement("div",{className:"gf-form-label width-7"},"Format"),r().createElement(a.Select,{className:"select-container",width:16,isSearchable:!1,options:xf,onChange:this.onFormatChange,value:s,"aria-label":"Select format"}),r().createElement(Of,{label:"Instant",checked:l,onChange:this.onInstantChange}),r().createElement(a.InlineFormLabel,{width:10,tooltip:"Link to Graph in Prometheus"},r().createElement(Qp,{datasource:t,query:this.query,panelData:o}))),p&&r().createElement(Ip,{onChange:this.onExemplarChange,datasource:t,query:this.query,"data-testid":Sf.exemplar}))})}constructor(t){super(t),this.onFieldChange=(e,t)=>{this.query.expr=e.expr},this.onFormatChange=e=>{this.query.format=e.value,this.setState({formatOption:e},this.onRunQuery)},this.onInstantChange=e=>{const t=e.target.checked;this.query.instant=t,this.setState({instant:t},this.onRunQuery)},this.onIntervalChange=e=>{const t=e.currentTarget.value;this.query.interval=t,this.setState({interval:t})},this.onIntervalFactorChange=e=>{this.query.intervalFactor=e.value,this.setState({intervalFactorOption:e},this.onRunQuery)},this.onLegendChange=e=>{const t=e.currentTarget.value;this.query.legendFormat=t,this.setState({legendFormat:t})},this.onExemplarChange=e=>{this.query.exemplar=e,this.setState({exemplar:e},this.onRunQuery)},this.onRunQuery=()=>{const{query:e}=this,{hide:t}=this.props.query;var r,n;this.props.onChange((r=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){yf(e,t,r[t])}))}return e}({},e),n=null!=(n={hide:t})?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(n)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(n,e))})),r)),this.props.onRunQuery()};const r={expr:"",legendFormat:"",interval:"",exemplar:t.app!==e.CoreApp.UnifiedAlerting},n=Object.assign({},r,t.query);this.query=n,this.state={interval:n.interval,legendFormat:n.legendFormat,formatOption:xf.find((e=>e.value===n.format))||xf[0],intervalFactorOption:wf.find((e=>e.value===n.intervalFactor))||wf[0],instant:Boolean(n.instant),exemplar:Boolean(n.exemplar)}}}const Sf={editor:"prom-editor",exemplar:"exemplar-editor"};var Ef=function(e,t){return"boolean"==typeof t?t:!e};function kf({title:e,children:n,collapsedInfo:i}){const[o,s]=(c=!1,(0,t.useReducer)(Ef,c)),l=(0,a.useStyles2)(Pf);var c;return r().createElement(u,{gap:0,direction:"column"},r().createElement("div",{className:l.header,onClick:s,title:"Click to edit options"},r().createElement("div",{className:l.toggle},r().createElement(a.Icon,{name:o?"angle-down":"angle-right"})),r().createElement("h6",{className:l.title},e),!o&&r().createElement("div",{className:l.description},i.map(((e,t)=>r().createElement("span",{key:t},e))))),o&&r().createElement("div",{className:l.body},n))}const Pf=e=>({switchLabel:(0,o.css)({color:e.colors.text.secondary,cursor:"pointer",fontSize:e.typography.bodySmall.fontSize,"&:hover":{color:e.colors.text.primary}}),header:(0,o.css)({display:"flex",cursor:"pointer",alignItems:"baseline",color:e.colors.text.primary,"&:hover":{background:e.colors.emphasize(e.colors.background.primary,.03)}}),title:(0,o.css)({flexGrow:1,overflow:"hidden",fontSize:e.typography.bodySmall.fontSize,fontWeight:e.typography.fontWeightMedium,margin:0}),description:(0,o.css)({color:e.colors.text.secondary,fontSize:e.typography.bodySmall.fontSize,paddingLeft:e.spacing(2),gap:e.spacing(2),display:"flex"}),body:(0,o.css)({display:"flex",paddingTop:e.spacing(2),gap:e.spacing(2),flexWrap:"wrap"}),toggle:(0,o.css)({color:e.colors.text.secondary,marginRight:`${e.spacing(1)}`})}),Tf=[{label:"Auto",value:ln.Auto,description:"Only includes unique labels"},{label:"Verbose",value:ln.Verbose,description:"All label names and values"},{label:"Custom",value:ln.Custom,description:"Provide a naming template"}],Cf=r().memo((({legendFormat:e,onChange:n,onRunQuery:i})=>{const o=If(e),s=(0,t.useRef)(null);return r().createElement(E,{label:"Legend",tooltip:"Series name override or template. Ex. {{hostname}} will be replaced with label value for hostname."},r().createElement(r().Fragment,null,o===ln.Custom&&r().createElement(a.AutoSizeInput,{id:"legendFormat",minWidth:22,placeholder:"auto",defaultValue:e,onCommitChange:t=>{let r=t.currentTarget.value;0===r.length&&(r=ln.Auto),r!==e&&(n(r),i())},ref:s}),o!==ln.Custom&&r().createElement(a.Select,{inputId:"legend.mode",isSearchable:!1,placeholder:"Select legend mode",options:Tf,width:22,onChange:e=>{switch(e.value){case ln.Auto:n(ln.Auto);break;case ln.Custom:n("{{label_name}}"),setTimeout((()=>{var e,t;null===(e=s.current)||void 0===e||e.focus(),null===(t=s.current)||void 0===t||t.setSelectionRange(2,12,"forward")}),10);break;case ln.Verbose:n("")}i()},value:Tf.find((e=>e.value===o))})))}));function If(e){return e===ln.Auto?ln.Auto:null==e||""===e?ln.Verbose:ln.Custom}function Df(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Af(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Df(e,t,r[t])}))}return e}function Rf(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}Cf.displayName="PromQueryLegendEditor";const jf=r().memo((({query:t,app:n,onChange:i,onRunQuery:o})=>{const s=Lp(n===e.CoreApp.Explore||n===e.CoreApp.PanelEditor),l=qp(t,i),c=xf.find((e=>e.value===t.format))||xf[0],u=function(e){return e.range&&e.instant?"both":e.instant?"instant":"range"}(t),d=s.find((e=>e.value===u)).label;return r().createElement(P,null,r().createElement(kf,{title:"Options",collapsedInfo:Lf(t,c.label,d,n)},r().createElement(Cf,{legendFormat:t.legendFormat,onChange:e=>i(Rf(Af({},t),{legendFormat:e})),onRunQuery:o}),r().createElement(E,{label:"Min step",tooltip:r().createElement(r().Fragment,null,"An additional lower limit for the step parameter of the Prometheus query and for the"," ",r().createElement("code",null,"$__interval")," and ",r().createElement("code",null,"$__rate_interval")," variables.")},r().createElement(a.AutoSizeInput,{type:"text","aria-label":"Set lower limit for the step parameter",placeholder:"auto",minWidth:10,onCommitChange:e=>{i(Rf(Af({},t),{interval:e.currentTarget.value})),o()},defaultValue:t.interval})),r().createElement(E,{label:"Format"},r().createElement(a.Select,{value:c,allowCustomValue:!0,onChange:e=>{i(Rf(Af({},t),{format:e.value})),o()},options:xf})),r().createElement(E,{label:"Type"},r().createElement(a.RadioButtonGroup,{options:s,value:u,onChange:l})),Nf(t,n)&&r().createElement(E,{label:"Exemplars"},r().createElement(A,{value:t.exemplar||!1,onChange:e=>{const r=e.currentTarget.checked;i(Rf(Af({},t),{exemplar:r})),o()}})),t.intervalFactor&&t.intervalFactor>1&&r().createElement(E,{label:"Resolution"},r().createElement(a.Select,{"aria-label":"Select resolution",isSearchable:!1,options:wf,onChange:e=>{i(Rf(Af({},t),{intervalFactor:e.value})),o()},value:wf.find((e=>e.value===t.intervalFactor))}))))}));function Nf(t,r){return!(r===e.CoreApp.UnifiedAlerting||!t.range)}function Lf(e,t,r,n){const i=[];var a;return i.push(`Legend: ${function(e){const t=If(e);var r;return t!==ln.Custom?null===(r=Tf.find((e=>e.value===t)))||void 0===r?void 0:r.label:e}(e.legendFormat)}`),i.push(`Format: ${t}`),i.push(`Step: ${null!==(a=e.interval)&&void 0!==a?a:"auto"}`),i.push(`Type: ${r}`),Nf(e,n)&&(e.exemplar?i.push("Exemplars: true"):i.push("Exemplars: false")),i}function qf(e){const{query:t,datasource:n,range:i,onRunQuery:o,onChange:s,data:l,app:c,showExplain:u}=e,d=(0,a.useStyles2)($f);return r().createElement("div",{className:d.wrapper},r().createElement(vf,{datasource:n,query:t,range:i,onRunQuery:o,onChange:s,history:[],data:l,"data-testid":Sf.editor,app:c}),u&&r().createElement(vp,{query:t.expr}))}jf.displayName="PromQueryBuilderOptions";const $f=e=>({wrapper:o.css`
      .gf-form {
        margin-bottom: 0;
      }
    `});function Mf(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Bf(){return Bf=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Bf.apply(this,arguments)}const Ff=r().memo((n=>{const{onChange:o,onRunQuery:s,data:l,app:c}=n,[u,d]=(0,t.useState)(!1),[p,h]=(0,t.useState)(!1),{flag:f,setFlag:m}=on("PrometheusQueryEditorExplainDefault"),{flag:g,setFlag:b}=on("PrometheusQueryEditorRawQueryDefault",!0),y=function(t,r){let n=t;return t.editorMode||(n=pn(dn({},t),{editorMode:mn(t.expr)})),null==t.expr&&(n=pn(dn({},n),{expr:"",legendFormat:ln.Auto})),null==t.range&&null==t.instant&&(n=pn(dn({},n),{range:!0}),r===e.CoreApp.Explore&&(n.instant=!0)),n}(n.query,c),x=y.editorMode,w=(0,t.useCallback)((e=>{var t;(0,i.reportInteraction)("user_grafana_prometheus_editor_mode_clicked",{newEditor:e,previousEditor:null!==(t=y.editorMode)&&void 0!==t?t:"",newQuery:!y.expr,app:null!=c?c:""}),e===Jr.Builder&&Wr(y.expr||"").errors.length?d(!0):fn(y,e,o)}),[o,y,c]);return(0,t.useEffect)((()=>{h(!1)}),[l]),r().createElement(r().Fragment,null,r().createElement(a.ConfirmModal,{isOpen:u,title:"Query parsing",body:"There were errors while trying to parse the query. Continuing to visual builder may lose some parts of the query.",confirmText:"Continue",onConfirm:()=>{fn(y,Jr.Builder,o),d(!1)},onDismiss:()=>d(!1)}),r().createElement(v,null,r().createElement(L,{value:null,placeholder:"Query patterns",allowCustomValue:!0,onChange:({value:e})=>{const t=Wr(y.expr||"");var r,n;t.query.operations=null==e?void 0:e.operations,o((r=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Mf(e,t,r[t])}))}return e}({},y),n=null!=(n={expr:$e.renderQuery(t.query)})?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(n)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(n,e))})),r))},options:$e.getQueryPatterns().map((e=>({label:e.name,value:e})))}),r().createElement(rn,{label:"Explain",value:f,onChange:e=>{m(e.currentTarget.checked)}}),x===Jr.Builder&&r().createElement(r().Fragment,null,r().createElement(rn,{label:"Raw query",value:g,onChange:e=>{const t=e.currentTarget.checked;b(t)}}),r().createElement(Yr,{feedbackUrl:"https://github.com/grafana/grafana/discussions/47693"})),r().createElement(j,{grow:1}),c!==e.CoreApp.Explore&&r().createElement(a.Button,{variant:p?"primary":"secondary",size:"sm",onClick:s,icon:(null==l?void 0:l.state)===e.LoadingState.Loading?"fa fa-spinner":void 0,disabled:(null==l?void 0:l.state)===e.LoadingState.Loading},"Run queries"),r().createElement(en,{mode:x,onChange:w})),r().createElement(O,{v:.5}),r().createElement(I,null,x===Jr.Code&&r().createElement(qf,Bf({},n,{query:y,showExplain:f})),x===Jr.Builder&&r().createElement(kp,{query:y,datasource:n.datasource,onChange:e=>{h(!0),o(e)},onRunQuery:n.onRunQuery,data:l,showRawQuery:g,showExplain:f}),r().createElement(jf,{query:y,app:n.app,onChange:o,onRunQuery:s})))}));function Qf(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zf(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Qf(e,t,r[t])}))}return e}function Vf(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}Ff.displayName="PromQueryEditorSelector";const Uf=(0,t.memo)((n=>{const{range:i,query:a,data:o,datasource:s,history:l,onChange:c,onRunQuery:u}=n;return(0,t.useEffect)((()=>{void 0===a.expr&&c(Vf(zf({},a),{expr:""})),void 0===a.exemplar&&c(Vf(zf({},a),{exemplar:!0})),a.instant||a.range||a.expr||c(Vf(zf({},a),{instant:!0,range:!0}))}),[c,a]),r().createElement(vf,{app:e.CoreApp.Explore,datasource:s,query:a,range:i,onRunQuery:u,onChange:c,onBlur:()=>{},history:l,data:o,"data-testid":Wf.editor,ExtraFieldElement:r().createElement(Np,{query:a,onChange:c,datasource:s,onRunQuery:u})})}));Uf.displayName="PromExploreQueryEditor";const Wf={editor:"prom-editor-explore"};function Xf(e){const{datasource:t,query:n,range:i,data:a,onChange:o,onRunQuery:s}=e;return r().createElement(vf,{datasource:t,query:n,onRunQuery:s,onChange:o,history:[],range:i,data:a,"data-testid":Gf.editor})}const Gf={editor:"prom-editor-cloud-alerting"};function Hf(){return Hf=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Hf.apply(this,arguments)}function Yf(t){const{app:n}=t;switch(n){case e.CoreApp.CloudAlerting:return r().createElement(Xf,Hf({},t));case e.CoreApp.Explore:return i.config.featureToggles.promQueryBuilder?r().createElement(Ff,Hf({},t)):r().createElement(Uf,Hf({},t));default:return i.config.featureToggles.promQueryBuilder?r().createElement(Ff,Hf({},t)):r().createElement(_f,Hf({},t))}}const Kf=(0,t.memo)(Yf);var Jf,Zf,em,tm,rm,nm,im,am,om,sm,lm,cm,um,dm,pm,hm,fm,mm,gm,bm,vm,ym,Om,xm,wm,_m=m(2199);!function(e){e.Active="active",e.Expired="expired",e.Pending="pending"}(Jf||(Jf={})),function(e){e.Unprocessed="unprocessed",e.Active="active",e.Suppressed="suppressed"}(Zf||(Zf={})),(pm=em||(em={})).equal="=",pm.notEqual="!=",pm.regex="=~",pm.notRegex="!~",function(e){e.Internal="internal",e.External="external",e.All="all"}(tm||(tm={})),(dm=rm||(rm={})).cortex="cortex",dm.mimir="mimir",dm.prometheus="prometheus",function(e){e.Home="home-dashboard",e.New="new-dashboard",e.Normal="normal-dashboard",e.Path="path-dashboard",e.Scripted="scripted-dashboard",e.Public="public-dashboard"}(nm||(nm={})),function(e){e.NotStarted="Not started",e.Fetching="Fetching",e.Services="Services",e.Failed="Failed",e.Completed="Completed"}(im||(im={})),function(e){e.Off="off",e.TV="tv",e.Full="full"}(am||(am={})),function(e){e.Viewer="Viewer",e.Editor="Editor",e.Admin="Admin"}(om||(om={})),function(e){e[e.View=1]="View",e[e.Edit=2]="Edit",e[e.Admin=4]="Admin"}(sm||(sm={})),function(e){e.View="View",e.Edit="Edit",e.Admin="Admin"}(lm||(lm={})),function(e){e[e.Query=1]="Query",e[e.Admin=2]="Admin"}(cm||(cm={})),function(e){e.Team="Team",e.User="User",e.Viewer="Viewer",e.Editor="Editor"}(um||(um={})),cm.Query,um.Team,um.User,um.Viewer,um.Editor,sm.View,lm.View,sm.Edit,lm.Edit,sm.Admin,function(e){e[e.Member=0]="Member",e[e.Admin=4]="Admin"}(hm||(hm={})),hm.Member,hm.Admin,function(e){e.All="All",e.WithExpiredTokens="WithExpiredTokens",e.Disabled="Disabled"}(fm||(fm={})),function(e){e.Success="success",e.Warning="warning",e.Error="error",e.Info="info"}(mm||(mm={})),function(e){e[e.Success=3e3]="Success",e[e.Warning=5e3]="Warning",e[e.Error=7e3]="Error"}(gm||(gm={})),mm.Success,gm.Success,mm.Warning,gm.Warning,mm.Error,gm.Error,mm.Info,gm.Success,function(e){e.left="left",e.right="right"}(bm||(bm={})),(wm=vm||(vm={})).UsersRead="users:read",wm.UsersWrite="users:write",wm.UsersAuthTokenList="users.authtoken:read",wm.UsersAuthTokenUpdate="users.authtoken:write",wm.UsersPasswordUpdate="users.password:write",wm.UsersDelete="users:delete",wm.UsersCreate="users:create",wm.UsersEnable="users:enable",wm.UsersDisable="users:disable",wm.UsersPermissionsUpdate="users.permissions:write",wm.UsersLogout="users:logout",wm.UsersQuotasList="users.quotas:read",wm.UsersQuotasUpdate="users.quotas:write",wm.ServiceAccountsRead="serviceaccounts:read",wm.ServiceAccountsCreate="serviceaccounts:create",wm.ServiceAccountsWrite="serviceaccounts:write",wm.ServiceAccountsDelete="serviceaccounts:delete",wm.ServiceAccountsPermissionsRead="serviceaccounts.permissions:read",wm.ServiceAccountsPermissionsWrite="serviceaccounts.permissions:write",wm.OrgsRead="orgs:read",wm.OrgsPreferencesRead="orgs.preferences:read",wm.OrgsWrite="orgs:write",wm.OrgsPreferencesWrite="orgs.preferences:write",wm.OrgsCreate="orgs:create",wm.OrgsDelete="orgs:delete",wm.OrgUsersRead="org.users:read",wm.OrgUsersAdd="org.users:add",wm.OrgUsersRemove="org.users:remove",wm.OrgUsersWrite="org.users:write",wm.LDAPUsersRead="ldap.user:read",wm.LDAPUsersSync="ldap.user:sync",wm.LDAPStatusRead="ldap.status:read",wm.DataSourcesExplore="datasources:explore",wm.DataSourcesRead="datasources:read",wm.DataSourcesCreate="datasources:create",wm.DataSourcesWrite="datasources:write",wm.DataSourcesDelete="datasources:delete",wm.DataSourcesPermissionsRead="datasources.permissions:read",wm.DataSourcesCachingRead="datasources.caching:read",wm.DataSourcesInsightsRead="datasources.insights:read",wm.ActionServerStatsRead="server.stats:read",wm.ActionTeamsCreate="teams:create",wm.ActionTeamsDelete="teams:delete",wm.ActionTeamsRead="teams:read",wm.ActionTeamsWrite="teams:write",wm.ActionTeamsPermissionsRead="teams.permissions:read",wm.ActionTeamsPermissionsWrite="teams.permissions:write",wm.ActionRolesList="roles:read",wm.ActionTeamsRolesList="teams.roles:read",wm.ActionTeamsRolesAdd="teams.roles:add",wm.ActionTeamsRolesRemove="teams.roles:remove",wm.ActionUserRolesList="users.roles:read",wm.ActionUserRolesAdd="users.roles:add",wm.ActionUserRolesRemove="users.roles:remove",wm.DashboardsRead="dashboards:read",wm.DashboardsWrite="dashboards:write",wm.DashboardsDelete="dashboards:delete",wm.DashboardsCreate="dashboards:create",wm.DashboardsPermissionsRead="dashboards.permissions:read",wm.DashboardsPermissionsWrite="dashboards.permissions:write",wm.DashboardsPublicWrite="dashboards.public:write",wm.FoldersRead="folders:read",wm.FoldersWrite="folders:write",wm.FoldersDelete="folders:delete",wm.FoldersCreate="folders:create",wm.FoldersPermissionsRead="folders.permissions:read",wm.FoldersPermissionsWrite="folders.permissions:write",wm.AlertingRuleCreate="alert.rules:create",wm.AlertingRuleRead="alert.rules:read",wm.AlertingRuleUpdate="alert.rules:write",wm.AlertingRuleDelete="alert.rules:delete",wm.AlertingInstanceCreate="alert.instances:create",wm.AlertingInstanceUpdate="alert.instances:write",wm.AlertingInstanceRead="alert.instances:read",wm.AlertingNotificationsRead="alert.notifications:read",wm.AlertingNotificationsWrite="alert.notifications:write",wm.AlertingRuleExternalWrite="alert.rules.external:write",wm.AlertingRuleExternalRead="alert.rules.external:read",wm.AlertingInstancesExternalWrite="alert.instances.external:write",wm.AlertingInstancesExternalRead="alert.instances.external:read",wm.AlertingNotificationsExternalWrite="alert.notifications.external:write",wm.AlertingNotificationsExternalRead="alert.notifications.external:read",wm.ActionAPIKeysRead="apikeys:read",wm.ActionAPIKeysCreate="apikeys:create",wm.ActionAPIKeysDelete="apikeys:delete",wm.PluginsInstall="plugins:install",wm.PluginsWrite="plugins:write";class Sm extends e.BusEventWithPayload{}Sm.type="zoom-out",function(e){e[e.Left=-1]="Left",e[e.Right=1]="Right"}(ym||(ym={}));class Em extends e.BusEventWithPayload{}Em.type="shift-time";class km extends e.BusEventBase{}km.type="absolute-time";class Pm extends e.BusEventWithPayload{}Pm.type="remove-panel";class Tm extends e.BusEventWithPayload{}Tm.type="show-modal";class Cm extends e.BusEventWithPayload{}Cm.type="show-confirm-modal";class Im extends e.BusEventWithPayload{}Im.type="show-react-modal";class Dm extends e.BusEventBase{}Dm.type="hide-modal";class Am extends e.BusEventBase{}Am.type="dashboard-saved";class Rm extends e.BusEventWithPayload{}Rm.type="annotation-query-started";class jm extends e.BusEventWithPayload{}jm.type="annotation-query-finished";class Nm extends e.BusEventWithPayload{}Nm.type="panel-edit-started";class Lm extends e.BusEventWithPayload{}Lm.type="panel-edit-finished";const qm=i.config;function $m(e,t,r,n,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}Boolean((null===(Om=i.config.panels)||void 0===Om||null===(xm=Om.debug)||void 0===xm?void 0:xm.state)===e.PluginState.alpha);class Mm{constructor(){this.id=0,this.isGrafanaAdmin=!1,this.isSignedIn=!1,this.orgRole="",this.orgId=0,this.orgName="",this.login="",this.externalUserId="",this.orgCount=0,this.timezone="",this.fiscalYearStartMonth=0,this.helpFlags1=0,this.lightTheme=!1,this.hasEditPermissionInFolders=!1,this.email="",this.name="",this.locale="",this.weekStart="",this.gravatarUrl="",qm.bootData.user&&(0,G.extend)(this,qm.bootData.user)}}var Bm,Fm;new class{fetchUserPermissions(){var e=this;return function(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function o(e){$m(a,n,i,o,s,"next",e)}function s(e){$m(a,n,i,o,s,"throw",e)}o(void 0)}))}}((function*(){try{e.accessControlEnabled()&&(e.user.permissions=yield(0,i.getBackendSrv)().get("/api/access-control/user/permissions",{reloadcache:!0}))}catch(e){console.error(e)}}))()}setLoggedOut(){this.user.isSignedIn=!1,this.isSignedIn=!1}hasRole(e){return"ServerAdmin"===e?this.isGrafanaAdmin:this.user.orgRole===e}accessControlEnabled(){return qm.rbacEnabled}licensedAccessControlEnabled(){return(0,i.featureEnabled)("accesscontrol")&&qm.rbacEnabled}hasPermissionInMetadata(e,t){var r;return!this.accessControlEnabled()||!!(null===(r=t.accessControl)||void 0===r?void 0:r[e])}hasPermission(e){var t;return!this.accessControlEnabled()||!!(null===(t=this.user.permissions)||void 0===t?void 0:t[e])}isGrafanaVisible(){return void 0===document.visibilityState||"visible"===document.visibilityState}isAllowedInterval(t){return!qm.minRefreshInterval||e.rangeUtil.intervalToMs(t)>=e.rangeUtil.intervalToMs(qm.minRefreshInterval)}getValidInterval(e){return this.isAllowedInterval(e)?e:qm.minRefreshInterval}hasAccessToExplore(){return this.accessControlEnabled()?this.hasPermission(vm.DataSourcesExplore):(this.isEditor||qm.viewersCanEdit)&&qm.exploreEnabled}hasAccess(e,t){return this.accessControlEnabled()?this.hasPermission(e):t}hasAccessInMetadata(e,t,r){return this.accessControlEnabled()?this.hasPermissionInMetadata(e,t):r}evaluatePermission(e,t){return this.accessControlEnabled()?t.some((e=>this.hasPermission(e)))?[]:["Reject"]:e()}constructor(){this.sidemenuSmallBreakpoint=!1,qm.bootData||(qm.bootData={user:{},settings:{}}),this.user=new Mm,this.isSignedIn=this.user.isSignedIn,this.isGrafanaAdmin=this.user.isGrafanaAdmin,this.isEditor=this.hasRole("Editor")||this.hasRole("Admin"),this.hasEditPermissionInFolders=this.user.hasEditPermissionInFolders,this.minRefreshInterval=qm.minRefreshInterval}},vm.AlertingInstanceRead,vm.AlertingInstancesExternalRead,vm.AlertingInstanceCreate,vm.AlertingInstancesExternalWrite,vm.AlertingInstanceUpdate,vm.AlertingInstancesExternalWrite,vm.AlertingInstanceUpdate,vm.AlertingInstancesExternalWrite,vm.AlertingNotificationsRead,vm.AlertingNotificationsExternalRead,vm.AlertingNotificationsWrite,vm.AlertingNotificationsExternalWrite,vm.AlertingNotificationsWrite,vm.AlertingNotificationsExternalWrite,vm.AlertingNotificationsWrite,vm.AlertingNotificationsExternalWrite,vm.AlertingRuleRead,vm.AlertingRuleExternalRead,vm.AlertingRuleCreate,vm.AlertingRuleExternalWrite,vm.AlertingRuleUpdate,vm.AlertingRuleExternalWrite,vm.AlertingRuleDelete,vm.AlertingRuleExternalWrite,function(e){e.Alertmanager="alertmanager",e.Loki="loki",e.Prometheus="prometheus"}(Bm||(Bm={})),Bm.Loki,Bm.Prometheus,em.equal,em.equal,em.notEqual,em.notEqual,em.regex,em.regex,em.notRegex,em.notRegex,em.regex,em.notRegex,em.notEqual,em.equal,function(e){e.Public="AzureCloud",e.China="AzureChinaCloud",e.USGovernment="AzureUSGovernment",e.Germany="AzureGermanCloud",e.None=""}(Fm||(Fm={}));const Qm=[{value:Fm.Public,label:"Azure"},{value:Fm.China,label:"Azure China"},{value:Fm.USGovernment,label:"Azure US Government"},{value:Fm.Germany,label:"Azure Germany"}];function zm(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Vm(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){zm(e,t,r[t])}))}return e}function Um(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const Wm=Symbol("Concealed client secret");function Xm(){return i.config.azure.cloud||Fm.Public}function Gm(e){if(e.secureJsonFields.azureClientSecret)return Wm;{var t;const r=null===(t=e.secureJsonData)||void 0===t?void 0:t.azureClientSecret;return"string"==typeof r&&r.length>0?r:void 0}}function Hm(){return i.config.azure.managedIdentityEnabled?{authType:"msi"}:{authType:"clientsecret",azureCloud:Xm()}}function Ym(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Km(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Ym(e,t,r[t])}))}return e}function Jm(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const Zm=[{value:"msi",label:"Managed Identity"},{value:"clientsecret",label:"App Registration"}],eg=e=>{const{credentials:n,azureCloudOptions:i,onCredentialsChange:o,getSubscriptions:s}=e,l=function(e){switch(e.authType){case"msi":return!0;case"clientsecret":return!!(e.azureCloud&&e.tenantId&&e.clientId&&e.clientSecret)}}(n),[c,u]=(0,t.useState)([]),[d,p]=(0,t.useReducer)((e=>e+1),0);(0,t.useEffect)((()=>{if(!s||!l)return void h([]);let e=!1;return s().then((t=>{e||h(t,d)})),()=>{e=!0}}),[d]);const h=(e,t=!1)=>{u(e),s&&(t&&!n.defaultSubscriptionId&&e.length>0?f(e[0]):n.defaultSubscriptionId&&(e.find((e=>e.value===n.defaultSubscriptionId))||f(void 0)))},f=e=>{if(o){const t=Jm(Km({},n),{defaultSubscriptionId:null==e?void 0:e.value});o(t)}};return r().createElement("div",{className:"gf-form-group"},e.managedIdentityEnabled&&r().createElement("div",{className:"gf-form-inline"},r().createElement("div",{className:"gf-form"},r().createElement(a.InlineFormLabel,{className:"width-12",tooltip:"Choose the type of authentication to Azure services"},"Authentication"),r().createElement(a.Select,{className:"width-15",value:Zm.find((e=>e.value===n.authType)),options:Zm,onChange:e=>{if(o){u([]);const t=Jm(Km({},n),{authType:e.value||"msi",defaultSubscriptionId:void 0});o(t)}}}))),"clientsecret"===n.authType&&r().createElement(r().Fragment,null,i&&r().createElement("div",{className:"gf-form-inline"},r().createElement("div",{className:"gf-form"},r().createElement(a.InlineFormLabel,{className:"width-12",tooltip:"Choose an Azure Cloud"},"Azure Cloud"),r().createElement(a.Select,{className:"width-15",value:i.find((e=>e.value===n.azureCloud)),options:i,onChange:e=>{if(o&&"clientsecret"===n.authType){u([]);const t=Jm(Km({},n),{azureCloud:e.value,defaultSubscriptionId:void 0});o(t)}}}))),r().createElement("div",{className:"gf-form-inline"},r().createElement("div",{className:"gf-form"},r().createElement(a.InlineFormLabel,{className:"width-12"},"Directory (tenant) ID"),r().createElement("div",{className:"width-15"},r().createElement(a.Input,{className:"width-30",placeholder:"XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX",value:n.tenantId||"",onChange:e=>{if(o&&"clientsecret"===n.authType){u([]);const t=Jm(Km({},n),{tenantId:e.target.value,defaultSubscriptionId:void 0});o(t)}}})))),r().createElement("div",{className:"gf-form-inline"},r().createElement("div",{className:"gf-form"},r().createElement(a.InlineFormLabel,{className:"width-12"},"Application (client) ID"),r().createElement("div",{className:"width-15"},r().createElement(a.Input,{className:"width-30",placeholder:"XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX",value:n.clientId||"",onChange:e=>{if(o&&"clientsecret"===n.authType){u([]);const t=Jm(Km({},n),{clientId:e.target.value,defaultSubscriptionId:void 0});o(t)}}})))),"symbol"==typeof n.clientSecret?r().createElement("div",{className:"gf-form-inline"},r().createElement("div",{className:"gf-form"},r().createElement(a.InlineFormLabel,{htmlFor:"azure-client-secret",className:"width-12"},"Client Secret"),r().createElement(a.Input,{id:"azure-client-secret",className:"width-25",placeholder:"configured",disabled:!0})),r().createElement("div",{className:"gf-form"},r().createElement("div",{className:"max-width-30 gf-form-inline"},r().createElement(a.Button,{variant:"secondary",type:"button",onClick:()=>{if(o&&"clientsecret"===n.authType){u([]);const e=Jm(Km({},n),{clientSecret:"",defaultSubscriptionId:void 0});o(e)}}},"reset")))):r().createElement("div",{className:"gf-form-inline"},r().createElement("div",{className:"gf-form"},r().createElement(a.InlineFormLabel,{className:"width-12"},"Client Secret"),r().createElement("div",{className:"width-15"},r().createElement(a.Input,{className:"width-30",placeholder:"XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX",value:n.clientSecret||"",onChange:e=>{if(o&&"clientsecret"===n.authType){u([]);const t=Jm(Km({},n),{clientSecret:e.target.value,defaultSubscriptionId:void 0});o(t)}}}))))),s&&r().createElement(r().Fragment,null,r().createElement("div",{className:"gf-form-inline"},r().createElement("div",{className:"gf-form"},r().createElement(a.InlineFormLabel,{className:"width-12"},"Default Subscription"),r().createElement("div",{className:"width-25"},r().createElement(a.Select,{value:n.defaultSubscriptionId?c.find((e=>e.value===n.defaultSubscriptionId)):void 0,options:c,onChange:f})))),r().createElement("div",{className:"gf-form-inline"},r().createElement("div",{className:"gf-form"},r().createElement("div",{className:"max-width-30 gf-form-inline"},r().createElement(a.Button,{variant:"secondary",size:"sm",type:"button",onClick:p,disabled:!l},"Load Subscriptions"))))))};function tg(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rg(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){tg(e,t,r[t])}))}return e}function ng(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const ig=e=>{const{dataSourceConfig:n,onChange:o}=e,[s]=(0,t.useState)(i.config.featureToggles.prometheusAzureOverrideAudience||!!n.jsonData.azureEndpointResourceId),[l,c]=(0,t.useState)(!!n.jsonData.azureEndpointResourceId),u=(0,t.useMemo)((()=>function(e){const t=e.jsonData.azureCredentials;if(!t)return Hm();switch(t.authType){case"msi":return i.config.azure.managedIdentityEnabled?{authType:"msi"}:{authType:"clientsecret",azureCloud:Xm()};case"clientsecret":return{authType:"clientsecret",azureCloud:t.azureCloud||Xm(),tenantId:t.tenantId,clientId:t.clientId,clientSecret:Gm(e)}}}(n)),[n]);return r().createElement(r().Fragment,null,r().createElement("h6",null,"Azure Authentication"),r().createElement(eg,{managedIdentityEnabled:i.config.azure.managedIdentityEnabled,credentials:u,azureCloudOptions:Qm,onCredentialsChange:e=>{o(function(e,t){switch(t.authType){case"msi":if(!i.config.azure.managedIdentityEnabled)throw new Error("Managed Identity authentication is not enabled in Grafana config.");return Um(Vm({},e),{jsonData:Um(Vm({},e.jsonData),{azureCredentials:{authType:"msi"}})});case"clientsecret":return Um(Vm({},e),{jsonData:Um(Vm({},e.jsonData),{azureCredentials:{authType:"clientsecret",azureCloud:t.azureCloud||Xm(),tenantId:t.tenantId,clientId:t.clientId}}),secureJsonData:Um(Vm({},e.secureJsonData),{azureClientSecret:"string"==typeof t.clientSecret&&t.clientSecret.length>0?t.clientSecret:void 0}),secureJsonFields:Um(Vm({},e.secureJsonFields),{azureClientSecret:"symbol"==typeof t.clientSecret})})}}(n,e))}}),s&&r().createElement(r().Fragment,null,r().createElement("h6",null,"Azure Configuration"),r().createElement("div",{className:"gf-form-group"},r().createElement(a.InlineFieldRow,null,r().createElement(a.InlineField,{labelWidth:26,label:"Override AAD audience"},r().createElement(a.InlineSwitch,{value:l,onChange:e=>{c(e.currentTarget.checked),e.currentTarget.checked||o(ng(rg({},n),{jsonData:ng(rg({},n.jsonData),{azureEndpointResourceId:void 0})}))}}))),l&&r().createElement(a.InlineFieldRow,null,r().createElement(a.InlineField,{labelWidth:26,label:"Resource ID"},r().createElement(a.Input,{className:"width-30",value:n.jsonData.azureEndpointResourceId||"",onChange:e=>{l&&o(ng(rg({},n),{jsonData:ng(rg({},n.jsonData),{azureEndpointResourceId:e.currentTarget.value})}))}}))))))};function ag(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function og(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){ag(e,t,r[t])}))}return e}function sg(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function lg({value:e,onChange:n,onDelete:s}){const[l,c]=(0,t.useState)(Boolean(e.datasourceUid));return r().createElement("div",{className:"gf-form-group"},r().createElement(a.InlineField,{label:"Internal link",labelWidth:24},r().createElement(r().Fragment,null,r().createElement(a.InlineSwitch,{value:l,"aria-label":aa.selectors.components.DataSource.Prometheus.configPage.internalLinkSwitch,onChange:e=>c(e.currentTarget.checked)}),r().createElement(a.Button,{variant:"destructive",title:"Remove link",icon:"times",onClick:e=>{e.preventDefault(),s()},className:o.css`
              margin-left: 8px;
            `}))),l?r().createElement(a.InlineField,{label:"Data source",labelWidth:24,tooltip:"The data source the exemplar is going to navigate to."},r().createElement(i.DataSourcePicker,{tracing:!0,current:e.datasourceUid,noDefault:!0,width:40,onChange:t=>n(sg(og({},e),{datasourceUid:t.uid,url:void 0}))})):r().createElement(a.InlineField,{label:"URL",labelWidth:24,tooltip:"The URL of the trace backend the user would go to see its trace."},r().createElement(a.Input,{placeholder:"https://example.com/${__value.raw}",spellCheck:!1,width:40,value:e.url,onChange:t=>n(sg(og({},e),{datasourceUid:void 0,url:t.currentTarget.value}))})),r().createElement(a.InlineField,{label:"URL Label",labelWidth:24,tooltip:"Use to override the button label on the exemplar traceID field."},r().createElement(a.Input,{placeholder:"Go to example.com",spellCheck:!1,width:40,value:e.urlDisplayLabel,onChange:t=>n(sg(og({},e),{urlDisplayLabel:t.currentTarget.value}))})),r().createElement(a.InlineField,{label:"Label name",labelWidth:24,tooltip:"The name of the field in the labels object that should be used to get the traceID."},r().createElement(a.Input,{placeholder:"traceID",spellCheck:!1,width:40,value:e.name,onChange:t=>n(sg(og({},e),{name:t.currentTarget.value}))})))}function cg({options:e,onChange:t}){return r().createElement(r().Fragment,null,r().createElement("h3",{className:"page-heading"},"Exemplars"),e&&e.map(((n,i)=>r().createElement(lg,{key:i,value:n,onChange:r=>{const n=[...e];n.splice(i,1,r),t(n)},onDelete:()=>{const r=[...e];r.splice(i,1),t(r)}}))),r().createElement(a.Button,{variant:"secondary","aria-label":aa.selectors.components.DataSource.Prometheus.configPage.exemplarsAddButton,className:o.css`
          margin-bottom: 10px;
        `,icon:"plus",onClick:r=>{r.preventDefault();const n=[...e||[],{name:"traceID"}];t(n)}},"Add"))}function ug(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dg(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){ug(e,t,r[t])}))}return e}function pg(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const{Select:hg,Input:fg,FormField:mg}=a.LegacyForms,gg=[{value:"POST",label:"POST"},{value:"GET",label:"GET"}],bg=t=>{const{options:n,onOptionsChange:i}=t;var o;return n.jsonData.httpMethod||(n.jsonData.httpMethod="POST"),r().createElement(r().Fragment,null,r().createElement("div",{className:"gf-form-group"},r().createElement("div",{className:"gf-form-inline"},r().createElement("div",{className:"gf-form"},r().createElement(mg,{label:"Scrape interval",labelWidth:13,inputEl:r().createElement(fg,{className:"width-6",value:n.jsonData.timeInterval,spellCheck:!1,placeholder:"15s",onChange:Og("timeInterval",n,i),validationEvents:vg}),tooltip:"Set this to the typical scrape and evaluation interval configured in Prometheus. Defaults to 15s."}))),r().createElement("div",{className:"gf-form-inline"},r().createElement("div",{className:"gf-form"},r().createElement(mg,{label:"Query timeout",labelWidth:13,inputEl:r().createElement(fg,{className:"width-6",value:n.jsonData.queryTimeout,onChange:Og("queryTimeout",n,i),spellCheck:!1,placeholder:"60s",validationEvents:vg}),tooltip:"Set the Prometheus query timeout."}))),r().createElement("div",{className:"gf-form"},r().createElement(a.InlineFormLabel,{width:13,tooltip:"You can use either POST or GET HTTP method to query your Prometheus data source. POST is the recommended method as it allows bigger queries. Change this to GET if you have a Prometheus version older than 2.1 or if POST requests are restricted in your network."},"HTTP Method"),r().createElement(hg,{"aria-label":"Select HTTP method",options:gg,value:gg.find((e=>e.value===n.jsonData.httpMethod)),onChange:Og("httpMethod",n,i),width:7}))),r().createElement("h3",{className:"page-heading"},"Misc"),r().createElement("div",{className:"gf-form-group"},r().createElement("div",{className:"gf-form"},r().createElement(a.InlineField,{labelWidth:28,label:"Disable metrics lookup",tooltip:"Checking this option will disable the metrics chooser and metric/label support in the query field's autocomplete. This helps if you have performance issues with bigger Prometheus instances."},r().createElement(a.InlineSwitch,{value:null!==(o=n.jsonData.disableMetricsLookup)&&void 0!==o&&o,onChange:(0,e.onUpdateDatasourceJsonDataOptionChecked)(t,"disableMetricsLookup")}))),r().createElement("div",{className:"gf-form-inline"},r().createElement("div",{className:"gf-form max-width-30"},r().createElement(mg,{label:"Custom query parameters",labelWidth:14,tooltip:"Add Custom parameters to all Prometheus or Thanos queries.",inputEl:r().createElement(fg,{className:"width-25",value:n.jsonData.customQueryParameters,onChange:Og("customQueryParameters",n,i),spellCheck:!1,placeholder:"Example: max_source_resolution=5m&timeout=10"})})))),r().createElement(cg,{options:n.jsonData.exemplarTraceIdDestinations,onChange:t=>(0,e.updateDatasourcePluginJsonDataOption)({onOptionsChange:i,options:n},"exemplarTraceIdDestinations",t)}))},vg={[a.EventsWithValidation.onBlur]:[(0,a.regexValidation)(/^$|^\d+(ms|[Mwdhmsy])$/,"Value is not valid, you can use number with time unit specifier: y, M, w, d, h, m, s")]},yg=e=>e?e.hasOwnProperty("currentTarget")?e.currentTarget.value:e.value:"",Og=(e,t,r)=>n=>{r(pg(dg({},t),{jsonData:pg(dg({},t.jsonData),{[e]:yg(n)})}))};function xg(){return xg=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},xg.apply(this,arguments)}var wg=m(1177);function _g(e){return"function"==typeof e}function Sg(e){return function(t){if(function(e){return _g(null==e?void 0:e.lift)}(t))return t.lift((function(t){try{return e(t,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")}}var Eg=function(e,t){return Eg=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},Eg(e,t)};function kg(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Eg(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function Pg(e,t){var r,n,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function Tg(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Cg(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,a=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)o.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}return o}function Ig(e,t,r){if(r||2===arguments.length)for(var n,i=0,a=t.length;i<a;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}function Dg(e){return this instanceof Dg?(this.v=e,this):new Dg(e)}function Ag(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),a=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(e){i[e]&&(n[e]=function(t){return new Promise((function(r,n){a.push([e,t,r,n])>1||s(e,t)}))})}function s(e,t){try{!function(e){e.value instanceof Dg?Promise.resolve(e.value.v).then(l,c):u(a[0][2],e)}(i[e](t))}catch(e){u(a[0][3],e)}}function l(e){s("next",e)}function c(e){s("throw",e)}function u(e,t){e(t),a.shift(),a.length&&s(a[0][0],a[0][1])}}Object.create,Object.create;var Rg,jg,Ng=(Rg=function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}},(jg=Rg((function(e){Error.call(e),e.stack=(new Error).stack}))).prototype=Object.create(Error.prototype),jg.prototype.constructor=jg,jg);function Lg(e,t){if(e){var r=e.indexOf(t);0<=r&&e.splice(r,1)}}var qg=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var e,t,r,n,i;if(!this.closed){this.closed=!0;var a=this._parentage;if(a)if(this._parentage=null,Array.isArray(a))try{for(var o=Tg(a),s=o.next();!s.done;s=o.next())s.value.remove(this)}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}else a.remove(this);var l=this.initialTeardown;if(_g(l))try{l()}catch(e){i=e instanceof Ng?e.errors:[e]}var c=this._finalizers;if(c){this._finalizers=null;try{for(var u=Tg(c),d=u.next();!d.done;d=u.next()){var p=d.value;try{Mg(p)}catch(e){i=null!=i?i:[],e instanceof Ng?i=Ig(Ig([],Cg(i)),Cg(e.errors)):i.push(e)}}}catch(e){r={error:e}}finally{try{d&&!d.done&&(n=u.return)&&n.call(u)}finally{if(r)throw r.error}}}if(i)throw new Ng(i)}},e.prototype.add=function(t){var r;if(t&&t!==this)if(this.closed)Mg(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(r=this._finalizers)&&void 0!==r?r:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&Lg(t,e)},e.prototype.remove=function(t){var r=this._finalizers;r&&Lg(r,t),t instanceof e&&t._removeParent(this)},e.EMPTY=function(){var t=new e;return t.closed=!0,t}(),e}();function $g(e){return e instanceof qg||e&&"closed"in e&&_g(e.remove)&&_g(e.add)&&_g(e.unsubscribe)}function Mg(e){_g(e)?e():e.unsubscribe()}qg.EMPTY;var Bg=null,Fg=null,Qg=void 0,zg=!1,Vg=!1,Ug={setTimeout:function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i=Ug.delegate;return(null==i?void 0:i.setTimeout)?i.setTimeout.apply(i,Ig([e,t],Cg(r))):setTimeout.apply(void 0,Ig([e,t],Cg(r)))},clearTimeout:function(e){var t=Ug.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function Wg(e){Ug.setTimeout((function(){if(!Bg)throw e;Bg(e)}))}function Xg(){}var Gg=Hg("C",void 0,void 0);function Hg(e,t,r){return{kind:e,value:t,error:r}}var Yg=null,Kg=function(e){function t(t){var r=e.call(this)||this;return r.isStopped=!1,t?(r.destination=t,$g(t)&&t.add(r)):r.destination=ib,r}return kg(t,e),t.create=function(e,t,r){return new tb(e,t,r)},t.prototype.next=function(e){this.isStopped?nb(function(e){return Hg("N",e,void 0)}(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?nb(Hg("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?nb(Gg,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(qg),Jg=Function.prototype.bind;function Zg(e,t){return Jg.call(e,t)}var eb=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){rb(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){rb(e)}else rb(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){rb(e)}},e}(),tb=function(e){function t(t,r,n){var i,a,o=e.call(this)||this;return _g(t)||!t?i={next:null!=t?t:void 0,error:null!=r?r:void 0,complete:null!=n?n:void 0}:o&&Vg?((a=Object.create(t)).unsubscribe=function(){return o.unsubscribe()},i={next:t.next&&Zg(t.next,a),error:t.error&&Zg(t.error,a),complete:t.complete&&Zg(t.complete,a)}):i=t,o.destination=new eb(i),o}return kg(t,e),t}(Kg);function rb(e){var t;zg?(t=e,zg&&Yg&&(Yg.errorThrown=!0,Yg.error=t)):Wg(e)}function nb(e,t){var r=Fg;r&&Ug.setTimeout((function(){return r(e,t)}))}var ib={closed:!0,next:Xg,error:function(e){throw e},complete:Xg};function ab(e,t,r,n,i){return new ob(e,t,r,n,i)}var ob=function(e){function t(t,r,n,i,a,o){var s=e.call(this,t)||this;return s.onFinalize=a,s.shouldUnsubscribe=o,s._next=r?function(e){try{r(e)}catch(e){t.error(e)}}:e.prototype._next,s._error=i?function(e){try{i(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,s._complete=n?function(){try{n()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,s}return kg(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),!r&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(Kg);function sb(e,t){return Sg((function(r,n){var i=0;r.subscribe(ab(n,(function(r){n.next(e.call(t,r,i++))})))}))}function lb(e){return e}function cb(e,t){return Sg((function(r,n){var i=0;r.subscribe(ab(n,(function(r){return e.call(t,r,i++)&&n.next(r)})))}))}var ub="function"==typeof Symbol&&Symbol.observable||"@@observable";function db(e){return 0===e.length?lb:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}var pb=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var r=new e;return r.source=this,r.operator=t,r},e.prototype.subscribe=function(e,t,r){var n,i=this,a=(n=e)&&n instanceof Kg||function(e){return e&&_g(e.next)&&_g(e.error)&&_g(e.complete)}(n)&&$g(n)?e:new tb(e,t,r);return function(e){if(zg){var t=!Yg;if(t&&(Yg={errorThrown:!1,error:null}),e(),t){var r=Yg,n=r.errorThrown,i=r.error;if(Yg=null,n)throw i}}else e()}((function(){var e=i,t=e.operator,r=e.source;a.add(t?t.call(a,r):r?i._subscribe(a):i._trySubscribe(a))})),a},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var r=this;return new(t=hb(t))((function(t,n){var i=new tb({next:function(t){try{e(t)}catch(e){n(e),i.unsubscribe()}},error:n,complete:t});r.subscribe(i)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[ub]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return db(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=hb(e))((function(e,r){var n;t.subscribe((function(e){return n=e}),(function(e){return r(e)}),(function(){return e(n)}))}))},e.create=function(t){return new e(t)},e}();function hb(e){var t;return null!==(t=null!=e?e:Qg)&&void 0!==t?t:Promise}var fb,mb="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function gb(e){return new pb((function(t){(function(e,t){var r,n,i,a;return function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function o(e){try{l(n.next(e))}catch(e){a(e)}}function s(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}l((n=n.apply(e,t||[])).next())}))}(this,void 0,void 0,(function(){var o,s;return Pg(this,(function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),r=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=Tg(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,i){!function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)}(n,i,(t=e[r](t)).done,t.value)}))}}}(e),l.label=1;case 1:return[4,r.next()];case 2:if((n=l.sent()).done)return[3,4];if(o=n.value,t.next(o),t.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return s=l.sent(),i={error:s},[3,11];case 6:return l.trys.push([6,,9,10]),n&&!n.done&&(a=r.return)?[4,a.call(r)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}}))}))})(e,t).catch((function(e){return t.error(e)}))}))}function bb(e){return Sg((function(t,r){var n,i=null,a=!1;i=t.subscribe(ab(r,void 0,void 0,(function(o){n=function(e){if(e instanceof pb)return e;if(null!=e){if(function(e){return _g(e[ub])}(e))return a=e,new pb((function(e){var t=a[ub]();if(_g(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if(function(e){return e&&"number"==typeof e.length&&"function"!=typeof e}(e))return i=e,new pb((function(e){for(var t=0;t<i.length&&!e.closed;t++)e.next(i[t]);e.complete()}));if(_g(null==(n=e)?void 0:n.then))return r=e,new pb((function(e){r.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,Wg)}));if(function(e){return Symbol.asyncIterator&&_g(null==e?void 0:e[Symbol.asyncIterator])}(e))return gb(e);if(function(e){return _g(null==e?void 0:e[mb])}(e))return t=e,new pb((function(e){var r,n;try{for(var i=Tg(t),a=i.next();!a.done;a=i.next()){var o=a.value;if(e.next(o),e.closed)return}}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}e.complete()}));if(function(e){return _g(null==e?void 0:e.getReader)}(e))return gb(function(e){return Ag(this,arguments,(function(){var t,r,n;return Pg(this,(function(i){switch(i.label){case 0:t=e.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,Dg(t.read())];case 3:return r=i.sent(),n=r.value,r.done?[4,Dg(void 0)]:[3,5];case 4:return[2,i.sent()];case 5:return[4,Dg(n)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}(e))}var t,r,n,i,a;throw function(e){return new TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}(e)}(e(o,bb(e)(t))),i?(i.unsubscribe(),i=null,n.subscribe(r)):a=!0}))),a&&(i.unsubscribe(),i=null,n.subscribe(r))}))}function vb(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yb(){return yb=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yb.apply(this,arguments)}function Ob(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){vb(e,t,r[t])}))}return e}function xb(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function wb(e){const t=e.annotation,n=e.onAnnotationChange,i={expr:t.expr,refId:t.name,interval:t.step};return r().createElement(r().Fragment,null,r().createElement(I,null,r().createElement(qf,yb({},e,{query:i,showExplain:!1,onChange:e=>{n(xb(Ob({},t),{expr:e.expr}))}})),r().createElement(P,null,r().createElement(E,{label:"Min step",tooltip:r().createElement(r().Fragment,null,"An additional lower limit for the step parameter of the Prometheus query and for the"," ",r().createElement("code",null,"$__interval")," and ",r().createElement("code",null,"$__rate_interval")," variables.")},r().createElement(a.AutoSizeInput,{type:"text","aria-label":"Set lower limit for the step parameter",placeholder:"auto",minWidth:10,onCommitChange:e=>{n(xb(Ob({},t),{step:e.currentTarget.value}))},defaultValue:i.interval})))),r().createElement(O,{v:.5}),r().createElement(P,null,r().createElement(E,{label:"Title",tooltip:"Use either the name or a pattern. For example, {{instance}} is replaced with label value for the label instance."},r().createElement(a.Input,{type:"text",placeholder:"{{alertname}}",value:t.titleFormat,onChange:e=>{n(xb(Ob({},t),{titleFormat:e.currentTarget.value}))}})),r().createElement(E,{label:"Tags"},r().createElement(a.Input,{type:"text",placeholder:"label1,label2",value:t.tagKeys,onChange:e=>{n(xb(Ob({},t),{tagKeys:e.currentTarget.value}))}})),r().createElement(E,{label:"Text",tooltip:"Use either the name or a pattern. For example, {{instance}} is replaced with label value for the label instance."},r().createElement(a.Input,{type:"text",placeholder:"{{instance}}",value:t.textFormat,onChange:e=>{n(xb(Ob({},t),{textFormat:e.currentTarget.value}))}})),r().createElement(E,{label:"Series value as timestamp",tooltip:"The unit of timestamp is milliseconds. If the unit of the series value is seconds, multiply its range vector by 1000."},r().createElement(A,{value:t.useValueForTime,onChange:e=>{n(xb(Ob({},t),{useValueForTime:e.currentTarget.value}))}}))))}function _b(e,t){return e.replace(/\{\{\s*(.+?)\s*\}\}/g,((e,r)=>t[r]?t[r]:r))}class Sb extends e.BusEventWithPayload{}Sb.type="zoom-out",function(e){e[e.Left=-1]="Left",e[e.Right=1]="Right"}(fb||(fb={}));class Eb extends e.BusEventWithPayload{}Eb.type="shift-time";class kb extends e.BusEventBase{}kb.type="absolute-time";class Pb extends e.BusEventWithPayload{}Pb.type="remove-panel";class Tb extends e.BusEventWithPayload{}Tb.type="show-modal";class Cb extends e.BusEventWithPayload{}Cb.type="show-confirm-modal";class Ib extends e.BusEventWithPayload{}Ib.type="show-react-modal";class Db extends e.BusEventBase{}Db.type="hide-modal";class Ab extends e.BusEventBase{}Ab.type="dashboard-saved";class Rb extends e.BusEventWithPayload{}Rb.type="annotation-query-started";class jb extends e.BusEventWithPayload{}jb.type="annotation-query-finished";class Nb extends e.BusEventWithPayload{}Nb.type="panel-edit-started";class Lb extends e.BusEventWithPayload{}Lb.type="panel-edit-finished";const qb=new e.EventBusSrv;var $b,Mb;const Bb=i.config;var Fb;function Qb(e,t,r,n,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}Boolean((null===($b=i.config.panels)||void 0===$b||null===(Mb=$b.debug)||void 0===Mb?void 0:Mb.state)===e.PluginState.alpha),function(e){e.UsersRead="users:read",e.UsersWrite="users:write",e.UsersAuthTokenList="users.authtoken:read",e.UsersAuthTokenUpdate="users.authtoken:write",e.UsersPasswordUpdate="users.password:write",e.UsersDelete="users:delete",e.UsersCreate="users:create",e.UsersEnable="users:enable",e.UsersDisable="users:disable",e.UsersPermissionsUpdate="users.permissions:write",e.UsersLogout="users:logout",e.UsersQuotasList="users.quotas:read",e.UsersQuotasUpdate="users.quotas:write",e.ServiceAccountsRead="serviceaccounts:read",e.ServiceAccountsCreate="serviceaccounts:create",e.ServiceAccountsWrite="serviceaccounts:write",e.ServiceAccountsDelete="serviceaccounts:delete",e.ServiceAccountsPermissionsRead="serviceaccounts.permissions:read",e.ServiceAccountsPermissionsWrite="serviceaccounts.permissions:write",e.OrgsRead="orgs:read",e.OrgsPreferencesRead="orgs.preferences:read",e.OrgsWrite="orgs:write",e.OrgsPreferencesWrite="orgs.preferences:write",e.OrgsCreate="orgs:create",e.OrgsDelete="orgs:delete",e.OrgUsersRead="org.users:read",e.OrgUsersAdd="org.users:add",e.OrgUsersRemove="org.users:remove",e.OrgUsersWrite="org.users:write",e.LDAPUsersRead="ldap.user:read",e.LDAPUsersSync="ldap.user:sync",e.LDAPStatusRead="ldap.status:read",e.DataSourcesExplore="datasources:explore",e.DataSourcesRead="datasources:read",e.DataSourcesCreate="datasources:create",e.DataSourcesWrite="datasources:write",e.DataSourcesDelete="datasources:delete",e.DataSourcesPermissionsRead="datasources.permissions:read",e.DataSourcesCachingRead="datasources.caching:read",e.DataSourcesInsightsRead="datasources.insights:read",e.ActionServerStatsRead="server.stats:read",e.ActionTeamsCreate="teams:create",e.ActionTeamsDelete="teams:delete",e.ActionTeamsRead="teams:read",e.ActionTeamsWrite="teams:write",e.ActionTeamsPermissionsRead="teams.permissions:read",e.ActionTeamsPermissionsWrite="teams.permissions:write",e.ActionRolesList="roles:read",e.ActionTeamsRolesList="teams.roles:read",e.ActionTeamsRolesAdd="teams.roles:add",e.ActionTeamsRolesRemove="teams.roles:remove",e.ActionUserRolesList="users.roles:read",e.ActionUserRolesAdd="users.roles:add",e.ActionUserRolesRemove="users.roles:remove",e.DashboardsRead="dashboards:read",e.DashboardsWrite="dashboards:write",e.DashboardsDelete="dashboards:delete",e.DashboardsCreate="dashboards:create",e.DashboardsPermissionsRead="dashboards.permissions:read",e.DashboardsPermissionsWrite="dashboards.permissions:write",e.DashboardsPublicWrite="dashboards.public:write",e.FoldersRead="folders:read",e.FoldersWrite="folders:write",e.FoldersDelete="folders:delete",e.FoldersCreate="folders:create",e.FoldersPermissionsRead="folders.permissions:read",e.FoldersPermissionsWrite="folders.permissions:write",e.AlertingRuleCreate="alert.rules:create",e.AlertingRuleRead="alert.rules:read",e.AlertingRuleUpdate="alert.rules:write",e.AlertingRuleDelete="alert.rules:delete",e.AlertingInstanceCreate="alert.instances:create",e.AlertingInstanceUpdate="alert.instances:write",e.AlertingInstanceRead="alert.instances:read",e.AlertingNotificationsRead="alert.notifications:read",e.AlertingNotificationsWrite="alert.notifications:write",e.AlertingRuleExternalWrite="alert.rules.external:write",e.AlertingRuleExternalRead="alert.rules.external:read",e.AlertingInstancesExternalWrite="alert.instances.external:write",e.AlertingInstancesExternalRead="alert.instances.external:read",e.AlertingNotificationsExternalWrite="alert.notifications.external:write",e.AlertingNotificationsExternalRead="alert.notifications.external:read",e.ActionAPIKeysRead="apikeys:read",e.ActionAPIKeysCreate="apikeys:create",e.ActionAPIKeysDelete="apikeys:delete",e.PluginsInstall="plugins:install",e.PluginsWrite="plugins:write"}(Fb||(Fb={}));class zb{constructor(){this.id=0,this.isGrafanaAdmin=!1,this.isSignedIn=!1,this.orgRole="",this.orgId=0,this.orgName="",this.login="",this.externalUserId="",this.orgCount=0,this.timezone="",this.fiscalYearStartMonth=0,this.helpFlags1=0,this.lightTheme=!1,this.hasEditPermissionInFolders=!1,this.email="",this.name="",this.locale="",this.weekStart="",this.gravatarUrl="",Bb.bootData.user&&(0,G.extend)(this,Bb.bootData.user)}}let Vb,Ub=new class{fetchUserPermissions(){var e=this;return function(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function o(e){Qb(a,n,i,o,s,"next",e)}function s(e){Qb(a,n,i,o,s,"throw",e)}o(void 0)}))}}((function*(){try{e.accessControlEnabled()&&(e.user.permissions=yield(0,i.getBackendSrv)().get("/api/access-control/user/permissions",{reloadcache:!0}))}catch(e){console.error(e)}}))()}setLoggedOut(){this.user.isSignedIn=!1,this.isSignedIn=!1}hasRole(e){return"ServerAdmin"===e?this.isGrafanaAdmin:this.user.orgRole===e}accessControlEnabled(){return Bb.rbacEnabled}licensedAccessControlEnabled(){return(0,i.featureEnabled)("accesscontrol")&&Bb.rbacEnabled}hasPermissionInMetadata(e,t){var r;return!this.accessControlEnabled()||!!(null===(r=t.accessControl)||void 0===r?void 0:r[e])}hasPermission(e){var t;return!this.accessControlEnabled()||!!(null===(t=this.user.permissions)||void 0===t?void 0:t[e])}isGrafanaVisible(){return void 0===document.visibilityState||"visible"===document.visibilityState}isAllowedInterval(t){return!Bb.minRefreshInterval||e.rangeUtil.intervalToMs(t)>=e.rangeUtil.intervalToMs(Bb.minRefreshInterval)}getValidInterval(e){return this.isAllowedInterval(e)?e:Bb.minRefreshInterval}hasAccessToExplore(){return this.accessControlEnabled()?this.hasPermission(Fb.DataSourcesExplore):(this.isEditor||Bb.viewersCanEdit)&&Bb.exploreEnabled}hasAccess(e,t){return this.accessControlEnabled()?this.hasPermission(e):t}hasAccessInMetadata(e,t,r){return this.accessControlEnabled()?this.hasPermissionInMetadata(e,t):r}evaluatePermission(e,t){return this.accessControlEnabled()?t.some((e=>this.hasPermission(e)))?[]:["Reject"]:e()}constructor(){this.sidemenuSmallBreakpoint=!1,Bb.bootData||(Bb.bootData={user:{},settings:{}}),this.user=new zb,this.isSignedIn=this.user.isSignedIn,this.isGrafanaAdmin=this.user.isGrafanaAdmin,this.isEditor=this.hasRole("Editor")||this.hasRole("Admin"),this.hasEditPermissionInFolders=this.user.hasEditPermissionInFolders,this.minRefreshInterval=Bb.minRefreshInterval}};class Wb{init(t){var r,n;this.timeModel=t,this.time=t.time,this.refresh=t.refresh,this.initTimeFromUrl(),this.parseTime(),this.timeAtLoad=(0,G.cloneDeep)(this.time);const i=e.rangeUtil.convertRawToRange(this.time,null===(r=this.timeModel)||void 0===r?void 0:r.getTimezone(),null===(n=this.timeModel)||void 0===n?void 0:n.fiscalYearStartMonth);i.to.isBefore(i.from)&&this.setTime({from:i.raw.to,to:i.raw.from},!1),this.refresh&&this.setAutoRefresh(this.refresh)}getValidIntervals(e){return this.contextSrv.minRefreshInterval?e.filter((e=>""!==e)).filter(this.contextSrv.isAllowedInterval):e}parseTime(){(0,G.isString)(this.time.from)&&this.time.from.indexOf("Z")>=0&&(this.time.from=(0,e.dateTime)(this.time.from).utc()),(0,G.isString)(this.time.to)&&this.time.to.indexOf("Z")>=0&&(this.time.to=(0,e.dateTime)(this.time.to).utc())}parseUrlParam(t){if(-1!==t.indexOf("now"))return t;if(8===t.length){const r=(0,e.toUtc)(t,"YYYYMMDD");if(r.isValid())return r}else if(15===t.length){const r=(0,e.toUtc)(t,"YYYYMMDDTHHmmss");if(r.isValid())return r}if(!isNaN(t)){const r=parseInt(t,10);return(0,e.toUtc)(r)}return null}getTimeWindow(t,r){const n=parseInt(t,10);let i;return i=r.match(/^\d+$/)&&parseInt(r,10)?parseInt(r,10):e.rangeUtil.intervalToMs(r),{from:(0,e.toUtc)(n-i/2),to:(0,e.toUtc)(n+i/2)}}initTimeFromUrl(){var e,t,r,n;const o=i.locationService.getSearch();o.get("time")&&o.get("time.window")&&(this.time=this.getTimeWindow(o.get("time"),o.get("time.window"))),o.get("from")&&(this.time.from=this.parseUrlParam(o.get("from"))||this.time.from),o.get("to")&&(this.time.to=this.parseUrlParam(o.get("to"))||this.time.to),o.get("to")&&-1===o.get("to").indexOf("now")&&(this.refresh=!1,this.timeModel&&(this.timeModel.refresh=!1)),this.refresh=function({urlRefresh:e,currentRefresh:t,isAllowedIntervalFn:r,minRefreshInterval:n,refreshIntervals:i=a.defaultIntervals}){if(!e)return t;const o=r(e),s=i.find((t=>t===e));if(!o||!s){const e=n?i.find((e=>e===n)):void 0,r=(null==i?void 0:i.length)?i[0]:void 0;var l;return null!==(l=null!=e?e:r)&&void 0!==l?l:t}return e||t}({urlRefresh:o.get("refresh"),currentRefresh:this.refresh,refreshIntervals:Array.isArray(null===(e=this.timeModel)||void 0===e||null===(t=e.timepicker)||void 0===t?void 0:t.refresh_intervals)?null===(r=this.timeModel)||void 0===r||null===(n=r.timepicker)||void 0===n?void 0:n.refresh_intervals:void 0,isAllowedIntervalFn:this.contextSrv.isAllowedInterval,minRefreshInterval:i.config.minRefreshInterval})}updateTimeRangeFromUrl(){const e=i.locationService.getSearch();if(e.get("left"))return;const t=this.timeRangeForUrl(),r=e.get("from"),n=e.get("to");r&&n?r===t.from&&n===t.to||(this.initTimeFromUrl(),this.setTime(this.time,!1)):this.timeHasChangedSinceLoad()&&this.setTime(this.timeAtLoad,!0)}timeHasChangedSinceLoad(){return this.timeAtLoad&&(this.timeAtLoad.from!==this.time.from||this.timeAtLoad.to!==this.time.to)}setAutoRefresh(t){this.timeModel&&(this.timeModel.refresh=t),this.stopAutoRefresh();const r=i.locationService.getSearchObject();if(!t)return void(r.refresh&&i.locationService.partial({refresh:null},!0));const n=this.contextSrv.getValidInterval(t),a=e.rangeUtil.intervalToMs(n);this.refreshTimer=setTimeout((()=>{this.startNextRefreshTimer(a),!this.autoRefreshPaused&&this.refreshTimeModel()}),a);const o=this.contextSrv.getValidInterval(t);r.refresh!==o&&i.locationService.partial({refresh:o},!0)}refreshTimeModel(){var e;null===(e=this.timeModel)||void 0===e||e.timeRangeUpdated(this.timeRange())}startNextRefreshTimer(e){this.refreshTimer=setTimeout((()=>{this.startNextRefreshTimer(e),this.contextSrv.isGrafanaVisible()?!this.autoRefreshPaused&&this.refreshTimeModel():this.autoRefreshBlocked=!0}),e)}stopAutoRefresh(){clearTimeout(this.refreshTimer)}pauseAutoRefresh(){this.autoRefreshPaused=!0}resumeAutoRefresh(){this.autoRefreshPaused=!1,this.refreshTimeModel()}setTime(t,r=!0){var n,a;if((0,G.extend)(this.time,t),(0,e.isDateTime)(t.to)?(this.oldRefresh=(null===(a=this.timeModel)||void 0===a?void 0:a.refresh)||this.oldRefresh,this.setAutoRefresh(!1)):this.oldRefresh&&this.oldRefresh!==(null===(n=this.timeModel)||void 0===n?void 0:n.refresh)&&(this.setAutoRefresh(this.oldRefresh),this.oldRefresh=null),!0===r){const e=this.timeRangeForUrl(),t=i.locationService.getSearchObject();if(t.from===e.from.toString()&&t.to===e.to.toString())return;t.from=e.from.toString(),t.to=e.to.toString(),i.locationService.partial(t)}this.refreshTimeModel()}timeRange(){var t,r;const n={from:(0,e.isDateTime)(this.time.from)?(0,e.dateTime)(this.time.from):this.time.from,to:(0,e.isDateTime)(this.time.to)?(0,e.dateTime)(this.time.to):this.time.to},i=this.timeModel?this.timeModel.getTimezone():void 0;return{from:e.dateMath.parse(n.from,!1,i,null===(t=this.timeModel)||void 0===t?void 0:t.fiscalYearStartMonth),to:e.dateMath.parse(n.to,!0,i,null===(r=this.timeModel)||void 0===r?void 0:r.fiscalYearStartMonth),raw:n}}zoomOut(t,r=!0){const n=this.timeRange(),{from:i,to:a}=((e,t)=>{const r=e.to.valueOf()-e.from.valueOf(),n=e.to.valueOf()-r/2,i=0===r?3e4:r*t;return{from:n-i/2,to:n+i/2}})(n,t);this.setTime({from:(0,e.toUtc)(i),to:(0,e.toUtc)(a)},r)}shiftTime(t,r=!0){const n=this.timeRange(),{from:i,to:a}=((t,r)=>{const n={from:(0,e.toUtc)(r.from),to:(0,e.toUtc)(r.to)},i=(n.to.valueOf()-n.from.valueOf())/2;let a,o;return-1===t?(a=n.to.valueOf()-i,o=n.from.valueOf()-i):1===t?(a=n.to.valueOf()+i,o=n.from.valueOf()+i,a>Date.now()&&n.to.valueOf()<Date.now()&&(a=Date.now(),o=n.from.valueOf())):(a=n.to.valueOf(),o=n.from.valueOf()),{from:o,to:a}})(t,n);this.setTime({from:(0,e.toUtc)(i),to:(0,e.toUtc)(a)},r)}makeAbsoluteTime(){if(i.locationService.getSearch().get("left"))return;const{from:e,to:t}=this.timeRange();this.setTime({from:e,to:t},!0)}isRefreshOutsideThreshold(t,r=.05){const n=this.timeRange();if(e.dateMath.isMathString(n.raw.from)){const e=n.to.diff(n.from);return Date.now()-t>=e*r}return!1}constructor(t){this.contextSrv=t,this.autoRefreshPaused=!1,this.timeRangeForUrl=()=>{const t=this.timeRange().raw;return(0,e.isDateTime)(t.from)&&(t.from=t.from.valueOf().toString()),(0,e.isDateTime)(t.to)&&(t.to=t.to.valueOf().toString()),t},this.time=(0,e.getDefaultTimeRange)().raw,this.refreshTimeModel=this.refreshTimeModel.bind(this),qb.subscribe(Sb,(e=>{this.zoomOut(e.payload.scale,e.payload.updateUrl)})),qb.subscribe(Eb,(e=>{this.shiftTime(e.payload.direction,e.payload.updateUrl)})),qb.subscribe(kb,(()=>{this.makeAbsoluteTime()})),document.addEventListener("visibilitychange",(()=>{this.autoRefreshBlocked&&"visible"===document.visibilityState&&(this.autoRefreshBlocked=!1,this.refreshTimeModel())}))}}function Xb(){return Vb||(Vb=new Wb(Ub)),Vb}class Gb{process(){if(this.query.match(/^label_names\(\)\s*$/))return this.labelNamesQuery();const e=this.query.match(/^label_values\((?:(.+),\s*)?([a-zA-Z_][a-zA-Z0-9_]*)\)\s*$/);if(e)return e[1]?this.labelValuesQuery(e[2],e[1]):this.labelValuesQuery(e[2]);const t=this.query.match(/^metrics\((.+)\)\s*$/);if(t)return this.metricNameQuery(t[1]);const r=this.query.match(/^query_result\((.+)\)\s*$/);return r?(0,wg.lastValueFrom)(this.queryResultQuery(r[1])):this.metricNameAndLabelsQuery(this.query)}labelNamesQuery(){const e=this.datasource.getPrometheusTime(this.range.from,!1),t=this.datasource.getPrometheusTime(this.range.to,!0),r={start:e.toString(),end:t.toString()};return this.datasource.metadataRequest("/api/v1/labels",r).then((e=>(0,G.map)(e.data.data,(e=>({text:e})))))}labelValuesQuery(e,t){const r=this.datasource.getPrometheusTime(this.range.from,!1),n=this.datasource.getPrometheusTime(this.range.to,!0);let i;if(t){const a={"match[]":t,start:r.toString(),end:n.toString()};return i="/api/v1/series",this.datasource.metadataRequest(i,a).then((t=>{const r=(0,G.map)(t.data.data,(t=>t[e]||"")).filter((e=>""!==e));return(0,G.uniq)(r).map((e=>({text:e,expandable:!0})))}))}{const t={start:r.toString(),end:n.toString()};return i=`/api/v1/label/${e}/values`,this.datasource.metadataRequest(i,t).then((e=>(0,G.map)(e.data.data,(e=>({text:e})))))}}metricNameQuery(e){const t=this.datasource.getPrometheusTime(this.range.from,!1),r=this.datasource.getPrometheusTime(this.range.to,!0),n={start:t.toString(),end:r.toString()};return this.datasource.metadataRequest("/api/v1/label/__name__/values",n).then((t=>(0,G.chain)(t.data.data).filter((t=>new RegExp(e).test(t))).map((e=>({text:e,expandable:!0}))).value()))}queryResultQuery(e){const t=this.datasource.getPrometheusTime(this.range.to,!0),r={expr:e};return this.datasource.performInstantQuery(r,t).pipe(sb((e=>{switch(e.data.data.resultType){case"scalar":case"string":return[{text:e.data.data.result[1]||"",expandable:!1}];case"vector":return(0,G.map)(e.data.data.result,(e=>{let t=e.metric.__name__||"";return delete e.metric.__name__,t+="{"+(0,G.map)(e.metric,((e,t)=>t+'="'+e+'"')).join(",")+"}",t+=" "+e.value[1]+" "+1e3*e.value[0],{text:t,expandable:!0}}));default:throw Error(`Unknown/Unhandled result type: [${e.data.data.resultType}]`)}})))}metricNameAndLabelsQuery(e){const t=this.datasource.getPrometheusTime(this.range.from,!1),r=this.datasource.getPrometheusTime(this.range.to,!0),n={"match[]":e,start:t.toString(),end:r.toString()},i=this;return this.datasource.metadataRequest("/api/v1/series",n).then((e=>(0,G.map)(e.data.data,(e=>({text:i.datasource.getOriginalMetricName(e),expandable:!0})))))}constructor(e,t){this.datasource=e,this.query=t,this.datasource=e,this.query=t,this.range=Xb().timeRange()}}function Hb(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yb(e,t,r){const n=[];if(e.trim().match(/^\w+_bucket$|^\w+_bucket{.*}$/)){const t="Selected metric has buckets.";n.push({type:"HISTOGRAM_QUANTILE",label:t,fix:{label:"Consider calculating aggregated quantile by adding histogram_quantile().",action:{type:"ADD_HISTOGRAM_QUANTILE",query:e}}})}if(-1===e.indexOf("rate(")&&-1===e.indexOf("increase(")){var i;const t=e.match(/\b(\w+_(total|sum|count))\b/);let o=t?t[1]:"";const s=null==r||null===(i=r.languageProvider)||void 0===i?void 0:i.metricsMetadata;let l=!1;var a;if(s)o=null!==(a=Array.from(e.matchAll(/\$?[a-zA-Z_:][a-zA-Z0-9_:]*/g)).map((([e])=>e)).filter((e=>!e.startsWith("$"))).flatMap((e=>e.split(":"))).find((e=>{const t=s[e];return!(!t||"counter"!==t.type.toLowerCase()||(l=!0,0))})))&&void 0!==a?a:"";if(o){const t=e.trim().match(/^\w+$|^\w+{.*}$/);let r,i=`Selected metric ${l?"is":"looks like"} a counter.`;t?r={label:"Consider calculating rate of counter by adding rate().",action:{type:"ADD_RATE",query:e}}:i=`${i} Consider calculating rate of counter by adding rate().`,n.push({type:"APPLY_RATE",label:i,fix:r})}}if(r&&r.ruleMappings){const t=r.ruleMappings,i=Object.keys(t).reduce(((r,n)=>{return e.search(n)>-1?(i=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Hb(e,t,r[t])}))}return e}({},r),a=null!=(a={[n]:t[n]})?a:{},Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(a)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(a)).forEach((function(e){Object.defineProperty(i,e,Object.getOwnPropertyDescriptor(a,e))})),i):r;var i,a}),{});if((0,G.size)(i)>0){const t="Query contains recording rules.";n.push({type:"EXPAND_RULES",label:t,fix:{label:"Expand rules",action:{type:"EXPAND_RULES",query:e,options:i}}})}}return t&&t.length>=20&&e.trim().match(/^\w+$/)&&n.push({type:"ADD_SUM",label:"Many time series results returned.",fix:{label:"Consider aggregating with sum().",action:{type:"ADD_SUM",query:e,preventSubmit:!0}}}),n}var Kb=m(8200);function Jb(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Zb(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Jb(e,t,r[t])}))}return e}function ev(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function tv(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}const rv=/^[+-]?inf(?:inity)?$/i;const nv="le";function iv(t,r){const n={format:r.target.format,step:r.query.step,legendFormat:r.target.legendFormat,start:r.query.start,end:r.query.end,query:r.query.expr,responseListLength:r.responseListLength,scopedVars:r.scopedVars,refId:r.target.refId,valueWithRefId:r.target.valueWithRefId,meta:{preferredVisualisationType:r.query.instant?"table":"graph"}},a=t.data.data;if(null!=(l=a)&&Array.isArray(l)&&l.length&&"exemplars"in l[0]){var o;const t=[];a.forEach((r=>{const n=r.exemplars.map((t=>Zb({[e.TIME_SERIES_TIME_FIELD_NAME]:1e3*t.timestamp,[e.TIME_SERIES_VALUE_FIELD_NAME]:t.value},t.labels,r.seriesLabels)));t.push(...n)}));const i=function(t,r){const n=r.step||15,i={},a=[];for(const r of t){const t=String(Math.floor(r[e.TIME_SERIES_TIME_FIELD_NAME]/1e3/n)*n*1e3);i[t]||(i[t]=[]),i[t].push(r),a.push(r[e.TIME_SERIES_VALUE_FIELD_NAME])}const o=(0,Kb.deviation)(a),s=Object.keys(i).sort(),l=[];for(const t of s){const r=i[t];if(1===r.length)l.push(r[0]);else{const t=r.map((t=>t[e.TIME_SERIES_VALUE_FIELD_NAME])).sort(Kb.descending).reduce(((e,t)=>{if(0===e.length)e.push(t);else{const r=e[e.length-1];o&&r-t>=2*o&&e.push(t)}return e}),[]);l.push(...t.map((t=>r.find((r=>r[e.TIME_SERIES_VALUE_FIELD_NAME]===t)))))}}return l}(t,n),l=new e.ArrayDataFrame(i);if(l.meta={dataTopic:e.DataTopic.Annotations},null===(o=r.exemplarTraceIdDestinations)||void 0===o?void 0:o.length)for(const e of r.exemplarTraceIdDestinations){const t=l.fields.find((t=>t.name===e.name));if(t){var s;const r=av(e);t.config.links=(null===(s=t.config.links)||void 0===s?void 0:s.length)?[...t.config.links,...r]:r}}return[l]}var l;if(!(null==a?void 0:a.result))return[];if("scalar"===a.resultType)return[{meta:n.meta,refId:n.refId,length:1,fields:[sv([a.result]),lv({data:[a.result]})]}];if("table"===n.format){const t=function(t,r){if(!t||0===t.length)return{meta:r.meta,refId:r.refId,length:0,fields:[]};const n=r.responseListLength>1||r.valueWithRefId?`Value #${r.refId}`:"Value",i=sv([]),a=Object.keys(t.reduce(((e,t)=>Zb({},e,t.metric)),{})).sort().map((t=>({name:t,config:{filterable:!0},type:t===nv?e.FieldType.number:e.FieldType.string,values:new e.ArrayVector}))),o=lv({data:[],valueName:n});return t.forEach((e=>{cn(e)?e.values.forEach((t=>{i.values.add(1e3*t[0]),a.forEach((t=>t.values.add(ov(e.metric,t.name)))),o.values.add(pv(t[1]))})):(i.values.add(1e3*e.value[0]),a.forEach((t=>t.values.add(ov(e.metric,t.name)))),o.values.add(pv(e.value[1])))})),{meta:r.meta,refId:r.refId,length:i.values.length,fields:[i,...a,o]}}(a.result,n);return[t]}const c=[];return a.result.forEach((t=>c.push(function(t,r){const{name:n,labels:a}=function(t,r){if(null==r?void 0:r.legendFormat)return{name:_b((0,i.getTemplateSrv)().replace(r.legendFormat,null==r?void 0:r.scopedVars),t),labels:t};const{__name__:n}=t,a=tv(t,["__name__"]);let o=`${null!=n?n:""}${(0,e.formatLabels)(a)}`;return o||(o=r.query),{name:o,labels:a}}(t.metric,r),o=[];if(cn(t)){const e=r.step?1e3*r.step:NaN;let i=1e3*r.start;const s=[];for(const r of t.values){let t=pv(r[1]);isNaN(t)&&(t=null);const n=1e3*r[0];for(let t=i;t<n;t+=e)s.push([t,null]);i=n+e,s.push([n,t])}const l=1e3*r.end;for(let t=i;t<=l;t+=e)s.push([t,null]);o.push(sv(s,!0)),o.push(lv({data:s,parseValue:!1,labels:a,displayNameFromDS:n}))}else o.push(sv([t.value])),o.push(lv({data:[t.value],labels:a,displayNameFromDS:n}));return{meta:r.meta,refId:r.refId,length:o[0].values.length,fields:o,name:n}}(t,n)))),"heatmap"===n.format?cv(uv(c.sort(dv))):c}function av(e){const t=[];if(e.datasourceUid){const n=(0,i.getDataSourceSrv)().getInstanceSettings(e.datasourceUid);var r;n&&t.push({title:e.urlDisplayLabel||`Query with ${null==n?void 0:n.name}`,url:"",internal:{query:{query:"${__value.raw}",queryType:"traceId"},datasourceUid:e.datasourceUid,datasourceName:null!==(r=null==n?void 0:n.name)&&void 0!==r?r:"Data source not found"}})}return e.url&&t.push({title:e.urlDisplayLabel||`Go to ${e.url}`,url:e.url,targetBlank:!0}),t}function ov(e,t){return e.hasOwnProperty(t)?t===nv?pv(e[t]):e[t]:""}function sv(t,r=!1){return{name:e.TIME_SERIES_TIME_FIELD_NAME,type:e.FieldType.time,config:{},values:new e.ArrayVector(t.map((e=>r?e[0]:1e3*e[0])))}}function lv({data:t,valueName:r=e.TIME_SERIES_VALUE_FIELD_NAME,parseValue:n=!0,labels:i,displayNameFromDS:a}){return{name:r,type:e.FieldType.number,display:(0,e.getDisplayProcessor)(),config:{displayNameFromDS:a},labels:i,values:new e.ArrayVector(t.map((e=>n?pv(e[1]):e[1])))}}function cv(t){if(0===t.length)return[];const r=t[0].fields.find((t=>t.type===e.FieldType.time)),n=t.map((t=>{let r=t.fields.find((t=>t.type===e.FieldType.number));return ev(Zb({},r),{name:r.config.displayNameFromDS})}));return[ev(Zb({},t[0]),{meta:ev(Zb({},t[0].meta),{type:e.DataFrameType.HeatmapRows}),fields:[r,...n]})]}function uv(t){for(let r=t.length-1;r>0;r--){const n=t[r].fields.find((t=>t.name===e.TIME_SERIES_VALUE_FIELD_NAME)),i=t[r-1].fields.find((t=>t.name===e.TIME_SERIES_VALUE_FIELD_NAME));if(!n||!i)throw new Error("Prometheus heatmap transform error: data should be a time series");for(let e=0;e<n.values.length;e++){const t=i.values.get(e)||[0];n.values.toArray()[e]-=t}}return t}function dv(e,t){let r,n;try{var i,a;r=pv(null!==(i=e.name)&&void 0!==i?i:""),n=pv(null!==(a=t.name)&&void 0!==a?a:"")}catch(e){return console.error(e),0}return r>n?1:r<n?-1:0}function pv(e){return rv.test(e)?"-"===e[0]?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY:parseFloat(e)}function hv(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class fv extends e.StandardVariableSupport{query(t){const r=t.targets[0].expr;if(!r)return(0,wg.of)({data:[]});const n=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){hv(e,t,r[t])}))}return e}({__interval:{text:this.datasource.interval,value:this.datasource.interval},__interval_ms:{text:e.rangeUtil.intervalToMs(this.datasource.interval),value:e.rangeUtil.intervalToMs(this.datasource.interval)}},this.datasource.getRangeScopedVars(this.timeSrv.timeRange())),i=this.templateSrv.replace(r,n,this.datasource.interpolateQueryExpr),a=new Gb(this.datasource,i);return(0,wg.from)(a.process()).pipe(sb((e=>({data:e}))))}toDataQuery(e){return{refId:"PrometheusDatasource-VariableQuery",expr:e.query}}constructor(e,t=(0,i.getTemplateSrv)(),r=Xb()){super(),this.datasource=e,this.templateSrv=t,this.timeSrv=r,this.query=this.query.bind(this)}}function mv(e,t,r,n,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function gv(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function o(e){mv(a,n,i,o,s,"next",e)}function s(e){mv(a,n,i,o,s,"throw",e)}o(void 0)}))}}function bv(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vv(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){bv(e,t,r[t])}))}return e}function yv(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}var Ov;!function(e){e.Lotex="Lotex",e.Mimir="Mimir",e.Prometheus="Prometheus"}(Ov||(Ov={}));const xv=["api/v1/query","api/v1/query_range","api/v1/series","api/v1/labels"];class wv extends i.DataSourceWithBackend{getQueryDisplayText(e){return e.expr}_addTracingHeaders(e,t){e.headers={},!this.url.match(/^http/)&&(e.headers["X-Dashboard-Id"]=t.dashboardId,e.headers["X-Dashboard-UID"]=t.dashboardUID||"",e.headers["X-Panel-Id"]=t.panelId)}_request(e,t,r={}){t=t||{};for(const[e,r]of this.customQueryParameters)null==t[e]&&(t[e]=r);let n=this.url+e;e.startsWith(`/api/datasources/proxy/${this.id}`)&&(n=e);const a=(0,G.defaults)(r,{url:n,method:this.httpMethod,headers:{}});return"GET"===a.method?t&&Object.keys(t).length&&(a.url=a.url+(a.url.search(/\?/)>=0?"&":"?")+Object.entries(t).map((([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`)).join("&")):(a.headers["Content-Type"]="application/x-www-form-urlencoded",a.data=t),(this.basicAuth||this.withCredentials)&&(a.withCredentials=!0),this.basicAuth&&(a.headers.Authorization=this.basicAuth),(0,i.getBackendSrv)().fetch(a)}importFromAbstractQueries(e){var t=this;return gv((function*(){return e.map((e=>t.languageProvider.importFromAbstractQuery(e)))}))()}exportToAbstractQueries(e){var t=this;return gv((function*(){return e.map((e=>t.languageProvider.exportToAbstractQuery(e)))}))()}metadataRequest(e,t={},r){var n=this;return gv((function*(){if(xv.some((t=>e.includes(t))))try{return yield(0,wg.lastValueFrom)(n._request(`/api/datasources/proxy/${n.id}${e}`,t,vv({method:n.httpMethod,hideFromInspector:!0,showErrorAlert:!1},r)))}catch(e){if("POST"!==n.httpMethod||!(0,i.isFetchError)(e)||405!==e.status&&400!==e.status)throw e;console.warn("Couldn't use configured POST HTTP method for this request. Trying to use GET method instead.")}return yield(0,wg.lastValueFrom)(n._request(`/api/datasources/proxy/${n.id}${e}`,t,vv({method:"GET",hideFromInspector:!0},r)))}))()}interpolateQueryExpr(e=[],t){if(!t.multi&&!t.includeAll)return _v(e);if("string"==typeof e)return Sv(e);const r=e.map((e=>Sv(e)));return 1===r.length?r[0]:"("+r.join("|")+")"}targetContainsTemplate(e){return this.templateSrv.containsTemplate(e.expr)}shouldRunExemplarQuery(e,t){if(e.exemplar){const r=this.languageProvider.histogramMetrics.find((t=>e.expr.includes(t))),n=t.targets.findIndex((t=>t.refId===e.refId)),i=t.targets.slice(0,n).filter((e=>!e.hide)),a=!r||r&&!i.some((e=>e.expr.includes(r)));return!!a}return!1}processTargetV2(e,t){return yv(vv({},e),{queryType:sn.timeSeriesQuery,exemplar:this.shouldRunExemplarQuery(e,t),requestId:t.panelId+e.refId,utcOffsetSec:60*this.timeSrv.timeRange().to.utcOffset()})}query(t){if("proxy"===this.access){const r=t.targets.map((e=>this.processTargetV2(e,t)));return super.query(yv(vv({},t),{targets:r})).pipe(sb((r=>function(t,r,n){const[i,a]=(0,G.partition)(t.data,(t=>((t,r)=>{var n,i,a,o;if(r.app===e.CoreApp.Explore&&("vector"===(null===(n=t.meta)||void 0===n||null===(i=n.custom)||void 0===i?void 0:i.resultType)||"scalar"===(null===(a=t.meta)||void 0===a||null===(o=a.custom)||void 0===o?void 0:o.resultType)))return!0;const s=r.targets.find((e=>e.refId===t.refId));return"table"===(null==s?void 0:s.format)})(t,r))),o=function(t){if(0===t.length||1===t.length&&0===t[0].length)return t;const r=(0,G.groupBy)(t,"refId"),n=Object.keys(r),i=n.map((i=>{const a=function(e,t=""){return e>1?`Value #${t}`:"Value"}(n.length,i),o=lv({data:[],valueName:a}),s=sv([]),l=[];return r[i].forEach((t=>{var r;const n=null!==(r=t.fields[1].labels)&&void 0!==r?r:{};Object.keys(n).sort().forEach((t=>{if(!l.some((e=>e.name===t))){const r=t===nv;l.push({name:t,config:{filterable:!0},type:r?e.FieldType.number:e.FieldType.string,values:new e.ArrayVector})}}))})),r[i].forEach((e=>{e.fields[0].values.toArray().forEach((e=>s.values.add(e))),e.fields[1].values.toArray().forEach((t=>{var r;o.values.add(pv(t));const n=null!==(r=e.fields[1].labels)&&void 0!==r?r:{};l.forEach((e=>e.values.add(ov(n,e.name))))}))})),{refId:i,fields:[s,...l,o],meta:ev(Zb({},t[0].meta),{preferredVisualisationType:"table"}),length:s.values.length}}));return i}(i),[s,l]=(0,G.partition)(a,(e=>{var t,r;return"exemplar"===(null===(t=e.meta)||void 0===t||null===(r=t.custom)||void 0===r?void 0:r.resultType)})),{exemplarTraceIdDestinations:c}=n,u=s.map((t=>{if(null==c?void 0:c.length)for(const e of c){const n=t.fields.find((t=>t.name===e.name));if(n){var r;const t=av(e);n.config.links=(null===(r=n.config.links)||void 0===r?void 0:r.length)?[...n.config.links,...t]:t}}return ev(Zb({},t),{meta:ev(Zb({},t.meta),{dataTopic:e.DataTopic.Annotations})})})),[d,p]=(0,G.partition)(l,(e=>((e,t)=>{const r=t.targets.find((t=>t.refId===e.refId));return"heatmap"===(null==r?void 0:r.format)})(e,r))),h=(0,G.groupBy)(d,(e=>e.refId));let f=[];for(const t in h){const r=h[t],n=(0,G.groupBy)(r,(t=>{const r=t.fields.find((t=>t.name===e.TIME_SERIES_VALUE_FIELD_NAME));if((null==r?void 0:r.labels)&&nv in r.labels){const e=null==r?void 0:r.labels,{le:t}=e,n=tv(e,["le"]);return Object.values(n).join()}var n;return Object.values(null!==(n=null==r?void 0:r.labels)&&void 0!==n?n:[]).join()}));(0,G.forOwn)(n,((e,t)=>{const r=e.sort(dv);f.push(cv(uv(r)))}))}const m=p.map((e=>ev(Zb({},e),{meta:ev(Zb({},e.meta),{preferredVisualisationType:"graph"})}))),g=(0,G.flatten)(f);return ev(Zb({},t),{data:[...m,...o,...g,...u]})}(r,t,{exemplarTraceIdDestinations:this.exemplarTraceIdDestinations}))))}{const r=this.getPrometheusTime(t.range.from,!1),n=this.getPrometheusTime(t.range.to,!0),{queries:i,activeTargets:a}=this.prepareTargets(t,r,n);return i&&i.length?t.app===e.CoreApp.Explore?this.exploreQuery(i,a,n):this.panelsQuery(i,a,n,t.requestId,t.scopedVars):(0,wg.of)({data:[],state:e.LoadingState.Done})}}exploreQuery(t,r,n){let i=t.length;const a=t.map(((a,o)=>{const s=r[o],l=(0,wg.pipe)((p=_g(c=()=>i--)?{next:c,error:u,complete:d}:c)?Sg((function(e,t){var r;null===(r=p.subscribe)||void 0===r||r.call(p);var n=!0;e.subscribe(ab(t,(function(e){var r;null===(r=p.next)||void 0===r||r.call(p,e),t.next(e)}),(function(){var e;n=!1,null===(e=p.complete)||void 0===e||e.call(p),t.complete()}),(function(e){var r;n=!1,null===(r=p.error)||void 0===r||r.call(p,e),t.error(e)}),(function(){var e,t;n&&(null===(e=p.unsubscribe)||void 0===e||e.call(p)),null===(t=p.finalize)||void 0===t||t.call(p)})))})):lb,cb((e=>!e.cancelled)),sb((r=>({data:iv(r,{query:a,target:s,responseListLength:t.length,exemplarTraceIdDestinations:this.exemplarTraceIdDestinations}),key:a.requestId,state:0===i?e.LoadingState.Done:e.LoadingState.Loading}))));var c,u,d,p;return this.runQuery(a,n,l)}));return(0,wg.merge)(...a)}panelsQuery(t,r,n,i,a){const o=t.map(((e,i)=>{const o=r[i],s=(0,wg.pipe)(cb((e=>!e.cancelled)),sb((r=>iv(r,{query:e,target:o,responseListLength:t.length,scopedVars:a,exemplarTraceIdDestinations:this.exemplarTraceIdDestinations}))));return this.runQuery(e,n,s)}));return(0,wg.forkJoin)(o).pipe(sb((t=>({data:t.reduce(((e,t)=>[...e,...t]),[]),key:i,state:e.LoadingState.Done}))))}runQuery(t,r,n){return t.instant?this.performInstantQuery(t,r).pipe(n):t.exemplar?this.getExemplars(t).pipe(bb((()=>(0,wg.of)({data:[],state:e.LoadingState.Done}))),n):this.performTimeSeriesQuery(t,t.start,t.end).pipe(n)}createQuery(t,r,n,i){const a={hinting:t.hinting,instant:t.instant,exemplar:t.exemplar,step:0,expr:"",requestId:t.requestId,refId:t.refId,start:0,end:0},o=Math.ceil(i-n);let s=e.rangeUtil.intervalToSeconds(r.interval);const l=e.rangeUtil.intervalToSeconds(this.templateSrv.replace(t.interval||r.interval,r.scopedVars)),c=t.interval?e.rangeUtil.intervalToSeconds(this.templateSrv.replace(t.interval,r.scopedVars)):e.rangeUtil.intervalToSeconds(this.interval),u=t.intervalFactor||1,d=this.adjustInterval(s,l,o,u);let p=vv({},r.scopedVars,this.getRangeScopedVars(r.range),this.getRateIntervalScopedVariable(d,c));s!==d&&(s=d,p=Object.assign({},r.scopedVars,vv({__interval:{text:s+"s",value:s+"s"},__interval_ms:{text:1e3*s,value:1e3*s}},this.getRateIntervalScopedVariable(s,c),this.getRangeScopedVars(r.range)))),a.step=s;let h=t.expr;h=this.enhanceExprWithAdHocFilters(h),a.expr=this.templateSrv.replace(h,p,this.interpolateQueryExpr);const f=function(e,t,r,n){return{end:Math.floor((t+n)/r)*r-n,start:Math.floor((e+n)/r)*r-n}}(n,i,a.step,60*this.timeSrv.timeRange().to.utcOffset());return a.start=f.start,a.end=f.end,this._addTracingHeaders(a,r),a}getRateIntervalScopedVariable(e,t){0===t&&(t=15);const r=Math.max(e+t,4*t);return{__rate_interval:{text:r+"s",value:r+"s"}}}adjustInterval(e,t,r,n){let i=r/11e3;return i>1&&(i=Math.ceil(i)),Math.max(e*n,t,i)}performTimeSeriesQuery(e,t,r){if(t>r)throw{message:"Invalid time range"};const n={query:e.expr,start:t,end:r,step:e.step};return this.queryTimeout&&(n.timeout=this.queryTimeout),this._request("/api/v1/query_range",n,{requestId:e.requestId,headers:e.headers}).pipe(bb((t=>t.cancelled?(0,wg.of)(t):(0,wg.throwError)(this.handleErrors(t,e)))))}performInstantQuery(e,t){const r={query:e.expr,time:t};return this.queryTimeout&&(r.timeout=this.queryTimeout),this._request("/api/v1/query",r,{requestId:e.requestId,headers:e.headers}).pipe(bb((t=>t.cancelled?(0,wg.of)(t):(0,wg.throwError)(this.handleErrors(t,e)))))}metricFindQuery(t){if(!t)return Promise.resolve([]);const r=vv({__interval:{text:this.interval,value:this.interval},__interval_ms:{text:e.rangeUtil.intervalToMs(this.interval),value:e.rangeUtil.intervalToMs(this.interval)}},this.getRangeScopedVars(this.timeSrv.timeRange())),n=this.templateSrv.replace(t,r,this.interpolateQueryExpr);return new Gb(this,n).process()}getRangeScopedVars(e=this.timeSrv.timeRange()){const t=e.to.diff(e.from),r=Math.round(t/1e3);return{__range_ms:{text:t,value:t},__range_s:{text:r,value:r},__range:{text:r+"s",value:r+"s"}}}annotationQuery(e){var t=this;return gv((function*(){const r=e.annotation,{expr:n=""}=r;if(!n)return Promise.resolve([]);const a={expr:n,range:!0,instant:!1,exemplar:!1,interval:e.annotation.step||"60s",queryType:sn.timeSeriesQuery,refId:"X",datasource:t.getRef()};return yield(0,wg.lastValueFrom)((0,i.getBackendSrv)().fetch({url:"/api/ds/query",method:"POST",data:{from:(1e3*t.getPrometheusTime(e.range.from,!1)).toString(),to:(1e3*t.getPrometheusTime(e.range.to,!0)).toString(),queries:[t.applyTemplateVariables(a,{})]},requestId:`prom-query-${r.name}`}).pipe(sb((r=>t.processAnnotationResponse(e,r.data)))))}))()}getExemplars(e){return this._request("/api/v1/query_exemplars",{query:e.expr,start:e.start.toString(),end:e.end.toString()},{requestId:e.requestId,headers:e.headers})}getTagKeys(e){var t=this;return gv((function*(){if(null==e?void 0:e.series){const r=yield Promise.all(e.series.map((e=>t.languageProvider.fetchSeriesLabels(e))));let n=[];return r.map((e=>n=n.concat(Object.keys(e)))),[...new Set(n)].map((e=>({text:e})))}{var r,n;const e=yield t.metadataRequest("/api/v1/labels");var i;return null!==(i=null==e||null===(r=e.data)||void 0===r||null===(n=r.data)||void 0===n?void 0:n.map((e=>({text:e}))))&&void 0!==i?i:[]}}))()}getTagValues(e={}){var t=this;return gv((function*(){var r,n;const i=yield t.metadataRequest(`/api/v1/label/${e.key}/values`);var a;return null!==(a=null==i||null===(r=i.data)||void 0===r||null===(n=r.data)||void 0===n?void 0:n.map((e=>({text:e}))))&&void 0!==a?a:[]}))()}testDatasource(){var t=this;return gv((function*(){const r=(new Date).getTime(),n={targets:[{refId:"test",expr:"1+1",instant:!0}],requestId:`${t.id}-health`,scopedVars:{},dashboardId:0,panelId:0,interval:"1m",intervalMs:6e4,maxDataPoints:1,range:{from:(0,e.dateTime)(r-1e3),to:(0,e.dateTime)(r)}};return(0,wg.lastValueFrom)(t.query(n)).then((t=>{return t&&t.data&&t.state===e.LoadingState.Done?{status:"success",message:"Data source is working"}:{status:"error",message:`Error reading Prometheus: ${null==t||null===(r=t.error)||void 0===r?void 0:r.message}`};var r})).catch((e=>(console.error("Prometheus Error",e),{status:"error",message:e.message})))}))()}interpolateVariablesInQueries(e,t){let r=e;return e&&e.length&&(r=e.map((e=>yv(vv({},e),{datasource:this.getRef(),expr:this.templateSrv.replace(e.expr,t,this.interpolateQueryExpr),interval:this.templateSrv.replace(e.interval,t)})))),r}getQueryHints(e,t){var r;return Yb(null!==(r=e.expr)&&void 0!==r?r:"",t,this)}getInitHints(){return function(e){const t=[];return e.directUrl.includes("/loki")&&!e.languageProvider.metrics.length&&t.push({label:"Using Loki as a Prometheus data source is no longer supported. You must use the Loki data source for your Loki instance.",type:"INFO"}),e.lookupsDisabled&&t.push({label:"Labels and metrics lookup was disabled in data source settings.",type:"INFO"}),t}(this)}loadRules(){var e=this;return gv((function*(){try{var t,r;const n=null===(t=(yield e.metadataRequest("/api/v1/rules",{},{showErrorAlert:!1})).data)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.groups;n&&(e.ruleMappings=function(e){return e.reduce(((e,t)=>t.rules.filter((e=>"recording"===e.type)).reduce(((e,t)=>yv(vv({},e),{[t.name]:t.query})),e)),{})}(n))}catch(e){console.log("Rules API is experimental. Ignore next error."),console.error(e)}}))()}areExemplarsAvailable(){var t=this;return gv((function*(){try{return"success"===(yield t.metadataRequest("/api/v1/query_exemplars",{query:"test",start:(0,e.dateTime)().subtract(30,"minutes").valueOf().toString(),end:(0,e.dateTime)().valueOf().toString()},{showErrorAlert:!1})).data.status}catch(e){return!1}}))()}modifyQuery(e,t){var r;let n=null!==(r=e.expr)&&void 0!==r?r:"";switch(t.type){case"ADD_FILTER":{var i;const{key:e,value:r}=null!==(i=t.options)&&void 0!==i?i:{};e&&r&&(n=Di(n,e,r));break}case"ADD_FILTER_OUT":{var a;const{key:e,value:r}=null!==(a=t.options)&&void 0!==a?a:{};e&&r&&(n=Di(n,e,r,"!="));break}case"ADD_HISTOGRAM_QUANTILE":n=`histogram_quantile(0.95, sum(rate(${n}[$__rate_interval])) by (le))`;break;case"ADD_RATE":n=`rate(${n}[$__rate_interval])`;break;case"ADD_SUM":n=`sum(${n.trim()}) by ($1)`;break;case"EXPAND_RULES":t.options&&(n=function(e,t){const r=Object.keys(t),n=new RegExp(`(\\s|^)(${r.join("|")})(\\s|$|\\(|\\[|\\{)`,"ig"),i=e.replace(n,((e,r,n,i)=>`${r}${t[n]}${i}`)).split(/(\+|\-|\*|\/|\%|\^)/),a=/(\)\{|\}\{|\]\{)/,o=i.map((e=>function(e,t){const r=e.match(t);if(!r)return e;var n;const i=null!==(n=r.index)&&void 0!==n?n:0,a=e.slice(0,i+1),o=e.slice(i+1),s=[];o.replace(Ni,((e,t,r,n)=>(s.push({key:t,operator:r,value:n}),"")));let l=a;return s.filter(Boolean).forEach((e=>{const t=e.value.slice(1,-1);l=Di(l,e.key,t,e.operator)})),l}(e,a)));return o.join("")}(n,t.options))}return yv(vv({},e),{expr:n})}getPrometheusTime(t,r){return"string"==typeof t&&(t=e.dateMath.parse(t,r)),Math.ceil(t.valueOf()/1e3)}getTimeRangeParams(){const e=this.timeSrv.timeRange();return{start:this.getPrometheusTime(e.from,!1).toString(),end:this.getPrometheusTime(e.to,!0).toString()}}getOriginalMetricName(e){return function(e){const t=e.__name__||"";return delete e.__name__,`${t}{${Object.entries(e).map((e=>`${e[0]}="${e[1]}"`)).join(",")}}`}(e)}enhanceExprWithAdHocFilters(e){return this.templateSrv.getAdhocFilters(this.name).reduce(((e,t)=>{const{key:r,operator:n}=t;let{value:i}=t;return"=~"!==n&&"!~"!==n||(i=_v(i)),Di(e,r,i,n)}),e)}filterQuery(e){return!(e.hide||!e.expr)}applyTemplateVariables(e,t){const r=(0,G.cloneDeep)(t);delete r.__interval,delete r.__interval_ms;const n=this.enhanceExprWithAdHocFilters(e.expr);return yv(vv({},e),{legendFormat:this.templateSrv.replace(e.legendFormat,r),expr:this.templateSrv.replace(n,r,this.interpolateQueryExpr),interval:this.templateSrv.replace(e.interval,r)})}getVariables(){return this.templateSrv.getVariables().map((e=>`$${e.name}`))}interpolateString(e){return this.templateSrv.replace(e,void 0,this.interpolateQueryExpr)}constructor(t,r=(0,i.getTemplateSrv)(),n=Xb(),a){super(t),this.templateSrv=r,this.timeSrv=n;var o,s,l=this;this.init=gv((function*(){yield l.loadRules(),l.exemplarsAvailable=yield l.areExemplarsAvailable()})),this.prepareTargets=(t,r,n)=>{const i=[],a=[],o=(0,G.cloneDeep)(t.targets);for(const s of o){if(!s.expr||s.hide)continue;s.requestId=t.panelId+s.refId;const o=this.languageProvider.histogramMetrics.find((e=>s.expr.includes(e)));if(t.app===e.CoreApp.Explore&&s.range===s.instant){const e=(0,G.cloneDeep)(s);e.format="table",e.instant=!0,e.range=!1,e.valueWithRefId=!0,delete e.maxDataPoints,e.requestId+="_instant";const l=(0,G.cloneDeep)(s);if(l.format="time_series",l.instant=!1,e.range=!0,s.exemplar){if(!o||o&&!a.some((e=>e.expr.includes(o)))){const e=(0,G.cloneDeep)(s);e.instant=!1,e.requestId+="_exemplar",i.push(this.createQuery(e,t,r,n)),a.push(e)}e.exemplar=!1,l.exemplar=!1}a.push(e,l),i.push(this.createQuery(e,t,r,n),this.createQuery(l,t,r,n))}else if(s.instant&&t.app===e.CoreApp.Explore){const e=(0,G.cloneDeep)(s);e.format="table",i.push(this.createQuery(e,t,r,n)),a.push(e)}else{if(s.exemplar&&!s.instant){if(!o||o&&!a.some((e=>e.expr.includes(o)))){const e=(0,G.cloneDeep)(s);e.requestId+="_exemplar",i.push(this.createQuery(e,t,r,n)),a.push(e)}s.exemplar=!1}i.push(this.createQuery(s,t,r,n)),a.push(s)}}return{queries:i,activeTargets:a}},this.handleErrors=(e,t)=>{const r={message:e&&e.statusText||"Unknown error during query transaction. Please check JS console logs.",refId:t.refId};return e.data?"string"==typeof e.data?r.message=e.data:e.data.error&&(r.message=((e,t)=>{if(!e)return"";try{return JSON.stringify(e,null,void 0)}catch(e){console.error(e)}return""})(e.data.error)):e.message?r.message=e.message:"string"==typeof e&&(r.message=e),r.status=e.status,r.statusText=e.statusText,r},this.processAnnotationResponse=(t,r)=>{const n=(0,i.toDataQueryResponse)({data:r}).data;if(!n||!n.length)return[];const a=t.annotation,{tagKeys:o="",titleFormat:s="",textFormat:l=""}=a,c=1e3*e.rangeUtil.intervalToSeconds(a.step||"60s"),u=o.split(","),d=[];for(const e of n){const r=e.fields[0],n=e.fields[1],i=(null==n?void 0:n.labels)||{},o=Object.keys(i).filter((e=>u.includes(e))).map((e=>i[e])),h=[];let f=0;n.values.toArray().forEach((e=>{let n,i;const a=r.values.get(f);t.annotation.useValueForTime?(n=Math.floor(parseFloat(e)),i=1):(n=Math.floor(parseFloat(a)),i=parseFloat(e)),f++,h.push([n,i])}));const m=h.filter((e=>e[1]>=1)).map((e=>e[0]));let g=null;for(const e of m){var p;g&&(null!==(p=g.timeEnd)&&void 0!==p?p:0)+c>=e?g.timeEnd=e:(g&&d.push(g),g={time:e,timeEnd:e,annotation:a,title:_b(s,i),tags:o,text:_b(l,i)})}g&&(g.timeEnd=m[m.length-1],d.push(g))}return d},this.type="prometheus",this.subType=Ov.Prometheus,this.rulerEnabled=!1,this.editorSrc="app/features/prometheus/partials/query.editor.html",this.id=t.id,this.url=t.url,this.access="direct",this.basicAuth=t.basicAuth,this.withCredentials=t.withCredentials,this.interval=t.jsonData.timeInterval||"15s",this.queryTimeout=t.jsonData.queryTimeout,this.httpMethod=t.jsonData.httpMethod||"GET",this.directUrl=null!==(o=t.jsonData.directUrl)&&void 0!==o?o:this.url,this.exemplarTraceIdDestinations=t.jsonData.exemplarTraceIdDestinations,this.ruleMappings={},this.languageProvider=null!=a?a:new ia(this),this.lookupsDisabled=null!==(s=t.jsonData.disableMetricsLookup)&&void 0!==s&&s,this.customQueryParameters=new URLSearchParams(t.jsonData.customQueryParameters),this.variables=new fv(this,this.templateSrv,this.timeSrv),this.exemplarsAvailable=!0,this.annotations={QueryEditor:wb}}}function _v(e){return"string"==typeof e?e.replace(/\\/g,"\\\\").replace(/'/g,"\\\\'"):e}function Sv(e){return"string"==typeof e?e.replace(/\\/g,"\\\\\\\\").replace(/[$^*{}\[\]'+?.()|]/g,"\\\\$&"):e}const Ev=new e.DataSourcePlugin(wv).setQueryEditor(Kf).setConfigEditor((e=>{const{options:n,onOptionsChange:o}=e,s=Object.values(i.config.datasources).filter((e=>e.type===Bm.Alertmanager)),l=(0,t.useRef)("direct"===e.options.access),c={azureAuthSupported:i.config.azureAuthEnabled,getAzureAuthEnabled:e=>function(e){return!!e.jsonData.azureCredentials}(e),setAzureAuthEnabled:(e,t)=>t?function(e){return{jsonData:Um(Vm({},e.jsonData),{azureCredentials:Hm()})}}(e):function(e){return{jsonData:Um(Vm({},e.jsonData),{azureAuth:void 0,azureCredentials:void 0,azureEndpointResourceId:void 0})}}(e),azureSettingsUI:ig};return r().createElement(r().Fragment,null,"direct"===n.access&&r().createElement(a.Alert,{title:"Error",severity:"error"},"Browser access mode in the Prometheus datasource is no longer available. Switch to server access mode."),r().createElement("div",{className:"gf-form-group"},r().createElement("h3",{className:"page-heading"},"Tips on how to setup"),r().createElement("div",{className:"submenu-controls"},r().createElement("div",{className:"gf-form"},r().createElement("a",{className:"gf-form-label gf-form-label--dashlink",href:"https://docs.victoriametrics.com/Cluster-VictoriaMetrics.html#url-format",target:"_blank",rel:"noreferrer"},r().createElement(a.Icon,{name:"file-alt"}),r().createElement("span",{style:{marginLeft:"4px"}},"Cluster VM"))),r().createElement("div",{className:"gf-form"},r().createElement("a",{className:"gf-form-label gf-form-label--dashlink",href:"https://docs.victoriametrics.com/Single-server-VictoriaMetrics.html#grafana-setup",target:"_blank",rel:"noreferrer"},r().createElement(a.Icon,{name:"file-alt"}),r().createElement("span",{style:{marginLeft:"4px"}},"Grafana setup"))))),r().createElement(a.DataSourceHttpSettings,{defaultUrl:"http://localhost:8428",dataSourceConfig:n,showAccessOptions:l.current,onChange:o,sigV4AuthToggleEnabled:i.config.sigV4AuthEnabled,azureAuthSettings:c,renderSigV4Editor:r().createElement(_m.SIGV4ConnectionConfig,xg({},e))}),r().createElement(a.AlertingSettings,{alertmanagerDataSources:s,options:n,onOptionsChange:o}),r().createElement(bg,{options:n,onOptionsChange:o}))})).setQueryEditorHelp((e=>r().createElement("div",null,r().createElement("h2",null,"PromQL Cheat Sheet"),n.map(((t,n)=>r().createElement("div",{className:"cheat-sheet-item",key:n},r().createElement("div",{className:"cheat-sheet-item__title"},t.title),t.expression?r().createElement("div",{className:"cheat-sheet-item__example",onClick:r=>e.onClickExample({refId:"A",expr:t.expression})},r().createElement("code",null,t.expression)):null,r().createElement("div",{className:"cheat-sheet-item__label"},t.label)))))))})(),g})()));
//# sourceMappingURL=module.js.map